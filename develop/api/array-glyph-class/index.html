
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Visualization package">
      
      
      
        <link rel="canonical" href="https://serapieum-of-alex.github.io/cleopatra/develop/api/array-glyph-class/">
      
      
        <link rel="prev" href="../statistics-class/">
      
      
        <link rel="next" href="../colors-class/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>ArrayGlyph - Cleopatra</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#array-class" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Cleopatra" class="md-header__button md-logo" aria-label="Cleopatra" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Cleopatra
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ArrayGlyph
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="lime"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Serapieum-of-alex/cleopatra" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    Serapieum-of-alex/cleopatra
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../installation/" class="md-tabs__link">
        
  
  
    
  
  Installation

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../statistics-class/" class="md-tabs__link">
          
  
  
    
  
  API Documentation

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../notebooks/array_glyph/array_glyph_examples/" class="md-tabs__link">
          
  
  
    
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../change-log/" class="md-tabs__link">
        
  
  
    
  
  Change-log

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Cleopatra" class="md-nav__button md-logo" aria-label="Cleopatra" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Cleopatra
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Serapieum-of-alex/cleopatra" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    Serapieum-of-alex/cleopatra
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API Documentation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            API Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../statistics-class/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Statistical plots
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    ArrayGlyph
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    ArrayGlyph
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#class-documentation" class="md-nav__link">
    <span class="md-ellipsis">
      Class Documentation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Class Documentation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph" class="md-nav__link">
    <span class="md-ellipsis">
      ArrayGlyph
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ArrayGlyph">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.anim" class="md-nav__link">
    <span class="md-ellipsis">
      anim
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.arr" class="md-nav__link">
    <span class="md-ellipsis">
      arr
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.default_options" class="md-nav__link">
    <span class="md-ellipsis">
      default_options
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.exclude_value" class="md-nav__link">
    <span class="md-ellipsis">
      exclude_value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.vmax" class="md-nav__link">
    <span class="md-ellipsis">
      vmax
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.vmin" class="md-nav__link">
    <span class="md-ellipsis">
      vmin
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.__str__" class="md-nav__link">
    <span class="md-ellipsis">
      __str__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.adjust_ticks" class="md-nav__link">
    <span class="md-ellipsis">
      adjust_ticks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.animate" class="md-nav__link">
    <span class="md-ellipsis">
      animate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.apply_colormap" class="md-nav__link">
    <span class="md-ellipsis">
      apply_colormap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.create_color_bar" class="md-nav__link">
    <span class="md-ellipsis">
      create_color_bar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.create_figure_axes" class="md-nav__link">
    <span class="md-ellipsis">
      create_figure_axes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.get_ticks" class="md-nav__link">
    <span class="md-ellipsis">
      get_ticks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.plot" class="md-nav__link">
    <span class="md-ellipsis">
      plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.prepare_array" class="md-nav__link">
    <span class="md-ellipsis">
      prepare_array
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.save_animation" class="md-nav__link">
    <span class="md-ellipsis">
      save_animation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.scale_percentile" class="md-nav__link">
    <span class="md-ellipsis">
      scale_percentile
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.scale_to_rgb" class="md-nav__link">
    <span class="md-ellipsis">
      scale_to_rgb
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.to_image" class="md-nav__link">
    <span class="md-ellipsis">
      to_image
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-array-plot" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Array Plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#display-cell-values" class="md-nav__link">
    <span class="md-ellipsis">
      Display Cell Values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#display-points" class="md-nav__link">
    <span class="md-ellipsis">
      Display Points
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#animation" class="md-nav__link">
    <span class="md-ellipsis">
      Animation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../colors-class/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Colors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../styles-class/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Styles
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/array_glyph/array_glyph_examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ArrayGlyph
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/statistics/statistics_examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Statistics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/colors/colors_examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Colors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/styles/styles_examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Styles
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../change-log/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Change-log
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#class-documentation" class="md-nav__link">
    <span class="md-ellipsis">
      Class Documentation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Class Documentation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph" class="md-nav__link">
    <span class="md-ellipsis">
      ArrayGlyph
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ArrayGlyph">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.anim" class="md-nav__link">
    <span class="md-ellipsis">
      anim
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.arr" class="md-nav__link">
    <span class="md-ellipsis">
      arr
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.default_options" class="md-nav__link">
    <span class="md-ellipsis">
      default_options
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.exclude_value" class="md-nav__link">
    <span class="md-ellipsis">
      exclude_value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.vmax" class="md-nav__link">
    <span class="md-ellipsis">
      vmax
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.vmin" class="md-nav__link">
    <span class="md-ellipsis">
      vmin
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.__str__" class="md-nav__link">
    <span class="md-ellipsis">
      __str__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.adjust_ticks" class="md-nav__link">
    <span class="md-ellipsis">
      adjust_ticks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.animate" class="md-nav__link">
    <span class="md-ellipsis">
      animate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.apply_colormap" class="md-nav__link">
    <span class="md-ellipsis">
      apply_colormap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.create_color_bar" class="md-nav__link">
    <span class="md-ellipsis">
      create_color_bar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.create_figure_axes" class="md-nav__link">
    <span class="md-ellipsis">
      create_figure_axes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.get_ticks" class="md-nav__link">
    <span class="md-ellipsis">
      get_ticks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.plot" class="md-nav__link">
    <span class="md-ellipsis">
      plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.prepare_array" class="md-nav__link">
    <span class="md-ellipsis">
      prepare_array
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.save_animation" class="md-nav__link">
    <span class="md-ellipsis">
      save_animation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.scale_percentile" class="md-nav__link">
    <span class="md-ellipsis">
      scale_percentile
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.scale_to_rgb" class="md-nav__link">
    <span class="md-ellipsis">
      scale_to_rgb
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cleopatra.array_glyph.ArrayGlyph.to_image" class="md-nav__link">
    <span class="md-ellipsis">
      to_image
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-array-plot" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Array Plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#display-cell-values" class="md-nav__link">
    <span class="md-ellipsis">
      Display Cell Values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#display-points" class="md-nav__link">
    <span class="md-ellipsis">
      Display Points
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#animation" class="md-nav__link">
    <span class="md-ellipsis">
      Animation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/Serapieum-of-alex/cleopatra/edit/master/docs/api/array-glyph-class.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/Serapieum-of-alex/cleopatra/raw/master/docs/api/array-glyph-class.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="array-class"><a class="toclink" href="#array-class">Array Class</a><a class="headerlink" href="#array-class" title="Permanent link">#</a></h1>
<p>The <code>ArrayGlyph</code> class provides functionality for visualizing and manipulating arrays, including plotting, animating, and saving animations.</p>
<h2 id="class-documentation"><a class="toclink" href="#class-documentation">Class Documentation</a><a class="headerlink" href="#class-documentation" title="Permanent link">#</a></h2>


<div class="doc doc-object doc-class">



<h3 id="cleopatra.array_glyph.ArrayGlyph" class="doc doc-heading"><a href="#cleopatra.array_glyph.ArrayGlyph" class="toclink">
            <code>cleopatra.array_glyph.ArrayGlyph</code>


</a><a href="#cleopatra.array_glyph.ArrayGlyph" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents first">


        <p>A class to handle arrays and perform various visualization operations on them.</p>
<p>The ArrayGlyph class provides functionality for visualizing 2D and 3D arrays with
various customization options. It supports plotting single arrays, RGB arrays,
and creating animations from 3D arrays.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="cleopatra.array_glyph.ArrayGlyph.fig">fig</span></code></td>
            <td>
                  <code><span title="matplotlib.figure.Figure">Figure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The matplotlib figure object.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="cleopatra.array_glyph.ArrayGlyph.ax">ax</span></code></td>
            <td>
                  <code><span title="matplotlib.axes.Axes">Axes</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The matplotlib axes object.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="cleopatra.array_glyph.ArrayGlyph.extent">extent</span></code></td>
            <td>
                  <code><span title="typing.List">List</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The extent of the array [xmin, xmax, ymin, ymax].</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="cleopatra.array_glyph.ArrayGlyph.rgb">rgb</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the array is an RGB array.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="cleopatra.array_glyph.ArrayGlyph.no_elem">no_elem</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of elements in the array.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;highlight language-python&quot;&gt;&lt;span class=&quot;n&quot;&gt;anim&lt;/span&gt;&lt;/code&gt;

  &lt;span class=&quot;doc doc-labels&quot;&gt;
      &lt;small class=&quot;doc doc-label doc-label-property&quot;&gt;&lt;code&gt;property&lt;/code&gt;&lt;/small&gt;
  &lt;/span&gt; (&lt;code&gt;cleopatra.array_glyph.ArrayGlyph.anim&lt;/code&gt;)" href="#cleopatra.array_glyph.ArrayGlyph.anim">anim</a></code></td>
            <td>
                  <code><span title="matplotlib.animation.FuncAnimation">FuncAnimation</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The animation object if created.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <p>This class provides methods for:
- Plotting arrays with customizable color scales, color bars, and annotations
- Creating animations from 3D arrays
- Displaying point values on arrays
- Customizing plot appearance</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <ul>
<li>Create a simple array plot:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">cleopatra.array_glyph</span><span class="w"> </span><span class="kn">import</span> <span class="n">ArrayGlyph</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]])</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">array_glyph</span> <span class="o">=</span> <span class="n">ArrayGlyph</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">array_glyph</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</code></pre></div></li>
<li>Create an RGB plot from a 3D array:
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">rgb_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">rgb_glyph</span> <span class="o">=</span> <span class="n">ArrayGlyph</span><span class="p">(</span><span class="n">rgb_array</span><span class="p">,</span> <span class="n">rgb</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">rgb_glyph</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</code></pre></div></li>
<li>Create an animated plot from a 3D array:
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">time_series</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">time_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Frame 1&quot;</span><span class="p">,</span> <span class="s2">&quot;Frame 2&quot;</span><span class="p">,</span> <span class="s2">&quot;Frame 3&quot;</span><span class="p">,</span> <span class="s2">&quot;Frame 4&quot;</span><span class="p">,</span> <span class="s2">&quot;Frame 5&quot;</span><span class="p">]</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">animated_glyph</span> <span class="o">=</span> <span class="n">ArrayGlyph</span><span class="p">(</span><span class="n">time_series</span><span class="p">)</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">anim</span> <span class="o">=</span> <span class="n">animated_glyph</span><span class="o">.</span><span class="n">animate</span><span class="p">(</span><span class="n">time_labels</span><span class="p">)</span>
</code></pre></div></li>
</ul>







              <details class="quote">
                <summary>Source code in <code>cleopatra/array_glyph.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-61">  61</a></span>
<span class="normal"><a href="#__codelineno-0-62">  62</a></span>
<span class="normal"><a href="#__codelineno-0-63">  63</a></span>
<span class="normal"><a href="#__codelineno-0-64">  64</a></span>
<span class="normal"><a href="#__codelineno-0-65">  65</a></span>
<span class="normal"><a href="#__codelineno-0-66">  66</a></span>
<span class="normal"><a href="#__codelineno-0-67">  67</a></span>
<span class="normal"><a href="#__codelineno-0-68">  68</a></span>
<span class="normal"><a href="#__codelineno-0-69">  69</a></span>
<span class="normal"><a href="#__codelineno-0-70">  70</a></span>
<span class="normal"><a href="#__codelineno-0-71">  71</a></span>
<span class="normal"><a href="#__codelineno-0-72">  72</a></span>
<span class="normal"><a href="#__codelineno-0-73">  73</a></span>
<span class="normal"><a href="#__codelineno-0-74">  74</a></span>
<span class="normal"><a href="#__codelineno-0-75">  75</a></span>
<span class="normal"><a href="#__codelineno-0-76">  76</a></span>
<span class="normal"><a href="#__codelineno-0-77">  77</a></span>
<span class="normal"><a href="#__codelineno-0-78">  78</a></span>
<span class="normal"><a href="#__codelineno-0-79">  79</a></span>
<span class="normal"><a href="#__codelineno-0-80">  80</a></span>
<span class="normal"><a href="#__codelineno-0-81">  81</a></span>
<span class="normal"><a href="#__codelineno-0-82">  82</a></span>
<span class="normal"><a href="#__codelineno-0-83">  83</a></span>
<span class="normal"><a href="#__codelineno-0-84">  84</a></span>
<span class="normal"><a href="#__codelineno-0-85">  85</a></span>
<span class="normal"><a href="#__codelineno-0-86">  86</a></span>
<span class="normal"><a href="#__codelineno-0-87">  87</a></span>
<span class="normal"><a href="#__codelineno-0-88">  88</a></span>
<span class="normal"><a href="#__codelineno-0-89">  89</a></span>
<span class="normal"><a href="#__codelineno-0-90">  90</a></span>
<span class="normal"><a href="#__codelineno-0-91">  91</a></span>
<span class="normal"><a href="#__codelineno-0-92">  92</a></span>
<span class="normal"><a href="#__codelineno-0-93">  93</a></span>
<span class="normal"><a href="#__codelineno-0-94">  94</a></span>
<span class="normal"><a href="#__codelineno-0-95">  95</a></span>
<span class="normal"><a href="#__codelineno-0-96">  96</a></span>
<span class="normal"><a href="#__codelineno-0-97">  97</a></span>
<span class="normal"><a href="#__codelineno-0-98">  98</a></span>
<span class="normal"><a href="#__codelineno-0-99">  99</a></span>
<span class="normal"><a href="#__codelineno-0-100"> 100</a></span>
<span class="normal"><a href="#__codelineno-0-101"> 101</a></span>
<span class="normal"><a href="#__codelineno-0-102"> 102</a></span>
<span class="normal"><a href="#__codelineno-0-103"> 103</a></span>
<span class="normal"><a href="#__codelineno-0-104"> 104</a></span>
<span class="normal"><a href="#__codelineno-0-105"> 105</a></span>
<span class="normal"><a href="#__codelineno-0-106"> 106</a></span>
<span class="normal"><a href="#__codelineno-0-107"> 107</a></span>
<span class="normal"><a href="#__codelineno-0-108"> 108</a></span>
<span class="normal"><a href="#__codelineno-0-109"> 109</a></span>
<span class="normal"><a href="#__codelineno-0-110"> 110</a></span>
<span class="normal"><a href="#__codelineno-0-111"> 111</a></span>
<span class="normal"><a href="#__codelineno-0-112"> 112</a></span>
<span class="normal"><a href="#__codelineno-0-113"> 113</a></span>
<span class="normal"><a href="#__codelineno-0-114"> 114</a></span>
<span class="normal"><a href="#__codelineno-0-115"> 115</a></span>
<span class="normal"><a href="#__codelineno-0-116"> 116</a></span>
<span class="normal"><a href="#__codelineno-0-117"> 117</a></span>
<span class="normal"><a href="#__codelineno-0-118"> 118</a></span>
<span class="normal"><a href="#__codelineno-0-119"> 119</a></span>
<span class="normal"><a href="#__codelineno-0-120"> 120</a></span>
<span class="normal"><a href="#__codelineno-0-121"> 121</a></span>
<span class="normal"><a href="#__codelineno-0-122"> 122</a></span>
<span class="normal"><a href="#__codelineno-0-123"> 123</a></span>
<span class="normal"><a href="#__codelineno-0-124"> 124</a></span>
<span class="normal"><a href="#__codelineno-0-125"> 125</a></span>
<span class="normal"><a href="#__codelineno-0-126"> 126</a></span>
<span class="normal"><a href="#__codelineno-0-127"> 127</a></span>
<span class="normal"><a href="#__codelineno-0-128"> 128</a></span>
<span class="normal"><a href="#__codelineno-0-129"> 129</a></span>
<span class="normal"><a href="#__codelineno-0-130"> 130</a></span>
<span class="normal"><a href="#__codelineno-0-131"> 131</a></span>
<span class="normal"><a href="#__codelineno-0-132"> 132</a></span>
<span class="normal"><a href="#__codelineno-0-133"> 133</a></span>
<span class="normal"><a href="#__codelineno-0-134"> 134</a></span>
<span class="normal"><a href="#__codelineno-0-135"> 135</a></span>
<span class="normal"><a href="#__codelineno-0-136"> 136</a></span>
<span class="normal"><a href="#__codelineno-0-137"> 137</a></span>
<span class="normal"><a href="#__codelineno-0-138"> 138</a></span>
<span class="normal"><a href="#__codelineno-0-139"> 139</a></span>
<span class="normal"><a href="#__codelineno-0-140"> 140</a></span>
<span class="normal"><a href="#__codelineno-0-141"> 141</a></span>
<span class="normal"><a href="#__codelineno-0-142"> 142</a></span>
<span class="normal"><a href="#__codelineno-0-143"> 143</a></span>
<span class="normal"><a href="#__codelineno-0-144"> 144</a></span>
<span class="normal"><a href="#__codelineno-0-145"> 145</a></span>
<span class="normal"><a href="#__codelineno-0-146"> 146</a></span>
<span class="normal"><a href="#__codelineno-0-147"> 147</a></span>
<span class="normal"><a href="#__codelineno-0-148"> 148</a></span>
<span class="normal"><a href="#__codelineno-0-149"> 149</a></span>
<span class="normal"><a href="#__codelineno-0-150"> 150</a></span>
<span class="normal"><a href="#__codelineno-0-151"> 151</a></span>
<span class="normal"><a href="#__codelineno-0-152"> 152</a></span>
<span class="normal"><a href="#__codelineno-0-153"> 153</a></span>
<span class="normal"><a href="#__codelineno-0-154"> 154</a></span>
<span class="normal"><a href="#__codelineno-0-155"> 155</a></span>
<span class="normal"><a href="#__codelineno-0-156"> 156</a></span>
<span class="normal"><a href="#__codelineno-0-157"> 157</a></span>
<span class="normal"><a href="#__codelineno-0-158"> 158</a></span>
<span class="normal"><a href="#__codelineno-0-159"> 159</a></span>
<span class="normal"><a href="#__codelineno-0-160"> 160</a></span>
<span class="normal"><a href="#__codelineno-0-161"> 161</a></span>
<span class="normal"><a href="#__codelineno-0-162"> 162</a></span>
<span class="normal"><a href="#__codelineno-0-163"> 163</a></span>
<span class="normal"><a href="#__codelineno-0-164"> 164</a></span>
<span class="normal"><a href="#__codelineno-0-165"> 165</a></span>
<span class="normal"><a href="#__codelineno-0-166"> 166</a></span>
<span class="normal"><a href="#__codelineno-0-167"> 167</a></span>
<span class="normal"><a href="#__codelineno-0-168"> 168</a></span>
<span class="normal"><a href="#__codelineno-0-169"> 169</a></span>
<span class="normal"><a href="#__codelineno-0-170"> 170</a></span>
<span class="normal"><a href="#__codelineno-0-171"> 171</a></span>
<span class="normal"><a href="#__codelineno-0-172"> 172</a></span>
<span class="normal"><a href="#__codelineno-0-173"> 173</a></span>
<span class="normal"><a href="#__codelineno-0-174"> 174</a></span>
<span class="normal"><a href="#__codelineno-0-175"> 175</a></span>
<span class="normal"><a href="#__codelineno-0-176"> 176</a></span>
<span class="normal"><a href="#__codelineno-0-177"> 177</a></span>
<span class="normal"><a href="#__codelineno-0-178"> 178</a></span>
<span class="normal"><a href="#__codelineno-0-179"> 179</a></span>
<span class="normal"><a href="#__codelineno-0-180"> 180</a></span>
<span class="normal"><a href="#__codelineno-0-181"> 181</a></span>
<span class="normal"><a href="#__codelineno-0-182"> 182</a></span>
<span class="normal"><a href="#__codelineno-0-183"> 183</a></span>
<span class="normal"><a href="#__codelineno-0-184"> 184</a></span>
<span class="normal"><a href="#__codelineno-0-185"> 185</a></span>
<span class="normal"><a href="#__codelineno-0-186"> 186</a></span>
<span class="normal"><a href="#__codelineno-0-187"> 187</a></span>
<span class="normal"><a href="#__codelineno-0-188"> 188</a></span>
<span class="normal"><a href="#__codelineno-0-189"> 189</a></span>
<span class="normal"><a href="#__codelineno-0-190"> 190</a></span>
<span class="normal"><a href="#__codelineno-0-191"> 191</a></span>
<span class="normal"><a href="#__codelineno-0-192"> 192</a></span>
<span class="normal"><a href="#__codelineno-0-193"> 193</a></span>
<span class="normal"><a href="#__codelineno-0-194"> 194</a></span>
<span class="normal"><a href="#__codelineno-0-195"> 195</a></span>
<span class="normal"><a href="#__codelineno-0-196"> 196</a></span>
<span class="normal"><a href="#__codelineno-0-197"> 197</a></span>
<span class="normal"><a href="#__codelineno-0-198"> 198</a></span>
<span class="normal"><a href="#__codelineno-0-199"> 199</a></span>
<span class="normal"><a href="#__codelineno-0-200"> 200</a></span>
<span class="normal"><a href="#__codelineno-0-201"> 201</a></span>
<span class="normal"><a href="#__codelineno-0-202"> 202</a></span>
<span class="normal"><a href="#__codelineno-0-203"> 203</a></span>
<span class="normal"><a href="#__codelineno-0-204"> 204</a></span>
<span class="normal"><a href="#__codelineno-0-205"> 205</a></span>
<span class="normal"><a href="#__codelineno-0-206"> 206</a></span>
<span class="normal"><a href="#__codelineno-0-207"> 207</a></span>
<span class="normal"><a href="#__codelineno-0-208"> 208</a></span>
<span class="normal"><a href="#__codelineno-0-209"> 209</a></span>
<span class="normal"><a href="#__codelineno-0-210"> 210</a></span>
<span class="normal"><a href="#__codelineno-0-211"> 211</a></span>
<span class="normal"><a href="#__codelineno-0-212"> 212</a></span>
<span class="normal"><a href="#__codelineno-0-213"> 213</a></span>
<span class="normal"><a href="#__codelineno-0-214"> 214</a></span>
<span class="normal"><a href="#__codelineno-0-215"> 215</a></span>
<span class="normal"><a href="#__codelineno-0-216"> 216</a></span>
<span class="normal"><a href="#__codelineno-0-217"> 217</a></span>
<span class="normal"><a href="#__codelineno-0-218"> 218</a></span>
<span class="normal"><a href="#__codelineno-0-219"> 219</a></span>
<span class="normal"><a href="#__codelineno-0-220"> 220</a></span>
<span class="normal"><a href="#__codelineno-0-221"> 221</a></span>
<span class="normal"><a href="#__codelineno-0-222"> 222</a></span>
<span class="normal"><a href="#__codelineno-0-223"> 223</a></span>
<span class="normal"><a href="#__codelineno-0-224"> 224</a></span>
<span class="normal"><a href="#__codelineno-0-225"> 225</a></span>
<span class="normal"><a href="#__codelineno-0-226"> 226</a></span>
<span class="normal"><a href="#__codelineno-0-227"> 227</a></span>
<span class="normal"><a href="#__codelineno-0-228"> 228</a></span>
<span class="normal"><a href="#__codelineno-0-229"> 229</a></span>
<span class="normal"><a href="#__codelineno-0-230"> 230</a></span>
<span class="normal"><a href="#__codelineno-0-231"> 231</a></span>
<span class="normal"><a href="#__codelineno-0-232"> 232</a></span>
<span class="normal"><a href="#__codelineno-0-233"> 233</a></span>
<span class="normal"><a href="#__codelineno-0-234"> 234</a></span>
<span class="normal"><a href="#__codelineno-0-235"> 235</a></span>
<span class="normal"><a href="#__codelineno-0-236"> 236</a></span>
<span class="normal"><a href="#__codelineno-0-237"> 237</a></span>
<span class="normal"><a href="#__codelineno-0-238"> 238</a></span>
<span class="normal"><a href="#__codelineno-0-239"> 239</a></span>
<span class="normal"><a href="#__codelineno-0-240"> 240</a></span>
<span class="normal"><a href="#__codelineno-0-241"> 241</a></span>
<span class="normal"><a href="#__codelineno-0-242"> 242</a></span>
<span class="normal"><a href="#__codelineno-0-243"> 243</a></span>
<span class="normal"><a href="#__codelineno-0-244"> 244</a></span>
<span class="normal"><a href="#__codelineno-0-245"> 245</a></span>
<span class="normal"><a href="#__codelineno-0-246"> 246</a></span>
<span class="normal"><a href="#__codelineno-0-247"> 247</a></span>
<span class="normal"><a href="#__codelineno-0-248"> 248</a></span>
<span class="normal"><a href="#__codelineno-0-249"> 249</a></span>
<span class="normal"><a href="#__codelineno-0-250"> 250</a></span>
<span class="normal"><a href="#__codelineno-0-251"> 251</a></span>
<span class="normal"><a href="#__codelineno-0-252"> 252</a></span>
<span class="normal"><a href="#__codelineno-0-253"> 253</a></span>
<span class="normal"><a href="#__codelineno-0-254"> 254</a></span>
<span class="normal"><a href="#__codelineno-0-255"> 255</a></span>
<span class="normal"><a href="#__codelineno-0-256"> 256</a></span>
<span class="normal"><a href="#__codelineno-0-257"> 257</a></span>
<span class="normal"><a href="#__codelineno-0-258"> 258</a></span>
<span class="normal"><a href="#__codelineno-0-259"> 259</a></span>
<span class="normal"><a href="#__codelineno-0-260"> 260</a></span>
<span class="normal"><a href="#__codelineno-0-261"> 261</a></span>
<span class="normal"><a href="#__codelineno-0-262"> 262</a></span>
<span class="normal"><a href="#__codelineno-0-263"> 263</a></span>
<span class="normal"><a href="#__codelineno-0-264"> 264</a></span>
<span class="normal"><a href="#__codelineno-0-265"> 265</a></span>
<span class="normal"><a href="#__codelineno-0-266"> 266</a></span>
<span class="normal"><a href="#__codelineno-0-267"> 267</a></span>
<span class="normal"><a href="#__codelineno-0-268"> 268</a></span>
<span class="normal"><a href="#__codelineno-0-269"> 269</a></span>
<span class="normal"><a href="#__codelineno-0-270"> 270</a></span>
<span class="normal"><a href="#__codelineno-0-271"> 271</a></span>
<span class="normal"><a href="#__codelineno-0-272"> 272</a></span>
<span class="normal"><a href="#__codelineno-0-273"> 273</a></span>
<span class="normal"><a href="#__codelineno-0-274"> 274</a></span>
<span class="normal"><a href="#__codelineno-0-275"> 275</a></span>
<span class="normal"><a href="#__codelineno-0-276"> 276</a></span>
<span class="normal"><a href="#__codelineno-0-277"> 277</a></span>
<span class="normal"><a href="#__codelineno-0-278"> 278</a></span>
<span class="normal"><a href="#__codelineno-0-279"> 279</a></span>
<span class="normal"><a href="#__codelineno-0-280"> 280</a></span>
<span class="normal"><a href="#__codelineno-0-281"> 281</a></span>
<span class="normal"><a href="#__codelineno-0-282"> 282</a></span>
<span class="normal"><a href="#__codelineno-0-283"> 283</a></span>
<span class="normal"><a href="#__codelineno-0-284"> 284</a></span>
<span class="normal"><a href="#__codelineno-0-285"> 285</a></span>
<span class="normal"><a href="#__codelineno-0-286"> 286</a></span>
<span class="normal"><a href="#__codelineno-0-287"> 287</a></span>
<span class="normal"><a href="#__codelineno-0-288"> 288</a></span>
<span class="normal"><a href="#__codelineno-0-289"> 289</a></span>
<span class="normal"><a href="#__codelineno-0-290"> 290</a></span>
<span class="normal"><a href="#__codelineno-0-291"> 291</a></span>
<span class="normal"><a href="#__codelineno-0-292"> 292</a></span>
<span class="normal"><a href="#__codelineno-0-293"> 293</a></span>
<span class="normal"><a href="#__codelineno-0-294"> 294</a></span>
<span class="normal"><a href="#__codelineno-0-295"> 295</a></span>
<span class="normal"><a href="#__codelineno-0-296"> 296</a></span>
<span class="normal"><a href="#__codelineno-0-297"> 297</a></span>
<span class="normal"><a href="#__codelineno-0-298"> 298</a></span>
<span class="normal"><a href="#__codelineno-0-299"> 299</a></span>
<span class="normal"><a href="#__codelineno-0-300"> 300</a></span>
<span class="normal"><a href="#__codelineno-0-301"> 301</a></span>
<span class="normal"><a href="#__codelineno-0-302"> 302</a></span>
<span class="normal"><a href="#__codelineno-0-303"> 303</a></span>
<span class="normal"><a href="#__codelineno-0-304"> 304</a></span>
<span class="normal"><a href="#__codelineno-0-305"> 305</a></span>
<span class="normal"><a href="#__codelineno-0-306"> 306</a></span>
<span class="normal"><a href="#__codelineno-0-307"> 307</a></span>
<span class="normal"><a href="#__codelineno-0-308"> 308</a></span>
<span class="normal"><a href="#__codelineno-0-309"> 309</a></span>
<span class="normal"><a href="#__codelineno-0-310"> 310</a></span>
<span class="normal"><a href="#__codelineno-0-311"> 311</a></span>
<span class="normal"><a href="#__codelineno-0-312"> 312</a></span>
<span class="normal"><a href="#__codelineno-0-313"> 313</a></span>
<span class="normal"><a href="#__codelineno-0-314"> 314</a></span>
<span class="normal"><a href="#__codelineno-0-315"> 315</a></span>
<span class="normal"><a href="#__codelineno-0-316"> 316</a></span>
<span class="normal"><a href="#__codelineno-0-317"> 317</a></span>
<span class="normal"><a href="#__codelineno-0-318"> 318</a></span>
<span class="normal"><a href="#__codelineno-0-319"> 319</a></span>
<span class="normal"><a href="#__codelineno-0-320"> 320</a></span>
<span class="normal"><a href="#__codelineno-0-321"> 321</a></span>
<span class="normal"><a href="#__codelineno-0-322"> 322</a></span>
<span class="normal"><a href="#__codelineno-0-323"> 323</a></span>
<span class="normal"><a href="#__codelineno-0-324"> 324</a></span>
<span class="normal"><a href="#__codelineno-0-325"> 325</a></span>
<span class="normal"><a href="#__codelineno-0-326"> 326</a></span>
<span class="normal"><a href="#__codelineno-0-327"> 327</a></span>
<span class="normal"><a href="#__codelineno-0-328"> 328</a></span>
<span class="normal"><a href="#__codelineno-0-329"> 329</a></span>
<span class="normal"><a href="#__codelineno-0-330"> 330</a></span>
<span class="normal"><a href="#__codelineno-0-331"> 331</a></span>
<span class="normal"><a href="#__codelineno-0-332"> 332</a></span>
<span class="normal"><a href="#__codelineno-0-333"> 333</a></span>
<span class="normal"><a href="#__codelineno-0-334"> 334</a></span>
<span class="normal"><a href="#__codelineno-0-335"> 335</a></span>
<span class="normal"><a href="#__codelineno-0-336"> 336</a></span>
<span class="normal"><a href="#__codelineno-0-337"> 337</a></span>
<span class="normal"><a href="#__codelineno-0-338"> 338</a></span>
<span class="normal"><a href="#__codelineno-0-339"> 339</a></span>
<span class="normal"><a href="#__codelineno-0-340"> 340</a></span>
<span class="normal"><a href="#__codelineno-0-341"> 341</a></span>
<span class="normal"><a href="#__codelineno-0-342"> 342</a></span>
<span class="normal"><a href="#__codelineno-0-343"> 343</a></span>
<span class="normal"><a href="#__codelineno-0-344"> 344</a></span>
<span class="normal"><a href="#__codelineno-0-345"> 345</a></span>
<span class="normal"><a href="#__codelineno-0-346"> 346</a></span>
<span class="normal"><a href="#__codelineno-0-347"> 347</a></span>
<span class="normal"><a href="#__codelineno-0-348"> 348</a></span>
<span class="normal"><a href="#__codelineno-0-349"> 349</a></span>
<span class="normal"><a href="#__codelineno-0-350"> 350</a></span>
<span class="normal"><a href="#__codelineno-0-351"> 351</a></span>
<span class="normal"><a href="#__codelineno-0-352"> 352</a></span>
<span class="normal"><a href="#__codelineno-0-353"> 353</a></span>
<span class="normal"><a href="#__codelineno-0-354"> 354</a></span>
<span class="normal"><a href="#__codelineno-0-355"> 355</a></span>
<span class="normal"><a href="#__codelineno-0-356"> 356</a></span>
<span class="normal"><a href="#__codelineno-0-357"> 357</a></span>
<span class="normal"><a href="#__codelineno-0-358"> 358</a></span>
<span class="normal"><a href="#__codelineno-0-359"> 359</a></span>
<span class="normal"><a href="#__codelineno-0-360"> 360</a></span>
<span class="normal"><a href="#__codelineno-0-361"> 361</a></span>
<span class="normal"><a href="#__codelineno-0-362"> 362</a></span>
<span class="normal"><a href="#__codelineno-0-363"> 363</a></span>
<span class="normal"><a href="#__codelineno-0-364"> 364</a></span>
<span class="normal"><a href="#__codelineno-0-365"> 365</a></span>
<span class="normal"><a href="#__codelineno-0-366"> 366</a></span>
<span class="normal"><a href="#__codelineno-0-367"> 367</a></span>
<span class="normal"><a href="#__codelineno-0-368"> 368</a></span>
<span class="normal"><a href="#__codelineno-0-369"> 369</a></span>
<span class="normal"><a href="#__codelineno-0-370"> 370</a></span>
<span class="normal"><a href="#__codelineno-0-371"> 371</a></span>
<span class="normal"><a href="#__codelineno-0-372"> 372</a></span>
<span class="normal"><a href="#__codelineno-0-373"> 373</a></span>
<span class="normal"><a href="#__codelineno-0-374"> 374</a></span>
<span class="normal"><a href="#__codelineno-0-375"> 375</a></span>
<span class="normal"><a href="#__codelineno-0-376"> 376</a></span>
<span class="normal"><a href="#__codelineno-0-377"> 377</a></span>
<span class="normal"><a href="#__codelineno-0-378"> 378</a></span>
<span class="normal"><a href="#__codelineno-0-379"> 379</a></span>
<span class="normal"><a href="#__codelineno-0-380"> 380</a></span>
<span class="normal"><a href="#__codelineno-0-381"> 381</a></span>
<span class="normal"><a href="#__codelineno-0-382"> 382</a></span>
<span class="normal"><a href="#__codelineno-0-383"> 383</a></span>
<span class="normal"><a href="#__codelineno-0-384"> 384</a></span>
<span class="normal"><a href="#__codelineno-0-385"> 385</a></span>
<span class="normal"><a href="#__codelineno-0-386"> 386</a></span>
<span class="normal"><a href="#__codelineno-0-387"> 387</a></span>
<span class="normal"><a href="#__codelineno-0-388"> 388</a></span>
<span class="normal"><a href="#__codelineno-0-389"> 389</a></span>
<span class="normal"><a href="#__codelineno-0-390"> 390</a></span>
<span class="normal"><a href="#__codelineno-0-391"> 391</a></span>
<span class="normal"><a href="#__codelineno-0-392"> 392</a></span>
<span class="normal"><a href="#__codelineno-0-393"> 393</a></span>
<span class="normal"><a href="#__codelineno-0-394"> 394</a></span>
<span class="normal"><a href="#__codelineno-0-395"> 395</a></span>
<span class="normal"><a href="#__codelineno-0-396"> 396</a></span>
<span class="normal"><a href="#__codelineno-0-397"> 397</a></span>
<span class="normal"><a href="#__codelineno-0-398"> 398</a></span>
<span class="normal"><a href="#__codelineno-0-399"> 399</a></span>
<span class="normal"><a href="#__codelineno-0-400"> 400</a></span>
<span class="normal"><a href="#__codelineno-0-401"> 401</a></span>
<span class="normal"><a href="#__codelineno-0-402"> 402</a></span>
<span class="normal"><a href="#__codelineno-0-403"> 403</a></span>
<span class="normal"><a href="#__codelineno-0-404"> 404</a></span>
<span class="normal"><a href="#__codelineno-0-405"> 405</a></span>
<span class="normal"><a href="#__codelineno-0-406"> 406</a></span>
<span class="normal"><a href="#__codelineno-0-407"> 407</a></span>
<span class="normal"><a href="#__codelineno-0-408"> 408</a></span>
<span class="normal"><a href="#__codelineno-0-409"> 409</a></span>
<span class="normal"><a href="#__codelineno-0-410"> 410</a></span>
<span class="normal"><a href="#__codelineno-0-411"> 411</a></span>
<span class="normal"><a href="#__codelineno-0-412"> 412</a></span>
<span class="normal"><a href="#__codelineno-0-413"> 413</a></span>
<span class="normal"><a href="#__codelineno-0-414"> 414</a></span>
<span class="normal"><a href="#__codelineno-0-415"> 415</a></span>
<span class="normal"><a href="#__codelineno-0-416"> 416</a></span>
<span class="normal"><a href="#__codelineno-0-417"> 417</a></span>
<span class="normal"><a href="#__codelineno-0-418"> 418</a></span>
<span class="normal"><a href="#__codelineno-0-419"> 419</a></span>
<span class="normal"><a href="#__codelineno-0-420"> 420</a></span>
<span class="normal"><a href="#__codelineno-0-421"> 421</a></span>
<span class="normal"><a href="#__codelineno-0-422"> 422</a></span>
<span class="normal"><a href="#__codelineno-0-423"> 423</a></span>
<span class="normal"><a href="#__codelineno-0-424"> 424</a></span>
<span class="normal"><a href="#__codelineno-0-425"> 425</a></span>
<span class="normal"><a href="#__codelineno-0-426"> 426</a></span>
<span class="normal"><a href="#__codelineno-0-427"> 427</a></span>
<span class="normal"><a href="#__codelineno-0-428"> 428</a></span>
<span class="normal"><a href="#__codelineno-0-429"> 429</a></span>
<span class="normal"><a href="#__codelineno-0-430"> 430</a></span>
<span class="normal"><a href="#__codelineno-0-431"> 431</a></span>
<span class="normal"><a href="#__codelineno-0-432"> 432</a></span>
<span class="normal"><a href="#__codelineno-0-433"> 433</a></span>
<span class="normal"><a href="#__codelineno-0-434"> 434</a></span>
<span class="normal"><a href="#__codelineno-0-435"> 435</a></span>
<span class="normal"><a href="#__codelineno-0-436"> 436</a></span>
<span class="normal"><a href="#__codelineno-0-437"> 437</a></span>
<span class="normal"><a href="#__codelineno-0-438"> 438</a></span>
<span class="normal"><a href="#__codelineno-0-439"> 439</a></span>
<span class="normal"><a href="#__codelineno-0-440"> 440</a></span>
<span class="normal"><a href="#__codelineno-0-441"> 441</a></span>
<span class="normal"><a href="#__codelineno-0-442"> 442</a></span>
<span class="normal"><a href="#__codelineno-0-443"> 443</a></span>
<span class="normal"><a href="#__codelineno-0-444"> 444</a></span>
<span class="normal"><a href="#__codelineno-0-445"> 445</a></span>
<span class="normal"><a href="#__codelineno-0-446"> 446</a></span>
<span class="normal"><a href="#__codelineno-0-447"> 447</a></span>
<span class="normal"><a href="#__codelineno-0-448"> 448</a></span>
<span class="normal"><a href="#__codelineno-0-449"> 449</a></span>
<span class="normal"><a href="#__codelineno-0-450"> 450</a></span>
<span class="normal"><a href="#__codelineno-0-451"> 451</a></span>
<span class="normal"><a href="#__codelineno-0-452"> 452</a></span>
<span class="normal"><a href="#__codelineno-0-453"> 453</a></span>
<span class="normal"><a href="#__codelineno-0-454"> 454</a></span>
<span class="normal"><a href="#__codelineno-0-455"> 455</a></span>
<span class="normal"><a href="#__codelineno-0-456"> 456</a></span>
<span class="normal"><a href="#__codelineno-0-457"> 457</a></span>
<span class="normal"><a href="#__codelineno-0-458"> 458</a></span>
<span class="normal"><a href="#__codelineno-0-459"> 459</a></span>
<span class="normal"><a href="#__codelineno-0-460"> 460</a></span>
<span class="normal"><a href="#__codelineno-0-461"> 461</a></span>
<span class="normal"><a href="#__codelineno-0-462"> 462</a></span>
<span class="normal"><a href="#__codelineno-0-463"> 463</a></span>
<span class="normal"><a href="#__codelineno-0-464"> 464</a></span>
<span class="normal"><a href="#__codelineno-0-465"> 465</a></span>
<span class="normal"><a href="#__codelineno-0-466"> 466</a></span>
<span class="normal"><a href="#__codelineno-0-467"> 467</a></span>
<span class="normal"><a href="#__codelineno-0-468"> 468</a></span>
<span class="normal"><a href="#__codelineno-0-469"> 469</a></span>
<span class="normal"><a href="#__codelineno-0-470"> 470</a></span>
<span class="normal"><a href="#__codelineno-0-471"> 471</a></span>
<span class="normal"><a href="#__codelineno-0-472"> 472</a></span>
<span class="normal"><a href="#__codelineno-0-473"> 473</a></span>
<span class="normal"><a href="#__codelineno-0-474"> 474</a></span>
<span class="normal"><a href="#__codelineno-0-475"> 475</a></span>
<span class="normal"><a href="#__codelineno-0-476"> 476</a></span>
<span class="normal"><a href="#__codelineno-0-477"> 477</a></span>
<span class="normal"><a href="#__codelineno-0-478"> 478</a></span>
<span class="normal"><a href="#__codelineno-0-479"> 479</a></span>
<span class="normal"><a href="#__codelineno-0-480"> 480</a></span>
<span class="normal"><a href="#__codelineno-0-481"> 481</a></span>
<span class="normal"><a href="#__codelineno-0-482"> 482</a></span>
<span class="normal"><a href="#__codelineno-0-483"> 483</a></span>
<span class="normal"><a href="#__codelineno-0-484"> 484</a></span>
<span class="normal"><a href="#__codelineno-0-485"> 485</a></span>
<span class="normal"><a href="#__codelineno-0-486"> 486</a></span>
<span class="normal"><a href="#__codelineno-0-487"> 487</a></span>
<span class="normal"><a href="#__codelineno-0-488"> 488</a></span>
<span class="normal"><a href="#__codelineno-0-489"> 489</a></span>
<span class="normal"><a href="#__codelineno-0-490"> 490</a></span>
<span class="normal"><a href="#__codelineno-0-491"> 491</a></span>
<span class="normal"><a href="#__codelineno-0-492"> 492</a></span>
<span class="normal"><a href="#__codelineno-0-493"> 493</a></span>
<span class="normal"><a href="#__codelineno-0-494"> 494</a></span>
<span class="normal"><a href="#__codelineno-0-495"> 495</a></span>
<span class="normal"><a href="#__codelineno-0-496"> 496</a></span>
<span class="normal"><a href="#__codelineno-0-497"> 497</a></span>
<span class="normal"><a href="#__codelineno-0-498"> 498</a></span>
<span class="normal"><a href="#__codelineno-0-499"> 499</a></span>
<span class="normal"><a href="#__codelineno-0-500"> 500</a></span>
<span class="normal"><a href="#__codelineno-0-501"> 501</a></span>
<span class="normal"><a href="#__codelineno-0-502"> 502</a></span>
<span class="normal"><a href="#__codelineno-0-503"> 503</a></span>
<span class="normal"><a href="#__codelineno-0-504"> 504</a></span>
<span class="normal"><a href="#__codelineno-0-505"> 505</a></span>
<span class="normal"><a href="#__codelineno-0-506"> 506</a></span>
<span class="normal"><a href="#__codelineno-0-507"> 507</a></span>
<span class="normal"><a href="#__codelineno-0-508"> 508</a></span>
<span class="normal"><a href="#__codelineno-0-509"> 509</a></span>
<span class="normal"><a href="#__codelineno-0-510"> 510</a></span>
<span class="normal"><a href="#__codelineno-0-511"> 511</a></span>
<span class="normal"><a href="#__codelineno-0-512"> 512</a></span>
<span class="normal"><a href="#__codelineno-0-513"> 513</a></span>
<span class="normal"><a href="#__codelineno-0-514"> 514</a></span>
<span class="normal"><a href="#__codelineno-0-515"> 515</a></span>
<span class="normal"><a href="#__codelineno-0-516"> 516</a></span>
<span class="normal"><a href="#__codelineno-0-517"> 517</a></span>
<span class="normal"><a href="#__codelineno-0-518"> 518</a></span>
<span class="normal"><a href="#__codelineno-0-519"> 519</a></span>
<span class="normal"><a href="#__codelineno-0-520"> 520</a></span>
<span class="normal"><a href="#__codelineno-0-521"> 521</a></span>
<span class="normal"><a href="#__codelineno-0-522"> 522</a></span>
<span class="normal"><a href="#__codelineno-0-523"> 523</a></span>
<span class="normal"><a href="#__codelineno-0-524"> 524</a></span>
<span class="normal"><a href="#__codelineno-0-525"> 525</a></span>
<span class="normal"><a href="#__codelineno-0-526"> 526</a></span>
<span class="normal"><a href="#__codelineno-0-527"> 527</a></span>
<span class="normal"><a href="#__codelineno-0-528"> 528</a></span>
<span class="normal"><a href="#__codelineno-0-529"> 529</a></span>
<span class="normal"><a href="#__codelineno-0-530"> 530</a></span>
<span class="normal"><a href="#__codelineno-0-531"> 531</a></span>
<span class="normal"><a href="#__codelineno-0-532"> 532</a></span>
<span class="normal"><a href="#__codelineno-0-533"> 533</a></span>
<span class="normal"><a href="#__codelineno-0-534"> 534</a></span>
<span class="normal"><a href="#__codelineno-0-535"> 535</a></span>
<span class="normal"><a href="#__codelineno-0-536"> 536</a></span>
<span class="normal"><a href="#__codelineno-0-537"> 537</a></span>
<span class="normal"><a href="#__codelineno-0-538"> 538</a></span>
<span class="normal"><a href="#__codelineno-0-539"> 539</a></span>
<span class="normal"><a href="#__codelineno-0-540"> 540</a></span>
<span class="normal"><a href="#__codelineno-0-541"> 541</a></span>
<span class="normal"><a href="#__codelineno-0-542"> 542</a></span>
<span class="normal"><a href="#__codelineno-0-543"> 543</a></span>
<span class="normal"><a href="#__codelineno-0-544"> 544</a></span>
<span class="normal"><a href="#__codelineno-0-545"> 545</a></span>
<span class="normal"><a href="#__codelineno-0-546"> 546</a></span>
<span class="normal"><a href="#__codelineno-0-547"> 547</a></span>
<span class="normal"><a href="#__codelineno-0-548"> 548</a></span>
<span class="normal"><a href="#__codelineno-0-549"> 549</a></span>
<span class="normal"><a href="#__codelineno-0-550"> 550</a></span>
<span class="normal"><a href="#__codelineno-0-551"> 551</a></span>
<span class="normal"><a href="#__codelineno-0-552"> 552</a></span>
<span class="normal"><a href="#__codelineno-0-553"> 553</a></span>
<span class="normal"><a href="#__codelineno-0-554"> 554</a></span>
<span class="normal"><a href="#__codelineno-0-555"> 555</a></span>
<span class="normal"><a href="#__codelineno-0-556"> 556</a></span>
<span class="normal"><a href="#__codelineno-0-557"> 557</a></span>
<span class="normal"><a href="#__codelineno-0-558"> 558</a></span>
<span class="normal"><a href="#__codelineno-0-559"> 559</a></span>
<span class="normal"><a href="#__codelineno-0-560"> 560</a></span>
<span class="normal"><a href="#__codelineno-0-561"> 561</a></span>
<span class="normal"><a href="#__codelineno-0-562"> 562</a></span>
<span class="normal"><a href="#__codelineno-0-563"> 563</a></span>
<span class="normal"><a href="#__codelineno-0-564"> 564</a></span>
<span class="normal"><a href="#__codelineno-0-565"> 565</a></span>
<span class="normal"><a href="#__codelineno-0-566"> 566</a></span>
<span class="normal"><a href="#__codelineno-0-567"> 567</a></span>
<span class="normal"><a href="#__codelineno-0-568"> 568</a></span>
<span class="normal"><a href="#__codelineno-0-569"> 569</a></span>
<span class="normal"><a href="#__codelineno-0-570"> 570</a></span>
<span class="normal"><a href="#__codelineno-0-571"> 571</a></span>
<span class="normal"><a href="#__codelineno-0-572"> 572</a></span>
<span class="normal"><a href="#__codelineno-0-573"> 573</a></span>
<span class="normal"><a href="#__codelineno-0-574"> 574</a></span>
<span class="normal"><a href="#__codelineno-0-575"> 575</a></span>
<span class="normal"><a href="#__codelineno-0-576"> 576</a></span>
<span class="normal"><a href="#__codelineno-0-577"> 577</a></span>
<span class="normal"><a href="#__codelineno-0-578"> 578</a></span>
<span class="normal"><a href="#__codelineno-0-579"> 579</a></span>
<span class="normal"><a href="#__codelineno-0-580"> 580</a></span>
<span class="normal"><a href="#__codelineno-0-581"> 581</a></span>
<span class="normal"><a href="#__codelineno-0-582"> 582</a></span>
<span class="normal"><a href="#__codelineno-0-583"> 583</a></span>
<span class="normal"><a href="#__codelineno-0-584"> 584</a></span>
<span class="normal"><a href="#__codelineno-0-585"> 585</a></span>
<span class="normal"><a href="#__codelineno-0-586"> 586</a></span>
<span class="normal"><a href="#__codelineno-0-587"> 587</a></span>
<span class="normal"><a href="#__codelineno-0-588"> 588</a></span>
<span class="normal"><a href="#__codelineno-0-589"> 589</a></span>
<span class="normal"><a href="#__codelineno-0-590"> 590</a></span>
<span class="normal"><a href="#__codelineno-0-591"> 591</a></span>
<span class="normal"><a href="#__codelineno-0-592"> 592</a></span>
<span class="normal"><a href="#__codelineno-0-593"> 593</a></span>
<span class="normal"><a href="#__codelineno-0-594"> 594</a></span>
<span class="normal"><a href="#__codelineno-0-595"> 595</a></span>
<span class="normal"><a href="#__codelineno-0-596"> 596</a></span>
<span class="normal"><a href="#__codelineno-0-597"> 597</a></span>
<span class="normal"><a href="#__codelineno-0-598"> 598</a></span>
<span class="normal"><a href="#__codelineno-0-599"> 599</a></span>
<span class="normal"><a href="#__codelineno-0-600"> 600</a></span>
<span class="normal"><a href="#__codelineno-0-601"> 601</a></span>
<span class="normal"><a href="#__codelineno-0-602"> 602</a></span>
<span class="normal"><a href="#__codelineno-0-603"> 603</a></span>
<span class="normal"><a href="#__codelineno-0-604"> 604</a></span>
<span class="normal"><a href="#__codelineno-0-605"> 605</a></span>
<span class="normal"><a href="#__codelineno-0-606"> 606</a></span>
<span class="normal"><a href="#__codelineno-0-607"> 607</a></span>
<span class="normal"><a href="#__codelineno-0-608"> 608</a></span>
<span class="normal"><a href="#__codelineno-0-609"> 609</a></span>
<span class="normal"><a href="#__codelineno-0-610"> 610</a></span>
<span class="normal"><a href="#__codelineno-0-611"> 611</a></span>
<span class="normal"><a href="#__codelineno-0-612"> 612</a></span>
<span class="normal"><a href="#__codelineno-0-613"> 613</a></span>
<span class="normal"><a href="#__codelineno-0-614"> 614</a></span>
<span class="normal"><a href="#__codelineno-0-615"> 615</a></span>
<span class="normal"><a href="#__codelineno-0-616"> 616</a></span>
<span class="normal"><a href="#__codelineno-0-617"> 617</a></span>
<span class="normal"><a href="#__codelineno-0-618"> 618</a></span>
<span class="normal"><a href="#__codelineno-0-619"> 619</a></span>
<span class="normal"><a href="#__codelineno-0-620"> 620</a></span>
<span class="normal"><a href="#__codelineno-0-621"> 621</a></span>
<span class="normal"><a href="#__codelineno-0-622"> 622</a></span>
<span class="normal"><a href="#__codelineno-0-623"> 623</a></span>
<span class="normal"><a href="#__codelineno-0-624"> 624</a></span>
<span class="normal"><a href="#__codelineno-0-625"> 625</a></span>
<span class="normal"><a href="#__codelineno-0-626"> 626</a></span>
<span class="normal"><a href="#__codelineno-0-627"> 627</a></span>
<span class="normal"><a href="#__codelineno-0-628"> 628</a></span>
<span class="normal"><a href="#__codelineno-0-629"> 629</a></span>
<span class="normal"><a href="#__codelineno-0-630"> 630</a></span>
<span class="normal"><a href="#__codelineno-0-631"> 631</a></span>
<span class="normal"><a href="#__codelineno-0-632"> 632</a></span>
<span class="normal"><a href="#__codelineno-0-633"> 633</a></span>
<span class="normal"><a href="#__codelineno-0-634"> 634</a></span>
<span class="normal"><a href="#__codelineno-0-635"> 635</a></span>
<span class="normal"><a href="#__codelineno-0-636"> 636</a></span>
<span class="normal"><a href="#__codelineno-0-637"> 637</a></span>
<span class="normal"><a href="#__codelineno-0-638"> 638</a></span>
<span class="normal"><a href="#__codelineno-0-639"> 639</a></span>
<span class="normal"><a href="#__codelineno-0-640"> 640</a></span>
<span class="normal"><a href="#__codelineno-0-641"> 641</a></span>
<span class="normal"><a href="#__codelineno-0-642"> 642</a></span>
<span class="normal"><a href="#__codelineno-0-643"> 643</a></span>
<span class="normal"><a href="#__codelineno-0-644"> 644</a></span>
<span class="normal"><a href="#__codelineno-0-645"> 645</a></span>
<span class="normal"><a href="#__codelineno-0-646"> 646</a></span>
<span class="normal"><a href="#__codelineno-0-647"> 647</a></span>
<span class="normal"><a href="#__codelineno-0-648"> 648</a></span>
<span class="normal"><a href="#__codelineno-0-649"> 649</a></span>
<span class="normal"><a href="#__codelineno-0-650"> 650</a></span>
<span class="normal"><a href="#__codelineno-0-651"> 651</a></span>
<span class="normal"><a href="#__codelineno-0-652"> 652</a></span>
<span class="normal"><a href="#__codelineno-0-653"> 653</a></span>
<span class="normal"><a href="#__codelineno-0-654"> 654</a></span>
<span class="normal"><a href="#__codelineno-0-655"> 655</a></span>
<span class="normal"><a href="#__codelineno-0-656"> 656</a></span>
<span class="normal"><a href="#__codelineno-0-657"> 657</a></span>
<span class="normal"><a href="#__codelineno-0-658"> 658</a></span>
<span class="normal"><a href="#__codelineno-0-659"> 659</a></span>
<span class="normal"><a href="#__codelineno-0-660"> 660</a></span>
<span class="normal"><a href="#__codelineno-0-661"> 661</a></span>
<span class="normal"><a href="#__codelineno-0-662"> 662</a></span>
<span class="normal"><a href="#__codelineno-0-663"> 663</a></span>
<span class="normal"><a href="#__codelineno-0-664"> 664</a></span>
<span class="normal"><a href="#__codelineno-0-665"> 665</a></span>
<span class="normal"><a href="#__codelineno-0-666"> 666</a></span>
<span class="normal"><a href="#__codelineno-0-667"> 667</a></span>
<span class="normal"><a href="#__codelineno-0-668"> 668</a></span>
<span class="normal"><a href="#__codelineno-0-669"> 669</a></span>
<span class="normal"><a href="#__codelineno-0-670"> 670</a></span>
<span class="normal"><a href="#__codelineno-0-671"> 671</a></span>
<span class="normal"><a href="#__codelineno-0-672"> 672</a></span>
<span class="normal"><a href="#__codelineno-0-673"> 673</a></span>
<span class="normal"><a href="#__codelineno-0-674"> 674</a></span>
<span class="normal"><a href="#__codelineno-0-675"> 675</a></span>
<span class="normal"><a href="#__codelineno-0-676"> 676</a></span>
<span class="normal"><a href="#__codelineno-0-677"> 677</a></span>
<span class="normal"><a href="#__codelineno-0-678"> 678</a></span>
<span class="normal"><a href="#__codelineno-0-679"> 679</a></span>
<span class="normal"><a href="#__codelineno-0-680"> 680</a></span>
<span class="normal"><a href="#__codelineno-0-681"> 681</a></span>
<span class="normal"><a href="#__codelineno-0-682"> 682</a></span>
<span class="normal"><a href="#__codelineno-0-683"> 683</a></span>
<span class="normal"><a href="#__codelineno-0-684"> 684</a></span>
<span class="normal"><a href="#__codelineno-0-685"> 685</a></span>
<span class="normal"><a href="#__codelineno-0-686"> 686</a></span>
<span class="normal"><a href="#__codelineno-0-687"> 687</a></span>
<span class="normal"><a href="#__codelineno-0-688"> 688</a></span>
<span class="normal"><a href="#__codelineno-0-689"> 689</a></span>
<span class="normal"><a href="#__codelineno-0-690"> 690</a></span>
<span class="normal"><a href="#__codelineno-0-691"> 691</a></span>
<span class="normal"><a href="#__codelineno-0-692"> 692</a></span>
<span class="normal"><a href="#__codelineno-0-693"> 693</a></span>
<span class="normal"><a href="#__codelineno-0-694"> 694</a></span>
<span class="normal"><a href="#__codelineno-0-695"> 695</a></span>
<span class="normal"><a href="#__codelineno-0-696"> 696</a></span>
<span class="normal"><a href="#__codelineno-0-697"> 697</a></span>
<span class="normal"><a href="#__codelineno-0-698"> 698</a></span>
<span class="normal"><a href="#__codelineno-0-699"> 699</a></span>
<span class="normal"><a href="#__codelineno-0-700"> 700</a></span>
<span class="normal"><a href="#__codelineno-0-701"> 701</a></span>
<span class="normal"><a href="#__codelineno-0-702"> 702</a></span>
<span class="normal"><a href="#__codelineno-0-703"> 703</a></span>
<span class="normal"><a href="#__codelineno-0-704"> 704</a></span>
<span class="normal"><a href="#__codelineno-0-705"> 705</a></span>
<span class="normal"><a href="#__codelineno-0-706"> 706</a></span>
<span class="normal"><a href="#__codelineno-0-707"> 707</a></span>
<span class="normal"><a href="#__codelineno-0-708"> 708</a></span>
<span class="normal"><a href="#__codelineno-0-709"> 709</a></span>
<span class="normal"><a href="#__codelineno-0-710"> 710</a></span>
<span class="normal"><a href="#__codelineno-0-711"> 711</a></span>
<span class="normal"><a href="#__codelineno-0-712"> 712</a></span>
<span class="normal"><a href="#__codelineno-0-713"> 713</a></span>
<span class="normal"><a href="#__codelineno-0-714"> 714</a></span>
<span class="normal"><a href="#__codelineno-0-715"> 715</a></span>
<span class="normal"><a href="#__codelineno-0-716"> 716</a></span>
<span class="normal"><a href="#__codelineno-0-717"> 717</a></span>
<span class="normal"><a href="#__codelineno-0-718"> 718</a></span>
<span class="normal"><a href="#__codelineno-0-719"> 719</a></span>
<span class="normal"><a href="#__codelineno-0-720"> 720</a></span>
<span class="normal"><a href="#__codelineno-0-721"> 721</a></span>
<span class="normal"><a href="#__codelineno-0-722"> 722</a></span>
<span class="normal"><a href="#__codelineno-0-723"> 723</a></span>
<span class="normal"><a href="#__codelineno-0-724"> 724</a></span>
<span class="normal"><a href="#__codelineno-0-725"> 725</a></span>
<span class="normal"><a href="#__codelineno-0-726"> 726</a></span>
<span class="normal"><a href="#__codelineno-0-727"> 727</a></span>
<span class="normal"><a href="#__codelineno-0-728"> 728</a></span>
<span class="normal"><a href="#__codelineno-0-729"> 729</a></span>
<span class="normal"><a href="#__codelineno-0-730"> 730</a></span>
<span class="normal"><a href="#__codelineno-0-731"> 731</a></span>
<span class="normal"><a href="#__codelineno-0-732"> 732</a></span>
<span class="normal"><a href="#__codelineno-0-733"> 733</a></span>
<span class="normal"><a href="#__codelineno-0-734"> 734</a></span>
<span class="normal"><a href="#__codelineno-0-735"> 735</a></span>
<span class="normal"><a href="#__codelineno-0-736"> 736</a></span>
<span class="normal"><a href="#__codelineno-0-737"> 737</a></span>
<span class="normal"><a href="#__codelineno-0-738"> 738</a></span>
<span class="normal"><a href="#__codelineno-0-739"> 739</a></span>
<span class="normal"><a href="#__codelineno-0-740"> 740</a></span>
<span class="normal"><a href="#__codelineno-0-741"> 741</a></span>
<span class="normal"><a href="#__codelineno-0-742"> 742</a></span>
<span class="normal"><a href="#__codelineno-0-743"> 743</a></span>
<span class="normal"><a href="#__codelineno-0-744"> 744</a></span>
<span class="normal"><a href="#__codelineno-0-745"> 745</a></span>
<span class="normal"><a href="#__codelineno-0-746"> 746</a></span>
<span class="normal"><a href="#__codelineno-0-747"> 747</a></span>
<span class="normal"><a href="#__codelineno-0-748"> 748</a></span>
<span class="normal"><a href="#__codelineno-0-749"> 749</a></span>
<span class="normal"><a href="#__codelineno-0-750"> 750</a></span>
<span class="normal"><a href="#__codelineno-0-751"> 751</a></span>
<span class="normal"><a href="#__codelineno-0-752"> 752</a></span>
<span class="normal"><a href="#__codelineno-0-753"> 753</a></span>
<span class="normal"><a href="#__codelineno-0-754"> 754</a></span>
<span class="normal"><a href="#__codelineno-0-755"> 755</a></span>
<span class="normal"><a href="#__codelineno-0-756"> 756</a></span>
<span class="normal"><a href="#__codelineno-0-757"> 757</a></span>
<span class="normal"><a href="#__codelineno-0-758"> 758</a></span>
<span class="normal"><a href="#__codelineno-0-759"> 759</a></span>
<span class="normal"><a href="#__codelineno-0-760"> 760</a></span>
<span class="normal"><a href="#__codelineno-0-761"> 761</a></span>
<span class="normal"><a href="#__codelineno-0-762"> 762</a></span>
<span class="normal"><a href="#__codelineno-0-763"> 763</a></span>
<span class="normal"><a href="#__codelineno-0-764"> 764</a></span>
<span class="normal"><a href="#__codelineno-0-765"> 765</a></span>
<span class="normal"><a href="#__codelineno-0-766"> 766</a></span>
<span class="normal"><a href="#__codelineno-0-767"> 767</a></span>
<span class="normal"><a href="#__codelineno-0-768"> 768</a></span>
<span class="normal"><a href="#__codelineno-0-769"> 769</a></span>
<span class="normal"><a href="#__codelineno-0-770"> 770</a></span>
<span class="normal"><a href="#__codelineno-0-771"> 771</a></span>
<span class="normal"><a href="#__codelineno-0-772"> 772</a></span>
<span class="normal"><a href="#__codelineno-0-773"> 773</a></span>
<span class="normal"><a href="#__codelineno-0-774"> 774</a></span>
<span class="normal"><a href="#__codelineno-0-775"> 775</a></span>
<span class="normal"><a href="#__codelineno-0-776"> 776</a></span>
<span class="normal"><a href="#__codelineno-0-777"> 777</a></span>
<span class="normal"><a href="#__codelineno-0-778"> 778</a></span>
<span class="normal"><a href="#__codelineno-0-779"> 779</a></span>
<span class="normal"><a href="#__codelineno-0-780"> 780</a></span>
<span class="normal"><a href="#__codelineno-0-781"> 781</a></span>
<span class="normal"><a href="#__codelineno-0-782"> 782</a></span>
<span class="normal"><a href="#__codelineno-0-783"> 783</a></span>
<span class="normal"><a href="#__codelineno-0-784"> 784</a></span>
<span class="normal"><a href="#__codelineno-0-785"> 785</a></span>
<span class="normal"><a href="#__codelineno-0-786"> 786</a></span>
<span class="normal"><a href="#__codelineno-0-787"> 787</a></span>
<span class="normal"><a href="#__codelineno-0-788"> 788</a></span>
<span class="normal"><a href="#__codelineno-0-789"> 789</a></span>
<span class="normal"><a href="#__codelineno-0-790"> 790</a></span>
<span class="normal"><a href="#__codelineno-0-791"> 791</a></span>
<span class="normal"><a href="#__codelineno-0-792"> 792</a></span>
<span class="normal"><a href="#__codelineno-0-793"> 793</a></span>
<span class="normal"><a href="#__codelineno-0-794"> 794</a></span>
<span class="normal"><a href="#__codelineno-0-795"> 795</a></span>
<span class="normal"><a href="#__codelineno-0-796"> 796</a></span>
<span class="normal"><a href="#__codelineno-0-797"> 797</a></span>
<span class="normal"><a href="#__codelineno-0-798"> 798</a></span>
<span class="normal"><a href="#__codelineno-0-799"> 799</a></span>
<span class="normal"><a href="#__codelineno-0-800"> 800</a></span>
<span class="normal"><a href="#__codelineno-0-801"> 801</a></span>
<span class="normal"><a href="#__codelineno-0-802"> 802</a></span>
<span class="normal"><a href="#__codelineno-0-803"> 803</a></span>
<span class="normal"><a href="#__codelineno-0-804"> 804</a></span>
<span class="normal"><a href="#__codelineno-0-805"> 805</a></span>
<span class="normal"><a href="#__codelineno-0-806"> 806</a></span>
<span class="normal"><a href="#__codelineno-0-807"> 807</a></span>
<span class="normal"><a href="#__codelineno-0-808"> 808</a></span>
<span class="normal"><a href="#__codelineno-0-809"> 809</a></span>
<span class="normal"><a href="#__codelineno-0-810"> 810</a></span>
<span class="normal"><a href="#__codelineno-0-811"> 811</a></span>
<span class="normal"><a href="#__codelineno-0-812"> 812</a></span>
<span class="normal"><a href="#__codelineno-0-813"> 813</a></span>
<span class="normal"><a href="#__codelineno-0-814"> 814</a></span>
<span class="normal"><a href="#__codelineno-0-815"> 815</a></span>
<span class="normal"><a href="#__codelineno-0-816"> 816</a></span>
<span class="normal"><a href="#__codelineno-0-817"> 817</a></span>
<span class="normal"><a href="#__codelineno-0-818"> 818</a></span>
<span class="normal"><a href="#__codelineno-0-819"> 819</a></span>
<span class="normal"><a href="#__codelineno-0-820"> 820</a></span>
<span class="normal"><a href="#__codelineno-0-821"> 821</a></span>
<span class="normal"><a href="#__codelineno-0-822"> 822</a></span>
<span class="normal"><a href="#__codelineno-0-823"> 823</a></span>
<span class="normal"><a href="#__codelineno-0-824"> 824</a></span>
<span class="normal"><a href="#__codelineno-0-825"> 825</a></span>
<span class="normal"><a href="#__codelineno-0-826"> 826</a></span>
<span class="normal"><a href="#__codelineno-0-827"> 827</a></span>
<span class="normal"><a href="#__codelineno-0-828"> 828</a></span>
<span class="normal"><a href="#__codelineno-0-829"> 829</a></span>
<span class="normal"><a href="#__codelineno-0-830"> 830</a></span>
<span class="normal"><a href="#__codelineno-0-831"> 831</a></span>
<span class="normal"><a href="#__codelineno-0-832"> 832</a></span>
<span class="normal"><a href="#__codelineno-0-833"> 833</a></span>
<span class="normal"><a href="#__codelineno-0-834"> 834</a></span>
<span class="normal"><a href="#__codelineno-0-835"> 835</a></span>
<span class="normal"><a href="#__codelineno-0-836"> 836</a></span>
<span class="normal"><a href="#__codelineno-0-837"> 837</a></span>
<span class="normal"><a href="#__codelineno-0-838"> 838</a></span>
<span class="normal"><a href="#__codelineno-0-839"> 839</a></span>
<span class="normal"><a href="#__codelineno-0-840"> 840</a></span>
<span class="normal"><a href="#__codelineno-0-841"> 841</a></span>
<span class="normal"><a href="#__codelineno-0-842"> 842</a></span>
<span class="normal"><a href="#__codelineno-0-843"> 843</a></span>
<span class="normal"><a href="#__codelineno-0-844"> 844</a></span>
<span class="normal"><a href="#__codelineno-0-845"> 845</a></span>
<span class="normal"><a href="#__codelineno-0-846"> 846</a></span>
<span class="normal"><a href="#__codelineno-0-847"> 847</a></span>
<span class="normal"><a href="#__codelineno-0-848"> 848</a></span>
<span class="normal"><a href="#__codelineno-0-849"> 849</a></span>
<span class="normal"><a href="#__codelineno-0-850"> 850</a></span>
<span class="normal"><a href="#__codelineno-0-851"> 851</a></span>
<span class="normal"><a href="#__codelineno-0-852"> 852</a></span>
<span class="normal"><a href="#__codelineno-0-853"> 853</a></span>
<span class="normal"><a href="#__codelineno-0-854"> 854</a></span>
<span class="normal"><a href="#__codelineno-0-855"> 855</a></span>
<span class="normal"><a href="#__codelineno-0-856"> 856</a></span>
<span class="normal"><a href="#__codelineno-0-857"> 857</a></span>
<span class="normal"><a href="#__codelineno-0-858"> 858</a></span>
<span class="normal"><a href="#__codelineno-0-859"> 859</a></span>
<span class="normal"><a href="#__codelineno-0-860"> 860</a></span>
<span class="normal"><a href="#__codelineno-0-861"> 861</a></span>
<span class="normal"><a href="#__codelineno-0-862"> 862</a></span>
<span class="normal"><a href="#__codelineno-0-863"> 863</a></span>
<span class="normal"><a href="#__codelineno-0-864"> 864</a></span>
<span class="normal"><a href="#__codelineno-0-865"> 865</a></span>
<span class="normal"><a href="#__codelineno-0-866"> 866</a></span>
<span class="normal"><a href="#__codelineno-0-867"> 867</a></span>
<span class="normal"><a href="#__codelineno-0-868"> 868</a></span>
<span class="normal"><a href="#__codelineno-0-869"> 869</a></span>
<span class="normal"><a href="#__codelineno-0-870"> 870</a></span>
<span class="normal"><a href="#__codelineno-0-871"> 871</a></span>
<span class="normal"><a href="#__codelineno-0-872"> 872</a></span>
<span class="normal"><a href="#__codelineno-0-873"> 873</a></span>
<span class="normal"><a href="#__codelineno-0-874"> 874</a></span>
<span class="normal"><a href="#__codelineno-0-875"> 875</a></span>
<span class="normal"><a href="#__codelineno-0-876"> 876</a></span>
<span class="normal"><a href="#__codelineno-0-877"> 877</a></span>
<span class="normal"><a href="#__codelineno-0-878"> 878</a></span>
<span class="normal"><a href="#__codelineno-0-879"> 879</a></span>
<span class="normal"><a href="#__codelineno-0-880"> 880</a></span>
<span class="normal"><a href="#__codelineno-0-881"> 881</a></span>
<span class="normal"><a href="#__codelineno-0-882"> 882</a></span>
<span class="normal"><a href="#__codelineno-0-883"> 883</a></span>
<span class="normal"><a href="#__codelineno-0-884"> 884</a></span>
<span class="normal"><a href="#__codelineno-0-885"> 885</a></span>
<span class="normal"><a href="#__codelineno-0-886"> 886</a></span>
<span class="normal"><a href="#__codelineno-0-887"> 887</a></span>
<span class="normal"><a href="#__codelineno-0-888"> 888</a></span>
<span class="normal"><a href="#__codelineno-0-889"> 889</a></span>
<span class="normal"><a href="#__codelineno-0-890"> 890</a></span>
<span class="normal"><a href="#__codelineno-0-891"> 891</a></span>
<span class="normal"><a href="#__codelineno-0-892"> 892</a></span>
<span class="normal"><a href="#__codelineno-0-893"> 893</a></span>
<span class="normal"><a href="#__codelineno-0-894"> 894</a></span>
<span class="normal"><a href="#__codelineno-0-895"> 895</a></span>
<span class="normal"><a href="#__codelineno-0-896"> 896</a></span>
<span class="normal"><a href="#__codelineno-0-897"> 897</a></span>
<span class="normal"><a href="#__codelineno-0-898"> 898</a></span>
<span class="normal"><a href="#__codelineno-0-899"> 899</a></span>
<span class="normal"><a href="#__codelineno-0-900"> 900</a></span>
<span class="normal"><a href="#__codelineno-0-901"> 901</a></span>
<span class="normal"><a href="#__codelineno-0-902"> 902</a></span>
<span class="normal"><a href="#__codelineno-0-903"> 903</a></span>
<span class="normal"><a href="#__codelineno-0-904"> 904</a></span>
<span class="normal"><a href="#__codelineno-0-905"> 905</a></span>
<span class="normal"><a href="#__codelineno-0-906"> 906</a></span>
<span class="normal"><a href="#__codelineno-0-907"> 907</a></span>
<span class="normal"><a href="#__codelineno-0-908"> 908</a></span>
<span class="normal"><a href="#__codelineno-0-909"> 909</a></span>
<span class="normal"><a href="#__codelineno-0-910"> 910</a></span>
<span class="normal"><a href="#__codelineno-0-911"> 911</a></span>
<span class="normal"><a href="#__codelineno-0-912"> 912</a></span>
<span class="normal"><a href="#__codelineno-0-913"> 913</a></span>
<span class="normal"><a href="#__codelineno-0-914"> 914</a></span>
<span class="normal"><a href="#__codelineno-0-915"> 915</a></span>
<span class="normal"><a href="#__codelineno-0-916"> 916</a></span>
<span class="normal"><a href="#__codelineno-0-917"> 917</a></span>
<span class="normal"><a href="#__codelineno-0-918"> 918</a></span>
<span class="normal"><a href="#__codelineno-0-919"> 919</a></span>
<span class="normal"><a href="#__codelineno-0-920"> 920</a></span>
<span class="normal"><a href="#__codelineno-0-921"> 921</a></span>
<span class="normal"><a href="#__codelineno-0-922"> 922</a></span>
<span class="normal"><a href="#__codelineno-0-923"> 923</a></span>
<span class="normal"><a href="#__codelineno-0-924"> 924</a></span>
<span class="normal"><a href="#__codelineno-0-925"> 925</a></span>
<span class="normal"><a href="#__codelineno-0-926"> 926</a></span>
<span class="normal"><a href="#__codelineno-0-927"> 927</a></span>
<span class="normal"><a href="#__codelineno-0-928"> 928</a></span>
<span class="normal"><a href="#__codelineno-0-929"> 929</a></span>
<span class="normal"><a href="#__codelineno-0-930"> 930</a></span>
<span class="normal"><a href="#__codelineno-0-931"> 931</a></span>
<span class="normal"><a href="#__codelineno-0-932"> 932</a></span>
<span class="normal"><a href="#__codelineno-0-933"> 933</a></span>
<span class="normal"><a href="#__codelineno-0-934"> 934</a></span>
<span class="normal"><a href="#__codelineno-0-935"> 935</a></span>
<span class="normal"><a href="#__codelineno-0-936"> 936</a></span>
<span class="normal"><a href="#__codelineno-0-937"> 937</a></span>
<span class="normal"><a href="#__codelineno-0-938"> 938</a></span>
<span class="normal"><a href="#__codelineno-0-939"> 939</a></span>
<span class="normal"><a href="#__codelineno-0-940"> 940</a></span>
<span class="normal"><a href="#__codelineno-0-941"> 941</a></span>
<span class="normal"><a href="#__codelineno-0-942"> 942</a></span>
<span class="normal"><a href="#__codelineno-0-943"> 943</a></span>
<span class="normal"><a href="#__codelineno-0-944"> 944</a></span>
<span class="normal"><a href="#__codelineno-0-945"> 945</a></span>
<span class="normal"><a href="#__codelineno-0-946"> 946</a></span>
<span class="normal"><a href="#__codelineno-0-947"> 947</a></span>
<span class="normal"><a href="#__codelineno-0-948"> 948</a></span>
<span class="normal"><a href="#__codelineno-0-949"> 949</a></span>
<span class="normal"><a href="#__codelineno-0-950"> 950</a></span>
<span class="normal"><a href="#__codelineno-0-951"> 951</a></span>
<span class="normal"><a href="#__codelineno-0-952"> 952</a></span>
<span class="normal"><a href="#__codelineno-0-953"> 953</a></span>
<span class="normal"><a href="#__codelineno-0-954"> 954</a></span>
<span class="normal"><a href="#__codelineno-0-955"> 955</a></span>
<span class="normal"><a href="#__codelineno-0-956"> 956</a></span>
<span class="normal"><a href="#__codelineno-0-957"> 957</a></span>
<span class="normal"><a href="#__codelineno-0-958"> 958</a></span>
<span class="normal"><a href="#__codelineno-0-959"> 959</a></span>
<span class="normal"><a href="#__codelineno-0-960"> 960</a></span>
<span class="normal"><a href="#__codelineno-0-961"> 961</a></span>
<span class="normal"><a href="#__codelineno-0-962"> 962</a></span>
<span class="normal"><a href="#__codelineno-0-963"> 963</a></span>
<span class="normal"><a href="#__codelineno-0-964"> 964</a></span>
<span class="normal"><a href="#__codelineno-0-965"> 965</a></span>
<span class="normal"><a href="#__codelineno-0-966"> 966</a></span>
<span class="normal"><a href="#__codelineno-0-967"> 967</a></span>
<span class="normal"><a href="#__codelineno-0-968"> 968</a></span>
<span class="normal"><a href="#__codelineno-0-969"> 969</a></span>
<span class="normal"><a href="#__codelineno-0-970"> 970</a></span>
<span class="normal"><a href="#__codelineno-0-971"> 971</a></span>
<span class="normal"><a href="#__codelineno-0-972"> 972</a></span>
<span class="normal"><a href="#__codelineno-0-973"> 973</a></span>
<span class="normal"><a href="#__codelineno-0-974"> 974</a></span>
<span class="normal"><a href="#__codelineno-0-975"> 975</a></span>
<span class="normal"><a href="#__codelineno-0-976"> 976</a></span>
<span class="normal"><a href="#__codelineno-0-977"> 977</a></span>
<span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span>
<span class="normal"><a href="#__codelineno-0-1066">1066</a></span>
<span class="normal"><a href="#__codelineno-0-1067">1067</a></span>
<span class="normal"><a href="#__codelineno-0-1068">1068</a></span>
<span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span>
<span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span>
<span class="normal"><a href="#__codelineno-0-1086">1086</a></span>
<span class="normal"><a href="#__codelineno-0-1087">1087</a></span>
<span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span>
<span class="normal"><a href="#__codelineno-0-1090">1090</a></span>
<span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span>
<span class="normal"><a href="#__codelineno-0-1096">1096</a></span>
<span class="normal"><a href="#__codelineno-0-1097">1097</a></span>
<span class="normal"><a href="#__codelineno-0-1098">1098</a></span>
<span class="normal"><a href="#__codelineno-0-1099">1099</a></span>
<span class="normal"><a href="#__codelineno-0-1100">1100</a></span>
<span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span>
<span class="normal"><a href="#__codelineno-0-1105">1105</a></span>
<span class="normal"><a href="#__codelineno-0-1106">1106</a></span>
<span class="normal"><a href="#__codelineno-0-1107">1107</a></span>
<span class="normal"><a href="#__codelineno-0-1108">1108</a></span>
<span class="normal"><a href="#__codelineno-0-1109">1109</a></span>
<span class="normal"><a href="#__codelineno-0-1110">1110</a></span>
<span class="normal"><a href="#__codelineno-0-1111">1111</a></span>
<span class="normal"><a href="#__codelineno-0-1112">1112</a></span>
<span class="normal"><a href="#__codelineno-0-1113">1113</a></span>
<span class="normal"><a href="#__codelineno-0-1114">1114</a></span>
<span class="normal"><a href="#__codelineno-0-1115">1115</a></span>
<span class="normal"><a href="#__codelineno-0-1116">1116</a></span>
<span class="normal"><a href="#__codelineno-0-1117">1117</a></span>
<span class="normal"><a href="#__codelineno-0-1118">1118</a></span>
<span class="normal"><a href="#__codelineno-0-1119">1119</a></span>
<span class="normal"><a href="#__codelineno-0-1120">1120</a></span>
<span class="normal"><a href="#__codelineno-0-1121">1121</a></span>
<span class="normal"><a href="#__codelineno-0-1122">1122</a></span>
<span class="normal"><a href="#__codelineno-0-1123">1123</a></span>
<span class="normal"><a href="#__codelineno-0-1124">1124</a></span>
<span class="normal"><a href="#__codelineno-0-1125">1125</a></span>
<span class="normal"><a href="#__codelineno-0-1126">1126</a></span>
<span class="normal"><a href="#__codelineno-0-1127">1127</a></span>
<span class="normal"><a href="#__codelineno-0-1128">1128</a></span>
<span class="normal"><a href="#__codelineno-0-1129">1129</a></span>
<span class="normal"><a href="#__codelineno-0-1130">1130</a></span>
<span class="normal"><a href="#__codelineno-0-1131">1131</a></span>
<span class="normal"><a href="#__codelineno-0-1132">1132</a></span>
<span class="normal"><a href="#__codelineno-0-1133">1133</a></span>
<span class="normal"><a href="#__codelineno-0-1134">1134</a></span>
<span class="normal"><a href="#__codelineno-0-1135">1135</a></span>
<span class="normal"><a href="#__codelineno-0-1136">1136</a></span>
<span class="normal"><a href="#__codelineno-0-1137">1137</a></span>
<span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span>
<span class="normal"><a href="#__codelineno-0-1140">1140</a></span>
<span class="normal"><a href="#__codelineno-0-1141">1141</a></span>
<span class="normal"><a href="#__codelineno-0-1142">1142</a></span>
<span class="normal"><a href="#__codelineno-0-1143">1143</a></span>
<span class="normal"><a href="#__codelineno-0-1144">1144</a></span>
<span class="normal"><a href="#__codelineno-0-1145">1145</a></span>
<span class="normal"><a href="#__codelineno-0-1146">1146</a></span>
<span class="normal"><a href="#__codelineno-0-1147">1147</a></span>
<span class="normal"><a href="#__codelineno-0-1148">1148</a></span>
<span class="normal"><a href="#__codelineno-0-1149">1149</a></span>
<span class="normal"><a href="#__codelineno-0-1150">1150</a></span>
<span class="normal"><a href="#__codelineno-0-1151">1151</a></span>
<span class="normal"><a href="#__codelineno-0-1152">1152</a></span>
<span class="normal"><a href="#__codelineno-0-1153">1153</a></span>
<span class="normal"><a href="#__codelineno-0-1154">1154</a></span>
<span class="normal"><a href="#__codelineno-0-1155">1155</a></span>
<span class="normal"><a href="#__codelineno-0-1156">1156</a></span>
<span class="normal"><a href="#__codelineno-0-1157">1157</a></span>
<span class="normal"><a href="#__codelineno-0-1158">1158</a></span>
<span class="normal"><a href="#__codelineno-0-1159">1159</a></span>
<span class="normal"><a href="#__codelineno-0-1160">1160</a></span>
<span class="normal"><a href="#__codelineno-0-1161">1161</a></span>
<span class="normal"><a href="#__codelineno-0-1162">1162</a></span>
<span class="normal"><a href="#__codelineno-0-1163">1163</a></span>
<span class="normal"><a href="#__codelineno-0-1164">1164</a></span>
<span class="normal"><a href="#__codelineno-0-1165">1165</a></span>
<span class="normal"><a href="#__codelineno-0-1166">1166</a></span>
<span class="normal"><a href="#__codelineno-0-1167">1167</a></span>
<span class="normal"><a href="#__codelineno-0-1168">1168</a></span>
<span class="normal"><a href="#__codelineno-0-1169">1169</a></span>
<span class="normal"><a href="#__codelineno-0-1170">1170</a></span>
<span class="normal"><a href="#__codelineno-0-1171">1171</a></span>
<span class="normal"><a href="#__codelineno-0-1172">1172</a></span>
<span class="normal"><a href="#__codelineno-0-1173">1173</a></span>
<span class="normal"><a href="#__codelineno-0-1174">1174</a></span>
<span class="normal"><a href="#__codelineno-0-1175">1175</a></span>
<span class="normal"><a href="#__codelineno-0-1176">1176</a></span>
<span class="normal"><a href="#__codelineno-0-1177">1177</a></span>
<span class="normal"><a href="#__codelineno-0-1178">1178</a></span>
<span class="normal"><a href="#__codelineno-0-1179">1179</a></span>
<span class="normal"><a href="#__codelineno-0-1180">1180</a></span>
<span class="normal"><a href="#__codelineno-0-1181">1181</a></span>
<span class="normal"><a href="#__codelineno-0-1182">1182</a></span>
<span class="normal"><a href="#__codelineno-0-1183">1183</a></span>
<span class="normal"><a href="#__codelineno-0-1184">1184</a></span>
<span class="normal"><a href="#__codelineno-0-1185">1185</a></span>
<span class="normal"><a href="#__codelineno-0-1186">1186</a></span>
<span class="normal"><a href="#__codelineno-0-1187">1187</a></span>
<span class="normal"><a href="#__codelineno-0-1188">1188</a></span>
<span class="normal"><a href="#__codelineno-0-1189">1189</a></span>
<span class="normal"><a href="#__codelineno-0-1190">1190</a></span>
<span class="normal"><a href="#__codelineno-0-1191">1191</a></span>
<span class="normal"><a href="#__codelineno-0-1192">1192</a></span>
<span class="normal"><a href="#__codelineno-0-1193">1193</a></span>
<span class="normal"><a href="#__codelineno-0-1194">1194</a></span>
<span class="normal"><a href="#__codelineno-0-1195">1195</a></span>
<span class="normal"><a href="#__codelineno-0-1196">1196</a></span>
<span class="normal"><a href="#__codelineno-0-1197">1197</a></span>
<span class="normal"><a href="#__codelineno-0-1198">1198</a></span>
<span class="normal"><a href="#__codelineno-0-1199">1199</a></span>
<span class="normal"><a href="#__codelineno-0-1200">1200</a></span>
<span class="normal"><a href="#__codelineno-0-1201">1201</a></span>
<span class="normal"><a href="#__codelineno-0-1202">1202</a></span>
<span class="normal"><a href="#__codelineno-0-1203">1203</a></span>
<span class="normal"><a href="#__codelineno-0-1204">1204</a></span>
<span class="normal"><a href="#__codelineno-0-1205">1205</a></span>
<span class="normal"><a href="#__codelineno-0-1206">1206</a></span>
<span class="normal"><a href="#__codelineno-0-1207">1207</a></span>
<span class="normal"><a href="#__codelineno-0-1208">1208</a></span>
<span class="normal"><a href="#__codelineno-0-1209">1209</a></span>
<span class="normal"><a href="#__codelineno-0-1210">1210</a></span>
<span class="normal"><a href="#__codelineno-0-1211">1211</a></span>
<span class="normal"><a href="#__codelineno-0-1212">1212</a></span>
<span class="normal"><a href="#__codelineno-0-1213">1213</a></span>
<span class="normal"><a href="#__codelineno-0-1214">1214</a></span>
<span class="normal"><a href="#__codelineno-0-1215">1215</a></span>
<span class="normal"><a href="#__codelineno-0-1216">1216</a></span>
<span class="normal"><a href="#__codelineno-0-1217">1217</a></span>
<span class="normal"><a href="#__codelineno-0-1218">1218</a></span>
<span class="normal"><a href="#__codelineno-0-1219">1219</a></span>
<span class="normal"><a href="#__codelineno-0-1220">1220</a></span>
<span class="normal"><a href="#__codelineno-0-1221">1221</a></span>
<span class="normal"><a href="#__codelineno-0-1222">1222</a></span>
<span class="normal"><a href="#__codelineno-0-1223">1223</a></span>
<span class="normal"><a href="#__codelineno-0-1224">1224</a></span>
<span class="normal"><a href="#__codelineno-0-1225">1225</a></span>
<span class="normal"><a href="#__codelineno-0-1226">1226</a></span>
<span class="normal"><a href="#__codelineno-0-1227">1227</a></span>
<span class="normal"><a href="#__codelineno-0-1228">1228</a></span>
<span class="normal"><a href="#__codelineno-0-1229">1229</a></span>
<span class="normal"><a href="#__codelineno-0-1230">1230</a></span>
<span class="normal"><a href="#__codelineno-0-1231">1231</a></span>
<span class="normal"><a href="#__codelineno-0-1232">1232</a></span>
<span class="normal"><a href="#__codelineno-0-1233">1233</a></span>
<span class="normal"><a href="#__codelineno-0-1234">1234</a></span>
<span class="normal"><a href="#__codelineno-0-1235">1235</a></span>
<span class="normal"><a href="#__codelineno-0-1236">1236</a></span>
<span class="normal"><a href="#__codelineno-0-1237">1237</a></span>
<span class="normal"><a href="#__codelineno-0-1238">1238</a></span>
<span class="normal"><a href="#__codelineno-0-1239">1239</a></span>
<span class="normal"><a href="#__codelineno-0-1240">1240</a></span>
<span class="normal"><a href="#__codelineno-0-1241">1241</a></span>
<span class="normal"><a href="#__codelineno-0-1242">1242</a></span>
<span class="normal"><a href="#__codelineno-0-1243">1243</a></span>
<span class="normal"><a href="#__codelineno-0-1244">1244</a></span>
<span class="normal"><a href="#__codelineno-0-1245">1245</a></span>
<span class="normal"><a href="#__codelineno-0-1246">1246</a></span>
<span class="normal"><a href="#__codelineno-0-1247">1247</a></span>
<span class="normal"><a href="#__codelineno-0-1248">1248</a></span>
<span class="normal"><a href="#__codelineno-0-1249">1249</a></span>
<span class="normal"><a href="#__codelineno-0-1250">1250</a></span>
<span class="normal"><a href="#__codelineno-0-1251">1251</a></span>
<span class="normal"><a href="#__codelineno-0-1252">1252</a></span>
<span class="normal"><a href="#__codelineno-0-1253">1253</a></span>
<span class="normal"><a href="#__codelineno-0-1254">1254</a></span>
<span class="normal"><a href="#__codelineno-0-1255">1255</a></span>
<span class="normal"><a href="#__codelineno-0-1256">1256</a></span>
<span class="normal"><a href="#__codelineno-0-1257">1257</a></span>
<span class="normal"><a href="#__codelineno-0-1258">1258</a></span>
<span class="normal"><a href="#__codelineno-0-1259">1259</a></span>
<span class="normal"><a href="#__codelineno-0-1260">1260</a></span>
<span class="normal"><a href="#__codelineno-0-1261">1261</a></span>
<span class="normal"><a href="#__codelineno-0-1262">1262</a></span>
<span class="normal"><a href="#__codelineno-0-1263">1263</a></span>
<span class="normal"><a href="#__codelineno-0-1264">1264</a></span>
<span class="normal"><a href="#__codelineno-0-1265">1265</a></span>
<span class="normal"><a href="#__codelineno-0-1266">1266</a></span>
<span class="normal"><a href="#__codelineno-0-1267">1267</a></span>
<span class="normal"><a href="#__codelineno-0-1268">1268</a></span>
<span class="normal"><a href="#__codelineno-0-1269">1269</a></span>
<span class="normal"><a href="#__codelineno-0-1270">1270</a></span>
<span class="normal"><a href="#__codelineno-0-1271">1271</a></span>
<span class="normal"><a href="#__codelineno-0-1272">1272</a></span>
<span class="normal"><a href="#__codelineno-0-1273">1273</a></span>
<span class="normal"><a href="#__codelineno-0-1274">1274</a></span>
<span class="normal"><a href="#__codelineno-0-1275">1275</a></span>
<span class="normal"><a href="#__codelineno-0-1276">1276</a></span>
<span class="normal"><a href="#__codelineno-0-1277">1277</a></span>
<span class="normal"><a href="#__codelineno-0-1278">1278</a></span>
<span class="normal"><a href="#__codelineno-0-1279">1279</a></span>
<span class="normal"><a href="#__codelineno-0-1280">1280</a></span>
<span class="normal"><a href="#__codelineno-0-1281">1281</a></span>
<span class="normal"><a href="#__codelineno-0-1282">1282</a></span>
<span class="normal"><a href="#__codelineno-0-1283">1283</a></span>
<span class="normal"><a href="#__codelineno-0-1284">1284</a></span>
<span class="normal"><a href="#__codelineno-0-1285">1285</a></span>
<span class="normal"><a href="#__codelineno-0-1286">1286</a></span>
<span class="normal"><a href="#__codelineno-0-1287">1287</a></span>
<span class="normal"><a href="#__codelineno-0-1288">1288</a></span>
<span class="normal"><a href="#__codelineno-0-1289">1289</a></span>
<span class="normal"><a href="#__codelineno-0-1290">1290</a></span>
<span class="normal"><a href="#__codelineno-0-1291">1291</a></span>
<span class="normal"><a href="#__codelineno-0-1292">1292</a></span>
<span class="normal"><a href="#__codelineno-0-1293">1293</a></span>
<span class="normal"><a href="#__codelineno-0-1294">1294</a></span>
<span class="normal"><a href="#__codelineno-0-1295">1295</a></span>
<span class="normal"><a href="#__codelineno-0-1296">1296</a></span>
<span class="normal"><a href="#__codelineno-0-1297">1297</a></span>
<span class="normal"><a href="#__codelineno-0-1298">1298</a></span>
<span class="normal"><a href="#__codelineno-0-1299">1299</a></span>
<span class="normal"><a href="#__codelineno-0-1300">1300</a></span>
<span class="normal"><a href="#__codelineno-0-1301">1301</a></span>
<span class="normal"><a href="#__codelineno-0-1302">1302</a></span>
<span class="normal"><a href="#__codelineno-0-1303">1303</a></span>
<span class="normal"><a href="#__codelineno-0-1304">1304</a></span>
<span class="normal"><a href="#__codelineno-0-1305">1305</a></span>
<span class="normal"><a href="#__codelineno-0-1306">1306</a></span>
<span class="normal"><a href="#__codelineno-0-1307">1307</a></span>
<span class="normal"><a href="#__codelineno-0-1308">1308</a></span>
<span class="normal"><a href="#__codelineno-0-1309">1309</a></span>
<span class="normal"><a href="#__codelineno-0-1310">1310</a></span>
<span class="normal"><a href="#__codelineno-0-1311">1311</a></span>
<span class="normal"><a href="#__codelineno-0-1312">1312</a></span>
<span class="normal"><a href="#__codelineno-0-1313">1313</a></span>
<span class="normal"><a href="#__codelineno-0-1314">1314</a></span>
<span class="normal"><a href="#__codelineno-0-1315">1315</a></span>
<span class="normal"><a href="#__codelineno-0-1316">1316</a></span>
<span class="normal"><a href="#__codelineno-0-1317">1317</a></span>
<span class="normal"><a href="#__codelineno-0-1318">1318</a></span>
<span class="normal"><a href="#__codelineno-0-1319">1319</a></span>
<span class="normal"><a href="#__codelineno-0-1320">1320</a></span>
<span class="normal"><a href="#__codelineno-0-1321">1321</a></span>
<span class="normal"><a href="#__codelineno-0-1322">1322</a></span>
<span class="normal"><a href="#__codelineno-0-1323">1323</a></span>
<span class="normal"><a href="#__codelineno-0-1324">1324</a></span>
<span class="normal"><a href="#__codelineno-0-1325">1325</a></span>
<span class="normal"><a href="#__codelineno-0-1326">1326</a></span>
<span class="normal"><a href="#__codelineno-0-1327">1327</a></span>
<span class="normal"><a href="#__codelineno-0-1328">1328</a></span>
<span class="normal"><a href="#__codelineno-0-1329">1329</a></span>
<span class="normal"><a href="#__codelineno-0-1330">1330</a></span>
<span class="normal"><a href="#__codelineno-0-1331">1331</a></span>
<span class="normal"><a href="#__codelineno-0-1332">1332</a></span>
<span class="normal"><a href="#__codelineno-0-1333">1333</a></span>
<span class="normal"><a href="#__codelineno-0-1334">1334</a></span>
<span class="normal"><a href="#__codelineno-0-1335">1335</a></span>
<span class="normal"><a href="#__codelineno-0-1336">1336</a></span>
<span class="normal"><a href="#__codelineno-0-1337">1337</a></span>
<span class="normal"><a href="#__codelineno-0-1338">1338</a></span>
<span class="normal"><a href="#__codelineno-0-1339">1339</a></span>
<span class="normal"><a href="#__codelineno-0-1340">1340</a></span>
<span class="normal"><a href="#__codelineno-0-1341">1341</a></span>
<span class="normal"><a href="#__codelineno-0-1342">1342</a></span>
<span class="normal"><a href="#__codelineno-0-1343">1343</a></span>
<span class="normal"><a href="#__codelineno-0-1344">1344</a></span>
<span class="normal"><a href="#__codelineno-0-1345">1345</a></span>
<span class="normal"><a href="#__codelineno-0-1346">1346</a></span>
<span class="normal"><a href="#__codelineno-0-1347">1347</a></span>
<span class="normal"><a href="#__codelineno-0-1348">1348</a></span>
<span class="normal"><a href="#__codelineno-0-1349">1349</a></span>
<span class="normal"><a href="#__codelineno-0-1350">1350</a></span>
<span class="normal"><a href="#__codelineno-0-1351">1351</a></span>
<span class="normal"><a href="#__codelineno-0-1352">1352</a></span>
<span class="normal"><a href="#__codelineno-0-1353">1353</a></span>
<span class="normal"><a href="#__codelineno-0-1354">1354</a></span>
<span class="normal"><a href="#__codelineno-0-1355">1355</a></span>
<span class="normal"><a href="#__codelineno-0-1356">1356</a></span>
<span class="normal"><a href="#__codelineno-0-1357">1357</a></span>
<span class="normal"><a href="#__codelineno-0-1358">1358</a></span>
<span class="normal"><a href="#__codelineno-0-1359">1359</a></span>
<span class="normal"><a href="#__codelineno-0-1360">1360</a></span>
<span class="normal"><a href="#__codelineno-0-1361">1361</a></span>
<span class="normal"><a href="#__codelineno-0-1362">1362</a></span>
<span class="normal"><a href="#__codelineno-0-1363">1363</a></span>
<span class="normal"><a href="#__codelineno-0-1364">1364</a></span>
<span class="normal"><a href="#__codelineno-0-1365">1365</a></span>
<span class="normal"><a href="#__codelineno-0-1366">1366</a></span>
<span class="normal"><a href="#__codelineno-0-1367">1367</a></span>
<span class="normal"><a href="#__codelineno-0-1368">1368</a></span>
<span class="normal"><a href="#__codelineno-0-1369">1369</a></span>
<span class="normal"><a href="#__codelineno-0-1370">1370</a></span>
<span class="normal"><a href="#__codelineno-0-1371">1371</a></span>
<span class="normal"><a href="#__codelineno-0-1372">1372</a></span>
<span class="normal"><a href="#__codelineno-0-1373">1373</a></span>
<span class="normal"><a href="#__codelineno-0-1374">1374</a></span>
<span class="normal"><a href="#__codelineno-0-1375">1375</a></span>
<span class="normal"><a href="#__codelineno-0-1376">1376</a></span>
<span class="normal"><a href="#__codelineno-0-1377">1377</a></span>
<span class="normal"><a href="#__codelineno-0-1378">1378</a></span>
<span class="normal"><a href="#__codelineno-0-1379">1379</a></span>
<span class="normal"><a href="#__codelineno-0-1380">1380</a></span>
<span class="normal"><a href="#__codelineno-0-1381">1381</a></span>
<span class="normal"><a href="#__codelineno-0-1382">1382</a></span>
<span class="normal"><a href="#__codelineno-0-1383">1383</a></span>
<span class="normal"><a href="#__codelineno-0-1384">1384</a></span>
<span class="normal"><a href="#__codelineno-0-1385">1385</a></span>
<span class="normal"><a href="#__codelineno-0-1386">1386</a></span>
<span class="normal"><a href="#__codelineno-0-1387">1387</a></span>
<span class="normal"><a href="#__codelineno-0-1388">1388</a></span>
<span class="normal"><a href="#__codelineno-0-1389">1389</a></span>
<span class="normal"><a href="#__codelineno-0-1390">1390</a></span>
<span class="normal"><a href="#__codelineno-0-1391">1391</a></span>
<span class="normal"><a href="#__codelineno-0-1392">1392</a></span>
<span class="normal"><a href="#__codelineno-0-1393">1393</a></span>
<span class="normal"><a href="#__codelineno-0-1394">1394</a></span>
<span class="normal"><a href="#__codelineno-0-1395">1395</a></span>
<span class="normal"><a href="#__codelineno-0-1396">1396</a></span>
<span class="normal"><a href="#__codelineno-0-1397">1397</a></span>
<span class="normal"><a href="#__codelineno-0-1398">1398</a></span>
<span class="normal"><a href="#__codelineno-0-1399">1399</a></span>
<span class="normal"><a href="#__codelineno-0-1400">1400</a></span>
<span class="normal"><a href="#__codelineno-0-1401">1401</a></span>
<span class="normal"><a href="#__codelineno-0-1402">1402</a></span>
<span class="normal"><a href="#__codelineno-0-1403">1403</a></span>
<span class="normal"><a href="#__codelineno-0-1404">1404</a></span>
<span class="normal"><a href="#__codelineno-0-1405">1405</a></span>
<span class="normal"><a href="#__codelineno-0-1406">1406</a></span>
<span class="normal"><a href="#__codelineno-0-1407">1407</a></span>
<span class="normal"><a href="#__codelineno-0-1408">1408</a></span>
<span class="normal"><a href="#__codelineno-0-1409">1409</a></span>
<span class="normal"><a href="#__codelineno-0-1410">1410</a></span>
<span class="normal"><a href="#__codelineno-0-1411">1411</a></span>
<span class="normal"><a href="#__codelineno-0-1412">1412</a></span>
<span class="normal"><a href="#__codelineno-0-1413">1413</a></span>
<span class="normal"><a href="#__codelineno-0-1414">1414</a></span>
<span class="normal"><a href="#__codelineno-0-1415">1415</a></span>
<span class="normal"><a href="#__codelineno-0-1416">1416</a></span>
<span class="normal"><a href="#__codelineno-0-1417">1417</a></span>
<span class="normal"><a href="#__codelineno-0-1418">1418</a></span>
<span class="normal"><a href="#__codelineno-0-1419">1419</a></span>
<span class="normal"><a href="#__codelineno-0-1420">1420</a></span>
<span class="normal"><a href="#__codelineno-0-1421">1421</a></span>
<span class="normal"><a href="#__codelineno-0-1422">1422</a></span>
<span class="normal"><a href="#__codelineno-0-1423">1423</a></span>
<span class="normal"><a href="#__codelineno-0-1424">1424</a></span>
<span class="normal"><a href="#__codelineno-0-1425">1425</a></span>
<span class="normal"><a href="#__codelineno-0-1426">1426</a></span>
<span class="normal"><a href="#__codelineno-0-1427">1427</a></span>
<span class="normal"><a href="#__codelineno-0-1428">1428</a></span>
<span class="normal"><a href="#__codelineno-0-1429">1429</a></span>
<span class="normal"><a href="#__codelineno-0-1430">1430</a></span>
<span class="normal"><a href="#__codelineno-0-1431">1431</a></span>
<span class="normal"><a href="#__codelineno-0-1432">1432</a></span>
<span class="normal"><a href="#__codelineno-0-1433">1433</a></span>
<span class="normal"><a href="#__codelineno-0-1434">1434</a></span>
<span class="normal"><a href="#__codelineno-0-1435">1435</a></span>
<span class="normal"><a href="#__codelineno-0-1436">1436</a></span>
<span class="normal"><a href="#__codelineno-0-1437">1437</a></span>
<span class="normal"><a href="#__codelineno-0-1438">1438</a></span>
<span class="normal"><a href="#__codelineno-0-1439">1439</a></span>
<span class="normal"><a href="#__codelineno-0-1440">1440</a></span>
<span class="normal"><a href="#__codelineno-0-1441">1441</a></span>
<span class="normal"><a href="#__codelineno-0-1442">1442</a></span>
<span class="normal"><a href="#__codelineno-0-1443">1443</a></span>
<span class="normal"><a href="#__codelineno-0-1444">1444</a></span>
<span class="normal"><a href="#__codelineno-0-1445">1445</a></span>
<span class="normal"><a href="#__codelineno-0-1446">1446</a></span>
<span class="normal"><a href="#__codelineno-0-1447">1447</a></span>
<span class="normal"><a href="#__codelineno-0-1448">1448</a></span>
<span class="normal"><a href="#__codelineno-0-1449">1449</a></span>
<span class="normal"><a href="#__codelineno-0-1450">1450</a></span>
<span class="normal"><a href="#__codelineno-0-1451">1451</a></span>
<span class="normal"><a href="#__codelineno-0-1452">1452</a></span>
<span class="normal"><a href="#__codelineno-0-1453">1453</a></span>
<span class="normal"><a href="#__codelineno-0-1454">1454</a></span>
<span class="normal"><a href="#__codelineno-0-1455">1455</a></span>
<span class="normal"><a href="#__codelineno-0-1456">1456</a></span>
<span class="normal"><a href="#__codelineno-0-1457">1457</a></span>
<span class="normal"><a href="#__codelineno-0-1458">1458</a></span>
<span class="normal"><a href="#__codelineno-0-1459">1459</a></span>
<span class="normal"><a href="#__codelineno-0-1460">1460</a></span>
<span class="normal"><a href="#__codelineno-0-1461">1461</a></span>
<span class="normal"><a href="#__codelineno-0-1462">1462</a></span>
<span class="normal"><a href="#__codelineno-0-1463">1463</a></span>
<span class="normal"><a href="#__codelineno-0-1464">1464</a></span>
<span class="normal"><a href="#__codelineno-0-1465">1465</a></span>
<span class="normal"><a href="#__codelineno-0-1466">1466</a></span>
<span class="normal"><a href="#__codelineno-0-1467">1467</a></span>
<span class="normal"><a href="#__codelineno-0-1468">1468</a></span>
<span class="normal"><a href="#__codelineno-0-1469">1469</a></span>
<span class="normal"><a href="#__codelineno-0-1470">1470</a></span>
<span class="normal"><a href="#__codelineno-0-1471">1471</a></span>
<span class="normal"><a href="#__codelineno-0-1472">1472</a></span>
<span class="normal"><a href="#__codelineno-0-1473">1473</a></span>
<span class="normal"><a href="#__codelineno-0-1474">1474</a></span>
<span class="normal"><a href="#__codelineno-0-1475">1475</a></span>
<span class="normal"><a href="#__codelineno-0-1476">1476</a></span>
<span class="normal"><a href="#__codelineno-0-1477">1477</a></span>
<span class="normal"><a href="#__codelineno-0-1478">1478</a></span>
<span class="normal"><a href="#__codelineno-0-1479">1479</a></span>
<span class="normal"><a href="#__codelineno-0-1480">1480</a></span>
<span class="normal"><a href="#__codelineno-0-1481">1481</a></span>
<span class="normal"><a href="#__codelineno-0-1482">1482</a></span>
<span class="normal"><a href="#__codelineno-0-1483">1483</a></span>
<span class="normal"><a href="#__codelineno-0-1484">1484</a></span>
<span class="normal"><a href="#__codelineno-0-1485">1485</a></span>
<span class="normal"><a href="#__codelineno-0-1486">1486</a></span>
<span class="normal"><a href="#__codelineno-0-1487">1487</a></span>
<span class="normal"><a href="#__codelineno-0-1488">1488</a></span>
<span class="normal"><a href="#__codelineno-0-1489">1489</a></span>
<span class="normal"><a href="#__codelineno-0-1490">1490</a></span>
<span class="normal"><a href="#__codelineno-0-1491">1491</a></span>
<span class="normal"><a href="#__codelineno-0-1492">1492</a></span>
<span class="normal"><a href="#__codelineno-0-1493">1493</a></span>
<span class="normal"><a href="#__codelineno-0-1494">1494</a></span>
<span class="normal"><a href="#__codelineno-0-1495">1495</a></span>
<span class="normal"><a href="#__codelineno-0-1496">1496</a></span>
<span class="normal"><a href="#__codelineno-0-1497">1497</a></span>
<span class="normal"><a href="#__codelineno-0-1498">1498</a></span>
<span class="normal"><a href="#__codelineno-0-1499">1499</a></span>
<span class="normal"><a href="#__codelineno-0-1500">1500</a></span>
<span class="normal"><a href="#__codelineno-0-1501">1501</a></span>
<span class="normal"><a href="#__codelineno-0-1502">1502</a></span>
<span class="normal"><a href="#__codelineno-0-1503">1503</a></span>
<span class="normal"><a href="#__codelineno-0-1504">1504</a></span>
<span class="normal"><a href="#__codelineno-0-1505">1505</a></span>
<span class="normal"><a href="#__codelineno-0-1506">1506</a></span>
<span class="normal"><a href="#__codelineno-0-1507">1507</a></span>
<span class="normal"><a href="#__codelineno-0-1508">1508</a></span>
<span class="normal"><a href="#__codelineno-0-1509">1509</a></span>
<span class="normal"><a href="#__codelineno-0-1510">1510</a></span>
<span class="normal"><a href="#__codelineno-0-1511">1511</a></span>
<span class="normal"><a href="#__codelineno-0-1512">1512</a></span>
<span class="normal"><a href="#__codelineno-0-1513">1513</a></span>
<span class="normal"><a href="#__codelineno-0-1514">1514</a></span>
<span class="normal"><a href="#__codelineno-0-1515">1515</a></span>
<span class="normal"><a href="#__codelineno-0-1516">1516</a></span>
<span class="normal"><a href="#__codelineno-0-1517">1517</a></span>
<span class="normal"><a href="#__codelineno-0-1518">1518</a></span>
<span class="normal"><a href="#__codelineno-0-1519">1519</a></span>
<span class="normal"><a href="#__codelineno-0-1520">1520</a></span>
<span class="normal"><a href="#__codelineno-0-1521">1521</a></span>
<span class="normal"><a href="#__codelineno-0-1522">1522</a></span>
<span class="normal"><a href="#__codelineno-0-1523">1523</a></span>
<span class="normal"><a href="#__codelineno-0-1524">1524</a></span>
<span class="normal"><a href="#__codelineno-0-1525">1525</a></span>
<span class="normal"><a href="#__codelineno-0-1526">1526</a></span>
<span class="normal"><a href="#__codelineno-0-1527">1527</a></span>
<span class="normal"><a href="#__codelineno-0-1528">1528</a></span>
<span class="normal"><a href="#__codelineno-0-1529">1529</a></span>
<span class="normal"><a href="#__codelineno-0-1530">1530</a></span>
<span class="normal"><a href="#__codelineno-0-1531">1531</a></span>
<span class="normal"><a href="#__codelineno-0-1532">1532</a></span>
<span class="normal"><a href="#__codelineno-0-1533">1533</a></span>
<span class="normal"><a href="#__codelineno-0-1534">1534</a></span>
<span class="normal"><a href="#__codelineno-0-1535">1535</a></span>
<span class="normal"><a href="#__codelineno-0-1536">1536</a></span>
<span class="normal"><a href="#__codelineno-0-1537">1537</a></span>
<span class="normal"><a href="#__codelineno-0-1538">1538</a></span>
<span class="normal"><a href="#__codelineno-0-1539">1539</a></span>
<span class="normal"><a href="#__codelineno-0-1540">1540</a></span>
<span class="normal"><a href="#__codelineno-0-1541">1541</a></span>
<span class="normal"><a href="#__codelineno-0-1542">1542</a></span>
<span class="normal"><a href="#__codelineno-0-1543">1543</a></span>
<span class="normal"><a href="#__codelineno-0-1544">1544</a></span>
<span class="normal"><a href="#__codelineno-0-1545">1545</a></span>
<span class="normal"><a href="#__codelineno-0-1546">1546</a></span>
<span class="normal"><a href="#__codelineno-0-1547">1547</a></span>
<span class="normal"><a href="#__codelineno-0-1548">1548</a></span>
<span class="normal"><a href="#__codelineno-0-1549">1549</a></span>
<span class="normal"><a href="#__codelineno-0-1550">1550</a></span>
<span class="normal"><a href="#__codelineno-0-1551">1551</a></span>
<span class="normal"><a href="#__codelineno-0-1552">1552</a></span>
<span class="normal"><a href="#__codelineno-0-1553">1553</a></span>
<span class="normal"><a href="#__codelineno-0-1554">1554</a></span>
<span class="normal"><a href="#__codelineno-0-1555">1555</a></span>
<span class="normal"><a href="#__codelineno-0-1556">1556</a></span>
<span class="normal"><a href="#__codelineno-0-1557">1557</a></span>
<span class="normal"><a href="#__codelineno-0-1558">1558</a></span>
<span class="normal"><a href="#__codelineno-0-1559">1559</a></span>
<span class="normal"><a href="#__codelineno-0-1560">1560</a></span>
<span class="normal"><a href="#__codelineno-0-1561">1561</a></span>
<span class="normal"><a href="#__codelineno-0-1562">1562</a></span>
<span class="normal"><a href="#__codelineno-0-1563">1563</a></span>
<span class="normal"><a href="#__codelineno-0-1564">1564</a></span>
<span class="normal"><a href="#__codelineno-0-1565">1565</a></span>
<span class="normal"><a href="#__codelineno-0-1566">1566</a></span>
<span class="normal"><a href="#__codelineno-0-1567">1567</a></span>
<span class="normal"><a href="#__codelineno-0-1568">1568</a></span>
<span class="normal"><a href="#__codelineno-0-1569">1569</a></span>
<span class="normal"><a href="#__codelineno-0-1570">1570</a></span>
<span class="normal"><a href="#__codelineno-0-1571">1571</a></span>
<span class="normal"><a href="#__codelineno-0-1572">1572</a></span>
<span class="normal"><a href="#__codelineno-0-1573">1573</a></span>
<span class="normal"><a href="#__codelineno-0-1574">1574</a></span>
<span class="normal"><a href="#__codelineno-0-1575">1575</a></span>
<span class="normal"><a href="#__codelineno-0-1576">1576</a></span>
<span class="normal"><a href="#__codelineno-0-1577">1577</a></span>
<span class="normal"><a href="#__codelineno-0-1578">1578</a></span>
<span class="normal"><a href="#__codelineno-0-1579">1579</a></span>
<span class="normal"><a href="#__codelineno-0-1580">1580</a></span>
<span class="normal"><a href="#__codelineno-0-1581">1581</a></span>
<span class="normal"><a href="#__codelineno-0-1582">1582</a></span>
<span class="normal"><a href="#__codelineno-0-1583">1583</a></span>
<span class="normal"><a href="#__codelineno-0-1584">1584</a></span>
<span class="normal"><a href="#__codelineno-0-1585">1585</a></span>
<span class="normal"><a href="#__codelineno-0-1586">1586</a></span>
<span class="normal"><a href="#__codelineno-0-1587">1587</a></span>
<span class="normal"><a href="#__codelineno-0-1588">1588</a></span>
<span class="normal"><a href="#__codelineno-0-1589">1589</a></span>
<span class="normal"><a href="#__codelineno-0-1590">1590</a></span>
<span class="normal"><a href="#__codelineno-0-1591">1591</a></span>
<span class="normal"><a href="#__codelineno-0-1592">1592</a></span>
<span class="normal"><a href="#__codelineno-0-1593">1593</a></span>
<span class="normal"><a href="#__codelineno-0-1594">1594</a></span>
<span class="normal"><a href="#__codelineno-0-1595">1595</a></span>
<span class="normal"><a href="#__codelineno-0-1596">1596</a></span>
<span class="normal"><a href="#__codelineno-0-1597">1597</a></span>
<span class="normal"><a href="#__codelineno-0-1598">1598</a></span>
<span class="normal"><a href="#__codelineno-0-1599">1599</a></span>
<span class="normal"><a href="#__codelineno-0-1600">1600</a></span>
<span class="normal"><a href="#__codelineno-0-1601">1601</a></span>
<span class="normal"><a href="#__codelineno-0-1602">1602</a></span>
<span class="normal"><a href="#__codelineno-0-1603">1603</a></span>
<span class="normal"><a href="#__codelineno-0-1604">1604</a></span>
<span class="normal"><a href="#__codelineno-0-1605">1605</a></span>
<span class="normal"><a href="#__codelineno-0-1606">1606</a></span>
<span class="normal"><a href="#__codelineno-0-1607">1607</a></span>
<span class="normal"><a href="#__codelineno-0-1608">1608</a></span>
<span class="normal"><a href="#__codelineno-0-1609">1609</a></span>
<span class="normal"><a href="#__codelineno-0-1610">1610</a></span>
<span class="normal"><a href="#__codelineno-0-1611">1611</a></span>
<span class="normal"><a href="#__codelineno-0-1612">1612</a></span>
<span class="normal"><a href="#__codelineno-0-1613">1613</a></span>
<span class="normal"><a href="#__codelineno-0-1614">1614</a></span>
<span class="normal"><a href="#__codelineno-0-1615">1615</a></span>
<span class="normal"><a href="#__codelineno-0-1616">1616</a></span>
<span class="normal"><a href="#__codelineno-0-1617">1617</a></span>
<span class="normal"><a href="#__codelineno-0-1618">1618</a></span>
<span class="normal"><a href="#__codelineno-0-1619">1619</a></span>
<span class="normal"><a href="#__codelineno-0-1620">1620</a></span>
<span class="normal"><a href="#__codelineno-0-1621">1621</a></span>
<span class="normal"><a href="#__codelineno-0-1622">1622</a></span>
<span class="normal"><a href="#__codelineno-0-1623">1623</a></span>
<span class="normal"><a href="#__codelineno-0-1624">1624</a></span>
<span class="normal"><a href="#__codelineno-0-1625">1625</a></span>
<span class="normal"><a href="#__codelineno-0-1626">1626</a></span>
<span class="normal"><a href="#__codelineno-0-1627">1627</a></span>
<span class="normal"><a href="#__codelineno-0-1628">1628</a></span>
<span class="normal"><a href="#__codelineno-0-1629">1629</a></span>
<span class="normal"><a href="#__codelineno-0-1630">1630</a></span>
<span class="normal"><a href="#__codelineno-0-1631">1631</a></span>
<span class="normal"><a href="#__codelineno-0-1632">1632</a></span>
<span class="normal"><a href="#__codelineno-0-1633">1633</a></span>
<span class="normal"><a href="#__codelineno-0-1634">1634</a></span>
<span class="normal"><a href="#__codelineno-0-1635">1635</a></span>
<span class="normal"><a href="#__codelineno-0-1636">1636</a></span>
<span class="normal"><a href="#__codelineno-0-1637">1637</a></span>
<span class="normal"><a href="#__codelineno-0-1638">1638</a></span>
<span class="normal"><a href="#__codelineno-0-1639">1639</a></span>
<span class="normal"><a href="#__codelineno-0-1640">1640</a></span>
<span class="normal"><a href="#__codelineno-0-1641">1641</a></span>
<span class="normal"><a href="#__codelineno-0-1642">1642</a></span>
<span class="normal"><a href="#__codelineno-0-1643">1643</a></span>
<span class="normal"><a href="#__codelineno-0-1644">1644</a></span>
<span class="normal"><a href="#__codelineno-0-1645">1645</a></span>
<span class="normal"><a href="#__codelineno-0-1646">1646</a></span>
<span class="normal"><a href="#__codelineno-0-1647">1647</a></span>
<span class="normal"><a href="#__codelineno-0-1648">1648</a></span>
<span class="normal"><a href="#__codelineno-0-1649">1649</a></span>
<span class="normal"><a href="#__codelineno-0-1650">1650</a></span>
<span class="normal"><a href="#__codelineno-0-1651">1651</a></span>
<span class="normal"><a href="#__codelineno-0-1652">1652</a></span>
<span class="normal"><a href="#__codelineno-0-1653">1653</a></span>
<span class="normal"><a href="#__codelineno-0-1654">1654</a></span>
<span class="normal"><a href="#__codelineno-0-1655">1655</a></span>
<span class="normal"><a href="#__codelineno-0-1656">1656</a></span>
<span class="normal"><a href="#__codelineno-0-1657">1657</a></span>
<span class="normal"><a href="#__codelineno-0-1658">1658</a></span>
<span class="normal"><a href="#__codelineno-0-1659">1659</a></span>
<span class="normal"><a href="#__codelineno-0-1660">1660</a></span>
<span class="normal"><a href="#__codelineno-0-1661">1661</a></span>
<span class="normal"><a href="#__codelineno-0-1662">1662</a></span>
<span class="normal"><a href="#__codelineno-0-1663">1663</a></span>
<span class="normal"><a href="#__codelineno-0-1664">1664</a></span>
<span class="normal"><a href="#__codelineno-0-1665">1665</a></span>
<span class="normal"><a href="#__codelineno-0-1666">1666</a></span>
<span class="normal"><a href="#__codelineno-0-1667">1667</a></span>
<span class="normal"><a href="#__codelineno-0-1668">1668</a></span>
<span class="normal"><a href="#__codelineno-0-1669">1669</a></span>
<span class="normal"><a href="#__codelineno-0-1670">1670</a></span>
<span class="normal"><a href="#__codelineno-0-1671">1671</a></span>
<span class="normal"><a href="#__codelineno-0-1672">1672</a></span>
<span class="normal"><a href="#__codelineno-0-1673">1673</a></span>
<span class="normal"><a href="#__codelineno-0-1674">1674</a></span>
<span class="normal"><a href="#__codelineno-0-1675">1675</a></span>
<span class="normal"><a href="#__codelineno-0-1676">1676</a></span>
<span class="normal"><a href="#__codelineno-0-1677">1677</a></span>
<span class="normal"><a href="#__codelineno-0-1678">1678</a></span>
<span class="normal"><a href="#__codelineno-0-1679">1679</a></span>
<span class="normal"><a href="#__codelineno-0-1680">1680</a></span>
<span class="normal"><a href="#__codelineno-0-1681">1681</a></span>
<span class="normal"><a href="#__codelineno-0-1682">1682</a></span>
<span class="normal"><a href="#__codelineno-0-1683">1683</a></span>
<span class="normal"><a href="#__codelineno-0-1684">1684</a></span>
<span class="normal"><a href="#__codelineno-0-1685">1685</a></span>
<span class="normal"><a href="#__codelineno-0-1686">1686</a></span>
<span class="normal"><a href="#__codelineno-0-1687">1687</a></span>
<span class="normal"><a href="#__codelineno-0-1688">1688</a></span>
<span class="normal"><a href="#__codelineno-0-1689">1689</a></span>
<span class="normal"><a href="#__codelineno-0-1690">1690</a></span>
<span class="normal"><a href="#__codelineno-0-1691">1691</a></span>
<span class="normal"><a href="#__codelineno-0-1692">1692</a></span>
<span class="normal"><a href="#__codelineno-0-1693">1693</a></span>
<span class="normal"><a href="#__codelineno-0-1694">1694</a></span>
<span class="normal"><a href="#__codelineno-0-1695">1695</a></span>
<span class="normal"><a href="#__codelineno-0-1696">1696</a></span>
<span class="normal"><a href="#__codelineno-0-1697">1697</a></span>
<span class="normal"><a href="#__codelineno-0-1698">1698</a></span>
<span class="normal"><a href="#__codelineno-0-1699">1699</a></span>
<span class="normal"><a href="#__codelineno-0-1700">1700</a></span>
<span class="normal"><a href="#__codelineno-0-1701">1701</a></span>
<span class="normal"><a href="#__codelineno-0-1702">1702</a></span>
<span class="normal"><a href="#__codelineno-0-1703">1703</a></span>
<span class="normal"><a href="#__codelineno-0-1704">1704</a></span>
<span class="normal"><a href="#__codelineno-0-1705">1705</a></span>
<span class="normal"><a href="#__codelineno-0-1706">1706</a></span>
<span class="normal"><a href="#__codelineno-0-1707">1707</a></span>
<span class="normal"><a href="#__codelineno-0-1708">1708</a></span>
<span class="normal"><a href="#__codelineno-0-1709">1709</a></span>
<span class="normal"><a href="#__codelineno-0-1710">1710</a></span>
<span class="normal"><a href="#__codelineno-0-1711">1711</a></span>
<span class="normal"><a href="#__codelineno-0-1712">1712</a></span>
<span class="normal"><a href="#__codelineno-0-1713">1713</a></span>
<span class="normal"><a href="#__codelineno-0-1714">1714</a></span>
<span class="normal"><a href="#__codelineno-0-1715">1715</a></span>
<span class="normal"><a href="#__codelineno-0-1716">1716</a></span>
<span class="normal"><a href="#__codelineno-0-1717">1717</a></span>
<span class="normal"><a href="#__codelineno-0-1718">1718</a></span>
<span class="normal"><a href="#__codelineno-0-1719">1719</a></span>
<span class="normal"><a href="#__codelineno-0-1720">1720</a></span>
<span class="normal"><a href="#__codelineno-0-1721">1721</a></span>
<span class="normal"><a href="#__codelineno-0-1722">1722</a></span>
<span class="normal"><a href="#__codelineno-0-1723">1723</a></span>
<span class="normal"><a href="#__codelineno-0-1724">1724</a></span>
<span class="normal"><a href="#__codelineno-0-1725">1725</a></span>
<span class="normal"><a href="#__codelineno-0-1726">1726</a></span>
<span class="normal"><a href="#__codelineno-0-1727">1727</a></span>
<span class="normal"><a href="#__codelineno-0-1728">1728</a></span>
<span class="normal"><a href="#__codelineno-0-1729">1729</a></span>
<span class="normal"><a href="#__codelineno-0-1730">1730</a></span>
<span class="normal"><a href="#__codelineno-0-1731">1731</a></span>
<span class="normal"><a href="#__codelineno-0-1732">1732</a></span>
<span class="normal"><a href="#__codelineno-0-1733">1733</a></span>
<span class="normal"><a href="#__codelineno-0-1734">1734</a></span>
<span class="normal"><a href="#__codelineno-0-1735">1735</a></span>
<span class="normal"><a href="#__codelineno-0-1736">1736</a></span>
<span class="normal"><a href="#__codelineno-0-1737">1737</a></span>
<span class="normal"><a href="#__codelineno-0-1738">1738</a></span>
<span class="normal"><a href="#__codelineno-0-1739">1739</a></span>
<span class="normal"><a href="#__codelineno-0-1740">1740</a></span>
<span class="normal"><a href="#__codelineno-0-1741">1741</a></span>
<span class="normal"><a href="#__codelineno-0-1742">1742</a></span>
<span class="normal"><a href="#__codelineno-0-1743">1743</a></span>
<span class="normal"><a href="#__codelineno-0-1744">1744</a></span>
<span class="normal"><a href="#__codelineno-0-1745">1745</a></span>
<span class="normal"><a href="#__codelineno-0-1746">1746</a></span>
<span class="normal"><a href="#__codelineno-0-1747">1747</a></span>
<span class="normal"><a href="#__codelineno-0-1748">1748</a></span>
<span class="normal"><a href="#__codelineno-0-1749">1749</a></span>
<span class="normal"><a href="#__codelineno-0-1750">1750</a></span>
<span class="normal"><a href="#__codelineno-0-1751">1751</a></span>
<span class="normal"><a href="#__codelineno-0-1752">1752</a></span>
<span class="normal"><a href="#__codelineno-0-1753">1753</a></span>
<span class="normal"><a href="#__codelineno-0-1754">1754</a></span>
<span class="normal"><a href="#__codelineno-0-1755">1755</a></span>
<span class="normal"><a href="#__codelineno-0-1756">1756</a></span>
<span class="normal"><a href="#__codelineno-0-1757">1757</a></span>
<span class="normal"><a href="#__codelineno-0-1758">1758</a></span>
<span class="normal"><a href="#__codelineno-0-1759">1759</a></span>
<span class="normal"><a href="#__codelineno-0-1760">1760</a></span>
<span class="normal"><a href="#__codelineno-0-1761">1761</a></span>
<span class="normal"><a href="#__codelineno-0-1762">1762</a></span>
<span class="normal"><a href="#__codelineno-0-1763">1763</a></span>
<span class="normal"><a href="#__codelineno-0-1764">1764</a></span>
<span class="normal"><a href="#__codelineno-0-1765">1765</a></span>
<span class="normal"><a href="#__codelineno-0-1766">1766</a></span>
<span class="normal"><a href="#__codelineno-0-1767">1767</a></span>
<span class="normal"><a href="#__codelineno-0-1768">1768</a></span>
<span class="normal"><a href="#__codelineno-0-1769">1769</a></span>
<span class="normal"><a href="#__codelineno-0-1770">1770</a></span>
<span class="normal"><a href="#__codelineno-0-1771">1771</a></span>
<span class="normal"><a href="#__codelineno-0-1772">1772</a></span>
<span class="normal"><a href="#__codelineno-0-1773">1773</a></span>
<span class="normal"><a href="#__codelineno-0-1774">1774</a></span>
<span class="normal"><a href="#__codelineno-0-1775">1775</a></span>
<span class="normal"><a href="#__codelineno-0-1776">1776</a></span>
<span class="normal"><a href="#__codelineno-0-1777">1777</a></span>
<span class="normal"><a href="#__codelineno-0-1778">1778</a></span>
<span class="normal"><a href="#__codelineno-0-1779">1779</a></span>
<span class="normal"><a href="#__codelineno-0-1780">1780</a></span>
<span class="normal"><a href="#__codelineno-0-1781">1781</a></span>
<span class="normal"><a href="#__codelineno-0-1782">1782</a></span>
<span class="normal"><a href="#__codelineno-0-1783">1783</a></span>
<span class="normal"><a href="#__codelineno-0-1784">1784</a></span>
<span class="normal"><a href="#__codelineno-0-1785">1785</a></span>
<span class="normal"><a href="#__codelineno-0-1786">1786</a></span>
<span class="normal"><a href="#__codelineno-0-1787">1787</a></span>
<span class="normal"><a href="#__codelineno-0-1788">1788</a></span>
<span class="normal"><a href="#__codelineno-0-1789">1789</a></span>
<span class="normal"><a href="#__codelineno-0-1790">1790</a></span>
<span class="normal"><a href="#__codelineno-0-1791">1791</a></span>
<span class="normal"><a href="#__codelineno-0-1792">1792</a></span>
<span class="normal"><a href="#__codelineno-0-1793">1793</a></span>
<span class="normal"><a href="#__codelineno-0-1794">1794</a></span>
<span class="normal"><a href="#__codelineno-0-1795">1795</a></span>
<span class="normal"><a href="#__codelineno-0-1796">1796</a></span>
<span class="normal"><a href="#__codelineno-0-1797">1797</a></span>
<span class="normal"><a href="#__codelineno-0-1798">1798</a></span>
<span class="normal"><a href="#__codelineno-0-1799">1799</a></span>
<span class="normal"><a href="#__codelineno-0-1800">1800</a></span>
<span class="normal"><a href="#__codelineno-0-1801">1801</a></span>
<span class="normal"><a href="#__codelineno-0-1802">1802</a></span>
<span class="normal"><a href="#__codelineno-0-1803">1803</a></span>
<span class="normal"><a href="#__codelineno-0-1804">1804</a></span>
<span class="normal"><a href="#__codelineno-0-1805">1805</a></span>
<span class="normal"><a href="#__codelineno-0-1806">1806</a></span>
<span class="normal"><a href="#__codelineno-0-1807">1807</a></span>
<span class="normal"><a href="#__codelineno-0-1808">1808</a></span>
<span class="normal"><a href="#__codelineno-0-1809">1809</a></span>
<span class="normal"><a href="#__codelineno-0-1810">1810</a></span>
<span class="normal"><a href="#__codelineno-0-1811">1811</a></span>
<span class="normal"><a href="#__codelineno-0-1812">1812</a></span>
<span class="normal"><a href="#__codelineno-0-1813">1813</a></span>
<span class="normal"><a href="#__codelineno-0-1814">1814</a></span>
<span class="normal"><a href="#__codelineno-0-1815">1815</a></span>
<span class="normal"><a href="#__codelineno-0-1816">1816</a></span>
<span class="normal"><a href="#__codelineno-0-1817">1817</a></span>
<span class="normal"><a href="#__codelineno-0-1818">1818</a></span>
<span class="normal"><a href="#__codelineno-0-1819">1819</a></span>
<span class="normal"><a href="#__codelineno-0-1820">1820</a></span>
<span class="normal"><a href="#__codelineno-0-1821">1821</a></span>
<span class="normal"><a href="#__codelineno-0-1822">1822</a></span>
<span class="normal"><a href="#__codelineno-0-1823">1823</a></span>
<span class="normal"><a href="#__codelineno-0-1824">1824</a></span>
<span class="normal"><a href="#__codelineno-0-1825">1825</a></span>
<span class="normal"><a href="#__codelineno-0-1826">1826</a></span>
<span class="normal"><a href="#__codelineno-0-1827">1827</a></span>
<span class="normal"><a href="#__codelineno-0-1828">1828</a></span>
<span class="normal"><a href="#__codelineno-0-1829">1829</a></span>
<span class="normal"><a href="#__codelineno-0-1830">1830</a></span>
<span class="normal"><a href="#__codelineno-0-1831">1831</a></span>
<span class="normal"><a href="#__codelineno-0-1832">1832</a></span>
<span class="normal"><a href="#__codelineno-0-1833">1833</a></span>
<span class="normal"><a href="#__codelineno-0-1834">1834</a></span>
<span class="normal"><a href="#__codelineno-0-1835">1835</a></span>
<span class="normal"><a href="#__codelineno-0-1836">1836</a></span>
<span class="normal"><a href="#__codelineno-0-1837">1837</a></span>
<span class="normal"><a href="#__codelineno-0-1838">1838</a></span>
<span class="normal"><a href="#__codelineno-0-1839">1839</a></span>
<span class="normal"><a href="#__codelineno-0-1840">1840</a></span>
<span class="normal"><a href="#__codelineno-0-1841">1841</a></span>
<span class="normal"><a href="#__codelineno-0-1842">1842</a></span>
<span class="normal"><a href="#__codelineno-0-1843">1843</a></span>
<span class="normal"><a href="#__codelineno-0-1844">1844</a></span>
<span class="normal"><a href="#__codelineno-0-1845">1845</a></span>
<span class="normal"><a href="#__codelineno-0-1846">1846</a></span>
<span class="normal"><a href="#__codelineno-0-1847">1847</a></span>
<span class="normal"><a href="#__codelineno-0-1848">1848</a></span>
<span class="normal"><a href="#__codelineno-0-1849">1849</a></span>
<span class="normal"><a href="#__codelineno-0-1850">1850</a></span>
<span class="normal"><a href="#__codelineno-0-1851">1851</a></span>
<span class="normal"><a href="#__codelineno-0-1852">1852</a></span>
<span class="normal"><a href="#__codelineno-0-1853">1853</a></span>
<span class="normal"><a href="#__codelineno-0-1854">1854</a></span>
<span class="normal"><a href="#__codelineno-0-1855">1855</a></span>
<span class="normal"><a href="#__codelineno-0-1856">1856</a></span>
<span class="normal"><a href="#__codelineno-0-1857">1857</a></span>
<span class="normal"><a href="#__codelineno-0-1858">1858</a></span>
<span class="normal"><a href="#__codelineno-0-1859">1859</a></span>
<span class="normal"><a href="#__codelineno-0-1860">1860</a></span>
<span class="normal"><a href="#__codelineno-0-1861">1861</a></span>
<span class="normal"><a href="#__codelineno-0-1862">1862</a></span>
<span class="normal"><a href="#__codelineno-0-1863">1863</a></span>
<span class="normal"><a href="#__codelineno-0-1864">1864</a></span>
<span class="normal"><a href="#__codelineno-0-1865">1865</a></span>
<span class="normal"><a href="#__codelineno-0-1866">1866</a></span>
<span class="normal"><a href="#__codelineno-0-1867">1867</a></span>
<span class="normal"><a href="#__codelineno-0-1868">1868</a></span>
<span class="normal"><a href="#__codelineno-0-1869">1869</a></span>
<span class="normal"><a href="#__codelineno-0-1870">1870</a></span>
<span class="normal"><a href="#__codelineno-0-1871">1871</a></span>
<span class="normal"><a href="#__codelineno-0-1872">1872</a></span>
<span class="normal"><a href="#__codelineno-0-1873">1873</a></span>
<span class="normal"><a href="#__codelineno-0-1874">1874</a></span>
<span class="normal"><a href="#__codelineno-0-1875">1875</a></span>
<span class="normal"><a href="#__codelineno-0-1876">1876</a></span>
<span class="normal"><a href="#__codelineno-0-1877">1877</a></span>
<span class="normal"><a href="#__codelineno-0-1878">1878</a></span>
<span class="normal"><a href="#__codelineno-0-1879">1879</a></span>
<span class="normal"><a href="#__codelineno-0-1880">1880</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="k">class</span><span class="w"> </span><span class="nc">ArrayGlyph</span><span class="p">:</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A class to handle arrays and perform various visualization operations on them.</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">    The ArrayGlyph class provides functionality for visualizing 2D and 3D arrays with</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">    various customization options. It supports plotting single arrays, RGB arrays,</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">    and creating animations from 3D arrays.</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">    Attributes</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">    fig : matplotlib.figure.Figure</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">        The matplotlib figure object.</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">    ax : matplotlib.axes.Axes</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        The matplotlib axes object.</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">    extent : List</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">        The extent of the array [xmin, xmax, ymin, ymax].</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">    rgb : bool</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">        Whether the array is an RGB array.</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">    no_elem : int</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">        The number of elements in the array.</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">    anim : matplotlib.animation.FuncAnimation</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">        The animation object if created.</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">    Notes</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">    -----</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">    This class provides methods for:</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">    - Plotting arrays with customizable color scales, color bars, and annotations</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">    - Creating animations from 3D arrays</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">    - Displaying point values on arrays</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a><span class="sd">    - Customizing plot appearance</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">    --------</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="sd">    - Create a simple array plot:</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">        &gt;&gt;&gt; from cleopatra.array_glyph import ArrayGlyph</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">        &gt;&gt;&gt; arr = np.array([[1, 2, 3], [4, 5, 6], [7, 8, 9]])</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        &gt;&gt;&gt; array_glyph = ArrayGlyph(arr)</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">        &gt;&gt;&gt; fig, ax = array_glyph.plot()</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">        ```</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">    - Create an RGB plot from a 3D array:</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">    &gt;&gt;&gt; rgb_array = np.random.randint(0, 255, size=(3, 10, 10))</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">    &gt;&gt;&gt; rgb_glyph = ArrayGlyph(rgb_array, rgb=[0, 1, 2])</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">    &gt;&gt;&gt; fig, ax = rgb_glyph.plot()</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">    ```</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">    - Create an animated plot from a 3D array:</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">    &gt;&gt;&gt; time_series = np.random.randint(1, 10, size=(5, 10, 10))</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">    &gt;&gt;&gt; time_labels = [&quot;Frame 1&quot;, &quot;Frame 2&quot;, &quot;Frame 3&quot;, &quot;Frame 4&quot;, &quot;Frame 5&quot;]</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">    &gt;&gt;&gt; animated_glyph = ArrayGlyph(time_series)</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">    &gt;&gt;&gt; anim = animated_glyph.animate(time_labels)</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a><span class="sd">    ```</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="n">array</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="n">exclude_value</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="n">extent</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="n">rgb</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="n">surface_reflectance</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="n">cutoff</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="n">ax</span><span class="p">:</span> <span class="n">Axes</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="n">fig</span><span class="p">:</span> <span class="n">Figure</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="n">percentile</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="p">):</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the ArrayGlyph object with an array and optional parameters.</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">        Parameters</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">        array : np.ndarray</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">            The array to be visualized. Can be a 2D array for single plots or a 3D array for RGB plots or animations.</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">        exclude_value : List or numeric, optional</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">            Value(s) used to mask cells out of the domain, by default np.nan.</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">            Can be a single value or a list of values to exclude.</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">        extent : List, optional</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">            The extent of the array in the format [xmin, ymin, xmax, ymax], by default None.</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">            If provided, the array will be plotted with these spatial boundaries.</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">        rgb : List[int], optional</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">            The indices of the red, green, and blue bands in the given array, by default None.</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">            If provided, the array will be treated as an RGB image.</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">            Can be a list of three values [r, g, b], or four values if alpha band is included [r, g, b, a].</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">        surface_reflectance : int, optional</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">            Surface reflectance value for normalizing satellite data, by default None.</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">            Typically 10000 for Sentinel-2 data.</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">        cutoff : List, optional</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">            Clip the range of pixel values for each band, by default None.</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">            Takes only pixel values from 0 to the value of the cutoff and scales them back to between 0 and 1.</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">            Should be a list with one value per band.</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">        ax : matplotlib.axes.Axes, optional</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">            A pre-existing axes to plot on, by default None.</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">            If None, a new axes will be created.</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">        fig : matplotlib.figure.Figure, optional</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">            A pre-existing figure to plot on, by default None.</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">            If None, a new figure will be created.</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">        percentile : int, optional</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">            The percentile value to be used for scaling the array values, by default None.</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">            Used to enhance contrast by stretching the histogram.</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">        **kwargs : dict</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">            Additional keyword arguments for customizing the plot.</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">            Supported arguments include:</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">                figsize : tuple, optional</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">                    Figure size, by default (8, 8).</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">                vmin : float, optional</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">                    Minimum value for color scaling, by default min(array).</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">                vmax : float, optional</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">                    Maximum value for color scaling, by default max(array).</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">                title : str, optional</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">                    Title of the plot, by default &#39;Array Plot&#39;.</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">                title_size : int, optional</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">                    Title font size, by default 15.</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">                cmap : str, optional</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">                    Colormap name, by default &#39;coolwarm_r&#39;.</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">        Raises</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">        ------</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">        ValueError</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">            If an invalid keyword argument is provided.</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">        ValueError</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">            If rgb is provided but the array doesn&#39;t have enough dimensions.</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">        Examples</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">        --------</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">        Basic initialization with a 2D array:</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">        &gt;&gt;&gt; from cleopatra.array_glyph import ArrayGlyph</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">        &gt;&gt;&gt; arr = np.array([[1, 2, 3], [4, 5, 6], [7, 8, 9]])</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">        &gt;&gt;&gt; array_glyph = ArrayGlyph(arr)</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">        &gt;&gt;&gt; fig, ax = array_glyph.plot()</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">        ```</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">        Initialization with custom figure size and title:</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">        &gt;&gt;&gt; array_glyph = ArrayGlyph(arr, figsize=(10, 8), title=&quot;Custom Array Plot&quot;)</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">        &gt;&gt;&gt; fig, ax = array_glyph.plot()</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">        ```</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">        Initialization with RGB bands from a 3D array:</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">        &gt;&gt;&gt; rgb_array = np.random.randint(0, 255, size=(3, 10, 10))</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">        &gt;&gt;&gt; rgb_glyph = ArrayGlyph(rgb_array, rgb=[0, 1, 2], surface_reflectance=255)</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">        &gt;&gt;&gt; fig, ax = rgb_glyph.plot()</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">        ```</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">        Initialization with custom extent:</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">        &gt;&gt;&gt; array_glyph = ArrayGlyph(arr, extent=[0, 0, 10, 10])</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">        &gt;&gt;&gt; fig, ax = array_glyph.plot()</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">        ```</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_default_options</span> <span class="o">=</span> <span class="n">DEFAULT_OPTIONS</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>                    <span class="sa">f</span><span class="s2">&quot;The given keyword argument:</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> is not correct, possible parameters are,&quot;</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>                    <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">DEFAULT_OPTIONS</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>                <span class="p">)</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="c1"># first replace the no_data_value by nan</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>        <span class="c1"># convert the array to float32 to be able to replace the no data value with nan</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>        <span class="k">if</span> <span class="n">exclude_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">:</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">exclude_value</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>                <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>                    <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">exclude_value</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">0.001</span><span class="p">),</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>                    <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">exclude_value</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">0.001</span><span class="p">),</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>                <span class="p">)</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>                <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">exclude_value</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">0.0000001</span><span class="p">)</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>            <span class="n">array</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">array</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>            <span class="n">array</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>        <span class="c1"># convert the extent from [xmin, ymin, xmax, ymax] to [xmin, xmax, ymin, ymax] as required by matplotlib.</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>        <span class="k">if</span> <span class="n">extent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>            <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">extent</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">extent</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">extent</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">extent</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">extent</span> <span class="o">=</span> <span class="n">extent</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>        <span class="k">if</span> <span class="n">rgb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>            <span class="c1"># prepare to plot rgb plot only if there are three arrays</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>            <span class="k">if</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>                    <span class="sa">f</span><span class="s2">&quot;To plot RGB plot the given array should have only 3 arrays, given array have &quot;</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>                <span class="p">)</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>                <span class="n">array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prepare_array</span><span class="p">(</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>                    <span class="n">array</span><span class="p">,</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>                    <span class="n">rgb</span><span class="o">=</span><span class="n">rgb</span><span class="p">,</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>                    <span class="n">surface_reflectance</span><span class="o">=</span><span class="n">surface_reflectance</span><span class="p">,</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>                    <span class="n">cutoff</span><span class="o">=</span><span class="n">cutoff</span><span class="p">,</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>                    <span class="n">percentile</span><span class="o">=</span><span class="n">percentile</span><span class="p">,</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>                <span class="p">)</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_exclude_value</span> <span class="o">=</span> <span class="n">exclude_value</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_vmax</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>            <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;vmax&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;vmax&quot;</span><span class="p">)</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>        <span class="p">)</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_vmin</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>            <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;vmin&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;vmin&quot;</span><span class="p">)</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>        <span class="p">)</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_arr</span> <span class="o">=</span> <span class="n">array</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>        <span class="c1"># get the tick spacing that has 10 ticks only</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ticks_spacing</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vmax</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vmin</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>        <span class="n">shape</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>            <span class="n">no_elem</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>            <span class="n">no_elem</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">no_elem</span> <span class="o">=</span> <span class="n">no_elem</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>        <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-290" name="__codelineno-0-290"></a>
<a id="__codelineno-0-291" name="__codelineno-0-291"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-292" name="__codelineno-0-292"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">arr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-293" name="__codelineno-0-293"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;array&quot;&quot;&quot;</span>
<a id="__codelineno-0-294" name="__codelineno-0-294"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arr</span>
<a id="__codelineno-0-295" name="__codelineno-0-295"></a>
<a id="__codelineno-0-296" name="__codelineno-0-296"></a>    <span class="nd">@arr</span><span class="o">.</span><span class="n">setter</span>
<a id="__codelineno-0-297" name="__codelineno-0-297"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">arr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<a id="__codelineno-0-298" name="__codelineno-0-298"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_arr</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-299" name="__codelineno-0-299"></a>
<a id="__codelineno-0-300" name="__codelineno-0-300"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">prepare_array</span><span class="p">(</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>        <span class="n">array</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>        <span class="n">rgb</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>        <span class="n">surface_reflectance</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>        <span class="n">cutoff</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>        <span class="n">percentile</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Prepare an array for RGB visualization.</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">        This method processes a multi-band array to create an RGB image suitable for visualization.</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">        It can normalize the data using either percentile-based scaling or surface reflectance values.</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">        Parameters</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">        array : np.ndarray</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">            The input array containing multiple bands. For RGB visualization,</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">            this should be a 3D array where the first dimension represents the bands.</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">        rgb : List[int], optional</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">            The indices of the red, green, and blue bands in the given array, by default None.</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">            If None, assumes the order is [3, 2, 1] (common for Sentinel-2 data).</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">        surface_reflectance : int, optional</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">            Surface reflectance value for normalizing satellite data, by default None.</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">            Typically 10000 for Sentinel-2 data or 255 for 8-bit imagery.</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">            Used to scale values to the range [0, 1].</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">        cutoff : List, optional</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">            Clip the range of pixel values for each band, by default None.</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">            Takes only pixel values from 0 to the value of the cutoff and scales them back to between 0 and 1.</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">            Should be a list with one value per band.</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">        percentile : int, optional</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">            The percentile value to be used for scaling the array values, by default None.</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">            Used to enhance contrast by stretching the histogram.</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">            If provided, this takes precedence over surface_reflectance.</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">        Returns</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">        -------</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">        np.ndarray</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">            The prepared array with shape (height, width, 3) suitable for RGB visualization.</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">            Values are normalized to the range [0, 1].</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a><span class="sd">            the rgb 3d array is converted into 2d array to be plotted using the plt.imshow function.</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">            a float32 array normalized between 0 and 1 using the `percentile` values or the `surface_reflectance`.</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="sd">            if the `percentile` or `surface_reflectance` values are not given, the function just reorders the values</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a><span class="sd">            to have the red-green-blue order.</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a><span class="sd">        Raises</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="sd">        ------</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="sd">        ValueError</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">            If the array shape is incompatible with the provided RGB indices.</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="sd">        Notes</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="sd">        -----</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="sd">            - The `prepare_array` function is called in the constructor of the `ArrayGlyph` class to prepare the array,</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">              so you can provide the same parameters of the `prepare_array` function to the `ArrayGlyph constructor`.</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a><span class="sd">            - The prepare function moves the first axes (the channel axis) to the last axes, and then scales the array</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="sd">              using the percentile values. If the percentile is not given, the function scales the array using the</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a><span class="sd">              surface reflectance values. If the surface reflectance is not given, the function scales the array using</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a><span class="sd">              the cutoff values. If the cutoff is not given, the function scales the array using the sentinel data</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">        Examples</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">        --------</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="sd">        Prepare an array using percentile-based scaling:</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">            &gt;&gt;&gt; from cleopatra.array_glyph import ArrayGlyph</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="sd">            &gt;&gt;&gt; # Create a 3-band array (e.g., satellite image)</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">            &gt;&gt;&gt; bands = np.random.randint(0, 10000, size=(3, 100, 100))</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a><span class="sd">            &gt;&gt;&gt; glyph = ArrayGlyph(np.zeros((1, 1)))  # Dummy initialization</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a><span class="sd">            &gt;&gt;&gt; rgb_array = glyph.prepare_array(bands, rgb=[0, 1, 2], percentile=2)</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="sd">            &gt;&gt;&gt; rgb_array.shape</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="sd">            (100, 100, 3)</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="sd">            &gt;&gt;&gt; np.all((0 &lt;= rgb_array) &amp; (rgb_array &lt;= 1))</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">            True</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">            ```</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="sd">        Prepare an array using surface reflectance normalization:</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="sd">            &gt;&gt;&gt; rgb_array = glyph.prepare_array(bands, rgb=[0, 1, 2], surface_reflectance=10000)</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="sd">            &gt;&gt;&gt; rgb_array.shape</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a><span class="sd">            (100, 100, 3)</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="sd">            &gt;&gt;&gt; np.all((0 &lt;= rgb_array) &amp; (rgb_array &lt;= 1))</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a><span class="sd">            True</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a><span class="sd">            ```</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a><span class="sd">        Prepare an array with cutoff values:</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a><span class="sd">            &gt;&gt;&gt; rgb_array = glyph.prepare_array(</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a><span class="sd">            ...     bands, rgb=[0, 1, 2], surface_reflectance=10000, cutoff=[5000, 5000, 5000]</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a><span class="sd">            &gt;&gt;&gt; rgb_array.shape</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a><span class="sd">            (100, 100, 3)</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a><span class="sd">            &gt;&gt;&gt; np.all((0 &lt;= rgb_array) &amp; (rgb_array &lt;= 1))</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a><span class="sd">            True</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a><span class="sd">            ```</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a><span class="sd">        - Create an array and instantiate the `ArrayGlyph` class.</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="sd">            &gt;&gt;&gt; arr = np.random.randint(0, 255, size=(3, 5, 5)).astype(np.float32)</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="sd">            &gt;&gt;&gt; array_glyph = ArrayGlyph(arr)</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="sd">            &gt;&gt;&gt; print(array_glyph.arr.shape)</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="sd">            (3, 5, 5)</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="sd">            ```</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a><span class="sd">        `rgb` channels:</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="sd">            - Now let&#39;s use the `prepare_array` function with `rgb` channels as [0, 1, 2]. so the finction does not to</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">                reorder the chennels. but it just needs to move the first axis to the last axis.</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="sd">                &gt;&gt;&gt; rgb_array = array_glyph.prepare_array(arr, rgb=[0, 1, 2])</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a><span class="sd">                &gt;&gt;&gt; print(rgb_array.shape)</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a><span class="sd">                (5, 5, 3)</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="sd">                ```</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a><span class="sd">            - If we compare the values of the first channel in the original array with the first array in the rgb array it</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">                should be the same.</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a><span class="sd">                &gt;&gt;&gt; np.testing.assert_equal(arr[0, :, :],rgb_array[:, :, 0])</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a><span class="sd">                ```</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="sd">        surface_reflectance:</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a><span class="sd">            - if you provide the surface reflectance value, the function will scale the array using the surface reflectance</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">                value to a normalized rgb values.</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="sd">                &gt;&gt;&gt; array_glyph = ArrayGlyph(arr)</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a><span class="sd">                &gt;&gt;&gt; rgb_array = array_glyph.prepare_array(arr, surface_reflectance=10000, rgb=[0, 1, 2])</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a><span class="sd">                &gt;&gt;&gt; print(rgb_array.shape)</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="sd">                (5, 5, 3)</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a><span class="sd">                ```</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="sd">            - if you print the values of the first channel, you will find all the values are between 0 and 1.</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a><span class="sd">                &gt;&gt;&gt; print(rgb_array[:, :, 0])</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a><span class="sd">                [[0.0195 0.02   0.0109 0.0211 0.0087]</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="sd">                 [0.0112 0.0221 0.0035 0.0234 0.0141]</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="sd">                 [0.0116 0.0188 0.0001 0.0176 0.    ]</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="sd">                 [0.0014 0.0147 0.0043 0.0167 0.0117]</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="sd">                 [0.0083 0.0139 0.0186 0.02   0.0058]]</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><span class="sd">                ```</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="sd">            - With the `surface_reflectance` parameter, you can also use the `cutoff` parameter to affect values that</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="sd">                are above it, by rescaling them.</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a><span class="sd">                &gt;&gt;&gt; rgb_array = array_glyph.prepare_array(</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="sd">                ...     arr, surface_reflectance=10000, rgb=[0, 1, 2], cutoff=[0.8, 0.8, 0.8]</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a><span class="sd">                ... )</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a><span class="sd">                &gt;&gt;&gt; print(rgb_array[:, :, 0])</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a><span class="sd">                [[0.     0.     0.     0.     0.    ]</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a><span class="sd">                 [1.     1.     1.     1.     1.    ]</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a><span class="sd">                 [1.     1.     1.     1.     1.    ]</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a><span class="sd">                 [0.0014 0.0147 0.0043 0.0167 0.0117]</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a><span class="sd">                 [0.0083 0.0139 0.0186 0.02   0.0058]]</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a><span class="sd">                ```</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>        <span class="c1"># take the rgb arrays and reorder them to have the red-green-blue, if the order is not given, assume the</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>        <span class="c1"># order as sentinel data. [3, 2, 1]</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>        <span class="n">array</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">rgb</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>        <span class="k">if</span> <span class="n">percentile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>            <span class="n">array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale_percentile</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">percentile</span><span class="o">=</span><span class="n">percentile</span><span class="p">)</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>        <span class="k">elif</span> <span class="n">surface_reflectance</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>            <span class="n">array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_sentinel_rgb</span><span class="p">(</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>                <span class="n">array</span><span class="p">,</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>                <span class="n">rgb</span><span class="o">=</span><span class="n">rgb</span><span class="p">,</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>                <span class="n">surface_reflectance</span><span class="o">=</span><span class="n">surface_reflectance</span><span class="p">,</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>                <span class="n">cutoff</span><span class="o">=</span><span class="n">cutoff</span><span class="p">,</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>            <span class="p">)</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>        <span class="k">return</span> <span class="n">array</span>
<a id="__codelineno-0-468" name="__codelineno-0-468"></a>
<a id="__codelineno-0-469" name="__codelineno-0-469"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_prepare_sentinel_rgb</span><span class="p">(</span>
<a id="__codelineno-0-470" name="__codelineno-0-470"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-471" name="__codelineno-0-471"></a>        <span class="n">array</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-472" name="__codelineno-0-472"></a>        <span class="n">rgb</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-473" name="__codelineno-0-473"></a>        <span class="n">surface_reflectance</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span>
<a id="__codelineno-0-474" name="__codelineno-0-474"></a>        <span class="n">cutoff</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-475" name="__codelineno-0-475"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-476" name="__codelineno-0-476"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Prepare Sentinel satellite data for RGB visualization.</span>
<a id="__codelineno-0-477" name="__codelineno-0-477"></a>
<a id="__codelineno-0-478" name="__codelineno-0-478"></a><span class="sd">        This method specifically handles Sentinel satellite imagery by normalizing the data</span>
<a id="__codelineno-0-479" name="__codelineno-0-479"></a><span class="sd">        using the provided surface reflectance value and optional cutoff values.</span>
<a id="__codelineno-0-480" name="__codelineno-0-480"></a>
<a id="__codelineno-0-481" name="__codelineno-0-481"></a><span class="sd">        Parameters</span>
<a id="__codelineno-0-482" name="__codelineno-0-482"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-483" name="__codelineno-0-483"></a><span class="sd">        array : np.ndarray</span>
<a id="__codelineno-0-484" name="__codelineno-0-484"></a><span class="sd">            The input array with shape (height, width, 3) containing RGB bands.</span>
<a id="__codelineno-0-485" name="__codelineno-0-485"></a><span class="sd">            This array should already be transposed from the original band-first format.</span>
<a id="__codelineno-0-486" name="__codelineno-0-486"></a><span class="sd">        rgb : List[int], optional</span>
<a id="__codelineno-0-487" name="__codelineno-0-487"></a><span class="sd">            The indices of the red, green, and blue bands in the original array, by default None.</span>
<a id="__codelineno-0-488" name="__codelineno-0-488"></a><span class="sd">            Used only for cutoff application.</span>
<a id="__codelineno-0-489" name="__codelineno-0-489"></a><span class="sd">        surface_reflectance : int, optional</span>
<a id="__codelineno-0-490" name="__codelineno-0-490"></a><span class="sd">            Surface reflectance value for normalizing satellite data, by default 10000.</span>
<a id="__codelineno-0-491" name="__codelineno-0-491"></a><span class="sd">            Sentinel-2 data typically uses 10000 as the maximum reflectance value.</span>
<a id="__codelineno-0-492" name="__codelineno-0-492"></a><span class="sd">            Used to scale values to the range [0, 1].</span>
<a id="__codelineno-0-493" name="__codelineno-0-493"></a><span class="sd">        cutoff : List, optional</span>
<a id="__codelineno-0-494" name="__codelineno-0-494"></a><span class="sd">            Clip the range of pixel values for each band, by default None.</span>
<a id="__codelineno-0-495" name="__codelineno-0-495"></a><span class="sd">            Takes only pixel values from 0 to the value of the cutoff and scales them back to between 0 and 1.</span>
<a id="__codelineno-0-496" name="__codelineno-0-496"></a><span class="sd">            Should be a list with one value per band.</span>
<a id="__codelineno-0-497" name="__codelineno-0-497"></a>
<a id="__codelineno-0-498" name="__codelineno-0-498"></a><span class="sd">        Returns</span>
<a id="__codelineno-0-499" name="__codelineno-0-499"></a><span class="sd">        -------</span>
<a id="__codelineno-0-500" name="__codelineno-0-500"></a><span class="sd">        np.ndarray</span>
<a id="__codelineno-0-501" name="__codelineno-0-501"></a><span class="sd">            The prepared array with shape (height, width, 3) suitable for RGB visualization.</span>
<a id="__codelineno-0-502" name="__codelineno-0-502"></a><span class="sd">            Values are normalized to the range [0, 1].</span>
<a id="__codelineno-0-503" name="__codelineno-0-503"></a>
<a id="__codelineno-0-504" name="__codelineno-0-504"></a><span class="sd">        Examples</span>
<a id="__codelineno-0-505" name="__codelineno-0-505"></a><span class="sd">        --------</span>
<a id="__codelineno-0-506" name="__codelineno-0-506"></a><span class="sd">        Prepare Sentinel-2 data with default surface reflectance:</span>
<a id="__codelineno-0-507" name="__codelineno-0-507"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-508" name="__codelineno-0-508"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-509" name="__codelineno-0-509"></a><span class="sd">        &gt;&gt;&gt; from cleopatra.array_glyph import ArrayGlyph</span>
<a id="__codelineno-0-510" name="__codelineno-0-510"></a><span class="sd">        &gt;&gt;&gt; # Create a simulated Sentinel-2 RGB array</span>
<a id="__codelineno-0-511" name="__codelineno-0-511"></a><span class="sd">        &gt;&gt;&gt; rgb_data = np.random.randint(0, 10000, size=(100, 100, 3))</span>
<a id="__codelineno-0-512" name="__codelineno-0-512"></a><span class="sd">        &gt;&gt;&gt; glyph = ArrayGlyph(np.zeros((1, 1)))  # Dummy initialization</span>
<a id="__codelineno-0-513" name="__codelineno-0-513"></a><span class="sd">        &gt;&gt;&gt; normalized = glyph._prepare_sentinel_rgb(rgb_data)</span>
<a id="__codelineno-0-514" name="__codelineno-0-514"></a><span class="sd">        &gt;&gt;&gt; np.all((0 &lt;= normalized) &amp; (normalized &lt;= 1))</span>
<a id="__codelineno-0-515" name="__codelineno-0-515"></a><span class="sd">        True</span>
<a id="__codelineno-0-516" name="__codelineno-0-516"></a>
<a id="__codelineno-0-517" name="__codelineno-0-517"></a><span class="sd">        ```</span>
<a id="__codelineno-0-518" name="__codelineno-0-518"></a><span class="sd">        Prepare Sentinel-2 data with custom cutoff values:</span>
<a id="__codelineno-0-519" name="__codelineno-0-519"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-520" name="__codelineno-0-520"></a><span class="sd">        &gt;&gt;&gt; cutoffs = [8000, 7000, 9000]</span>
<a id="__codelineno-0-521" name="__codelineno-0-521"></a><span class="sd">        &gt;&gt;&gt; normalized = glyph._prepare_sentinel_rgb(rgb_data, rgb=[0, 1, 2], cutoff=cutoffs)</span>
<a id="__codelineno-0-522" name="__codelineno-0-522"></a><span class="sd">        &gt;&gt;&gt; np.all((0 &lt;= normalized) &amp; (normalized &lt;= 1))</span>
<a id="__codelineno-0-523" name="__codelineno-0-523"></a><span class="sd">        True</span>
<a id="__codelineno-0-524" name="__codelineno-0-524"></a>
<a id="__codelineno-0-525" name="__codelineno-0-525"></a><span class="sd">        ```</span>
<a id="__codelineno-0-526" name="__codelineno-0-526"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-527" name="__codelineno-0-527"></a>        <span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">array</span> <span class="o">/</span> <span class="n">surface_reflectance</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-528" name="__codelineno-0-528"></a>        <span class="k">if</span> <span class="n">cutoff</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-529" name="__codelineno-0-529"></a>            <span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">rgb</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">cutoff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-530" name="__codelineno-0-530"></a>            <span class="n">array</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">rgb</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">cutoff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-531" name="__codelineno-0-531"></a>            <span class="n">array</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">rgb</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="n">cutoff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-532" name="__codelineno-0-532"></a>
<a id="__codelineno-0-533" name="__codelineno-0-533"></a>        <span class="k">return</span> <span class="n">array</span>
<a id="__codelineno-0-534" name="__codelineno-0-534"></a>
<a id="__codelineno-0-535" name="__codelineno-0-535"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">scale_percentile</span><span class="p">(</span><span class="n">arr</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">percentile</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Scale an array using percentile-based contrast stretching.</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a><span class="sd">        This method enhances the contrast of an image by stretching the histogram</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a><span class="sd">        based on percentile values. It calculates the lower and upper percentile values</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a><span class="sd">        for each band and normalizes the data to the range [0, 1].</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a><span class="sd">        Parameters</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a><span class="sd">        arr : np.ndarray</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a><span class="sd">            The array to be scaled, with shape (height, width, bands).</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a><span class="sd">            Typically an RGB image with 3 bands.</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a><span class="sd">        percentile : int, optional</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a><span class="sd">            The percentile value to be used for scaling, by default 1.</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a><span class="sd">            This value determines how much of the histogram tails to exclude.</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a><span class="sd">            Higher values result in more contrast stretching.</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a><span class="sd">            Typical values range from 1 to 5.</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a><span class="sd">        Returns</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a><span class="sd">        -------</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a><span class="sd">        np.ndarray</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a><span class="sd">            The scaled array, normalized between 0 and 1, with the same shape as input.</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a><span class="sd">            Data type is float32.</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a><span class="sd">        Notes</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a><span class="sd">        -----</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a><span class="sd">        The method works by:</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a><span class="sd">        1. Computing the lower percentile value for each band</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a><span class="sd">        2. Computing the upper percentile value (100 - percentile) for each band</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a><span class="sd">        3. Normalizing each band using these percentile values</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a><span class="sd">        4. Clipping values to the range [0, 1]</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a><span class="sd">        This is particularly useful for visualizing satellite imagery with high dynamic range.</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a><span class="sd">        Examples</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a><span class="sd">        --------</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a><span class="sd">        Scale a single-band array:</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a><span class="sd">        &gt;&gt;&gt; from cleopatra.array_glyph import ArrayGlyph</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a><span class="sd">        &gt;&gt;&gt; # Create a test array with values between 0 and 10000</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a><span class="sd">        &gt;&gt;&gt; test_array = np.random.randint(0, 10000, size=(100, 100, 1))</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a><span class="sd">        &gt;&gt;&gt; scaled = ArrayGlyph.scale_percentile(test_array, percentile=2)</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a><span class="sd">        &gt;&gt;&gt; scaled.shape</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a><span class="sd">        (100, 100, 1)</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a><span class="sd">        &gt;&gt;&gt; np.all((0 &lt;= scaled) &amp; (scaled &lt;= 1))</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a><span class="sd">        np.True_</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a><span class="sd">        ```</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a><span class="sd">        Scale an RGB array:</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a><span class="sd">        &gt;&gt;&gt; rgb_array = np.random.randint(0, 10000, size=(100, 100, 3))</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a><span class="sd">        &gt;&gt;&gt; scaled = ArrayGlyph.scale_percentile(rgb_array, percentile=2)</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a><span class="sd">        &gt;&gt;&gt; scaled.shape</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a><span class="sd">        (100, 100, 3)</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a><span class="sd">        &gt;&gt;&gt; np.all((0 &lt;= scaled) &amp; (scaled &lt;= 1))</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a><span class="sd">        np.True_</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a><span class="sd">        ```</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a><span class="sd">        Using different percentile values affects contrast:</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a><span class="sd">        &gt;&gt;&gt; low_contrast = ArrayGlyph.scale_percentile(rgb_array, percentile=1)</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a><span class="sd">        &gt;&gt;&gt; high_contrast = ArrayGlyph.scale_percentile(rgb_array, percentile=5)</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a><span class="sd">        &gt;&gt;&gt; # Higher percentile typically results in higher contrast</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a><span class="sd">        ```</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>        <span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">bands</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>        <span class="c1"># flatten image.</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>        <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">[</span><span class="n">rows</span> <span class="o">*</span> <span class="n">columns</span><span class="p">,</span> <span class="n">bands</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>        <span class="c1"># lower percentile values (one value for each band).</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>        <span class="n">lower_percent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">percentile</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>        <span class="c1"># 98 percentile values.</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>        <span class="n">upper_percent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="mi">100</span> <span class="o">-</span> <span class="n">percentile</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">lower_percent</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>        <span class="c1"># normalize the 3 bands using the percentile values for each band.</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>        <span class="n">arr</span> <span class="o">=</span> <span class="p">(</span><span class="n">arr</span> <span class="o">-</span> <span class="n">lower_percent</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:])</span> <span class="o">/</span> <span class="n">upper_percent</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>        <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">[</span><span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">bands</span><span class="p">])</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>        <span class="c1"># discard outliers.</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>        <span class="n">arr</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>        <span class="k">return</span> <span class="n">arr</span>
<a id="__codelineno-0-617" name="__codelineno-0-617"></a>
<a id="__codelineno-0-618" name="__codelineno-0-618"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;String representation of the Array object.&quot;&quot;&quot;</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>        <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a><span class="s2">                    Min: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">vmin</span><span class="si">}</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a><span class="s2">                    Max: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">vmax</span><span class="si">}</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a><span class="s2">                    Exclude values: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">exclude_value</span><span class="si">}</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a><span class="s2">                    RGB: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">rgb</span><span class="si">}</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a><span class="s2">                &quot;&quot;&quot;</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a>        <span class="k">return</span> <span class="n">message</span>
<a id="__codelineno-0-627" name="__codelineno-0-627"></a>
<a id="__codelineno-0-628" name="__codelineno-0-628"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-629" name="__codelineno-0-629"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">vmin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-630" name="__codelineno-0-630"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;min value in the array&quot;&quot;&quot;</span>
<a id="__codelineno-0-631" name="__codelineno-0-631"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vmin</span>
<a id="__codelineno-0-632" name="__codelineno-0-632"></a>
<a id="__codelineno-0-633" name="__codelineno-0-633"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-634" name="__codelineno-0-634"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">vmax</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-635" name="__codelineno-0-635"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;max value in the array&quot;&quot;&quot;</span>
<a id="__codelineno-0-636" name="__codelineno-0-636"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vmax</span>
<a id="__codelineno-0-637" name="__codelineno-0-637"></a>
<a id="__codelineno-0-638" name="__codelineno-0-638"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-639" name="__codelineno-0-639"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">exclude_value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-640" name="__codelineno-0-640"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;exclude_value&quot;&quot;&quot;</span>
<a id="__codelineno-0-641" name="__codelineno-0-641"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exclude_value</span>
<a id="__codelineno-0-642" name="__codelineno-0-642"></a>
<a id="__codelineno-0-643" name="__codelineno-0-643"></a>    <span class="nd">@exclude_value</span><span class="o">.</span><span class="n">setter</span>
<a id="__codelineno-0-644" name="__codelineno-0-644"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">exclude_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<a id="__codelineno-0-645" name="__codelineno-0-645"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_exclude_value</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-0-646" name="__codelineno-0-646"></a>
<a id="__codelineno-0-647" name="__codelineno-0-647"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-648" name="__codelineno-0-648"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">default_options</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-649" name="__codelineno-0-649"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Default plot options&quot;&quot;&quot;</span>
<a id="__codelineno-0-650" name="__codelineno-0-650"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_options</span>
<a id="__codelineno-0-651" name="__codelineno-0-651"></a>
<a id="__codelineno-0-652" name="__codelineno-0-652"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-653" name="__codelineno-0-653"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">anim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-654" name="__codelineno-0-654"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Animation function&quot;&quot;&quot;</span>
<a id="__codelineno-0-655" name="__codelineno-0-655"></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_anim&quot;</span><span class="p">):</span>
<a id="__codelineno-0-656" name="__codelineno-0-656"></a>            <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_anim</span>
<a id="__codelineno-0-657" name="__codelineno-0-657"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-658" name="__codelineno-0-658"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-659" name="__codelineno-0-659"></a>                <span class="s2">&quot;Please first use the function animate to create the animation object&quot;</span>
<a id="__codelineno-0-660" name="__codelineno-0-660"></a>            <span class="p">)</span>
<a id="__codelineno-0-661" name="__codelineno-0-661"></a>        <span class="k">return</span> <span class="n">val</span>
<a id="__codelineno-0-662" name="__codelineno-0-662"></a>
<a id="__codelineno-0-663" name="__codelineno-0-663"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_figure_axes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Figure</span><span class="p">,</span> <span class="n">Axes</span><span class="p">]:</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create the figure and the axes.</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a><span class="sd">        Returns</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a><span class="sd">        -------</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a><span class="sd">        fig: matplotlib.figure.Figure</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a><span class="sd">            the created figure.</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a><span class="sd">        ax: matplotlib.axes.Axes</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a><span class="sd">            the created axes.</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>        <span class="c1"># plt.ioff()  # to prevent the empty figure from being displayed</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;figsize&quot;</span><span class="p">])</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
<a id="__codelineno-0-677" name="__codelineno-0-677"></a>
<a id="__codelineno-0-678" name="__codelineno-0-678"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_ticks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;get a list of ticks for the color bar&quot;&quot;&quot;</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>        <span class="n">ticks_spacing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;ticks_spacing&quot;</span><span class="p">]</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>        <span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;vmax&quot;</span><span class="p">]</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>        <span class="n">vmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;vmin&quot;</span><span class="p">]</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>        <span class="n">remainder</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">remainder</span><span class="p">(</span><span class="n">vmax</span><span class="p">,</span> <span class="n">ticks_spacing</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>        <span class="c1"># np.mod(vmax, ticks_spacing) gives float point error, so we use the round function.</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>        <span class="k">if</span> <span class="n">remainder</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>            <span class="n">ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">+</span> <span class="n">ticks_spacing</span><span class="p">,</span> <span class="n">ticks_spacing</span><span class="p">)</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>                <span class="n">ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">+</span> <span class="n">ticks_spacing</span><span class="p">,</span> <span class="n">ticks_spacing</span><span class="p">)</span>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a>            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a>                    <span class="s2">&quot;The number of ticks exceeded the max allowed size, possible errors&quot;</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a>                    <span class="sa">f</span><span class="s2">&quot; is the value of the NodataValue you entered-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">exclude_value</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>                <span class="p">)</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a>            <span class="n">ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a>                <span class="n">ticks</span><span class="p">,</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a>                <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">vmax</span> <span class="o">/</span> <span class="n">ticks_spacing</span><span class="p">)</span> <span class="o">*</span> <span class="n">ticks_spacing</span> <span class="o">+</span> <span class="n">ticks_spacing</span><span class="p">],</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a>            <span class="p">)</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>        <span class="k">return</span> <span class="n">ticks</span>
<a id="__codelineno-0-700" name="__codelineno-0-700"></a>
<a id="__codelineno-0-701" name="__codelineno-0-701"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_plot_im_get_cbar_kw</span><span class="p">(</span>
<a id="__codelineno-0-702" name="__codelineno-0-702"></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">:</span> <span class="n">Axes</span><span class="p">,</span> <span class="n">arr</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">ticks</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
<a id="__codelineno-0-703" name="__codelineno-0-703"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">AxesImage</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<a id="__codelineno-0-704" name="__codelineno-0-704"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot a single image and get color bar keyword arguments.</span>
<a id="__codelineno-0-705" name="__codelineno-0-705"></a>
<a id="__codelineno-0-706" name="__codelineno-0-706"></a><span class="sd">        Parameters</span>
<a id="__codelineno-0-707" name="__codelineno-0-707"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-708" name="__codelineno-0-708"></a><span class="sd">        ax: [axes]</span>
<a id="__codelineno-0-709" name="__codelineno-0-709"></a><span class="sd">            matplotlib figure axes.</span>
<a id="__codelineno-0-710" name="__codelineno-0-710"></a><span class="sd">        arr: [array]</span>
<a id="__codelineno-0-711" name="__codelineno-0-711"></a><span class="sd">            numpy array.</span>
<a id="__codelineno-0-712" name="__codelineno-0-712"></a><span class="sd">        ticks: [list]</span>
<a id="__codelineno-0-713" name="__codelineno-0-713"></a><span class="sd">            color bar ticks.</span>
<a id="__codelineno-0-714" name="__codelineno-0-714"></a>
<a id="__codelineno-0-715" name="__codelineno-0-715"></a><span class="sd">        Returns</span>
<a id="__codelineno-0-716" name="__codelineno-0-716"></a><span class="sd">        -------</span>
<a id="__codelineno-0-717" name="__codelineno-0-717"></a><span class="sd">        im: AxesImage</span>
<a id="__codelineno-0-718" name="__codelineno-0-718"></a><span class="sd">            image axes.</span>
<a id="__codelineno-0-719" name="__codelineno-0-719"></a><span class="sd">        cbar: Dict[str,str]</span>
<a id="__codelineno-0-720" name="__codelineno-0-720"></a><span class="sd">            color bar keyword arguments.</span>
<a id="__codelineno-0-721" name="__codelineno-0-721"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-722" name="__codelineno-0-722"></a>        <span class="n">color_scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;color_scale&quot;</span><span class="p">]</span>
<a id="__codelineno-0-723" name="__codelineno-0-723"></a>        <span class="n">cmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;cmap&quot;</span><span class="p">]</span>
<a id="__codelineno-0-724" name="__codelineno-0-724"></a>        <span class="c1"># get the vmin and vmax from the tick instead of the default values.</span>
<a id="__codelineno-0-725" name="__codelineno-0-725"></a>        <span class="n">vmin</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># self.default_options[&quot;vmin&quot;]</span>
<a id="__codelineno-0-726" name="__codelineno-0-726"></a>        <span class="n">vmax</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">ticks</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># self.default_options[&quot;vmax&quot;]</span>
<a id="__codelineno-0-727" name="__codelineno-0-727"></a>
<a id="__codelineno-0-728" name="__codelineno-0-728"></a>        <span class="k">if</span> <span class="n">color_scale</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;linear&quot;</span><span class="p">:</span>
<a id="__codelineno-0-729" name="__codelineno-0-729"></a>            <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extent</span><span class="p">)</span>
<a id="__codelineno-0-730" name="__codelineno-0-730"></a>            <span class="n">cbar_kw</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ticks&quot;</span><span class="p">:</span> <span class="n">ticks</span><span class="p">}</span>
<a id="__codelineno-0-731" name="__codelineno-0-731"></a>        <span class="k">elif</span> <span class="n">color_scale</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;power&quot;</span><span class="p">:</span>
<a id="__codelineno-0-732" name="__codelineno-0-732"></a>            <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span>
<a id="__codelineno-0-733" name="__codelineno-0-733"></a>                <span class="n">arr</span><span class="p">,</span>
<a id="__codelineno-0-734" name="__codelineno-0-734"></a>                <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
<a id="__codelineno-0-735" name="__codelineno-0-735"></a>                <span class="n">norm</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">PowerNorm</span><span class="p">(</span>
<a id="__codelineno-0-736" name="__codelineno-0-736"></a>                    <span class="n">gamma</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;gamma&quot;</span><span class="p">],</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span>
<a id="__codelineno-0-737" name="__codelineno-0-737"></a>                <span class="p">),</span>
<a id="__codelineno-0-738" name="__codelineno-0-738"></a>                <span class="n">extent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extent</span><span class="p">,</span>
<a id="__codelineno-0-739" name="__codelineno-0-739"></a>            <span class="p">)</span>
<a id="__codelineno-0-740" name="__codelineno-0-740"></a>            <span class="n">cbar_kw</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ticks&quot;</span><span class="p">:</span> <span class="n">ticks</span><span class="p">}</span>
<a id="__codelineno-0-741" name="__codelineno-0-741"></a>        <span class="k">elif</span> <span class="n">color_scale</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;sym-lognorm&quot;</span><span class="p">:</span>
<a id="__codelineno-0-742" name="__codelineno-0-742"></a>            <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span>
<a id="__codelineno-0-743" name="__codelineno-0-743"></a>                <span class="n">arr</span><span class="p">,</span>
<a id="__codelineno-0-744" name="__codelineno-0-744"></a>                <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
<a id="__codelineno-0-745" name="__codelineno-0-745"></a>                <span class="n">norm</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">SymLogNorm</span><span class="p">(</span>
<a id="__codelineno-0-746" name="__codelineno-0-746"></a>                    <span class="n">linthresh</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;line_threshold&quot;</span><span class="p">],</span>
<a id="__codelineno-0-747" name="__codelineno-0-747"></a>                    <span class="n">linscale</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;line_scale&quot;</span><span class="p">],</span>
<a id="__codelineno-0-748" name="__codelineno-0-748"></a>                    <span class="n">base</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">e</span><span class="p">,</span>
<a id="__codelineno-0-749" name="__codelineno-0-749"></a>                    <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
<a id="__codelineno-0-750" name="__codelineno-0-750"></a>                    <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
<a id="__codelineno-0-751" name="__codelineno-0-751"></a>                <span class="p">),</span>
<a id="__codelineno-0-752" name="__codelineno-0-752"></a>                <span class="n">extent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extent</span><span class="p">,</span>
<a id="__codelineno-0-753" name="__codelineno-0-753"></a>            <span class="p">)</span>
<a id="__codelineno-0-754" name="__codelineno-0-754"></a>            <span class="n">formatter</span> <span class="o">=</span> <span class="n">LogFormatter</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">labelOnlyBase</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-0-755" name="__codelineno-0-755"></a>            <span class="n">cbar_kw</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ticks&quot;</span><span class="p">:</span> <span class="n">ticks</span><span class="p">,</span> <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="n">formatter</span><span class="p">}</span>
<a id="__codelineno-0-756" name="__codelineno-0-756"></a>        <span class="k">elif</span> <span class="n">color_scale</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;boundary-norm&quot;</span><span class="p">:</span>
<a id="__codelineno-0-757" name="__codelineno-0-757"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;bounds&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-758" name="__codelineno-0-758"></a>                <span class="n">bounds</span> <span class="o">=</span> <span class="n">ticks</span>
<a id="__codelineno-0-759" name="__codelineno-0-759"></a>                <span class="n">cbar_kw</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ticks&quot;</span><span class="p">:</span> <span class="n">ticks</span><span class="p">}</span>
<a id="__codelineno-0-760" name="__codelineno-0-760"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-761" name="__codelineno-0-761"></a>                <span class="n">bounds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;bounds&quot;</span><span class="p">]</span>
<a id="__codelineno-0-762" name="__codelineno-0-762"></a>                <span class="n">cbar_kw</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ticks&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;bounds&quot;</span><span class="p">]}</span>
<a id="__codelineno-0-763" name="__codelineno-0-763"></a>            <span class="n">norm</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">boundaries</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span> <span class="n">ncolors</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>
<a id="__codelineno-0-764" name="__codelineno-0-764"></a>            <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extent</span><span class="p">)</span>
<a id="__codelineno-0-765" name="__codelineno-0-765"></a>        <span class="k">elif</span> <span class="n">color_scale</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;midpoint&quot;</span><span class="p">:</span>
<a id="__codelineno-0-766" name="__codelineno-0-766"></a>            <span class="n">arr</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">filled</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<a id="__codelineno-0-767" name="__codelineno-0-767"></a>            <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span>
<a id="__codelineno-0-768" name="__codelineno-0-768"></a>                <span class="n">arr</span><span class="p">,</span>
<a id="__codelineno-0-769" name="__codelineno-0-769"></a>                <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
<a id="__codelineno-0-770" name="__codelineno-0-770"></a>                <span class="n">norm</span><span class="o">=</span><span class="n">MidpointNormalize</span><span class="p">(</span>
<a id="__codelineno-0-771" name="__codelineno-0-771"></a>                    <span class="n">midpoint</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;midpoint&quot;</span><span class="p">],</span>
<a id="__codelineno-0-772" name="__codelineno-0-772"></a>                    <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
<a id="__codelineno-0-773" name="__codelineno-0-773"></a>                    <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
<a id="__codelineno-0-774" name="__codelineno-0-774"></a>                <span class="p">),</span>
<a id="__codelineno-0-775" name="__codelineno-0-775"></a>                <span class="n">extent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extent</span><span class="p">,</span>
<a id="__codelineno-0-776" name="__codelineno-0-776"></a>            <span class="p">)</span>
<a id="__codelineno-0-777" name="__codelineno-0-777"></a>            <span class="n">cbar_kw</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ticks&quot;</span><span class="p">:</span> <span class="n">ticks</span><span class="p">}</span>
<a id="__codelineno-0-778" name="__codelineno-0-778"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-779" name="__codelineno-0-779"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-780" name="__codelineno-0-780"></a>                <span class="sa">f</span><span class="s2">&quot;Invalid color scale option: </span><span class="si">{</span><span class="n">color_scale</span><span class="si">}</span><span class="s2">. Use &#39;linear&#39;, &#39;power&#39;, &#39;power-norm&#39;,&quot;</span>
<a id="__codelineno-0-781" name="__codelineno-0-781"></a>                <span class="s2">&quot;&#39;sym-lognorm&#39;, &#39;boundary-norm&#39;&quot;</span>
<a id="__codelineno-0-782" name="__codelineno-0-782"></a>            <span class="p">)</span>
<a id="__codelineno-0-783" name="__codelineno-0-783"></a>
<a id="__codelineno-0-784" name="__codelineno-0-784"></a>        <span class="k">return</span> <span class="n">im</span><span class="p">,</span> <span class="n">cbar_kw</span>
<a id="__codelineno-0-785" name="__codelineno-0-785"></a>
<a id="__codelineno-0-786" name="__codelineno-0-786"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">apply_colormap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmap</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Colormap</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply a matplotlib colormap to an array.</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a><span class="sd">            Create an RGB channel from the given array using the given colormap.</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a><span class="sd">        Parameters</span>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a><span class="sd">        cmap: Colormap/str</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a><span class="sd">            colormap.</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a><span class="sd">        Returns</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a><span class="sd">        -------</span>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a><span class="sd">        np.ndarray: 8-bit array</span>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a><span class="sd">            the array with the colormap applied.</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a><span class="sd">        Examples</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a><span class="sd">        --------</span>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a><span class="sd">        - Create an array and instantiate the `Array` object:</span>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a><span class="sd">            &gt;&gt;&gt; arr = np.array([[1, 2, 3], [4, 5, 6], [7, 8, 9]])</span>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a><span class="sd">            &gt;&gt;&gt; array = ArrayGlyph(arr)</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a><span class="sd">            &gt;&gt;&gt; rgb_array = array.apply_colormap(&quot;coolwarm_r&quot;)</span>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a><span class="sd">            &gt;&gt;&gt; print(rgb_array)</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a><span class="sd">            [[[179   3  38]</span>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a><span class="sd">              [221  96  76]</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a><span class="sd">              [244 154 123]]</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a><span class="sd">             [[244 196 173]</span>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a><span class="sd">              [220 220 221]</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a><span class="sd">              [183 207 249]]</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a><span class="sd">             [[139 17 4 253]</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a><span class="sd">              [ 96 128 232]</span>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a><span class="sd">              [ 58  76 192]]]</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a><span class="sd">              &gt;&gt;&gt; print(rgb_array.dtype)</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a><span class="sd">                uint8</span>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a><span class="sd">            ```</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a>        <span class="n">colormap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">cmap</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a>        <span class="n">normed_data</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arr</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="o">.</span><span class="n">min</span><span class="p">())</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a>        <span class="n">colored</span> <span class="o">=</span> <span class="n">colormap</span><span class="p">(</span><span class="n">normed_data</span><span class="p">)</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a>        <span class="k">return</span> <span class="p">(</span><span class="n">colored</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;uint8&quot;</span><span class="p">)</span>
<a id="__codelineno-0-827" name="__codelineno-0-827"></a>
<a id="__codelineno-0-828" name="__codelineno-0-828"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arr</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Image</span><span class="o">.</span><span class="n">Image</span><span class="p">:</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create an RGB image from an array.</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a><span class="sd">            convert the array to an image.</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a><span class="sd">        Parameters</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a><span class="sd">        arr: np.ndarray, default is None.</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a><span class="sd">            array. if None, the array in the object will be used.</span>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a><span class="sd">        Examples</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a><span class="sd">        --------</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a><span class="sd">        &gt;&gt;&gt; arr = np.array([[1, 2, 3], [4, 5, 6], [7, 8, 9]])</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a><span class="sd">        &gt;&gt;&gt; array = ArrayGlyph(arr)</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a><span class="sd">        &gt;&gt;&gt; image = array.to_image()</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a><span class="sd">        &gt;&gt;&gt; print(image) # doctest: +SKIP</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a><span class="sd">        &lt;PIL.Image.Image image mode=RGB size=3x3 at 0x7F5E0D2F4C40&gt;</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a>        <span class="k">if</span> <span class="n">arr</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a>            <span class="n">arr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr</span>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a>        <span class="c1"># This is done to scale the values between 0 and 255</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a>        <span class="n">arr</span> <span class="o">=</span> <span class="n">arr</span> <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s2">&quot;uint8&quot;</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale_to_rgb</span><span class="p">()</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a>        <span class="k">return</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;RGB&quot;</span><span class="p">)</span>
<a id="__codelineno-0-852" name="__codelineno-0-852"></a>
<a id="__codelineno-0-853" name="__codelineno-0-853"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">scale_to_rgb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arr</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create an RGB image.</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a><span class="sd">        Parameters</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a><span class="sd">        arr: np.ndarray, default is None.</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a><span class="sd">            array. if None, the array in the object will be used.</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a><span class="sd">        Examples</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a><span class="sd">        --------</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a><span class="sd">        &gt;&gt;&gt; arr = np.array([[1, 2, 3], [4, 5, 6], [7, 8, 9]])</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a><span class="sd">        &gt;&gt;&gt; array = ArrayGlyph(arr)</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a><span class="sd">        &gt;&gt;&gt; rgb_array = array.scale_to_rgb()</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a><span class="sd">        &gt;&gt;&gt; print(rgb_array)</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a><span class="sd">        [[28 56 85]</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a><span class="sd">         [113 141 170]</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a><span class="sd">         [198 226 255]]</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a><span class="sd">         &gt;&gt;&gt; print(rgb_array.dtype)</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a>        <span class="k">if</span> <span class="n">arr</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a>            <span class="n">arr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a>        <span class="c1"># This is done to scale the values between 0 and 255</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a>        <span class="k">return</span> <span class="p">(</span><span class="n">arr</span> <span class="o">*</span> <span class="mi">255</span> <span class="o">/</span> <span class="n">arr</span><span class="o">.</span><span class="n">max</span><span class="p">())</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;uint8&quot;</span><span class="p">)</span>
<a id="__codelineno-0-877" name="__codelineno-0-877"></a>
<a id="__codelineno-0-878" name="__codelineno-0-878"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-0-879" name="__codelineno-0-879"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_plot_text</span><span class="p">(</span>
<a id="__codelineno-0-880" name="__codelineno-0-880"></a>        <span class="n">ax</span><span class="p">:</span> <span class="n">Axes</span><span class="p">,</span> <span class="n">arr</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">default_options_dict</span><span class="p">:</span> <span class="nb">dict</span>
<a id="__codelineno-0-881" name="__codelineno-0-881"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<a id="__codelineno-0-882" name="__codelineno-0-882"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;plot values as a text in each cell.</span>
<a id="__codelineno-0-883" name="__codelineno-0-883"></a>
<a id="__codelineno-0-884" name="__codelineno-0-884"></a><span class="sd">        Parameters</span>
<a id="__codelineno-0-885" name="__codelineno-0-885"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-886" name="__codelineno-0-886"></a><span class="sd">        ax:[matplotlib ax]</span>
<a id="__codelineno-0-887" name="__codelineno-0-887"></a><span class="sd">            matplotlib axes</span>
<a id="__codelineno-0-888" name="__codelineno-0-888"></a><span class="sd">        indices: [array]</span>
<a id="__codelineno-0-889" name="__codelineno-0-889"></a><span class="sd">            array with columns, (row, col)</span>
<a id="__codelineno-0-890" name="__codelineno-0-890"></a><span class="sd">        default_options_dict: Dict</span>
<a id="__codelineno-0-891" name="__codelineno-0-891"></a><span class="sd">            default options dictionary after updating the options.</span>
<a id="__codelineno-0-892" name="__codelineno-0-892"></a>
<a id="__codelineno-0-893" name="__codelineno-0-893"></a><span class="sd">        Returns</span>
<a id="__codelineno-0-894" name="__codelineno-0-894"></a><span class="sd">        -------</span>
<a id="__codelineno-0-895" name="__codelineno-0-895"></a><span class="sd">        list:</span>
<a id="__codelineno-0-896" name="__codelineno-0-896"></a><span class="sd">            list of the text object</span>
<a id="__codelineno-0-897" name="__codelineno-0-897"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-898" name="__codelineno-0-898"></a>        <span class="c1"># https://github.com/Serapieum-of-alex/cleopatra/issues/75</span>
<a id="__codelineno-0-899" name="__codelineno-0-899"></a>        <span class="c1"># add text for the cell values</span>
<a id="__codelineno-0-900" name="__codelineno-0-900"></a>        <span class="n">add_text</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">elem</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
<a id="__codelineno-0-901" name="__codelineno-0-901"></a>            <span class="n">elem</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-902" name="__codelineno-0-902"></a>            <span class="n">elem</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<a id="__codelineno-0-903" name="__codelineno-0-903"></a>            <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">elem</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">elem</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="mi">2</span><span class="p">),</span>
<a id="__codelineno-0-904" name="__codelineno-0-904"></a>            <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
<a id="__codelineno-0-905" name="__codelineno-0-905"></a>            <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
<a id="__codelineno-0-906" name="__codelineno-0-906"></a>            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span>
<a id="__codelineno-0-907" name="__codelineno-0-907"></a>            <span class="n">fontsize</span><span class="o">=</span><span class="n">default_options_dict</span><span class="p">[</span><span class="s2">&quot;num_size&quot;</span><span class="p">],</span>
<a id="__codelineno-0-908" name="__codelineno-0-908"></a>        <span class="p">)</span>
<a id="__codelineno-0-909" name="__codelineno-0-909"></a>        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">add_text</span><span class="p">,</span> <span class="n">indices</span><span class="p">))</span>
<a id="__codelineno-0-910" name="__codelineno-0-910"></a>
<a id="__codelineno-0-911" name="__codelineno-0-911"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-0-912" name="__codelineno-0-912"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_plot_point_values</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">point_table</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pid_color</span><span class="p">,</span> <span class="n">pid_size</span><span class="p">):</span>
<a id="__codelineno-0-913" name="__codelineno-0-913"></a>        <span class="n">write_points</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
<a id="__codelineno-0-914" name="__codelineno-0-914"></a>            <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
<a id="__codelineno-0-915" name="__codelineno-0-915"></a>            <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-916" name="__codelineno-0-916"></a>            <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<a id="__codelineno-0-917" name="__codelineno-0-917"></a>            <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
<a id="__codelineno-0-918" name="__codelineno-0-918"></a>            <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
<a id="__codelineno-0-919" name="__codelineno-0-919"></a>            <span class="n">color</span><span class="o">=</span><span class="n">pid_color</span><span class="p">,</span>
<a id="__codelineno-0-920" name="__codelineno-0-920"></a>            <span class="n">fontsize</span><span class="o">=</span><span class="n">pid_size</span><span class="p">,</span>
<a id="__codelineno-0-921" name="__codelineno-0-921"></a>        <span class="p">)</span>
<a id="__codelineno-0-922" name="__codelineno-0-922"></a>        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">write_points</span><span class="p">,</span> <span class="n">point_table</span><span class="p">))</span>
<a id="__codelineno-0-923" name="__codelineno-0-923"></a>
<a id="__codelineno-0-924" name="__codelineno-0-924"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">create_color_bar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">:</span> <span class="n">Axes</span><span class="p">,</span> <span class="n">im</span><span class="p">:</span> <span class="n">AxesImage</span><span class="p">,</span> <span class="n">cbar_kw</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Colorbar</span><span class="p">:</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create Color bar.</span>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a><span class="sd">        Parameters</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a><span class="sd">        ax: Axes</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a><span class="sd">            matplotlib axes.</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a><span class="sd">        im: AxesImage</span>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a><span class="sd">            Image axes.</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a><span class="sd">        cbar_kw: dict</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a><span class="sd">            color bar keyword arguments.</span>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a><span class="sd">        Returns</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a><span class="sd">        -------</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a><span class="sd">        Colorbar:</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a><span class="sd">            colorbar object.</span>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a>        <span class="c1"># im or cax is the last image added to the axes</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a>        <span class="c1"># im = ax.images[-1]</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a>        <span class="n">cbar</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a>            <span class="n">im</span><span class="p">,</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a>            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a>            <span class="n">shrink</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;cbar_length&quot;</span><span class="p">],</span>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a>            <span class="n">orientation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;cbar_orientation&quot;</span><span class="p">],</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a>            <span class="o">**</span><span class="n">cbar_kw</span><span class="p">,</span>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a>        <span class="p">)</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a>        <span class="c1"># cbar.ax.set_ylabel(</span>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a>        <span class="c1">#     self.default_options[&quot;cbar_label&quot;],</span>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a>        <span class="c1">#     rotation=self.default_options[&quot;cbar_label_rotation&quot;],</span>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a>        <span class="c1">#     va=self.default_options[&quot;cbar_label_location&quot;],</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a>        <span class="c1">#     fontsize=self.default_options[&quot;cbar_label_size&quot;],</span>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a>        <span class="c1"># )</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a>        <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a>        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;cbar_label&quot;</span><span class="p">],</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a>            <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;cbar_label_size&quot;</span><span class="p">],</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a>            <span class="n">loc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;cbar_label_location&quot;</span><span class="p">],</span>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a>        <span class="p">)</span>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a>        <span class="k">return</span> <span class="n">cbar</span>
<a id="__codelineno-0-964" name="__codelineno-0-964"></a>
<a id="__codelineno-0-965" name="__codelineno-0-965"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a>        <span class="n">points</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a>        <span class="n">point_color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a>        <span class="n">point_size</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a>        <span class="n">pid_color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a>        <span class="n">pid_size</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Figure</span><span class="p">,</span> <span class="n">Axes</span><span class="p">]:</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the array with customizable visualization options.</span>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a><span class="sd">        This method creates a visualization of the array with various customization options</span>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a><span class="sd">        including color scales, color bars, cell value display, and point annotations.</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a><span class="sd">        It supports both regular arrays and RGB arrays.</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a><span class="sd">        Parameters</span>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a><span class="sd">        points : np.ndarray, optional</span>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a><span class="sd">            Points to display on the array, by default None.</span>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a><span class="sd">            Should be a 3-column array where:</span>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a><span class="sd">            - First column: values to display for each point</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a><span class="sd">            - Second column: row indices of the points in the array</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a><span class="sd">            - Third column: column indices of the points in the array</span>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a><span class="sd">        point_color : str, optional</span>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a><span class="sd">            Color of the points, by default &quot;red&quot;.</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a><span class="sd">            Any valid matplotlib color string.</span>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a><span class="sd">        point_size : Union[int, float], optional</span>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a><span class="sd">            Size of the points, by default 100.</span>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a><span class="sd">            Controls the marker size.</span>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a><span class="sd">        pid_color : str, optional</span>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a><span class="sd">            Color of the point value annotations, by default &quot;blue&quot;.</span>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a><span class="sd">            Any valid matplotlib color string.</span>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a><span class="sd">        pid_size : Union[int, float], optional</span>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a><span class="sd">            Size of the point value annotations, by default 10.</span>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a><span class="sd">            Controls the font size of the annotations.</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a><span class="sd">        **kwargs : dict</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a><span class="sd">            Additional keyword arguments for customizing the plot.</span>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a><span class="sd">            Plot appearance:</span>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a><span class="sd">            ---------------</span>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a><span class="sd">            title : str, optional</span>
<a id="__codelineno-0-1006" name="__codelineno-0-1006"></a><span class="sd">                Title of the plot, by default &#39;Array Plot&#39;.</span>
<a id="__codelineno-0-1007" name="__codelineno-0-1007"></a><span class="sd">            title_size : int, optional</span>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a><span class="sd">                Title font size, by default 15.</span>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a><span class="sd">            cmap : str, optional</span>
<a id="__codelineno-0-1010" name="__codelineno-0-1010"></a><span class="sd">                Colormap name, by default &#39;coolwarm_r&#39;.</span>
<a id="__codelineno-0-1011" name="__codelineno-0-1011"></a><span class="sd">            vmin : float, optional</span>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a><span class="sd">                Minimum value for color scaling, by default min(array).</span>
<a id="__codelineno-0-1013" name="__codelineno-0-1013"></a><span class="sd">            vmax : float, optional</span>
<a id="__codelineno-0-1014" name="__codelineno-0-1014"></a><span class="sd">                Maximum value for color scaling, by default max(array).</span>
<a id="__codelineno-0-1015" name="__codelineno-0-1015"></a>
<a id="__codelineno-0-1016" name="__codelineno-0-1016"></a><span class="sd">            Color bar options:</span>
<a id="__codelineno-0-1017" name="__codelineno-0-1017"></a><span class="sd">            ----------------</span>
<a id="__codelineno-0-1018" name="__codelineno-0-1018"></a><span class="sd">            cbar_orientation : str, optional</span>
<a id="__codelineno-0-1019" name="__codelineno-0-1019"></a><span class="sd">                Orientation of the color bar, by default &#39;vertical&#39;.</span>
<a id="__codelineno-0-1020" name="__codelineno-0-1020"></a><span class="sd">                Can be &#39;horizontal&#39; or &#39;vertical&#39;.</span>
<a id="__codelineno-0-1021" name="__codelineno-0-1021"></a><span class="sd">            cbar_label_rotation : float, optional</span>
<a id="__codelineno-0-1022" name="__codelineno-0-1022"></a><span class="sd">                Rotation angle of the color bar label, by default -90.</span>
<a id="__codelineno-0-1023" name="__codelineno-0-1023"></a><span class="sd">            cbar_label_location : str, optional</span>
<a id="__codelineno-0-1024" name="__codelineno-0-1024"></a><span class="sd">                Location of the color bar label, by default &#39;bottom&#39;.</span>
<a id="__codelineno-0-1025" name="__codelineno-0-1025"></a><span class="sd">                Options: &#39;top&#39;, &#39;bottom&#39;, &#39;center&#39;, &#39;baseline&#39;, &#39;center_baseline&#39;.</span>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a><span class="sd">            cbar_length : float, optional</span>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a><span class="sd">                Ratio to control the height/width of the color bar, by default 0.75.</span>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a><span class="sd">            ticks_spacing : int, optional</span>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a><span class="sd">                Spacing between ticks on the color bar, by default 2.</span>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a><span class="sd">            cbar_label_size : int, optional</span>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a><span class="sd">                Font size of the color bar label, by default 12.</span>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a><span class="sd">            cbar_label : str, optional</span>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a><span class="sd">                Label text for the color bar, by default &#39;Value&#39;.</span>
<a id="__codelineno-0-1034" name="__codelineno-0-1034"></a>
<a id="__codelineno-0-1035" name="__codelineno-0-1035"></a><span class="sd">            Color scale options:</span>
<a id="__codelineno-0-1036" name="__codelineno-0-1036"></a><span class="sd">            ------------------</span>
<a id="__codelineno-0-1037" name="__codelineno-0-1037"></a><span class="sd">            color_scale : str, optional</span>
<a id="__codelineno-0-1038" name="__codelineno-0-1038"></a><span class="sd">                Type of color scaling to use, by default &#39;linear&#39;.</span>
<a id="__codelineno-0-1039" name="__codelineno-0-1039"></a><span class="sd">                Options:</span>
<a id="__codelineno-0-1040" name="__codelineno-0-1040"></a><span class="sd">                - &#39;linear&#39;: Linear scale</span>
<a id="__codelineno-0-1041" name="__codelineno-0-1041"></a><span class="sd">                - &#39;power&#39;: Power-law normalization</span>
<a id="__codelineno-0-1042" name="__codelineno-0-1042"></a><span class="sd">                - &#39;sym-lognorm&#39;: Symmetrical logarithmic scale</span>
<a id="__codelineno-0-1043" name="__codelineno-0-1043"></a><span class="sd">                - &#39;boundary-norm&#39;: Discrete intervals based on boundaries</span>
<a id="__codelineno-0-1044" name="__codelineno-0-1044"></a><span class="sd">                - &#39;midpoint&#39;: Scale split at a specified midpoint</span>
<a id="__codelineno-0-1045" name="__codelineno-0-1045"></a><span class="sd">            gamma : float, optional</span>
<a id="__codelineno-0-1046" name="__codelineno-0-1046"></a><span class="sd">                Exponent for &#39;power&#39; color scale, by default 0.5.</span>
<a id="__codelineno-0-1047" name="__codelineno-0-1047"></a><span class="sd">                Values &lt; 1 emphasize lower values, values &gt; 1 emphasize higher values.</span>
<a id="__codelineno-0-1048" name="__codelineno-0-1048"></a><span class="sd">            line_threshold : float, optional</span>
<a id="__codelineno-0-1049" name="__codelineno-0-1049"></a><span class="sd">                Threshold for &#39;sym-lognorm&#39; color scale, by default 0.0001.</span>
<a id="__codelineno-0-1050" name="__codelineno-0-1050"></a><span class="sd">            line_scale : float, optional</span>
<a id="__codelineno-0-1051" name="__codelineno-0-1051"></a><span class="sd">                Scale factor for &#39;sym-lognorm&#39; color scale, by default 0.001.</span>
<a id="__codelineno-0-1052" name="__codelineno-0-1052"></a><span class="sd">            bounds : List, optional</span>
<a id="__codelineno-0-1053" name="__codelineno-0-1053"></a><span class="sd">                Boundaries for &#39;boundary-norm&#39; color scale, by default None.</span>
<a id="__codelineno-0-1054" name="__codelineno-0-1054"></a><span class="sd">                Defines the discrete intervals for color mapping.</span>
<a id="__codelineno-0-1055" name="__codelineno-0-1055"></a><span class="sd">            midpoint : float, optional</span>
<a id="__codelineno-0-1056" name="__codelineno-0-1056"></a><span class="sd">                Midpoint value for &#39;midpoint&#39; color scale, by default 0.</span>
<a id="__codelineno-0-1057" name="__codelineno-0-1057"></a>
<a id="__codelineno-0-1058" name="__codelineno-0-1058"></a><span class="sd">            Cell value display options:</span>
<a id="__codelineno-0-1059" name="__codelineno-0-1059"></a><span class="sd">            -------------------------</span>
<a id="__codelineno-0-1060" name="__codelineno-0-1060"></a><span class="sd">            display_cell_value : bool, optional</span>
<a id="__codelineno-0-1061" name="__codelineno-0-1061"></a><span class="sd">                Whether to display the values of cells as text, by default False.</span>
<a id="__codelineno-0-1062" name="__codelineno-0-1062"></a><span class="sd">            num_size : int, optional</span>
<a id="__codelineno-0-1063" name="__codelineno-0-1063"></a><span class="sd">                Font size of the cell value text, by default 8.</span>
<a id="__codelineno-0-1064" name="__codelineno-0-1064"></a><span class="sd">            background_color_threshold : float, optional</span>
<a id="__codelineno-0-1065" name="__codelineno-0-1065"></a><span class="sd">                Threshold for cell value text color, by default None.</span>
<a id="__codelineno-0-1066" name="__codelineno-0-1066"></a><span class="sd">                If cell value &gt; threshold, text is black; otherwise, text is white.</span>
<a id="__codelineno-0-1067" name="__codelineno-0-1067"></a><span class="sd">                If None, uses max(array)/2 as the threshold.</span>
<a id="__codelineno-0-1068" name="__codelineno-0-1068"></a>
<a id="__codelineno-0-1069" name="__codelineno-0-1069"></a><span class="sd">        Returns</span>
<a id="__codelineno-0-1070" name="__codelineno-0-1070"></a><span class="sd">        -------</span>
<a id="__codelineno-0-1071" name="__codelineno-0-1071"></a><span class="sd">        Tuple[matplotlib.figure.Figure, matplotlib.axes.Axes]</span>
<a id="__codelineno-0-1072" name="__codelineno-0-1072"></a><span class="sd">            A tuple containing:</span>
<a id="__codelineno-0-1073" name="__codelineno-0-1073"></a><span class="sd">            - fig: The matplotlib Figure object</span>
<a id="__codelineno-0-1074" name="__codelineno-0-1074"></a><span class="sd">            - ax: The matplotlib Axes object</span>
<a id="__codelineno-0-1075" name="__codelineno-0-1075"></a>
<a id="__codelineno-0-1076" name="__codelineno-0-1076"></a><span class="sd">        Raises</span>
<a id="__codelineno-0-1077" name="__codelineno-0-1077"></a><span class="sd">        ------</span>
<a id="__codelineno-0-1078" name="__codelineno-0-1078"></a><span class="sd">        ValueError</span>
<a id="__codelineno-0-1079" name="__codelineno-0-1079"></a><span class="sd">            If an invalid keyword argument is provided.</span>
<a id="__codelineno-0-1080" name="__codelineno-0-1080"></a>
<a id="__codelineno-0-1081" name="__codelineno-0-1081"></a><span class="sd">        Examples</span>
<a id="__codelineno-0-1082" name="__codelineno-0-1082"></a><span class="sd">        --------</span>
<a id="__codelineno-0-1083" name="__codelineno-0-1083"></a><span class="sd">        - Basic array plot:</span>
<a id="__codelineno-0-1084" name="__codelineno-0-1084"></a>
<a id="__codelineno-0-1085" name="__codelineno-0-1085"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-1086" name="__codelineno-0-1086"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-1087" name="__codelineno-0-1087"></a><span class="sd">            &gt;&gt;&gt; from cleopatra.array_glyph import ArrayGlyph</span>
<a id="__codelineno-0-1088" name="__codelineno-0-1088"></a><span class="sd">            &gt;&gt;&gt; arr = np.array([[1, 2, 3], [4, 5, 6], [7, 8, 9]])</span>
<a id="__codelineno-0-1089" name="__codelineno-0-1089"></a><span class="sd">            &gt;&gt;&gt; array = ArrayGlyph(arr, figsize=(6, 6), title=&quot;Customized Plot&quot;, title_size=18)</span>
<a id="__codelineno-0-1090" name="__codelineno-0-1090"></a><span class="sd">            &gt;&gt;&gt; fig, ax = array.plot()</span>
<a id="__codelineno-0-1091" name="__codelineno-0-1091"></a>
<a id="__codelineno-0-1092" name="__codelineno-0-1092"></a><span class="sd">            ```</span>
<a id="__codelineno-0-1093" name="__codelineno-0-1093"></a><span class="sd">        ![array-plot](./../_images/array_glyph/array-plot.png)</span>
<a id="__codelineno-0-1094" name="__codelineno-0-1094"></a>
<a id="__codelineno-0-1095" name="__codelineno-0-1095"></a><span class="sd">        - Color bar customization:</span>
<a id="__codelineno-0-1096" name="__codelineno-0-1096"></a>
<a id="__codelineno-0-1097" name="__codelineno-0-1097"></a><span class="sd">            - Create an array and instantiate the `Array` object with custom options.</span>
<a id="__codelineno-0-1098" name="__codelineno-0-1098"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-1099" name="__codelineno-0-1099"></a><span class="sd">                &gt;&gt;&gt; array = ArrayGlyph(arr, figsize=(6, 6), title=&quot;Customized color bar&quot;, title_size=18)</span>
<a id="__codelineno-0-1100" name="__codelineno-0-1100"></a><span class="sd">                &gt;&gt;&gt; fig, ax = array.plot(</span>
<a id="__codelineno-0-1101" name="__codelineno-0-1101"></a><span class="sd">                ...     cbar_orientation=&quot;horizontal&quot;,</span>
<a id="__codelineno-0-1102" name="__codelineno-0-1102"></a><span class="sd">                ...     cbar_label_rotation=-90,</span>
<a id="__codelineno-0-1103" name="__codelineno-0-1103"></a><span class="sd">                ...     cbar_label_location=&quot;center&quot;,</span>
<a id="__codelineno-0-1104" name="__codelineno-0-1104"></a><span class="sd">                ...     cbar_length=0.7,</span>
<a id="__codelineno-0-1105" name="__codelineno-0-1105"></a><span class="sd">                ...     cbar_label_size=12,</span>
<a id="__codelineno-0-1106" name="__codelineno-0-1106"></a><span class="sd">                ...     cbar_label=&quot;Discharge m3/s&quot;,</span>
<a id="__codelineno-0-1107" name="__codelineno-0-1107"></a><span class="sd">                ...     ticks_spacing=5,</span>
<a id="__codelineno-0-1108" name="__codelineno-0-1108"></a><span class="sd">                ...     color_scale=&quot;linear&quot;,</span>
<a id="__codelineno-0-1109" name="__codelineno-0-1109"></a><span class="sd">                ...     cmap=&quot;coolwarm_r&quot;,</span>
<a id="__codelineno-0-1110" name="__codelineno-0-1110"></a><span class="sd">                ... )</span>
<a id="__codelineno-0-1111" name="__codelineno-0-1111"></a>
<a id="__codelineno-0-1112" name="__codelineno-0-1112"></a><span class="sd">                ```</span>
<a id="__codelineno-0-1113" name="__codelineno-0-1113"></a><span class="sd">                ![color-bar-customization](./../_images/array_glyph/color-bar-customization.png)</span>
<a id="__codelineno-0-1114" name="__codelineno-0-1114"></a>
<a id="__codelineno-0-1115" name="__codelineno-0-1115"></a><span class="sd">        - Display values for each cell:</span>
<a id="__codelineno-0-1116" name="__codelineno-0-1116"></a>
<a id="__codelineno-0-1117" name="__codelineno-0-1117"></a><span class="sd">            - you can display the values for each cell by using thr parameter `display_cell_value`, and customize how</span>
<a id="__codelineno-0-1118" name="__codelineno-0-1118"></a><span class="sd">                the values are displayed using the parameter `background_color_threshold` and `num_size`.</span>
<a id="__codelineno-0-1119" name="__codelineno-0-1119"></a>
<a id="__codelineno-0-1120" name="__codelineno-0-1120"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-1121" name="__codelineno-0-1121"></a><span class="sd">                &gt;&gt;&gt; array = ArrayGlyph(arr, figsize=(6, 6), title=&quot;Display array values&quot;, title_size=18)</span>
<a id="__codelineno-0-1122" name="__codelineno-0-1122"></a><span class="sd">                &gt;&gt;&gt; fig, ax = array.plot(</span>
<a id="__codelineno-0-1123" name="__codelineno-0-1123"></a><span class="sd">                ...     display_cell_value=True,</span>
<a id="__codelineno-0-1124" name="__codelineno-0-1124"></a><span class="sd">                ...     num_size=12</span>
<a id="__codelineno-0-1125" name="__codelineno-0-1125"></a><span class="sd">                ... )</span>
<a id="__codelineno-0-1126" name="__codelineno-0-1126"></a>
<a id="__codelineno-0-1127" name="__codelineno-0-1127"></a><span class="sd">                ```</span>
<a id="__codelineno-0-1128" name="__codelineno-0-1128"></a><span class="sd">                ![display-cell-values](./../_images/array_glyph/display-cell-values.png)</span>
<a id="__codelineno-0-1129" name="__codelineno-0-1129"></a>
<a id="__codelineno-0-1130" name="__codelineno-0-1130"></a><span class="sd">        - Plot points at specific locations in the array:</span>
<a id="__codelineno-0-1131" name="__codelineno-0-1131"></a>
<a id="__codelineno-0-1132" name="__codelineno-0-1132"></a><span class="sd">            - you can display points in specific cells in the array and also display a value for each of these points.</span>
<a id="__codelineno-0-1133" name="__codelineno-0-1133"></a><span class="sd">                The point parameter takes an array with the first column as the values to be displayed on top of the</span>
<a id="__codelineno-0-1134" name="__codelineno-0-1134"></a><span class="sd">                points, the second and third columns are the row and column index of the point in the array.</span>
<a id="__codelineno-0-1135" name="__codelineno-0-1135"></a><span class="sd">            - The `point_color` and `point_size` parameters are used to customize the appearance of the points,</span>
<a id="__codelineno-0-1136" name="__codelineno-0-1136"></a><span class="sd">                while the `pid_color` and `pid_size` parameters are used to customize the appearance of the point</span>
<a id="__codelineno-0-1137" name="__codelineno-0-1137"></a><span class="sd">                IDs/text.</span>
<a id="__codelineno-0-1138" name="__codelineno-0-1138"></a>
<a id="__codelineno-0-1139" name="__codelineno-0-1139"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-1140" name="__codelineno-0-1140"></a><span class="sd">                &gt;&gt;&gt; array = ArrayGlyph(arr, figsize=(6, 6), title=&quot;Display Points&quot;, title_size=14)</span>
<a id="__codelineno-0-1141" name="__codelineno-0-1141"></a><span class="sd">                &gt;&gt;&gt; points = np.array([[1, 0, 0], [2, 1, 1], [3, 2, 2]])</span>
<a id="__codelineno-0-1142" name="__codelineno-0-1142"></a><span class="sd">                &gt;&gt;&gt; fig, ax = array.plot(</span>
<a id="__codelineno-0-1143" name="__codelineno-0-1143"></a><span class="sd">                ...     points=points,</span>
<a id="__codelineno-0-1144" name="__codelineno-0-1144"></a><span class="sd">                ...     point_color=&quot;black&quot;,</span>
<a id="__codelineno-0-1145" name="__codelineno-0-1145"></a><span class="sd">                ...     point_size=100,</span>
<a id="__codelineno-0-1146" name="__codelineno-0-1146"></a><span class="sd">                ...     pid_color=&quot;orange&quot;,</span>
<a id="__codelineno-0-1147" name="__codelineno-0-1147"></a><span class="sd">                ...     pid_size=30,</span>
<a id="__codelineno-0-1148" name="__codelineno-0-1148"></a><span class="sd">                ... )</span>
<a id="__codelineno-0-1149" name="__codelineno-0-1149"></a>
<a id="__codelineno-0-1150" name="__codelineno-0-1150"></a><span class="sd">                ```</span>
<a id="__codelineno-0-1151" name="__codelineno-0-1151"></a><span class="sd">                ![display-points](./../_images/array_glyph/display-points.png)</span>
<a id="__codelineno-0-1152" name="__codelineno-0-1152"></a>
<a id="__codelineno-0-1153" name="__codelineno-0-1153"></a><span class="sd">        - Color scale customization:</span>
<a id="__codelineno-0-1154" name="__codelineno-0-1154"></a>
<a id="__codelineno-0-1155" name="__codelineno-0-1155"></a><span class="sd">            - Power scale (with different gamma values).</span>
<a id="__codelineno-0-1156" name="__codelineno-0-1156"></a>
<a id="__codelineno-0-1157" name="__codelineno-0-1157"></a><span class="sd">                - The default power scale uses a gamma value of 0.5.</span>
<a id="__codelineno-0-1158" name="__codelineno-0-1158"></a>
<a id="__codelineno-0-1159" name="__codelineno-0-1159"></a><span class="sd">                    ```python</span>
<a id="__codelineno-0-1160" name="__codelineno-0-1160"></a><span class="sd">                    &gt;&gt;&gt; array = ArrayGlyph(arr, figsize=(6, 6), title=&quot;Power scale&quot;, title_size=18)</span>
<a id="__codelineno-0-1161" name="__codelineno-0-1161"></a><span class="sd">                    &gt;&gt;&gt; fig, ax = array.plot(</span>
<a id="__codelineno-0-1162" name="__codelineno-0-1162"></a><span class="sd">                    ...     cbar_label=&quot;Discharge m3/s&quot;,</span>
<a id="__codelineno-0-1163" name="__codelineno-0-1163"></a><span class="sd">                    ...     color_scale=&quot;power&quot;,</span>
<a id="__codelineno-0-1164" name="__codelineno-0-1164"></a><span class="sd">                    ...     cmap=&quot;coolwarm_r&quot;,</span>
<a id="__codelineno-0-1165" name="__codelineno-0-1165"></a><span class="sd">                    ...     cbar_label_rotation=-90,</span>
<a id="__codelineno-0-1166" name="__codelineno-0-1166"></a><span class="sd">                    ... )</span>
<a id="__codelineno-0-1167" name="__codelineno-0-1167"></a>
<a id="__codelineno-0-1168" name="__codelineno-0-1168"></a><span class="sd">                    ```</span>
<a id="__codelineno-0-1169" name="__codelineno-0-1169"></a><span class="sd">                    ![power-scale](./../_images/array_glyph/power-scale.png)</span>
<a id="__codelineno-0-1170" name="__codelineno-0-1170"></a>
<a id="__codelineno-0-1171" name="__codelineno-0-1171"></a><span class="sd">                - change the gamma of 0.8 (emphasizes higher values less).</span>
<a id="__codelineno-0-1172" name="__codelineno-0-1172"></a>
<a id="__codelineno-0-1173" name="__codelineno-0-1173"></a><span class="sd">                    ```python</span>
<a id="__codelineno-0-1174" name="__codelineno-0-1174"></a><span class="sd">                    &gt;&gt;&gt; fig, ax = array.plot(</span>
<a id="__codelineno-0-1175" name="__codelineno-0-1175"></a><span class="sd">                    ...     color_scale=&quot;power&quot;,</span>
<a id="__codelineno-0-1176" name="__codelineno-0-1176"></a><span class="sd">                    ...     gamma=0.8,</span>
<a id="__codelineno-0-1177" name="__codelineno-0-1177"></a><span class="sd">                    ...     cmap=&quot;coolwarm_r&quot;,</span>
<a id="__codelineno-0-1178" name="__codelineno-0-1178"></a><span class="sd">                    ...     cbar_label_rotation=-90,</span>
<a id="__codelineno-0-1179" name="__codelineno-0-1179"></a><span class="sd">                    ...     cbar_label=&quot;Discharge m3/s&quot;,</span>
<a id="__codelineno-0-1180" name="__codelineno-0-1180"></a><span class="sd">                    ... )</span>
<a id="__codelineno-0-1181" name="__codelineno-0-1181"></a>
<a id="__codelineno-0-1182" name="__codelineno-0-1182"></a><span class="sd">                    ```</span>
<a id="__codelineno-0-1183" name="__codelineno-0-1183"></a><span class="sd">                    ![power-scale-gamma-0.8](./../_images/array_glyph/power-scale-gamma-0.8.png)</span>
<a id="__codelineno-0-1184" name="__codelineno-0-1184"></a>
<a id="__codelineno-0-1185" name="__codelineno-0-1185"></a><span class="sd">                - change the gamma of 0.1 (emphasizes higher values more).</span>
<a id="__codelineno-0-1186" name="__codelineno-0-1186"></a>
<a id="__codelineno-0-1187" name="__codelineno-0-1187"></a><span class="sd">                    ```python</span>
<a id="__codelineno-0-1188" name="__codelineno-0-1188"></a><span class="sd">                    &gt;&gt;&gt; fig, ax = array.plot(</span>
<a id="__codelineno-0-1189" name="__codelineno-0-1189"></a><span class="sd">                    ...     color_scale=&quot;power&quot;,</span>
<a id="__codelineno-0-1190" name="__codelineno-0-1190"></a><span class="sd">                    ...     gamma=0.1,</span>
<a id="__codelineno-0-1191" name="__codelineno-0-1191"></a><span class="sd">                    ...     cmap=&quot;coolwarm_r&quot;,</span>
<a id="__codelineno-0-1192" name="__codelineno-0-1192"></a><span class="sd">                    ...     cbar_label_rotation=-90,</span>
<a id="__codelineno-0-1193" name="__codelineno-0-1193"></a><span class="sd">                    ...     cbar_label=&quot;Discharge m3/s&quot;,</span>
<a id="__codelineno-0-1194" name="__codelineno-0-1194"></a><span class="sd">                    ... )</span>
<a id="__codelineno-0-1195" name="__codelineno-0-1195"></a>
<a id="__codelineno-0-1196" name="__codelineno-0-1196"></a><span class="sd">                    ```</span>
<a id="__codelineno-0-1197" name="__codelineno-0-1197"></a><span class="sd">                    ![power-scale-gamma-0.1](./../_images/array_glyph/power-scale-gamma-0.1.png)</span>
<a id="__codelineno-0-1198" name="__codelineno-0-1198"></a>
<a id="__codelineno-0-1199" name="__codelineno-0-1199"></a><span class="sd">            - Logarithmic scale.</span>
<a id="__codelineno-0-1200" name="__codelineno-0-1200"></a>
<a id="__codelineno-0-1201" name="__codelineno-0-1201"></a><span class="sd">                - the logarithmic scale uses to parameters `line_threshold` and `line_scale` with a default</span>
<a id="__codelineno-0-1202" name="__codelineno-0-1202"></a><span class="sd">                value if 0.0001, and 0.001 respectively.</span>
<a id="__codelineno-0-1203" name="__codelineno-0-1203"></a><span class="sd">                    ```python</span>
<a id="__codelineno-0-1204" name="__codelineno-0-1204"></a><span class="sd">                    &gt;&gt;&gt; fig, ax = array.plot(</span>
<a id="__codelineno-0-1205" name="__codelineno-0-1205"></a><span class="sd">                    ...     cbar_label=&quot;Discharge m3/s&quot;,</span>
<a id="__codelineno-0-1206" name="__codelineno-0-1206"></a><span class="sd">                    ...     color_scale=&quot;sym-lognorm&quot;,</span>
<a id="__codelineno-0-1207" name="__codelineno-0-1207"></a><span class="sd">                    ...     cmap=&quot;coolwarm_r&quot;,</span>
<a id="__codelineno-0-1208" name="__codelineno-0-1208"></a><span class="sd">                    ...     cbar_label_rotation=-90,</span>
<a id="__codelineno-0-1209" name="__codelineno-0-1209"></a><span class="sd">                    ... )</span>
<a id="__codelineno-0-1210" name="__codelineno-0-1210"></a>
<a id="__codelineno-0-1211" name="__codelineno-0-1211"></a><span class="sd">                    ```</span>
<a id="__codelineno-0-1212" name="__codelineno-0-1212"></a><span class="sd">                    ![log-scale](./../_images/array_glyph/log-scale.png)</span>
<a id="__codelineno-0-1213" name="__codelineno-0-1213"></a>
<a id="__codelineno-0-1214" name="__codelineno-0-1214"></a><span class="sd">                - you can change the `line_threshold` and `line_scale` values.</span>
<a id="__codelineno-0-1215" name="__codelineno-0-1215"></a><span class="sd">                    ```python</span>
<a id="__codelineno-0-1216" name="__codelineno-0-1216"></a><span class="sd">                    &gt;&gt;&gt; array = ArrayGlyph(</span>
<a id="__codelineno-0-1217" name="__codelineno-0-1217"></a><span class="sd">                    ...     arr, figsize=(6, 6), title=&quot;Logarithmic scale: Customized Parameter&quot;, title_size=12</span>
<a id="__codelineno-0-1218" name="__codelineno-0-1218"></a><span class="sd">                    ... )</span>
<a id="__codelineno-0-1219" name="__codelineno-0-1219"></a><span class="sd">                    &gt;&gt;&gt; fig, ax = array.plot(</span>
<a id="__codelineno-0-1220" name="__codelineno-0-1220"></a><span class="sd">                    ...     cbar_label_rotation=-90,</span>
<a id="__codelineno-0-1221" name="__codelineno-0-1221"></a><span class="sd">                    ...     cbar_label=&quot;Discharge m3/s&quot;,</span>
<a id="__codelineno-0-1222" name="__codelineno-0-1222"></a><span class="sd">                    ...     color_scale=&quot;sym-lognorm&quot;,</span>
<a id="__codelineno-0-1223" name="__codelineno-0-1223"></a><span class="sd">                    ...     cmap=&quot;coolwarm_r&quot;,</span>
<a id="__codelineno-0-1224" name="__codelineno-0-1224"></a><span class="sd">                    ...     line_threshold=0.015,</span>
<a id="__codelineno-0-1225" name="__codelineno-0-1225"></a><span class="sd">                    ...     line_scale=0.1,</span>
<a id="__codelineno-0-1226" name="__codelineno-0-1226"></a><span class="sd">                    ... )</span>
<a id="__codelineno-0-1227" name="__codelineno-0-1227"></a>
<a id="__codelineno-0-1228" name="__codelineno-0-1228"></a><span class="sd">                    ```</span>
<a id="__codelineno-0-1229" name="__codelineno-0-1229"></a><span class="sd">                    ![log-scale](./../_images/array_glyph/log-scale-custom-parameters.png)</span>
<a id="__codelineno-0-1230" name="__codelineno-0-1230"></a>
<a id="__codelineno-0-1231" name="__codelineno-0-1231"></a><span class="sd">            - Defined boundary scale.</span>
<a id="__codelineno-0-1232" name="__codelineno-0-1232"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-1233" name="__codelineno-0-1233"></a><span class="sd">                &gt;&gt;&gt; array = ArrayGlyph(arr, figsize=(6, 6), title=&quot;Defined boundary scale&quot;, title_size=18)</span>
<a id="__codelineno-0-1234" name="__codelineno-0-1234"></a><span class="sd">                &gt;&gt;&gt; fig, ax = array.plot(</span>
<a id="__codelineno-0-1235" name="__codelineno-0-1235"></a><span class="sd">                ...     cbar_label_rotation=-90,</span>
<a id="__codelineno-0-1236" name="__codelineno-0-1236"></a><span class="sd">                ...     cbar_label=&quot;Discharge m3/s&quot;,</span>
<a id="__codelineno-0-1237" name="__codelineno-0-1237"></a><span class="sd">                ...     color_scale=&quot;boundary-norm&quot;,</span>
<a id="__codelineno-0-1238" name="__codelineno-0-1238"></a><span class="sd">                ...     cmap=&quot;coolwarm_r&quot;,</span>
<a id="__codelineno-0-1239" name="__codelineno-0-1239"></a><span class="sd">                ... )</span>
<a id="__codelineno-0-1240" name="__codelineno-0-1240"></a>
<a id="__codelineno-0-1241" name="__codelineno-0-1241"></a><span class="sd">                ```</span>
<a id="__codelineno-0-1242" name="__codelineno-0-1242"></a><span class="sd">                ![boundary-scale](./../_images/array_glyph/boundary-scale.png)</span>
<a id="__codelineno-0-1243" name="__codelineno-0-1243"></a>
<a id="__codelineno-0-1244" name="__codelineno-0-1244"></a><span class="sd">                - You can also define the boundaries.</span>
<a id="__codelineno-0-1245" name="__codelineno-0-1245"></a><span class="sd">                    ```python</span>
<a id="__codelineno-0-1246" name="__codelineno-0-1246"></a><span class="sd">                    &gt;&gt;&gt; array = ArrayGlyph(</span>
<a id="__codelineno-0-1247" name="__codelineno-0-1247"></a><span class="sd">                    ...     arr, figsize=(6, 6), title=&quot;Defined boundary scale: defined bounds&quot;, title_size=18</span>
<a id="__codelineno-0-1248" name="__codelineno-0-1248"></a><span class="sd">                    ... )</span>
<a id="__codelineno-0-1249" name="__codelineno-0-1249"></a><span class="sd">                    &gt;&gt;&gt; bounds = [0, 5, 10]</span>
<a id="__codelineno-0-1250" name="__codelineno-0-1250"></a><span class="sd">                    &gt;&gt;&gt; fig, ax = array.plot(</span>
<a id="__codelineno-0-1251" name="__codelineno-0-1251"></a><span class="sd">                    ...     cbar_label_rotation=-90,</span>
<a id="__codelineno-0-1252" name="__codelineno-0-1252"></a><span class="sd">                    ...     cbar_label=&quot;Discharge m3/s&quot;,</span>
<a id="__codelineno-0-1253" name="__codelineno-0-1253"></a><span class="sd">                    ...     color_scale=&quot;boundary-norm&quot;,</span>
<a id="__codelineno-0-1254" name="__codelineno-0-1254"></a><span class="sd">                    ...     bounds=bounds,</span>
<a id="__codelineno-0-1255" name="__codelineno-0-1255"></a><span class="sd">                    ...     cmap=&quot;coolwarm_r&quot;,</span>
<a id="__codelineno-0-1256" name="__codelineno-0-1256"></a><span class="sd">                    ... )</span>
<a id="__codelineno-0-1257" name="__codelineno-0-1257"></a>
<a id="__codelineno-0-1258" name="__codelineno-0-1258"></a><span class="sd">                    ```</span>
<a id="__codelineno-0-1259" name="__codelineno-0-1259"></a><span class="sd">                    ![boundary-scale-defined-bounds](./../_images/array_glyph/boundary-scale-defined-bounds.png)</span>
<a id="__codelineno-0-1260" name="__codelineno-0-1260"></a>
<a id="__codelineno-0-1261" name="__codelineno-0-1261"></a><span class="sd">            - Midpoint scale.</span>
<a id="__codelineno-0-1262" name="__codelineno-0-1262"></a>
<a id="__codelineno-0-1263" name="__codelineno-0-1263"></a><span class="sd">                in the midpoint scale you can define a value that splits the scale into half.</span>
<a id="__codelineno-0-1264" name="__codelineno-0-1264"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-1265" name="__codelineno-0-1265"></a><span class="sd">                &gt;&gt;&gt; array = ArrayGlyph(arr, figsize=(6, 6), title=&quot;Midpoint scale&quot;, title_size=18)</span>
<a id="__codelineno-0-1266" name="__codelineno-0-1266"></a><span class="sd">                &gt;&gt;&gt; fig, ax = array.plot(</span>
<a id="__codelineno-0-1267" name="__codelineno-0-1267"></a><span class="sd">                ...     cbar_label_rotation=-90,</span>
<a id="__codelineno-0-1268" name="__codelineno-0-1268"></a><span class="sd">                ...     cbar_label=&quot;Discharge m3/s&quot;,</span>
<a id="__codelineno-0-1269" name="__codelineno-0-1269"></a><span class="sd">                ...     color_scale=&quot;midpoint&quot;,</span>
<a id="__codelineno-0-1270" name="__codelineno-0-1270"></a><span class="sd">                ...     cmap=&quot;coolwarm_r&quot;,</span>
<a id="__codelineno-0-1271" name="__codelineno-0-1271"></a><span class="sd">                ...     midpoint=2,</span>
<a id="__codelineno-0-1272" name="__codelineno-0-1272"></a><span class="sd">                ... )</span>
<a id="__codelineno-0-1273" name="__codelineno-0-1273"></a>
<a id="__codelineno-0-1274" name="__codelineno-0-1274"></a><span class="sd">                ```</span>
<a id="__codelineno-0-1275" name="__codelineno-0-1275"></a><span class="sd">                ![midpoint-scale-costom-parameters](./../_images/array_glyph/midpoint-scale-costom-parameters.png)</span>
<a id="__codelineno-0-1276" name="__codelineno-0-1276"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1277" name="__codelineno-0-1277"></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-1278" name="__codelineno-0-1278"></a>            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-1279" name="__codelineno-0-1279"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1280" name="__codelineno-0-1280"></a>                    <span class="sa">f</span><span class="s2">&quot;The given keyword argument:</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> is not correct, possible parameters are,&quot;</span>
<a id="__codelineno-0-1281" name="__codelineno-0-1281"></a>                    <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">DEFAULT_OPTIONS</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-1282" name="__codelineno-0-1282"></a>                <span class="p">)</span>
<a id="__codelineno-0-1283" name="__codelineno-0-1283"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1284" name="__codelineno-0-1284"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
<a id="__codelineno-0-1285" name="__codelineno-0-1285"></a>
<a id="__codelineno-0-1286" name="__codelineno-0-1286"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1287" name="__codelineno-0-1287"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_figure_axes</span><span class="p">()</span>
<a id="__codelineno-0-1288" name="__codelineno-0-1288"></a>
<a id="__codelineno-0-1289" name="__codelineno-0-1289"></a>        <span class="n">arr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr</span>
<a id="__codelineno-0-1290" name="__codelineno-0-1290"></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span>
<a id="__codelineno-0-1291" name="__codelineno-0-1291"></a>
<a id="__codelineno-0-1292" name="__codelineno-0-1292"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span><span class="p">:</span>
<a id="__codelineno-0-1293" name="__codelineno-0-1293"></a>            <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extent</span><span class="p">)</span>
<a id="__codelineno-0-1294" name="__codelineno-0-1294"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1295" name="__codelineno-0-1295"></a>            <span class="c1"># if user did not input ticks spacing use the calculated one.</span>
<a id="__codelineno-0-1296" name="__codelineno-0-1296"></a>            <span class="k">if</span> <span class="s2">&quot;ticks_spacing&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-1297" name="__codelineno-0-1297"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;ticks_spacing&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;ticks_spacing&quot;</span><span class="p">]</span>
<a id="__codelineno-0-1298" name="__codelineno-0-1298"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1299" name="__codelineno-0-1299"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;ticks_spacing&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ticks_spacing</span>
<a id="__codelineno-0-1300" name="__codelineno-0-1300"></a>
<a id="__codelineno-0-1301" name="__codelineno-0-1301"></a>            <span class="k">if</span> <span class="s2">&quot;vmin&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-1302" name="__codelineno-0-1302"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;vmin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;vmin&quot;</span><span class="p">]</span>
<a id="__codelineno-0-1303" name="__codelineno-0-1303"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1304" name="__codelineno-0-1304"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;vmin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmin</span>
<a id="__codelineno-0-1305" name="__codelineno-0-1305"></a>
<a id="__codelineno-0-1306" name="__codelineno-0-1306"></a>            <span class="k">if</span> <span class="s2">&quot;vmax&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-1307" name="__codelineno-0-1307"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;vmax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;vmax&quot;</span><span class="p">]</span>
<a id="__codelineno-0-1308" name="__codelineno-0-1308"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1309" name="__codelineno-0-1309"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;vmax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmax</span>
<a id="__codelineno-0-1310" name="__codelineno-0-1310"></a>
<a id="__codelineno-0-1311" name="__codelineno-0-1311"></a>            <span class="c1"># creating the ticks/bounds</span>
<a id="__codelineno-0-1312" name="__codelineno-0-1312"></a>            <span class="n">ticks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-0-1313" name="__codelineno-0-1313"></a>            <span class="n">im</span><span class="p">,</span> <span class="n">cbar_kw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_im_get_cbar_kw</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="n">ticks</span><span class="p">)</span>
<a id="__codelineno-0-1314" name="__codelineno-0-1314"></a>
<a id="__codelineno-0-1315" name="__codelineno-0-1315"></a>            <span class="c1"># Create colorbar</span>
<a id="__codelineno-0-1316" name="__codelineno-0-1316"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">create_color_bar</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">im</span><span class="p">,</span> <span class="n">cbar_kw</span><span class="p">)</span>
<a id="__codelineno-0-1317" name="__codelineno-0-1317"></a>
<a id="__codelineno-0-1318" name="__codelineno-0-1318"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
<a id="__codelineno-0-1319" name="__codelineno-0-1319"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;title_size&quot;</span><span class="p">]</span>
<a id="__codelineno-0-1320" name="__codelineno-0-1320"></a>        <span class="p">)</span>
<a id="__codelineno-0-1321" name="__codelineno-0-1321"></a>
<a id="__codelineno-0-1322" name="__codelineno-0-1322"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1323" name="__codelineno-0-1323"></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
<a id="__codelineno-0-1324" name="__codelineno-0-1324"></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
<a id="__codelineno-0-1325" name="__codelineno-0-1325"></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
<a id="__codelineno-0-1326" name="__codelineno-0-1326"></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
<a id="__codelineno-0-1327" name="__codelineno-0-1327"></a>
<a id="__codelineno-0-1328" name="__codelineno-0-1328"></a>        <span class="n">optional_display</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1329" name="__codelineno-0-1329"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;display_cell_value&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-1330" name="__codelineno-0-1330"></a>            <span class="n">indices</span> <span class="o">=</span> <span class="n">get_indices2</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
<a id="__codelineno-0-1331" name="__codelineno-0-1331"></a>            <span class="n">optional_display</span><span class="p">[</span><span class="s2">&quot;cell_text_value&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_text</span><span class="p">(</span>
<a id="__codelineno-0-1332" name="__codelineno-0-1332"></a>                <span class="n">ax</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span>
<a id="__codelineno-0-1333" name="__codelineno-0-1333"></a>            <span class="p">)</span>
<a id="__codelineno-0-1334" name="__codelineno-0-1334"></a>
<a id="__codelineno-0-1335" name="__codelineno-0-1335"></a>        <span class="k">if</span> <span class="n">points</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1336" name="__codelineno-0-1336"></a>            <span class="n">row</span> <span class="o">=</span> <span class="n">points</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-1337" name="__codelineno-0-1337"></a>            <span class="n">col</span> <span class="o">=</span> <span class="n">points</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-1338" name="__codelineno-0-1338"></a>            <span class="n">optional_display</span><span class="p">[</span><span class="s2">&quot;points_scatter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
<a id="__codelineno-0-1339" name="__codelineno-0-1339"></a>                <span class="n">col</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">point_color</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">point_size</span>
<a id="__codelineno-0-1340" name="__codelineno-0-1340"></a>            <span class="p">)</span>
<a id="__codelineno-0-1341" name="__codelineno-0-1341"></a>            <span class="n">optional_display</span><span class="p">[</span><span class="s2">&quot;points_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_point_values</span><span class="p">(</span>
<a id="__codelineno-0-1342" name="__codelineno-0-1342"></a>                <span class="n">ax</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">pid_color</span><span class="p">,</span> <span class="n">pid_size</span>
<a id="__codelineno-0-1343" name="__codelineno-0-1343"></a>            <span class="p">)</span>
<a id="__codelineno-0-1344" name="__codelineno-0-1344"></a>
<a id="__codelineno-0-1345" name="__codelineno-0-1345"></a>        <span class="c1"># # Normalize the threshold to the image color range.</span>
<a id="__codelineno-0-1346" name="__codelineno-0-1346"></a>        <span class="c1"># if self.default_options[&quot;background_color_threshold&quot;] is not None:</span>
<a id="__codelineno-0-1347" name="__codelineno-0-1347"></a>        <span class="c1">#     im.norm(self.default_options[&quot;background_color_threshold&quot;])</span>
<a id="__codelineno-0-1348" name="__codelineno-0-1348"></a>        <span class="c1"># else:</span>
<a id="__codelineno-0-1349" name="__codelineno-0-1349"></a>        <span class="c1">#     im.norm(self.vmax) / 2.0</span>
<a id="__codelineno-0-1350" name="__codelineno-0-1350"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a id="__codelineno-0-1351" name="__codelineno-0-1351"></a>        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
<a id="__codelineno-0-1352" name="__codelineno-0-1352"></a>
<a id="__codelineno-0-1353" name="__codelineno-0-1353"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">adjust_ticks</span><span class="p">(</span>
<a id="__codelineno-0-1354" name="__codelineno-0-1354"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1355" name="__codelineno-0-1355"></a>        <span class="n">axis</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-1356" name="__codelineno-0-1356"></a>        <span class="n">multiply_value</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-1357" name="__codelineno-0-1357"></a>        <span class="n">add_value</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-1358" name="__codelineno-0-1358"></a>        <span class="n">fmt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0:g}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1359" name="__codelineno-0-1359"></a>        <span class="n">visible</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1360" name="__codelineno-0-1360"></a>    <span class="p">):</span>
<a id="__codelineno-0-1361" name="__codelineno-0-1361"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Adjust the ticks of the axes.</span>
<a id="__codelineno-0-1362" name="__codelineno-0-1362"></a>
<a id="__codelineno-0-1363" name="__codelineno-0-1363"></a><span class="sd">        Parameters</span>
<a id="__codelineno-0-1364" name="__codelineno-0-1364"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-1365" name="__codelineno-0-1365"></a><span class="sd">        axis: str</span>
<a id="__codelineno-0-1366" name="__codelineno-0-1366"></a><span class="sd">            x or y.</span>
<a id="__codelineno-0-1367" name="__codelineno-0-1367"></a><span class="sd">        multiply_value: Union[float, int]</span>
<a id="__codelineno-0-1368" name="__codelineno-0-1368"></a><span class="sd">            value to be multiplied.</span>
<a id="__codelineno-0-1369" name="__codelineno-0-1369"></a><span class="sd">        add_value: Union[float, int]</span>
<a id="__codelineno-0-1370" name="__codelineno-0-1370"></a><span class="sd">            value to be added.</span>
<a id="__codelineno-0-1371" name="__codelineno-0-1371"></a><span class="sd">        fmt: str, default is &quot;{0:g}&quot;.</span>
<a id="__codelineno-0-1372" name="__codelineno-0-1372"></a><span class="sd">            format of the ticks.</span>
<a id="__codelineno-0-1373" name="__codelineno-0-1373"></a><span class="sd">            - 123.456 with the format &quot;{0:f}&quot; will give &#39;123.456000&#39;.</span>
<a id="__codelineno-0-1374" name="__codelineno-0-1374"></a><span class="sd">            - 123.456 with the format &quot;{0:.2f}&quot; will give &#39;123.46&#39;.</span>
<a id="__codelineno-0-1375" name="__codelineno-0-1375"></a><span class="sd">            - 123456.789 with the format &quot;{0:e}&quot; will give &#39;1.234568e+05&#39;.</span>
<a id="__codelineno-0-1376" name="__codelineno-0-1376"></a><span class="sd">            - 123456.789 with the format &quot;{0:.2e}&quot; will give &#39;1.23e+05&#39;.</span>
<a id="__codelineno-0-1377" name="__codelineno-0-1377"></a><span class="sd">            - 123456.789 with the format &quot;{0:g}&quot; will give &#39;123457&#39;.</span>
<a id="__codelineno-0-1378" name="__codelineno-0-1378"></a><span class="sd">            - 123456.789 with the format &quot;{0:.2g}&quot; will give &#39;1.2e+05&#39;.</span>
<a id="__codelineno-0-1379" name="__codelineno-0-1379"></a><span class="sd">            - 123 with the format &quot;{0:d}&quot; will give &#39;123&#39;.</span>
<a id="__codelineno-0-1380" name="__codelineno-0-1380"></a><span class="sd">         visible: bool, optional, default is True.</span>
<a id="__codelineno-0-1381" name="__codelineno-0-1381"></a><span class="sd">            Whether the ticks are visible or not.</span>
<a id="__codelineno-0-1382" name="__codelineno-0-1382"></a>
<a id="__codelineno-0-1383" name="__codelineno-0-1383"></a><span class="sd">        Returns</span>
<a id="__codelineno-0-1384" name="__codelineno-0-1384"></a><span class="sd">        -------</span>
<a id="__codelineno-0-1385" name="__codelineno-0-1385"></a><span class="sd">        None</span>
<a id="__codelineno-0-1386" name="__codelineno-0-1386"></a>
<a id="__codelineno-0-1387" name="__codelineno-0-1387"></a><span class="sd">        Examples</span>
<a id="__codelineno-0-1388" name="__codelineno-0-1388"></a><span class="sd">        --------</span>
<a id="__codelineno-0-1389" name="__codelineno-0-1389"></a><span class="sd">        - Create an array and instantiate the `ArrayGlyph` object:</span>
<a id="__codelineno-0-1390" name="__codelineno-0-1390"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-1391" name="__codelineno-0-1391"></a><span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-1392" name="__codelineno-0-1392"></a><span class="sd">            &gt;&gt;&gt; arr = np.array([[1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 11, 12], [13, 14, 15, 16]])</span>
<a id="__codelineno-0-1393" name="__codelineno-0-1393"></a><span class="sd">            &gt;&gt;&gt; extent = [34.62, 34.65, 31.82, 31.85]</span>
<a id="__codelineno-0-1394" name="__codelineno-0-1394"></a><span class="sd">            &gt;&gt;&gt; my_glyph = ArrayGlyph(arr, extent=extent)</span>
<a id="__codelineno-0-1395" name="__codelineno-0-1395"></a><span class="sd">            &gt;&gt;&gt; fig, ax = my_glyph.plot()</span>
<a id="__codelineno-0-1396" name="__codelineno-0-1396"></a>
<a id="__codelineno-0-1397" name="__codelineno-0-1397"></a><span class="sd">            ```</span>
<a id="__codelineno-0-1398" name="__codelineno-0-1398"></a><span class="sd">            ![adjust_tick](./../_images/array_glyph/adjust_tick.png)</span>
<a id="__codelineno-0-1399" name="__codelineno-0-1399"></a>
<a id="__codelineno-0-1400" name="__codelineno-0-1400"></a><span class="sd">        - Adjust the ticks of the x-axis:</span>
<a id="__codelineno-0-1401" name="__codelineno-0-1401"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-1402" name="__codelineno-0-1402"></a><span class="sd">            &gt;&gt;&gt; my_glyph.adjust_ticks(axis=&#39;x&#39;, multiply_value=0.01, add_value=34.62, fmt=&quot;{0:.2f}&quot;)</span>
<a id="__codelineno-0-1403" name="__codelineno-0-1403"></a>
<a id="__codelineno-0-1404" name="__codelineno-0-1404"></a><span class="sd">            ```</span>
<a id="__codelineno-0-1405" name="__codelineno-0-1405"></a><span class="sd">            ![adjust_tick](./../_images/array_glyph/adjust_tick-x.png)</span>
<a id="__codelineno-0-1406" name="__codelineno-0-1406"></a>
<a id="__codelineno-0-1407" name="__codelineno-0-1407"></a><span class="sd">        - Adjust the ticks of the y-axis:</span>
<a id="__codelineno-0-1408" name="__codelineno-0-1408"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-1409" name="__codelineno-0-1409"></a><span class="sd">            &gt;&gt;&gt; my_glyph.adjust_ticks(axis=&#39;y&#39;, multiply_value=0.01, add_value=31.82, fmt=&quot;{0:.2e}&quot;)</span>
<a id="__codelineno-0-1410" name="__codelineno-0-1410"></a>
<a id="__codelineno-0-1411" name="__codelineno-0-1411"></a><span class="sd">            ```</span>
<a id="__codelineno-0-1412" name="__codelineno-0-1412"></a><span class="sd">            ![adjust_tick-y](./../_images/array_glyph/adjust_tick-y.png)</span>
<a id="__codelineno-0-1413" name="__codelineno-0-1413"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1414" name="__codelineno-0-1414"></a>        <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1415" name="__codelineno-0-1415"></a>            <span class="n">ticks_x</span> <span class="o">=</span> <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span>
<a id="__codelineno-0-1416" name="__codelineno-0-1416"></a>                <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">multiply_value</span> <span class="o">+</span> <span class="n">add_value</span><span class="p">)</span>
<a id="__codelineno-0-1417" name="__codelineno-0-1417"></a>            <span class="p">)</span>
<a id="__codelineno-0-1418" name="__codelineno-0-1418"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">ticks_x</span><span class="p">)</span>
<a id="__codelineno-0-1419" name="__codelineno-0-1419"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1420" name="__codelineno-0-1420"></a>            <span class="n">ticks_y</span> <span class="o">=</span> <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span>
<a id="__codelineno-0-1421" name="__codelineno-0-1421"></a>                <span class="k">lambda</span> <span class="n">y</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">y</span> <span class="o">*</span> <span class="n">multiply_value</span> <span class="o">+</span> <span class="n">add_value</span><span class="p">)</span>
<a id="__codelineno-0-1422" name="__codelineno-0-1422"></a>            <span class="p">)</span>
<a id="__codelineno-0-1423" name="__codelineno-0-1423"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">ticks_y</span><span class="p">)</span>
<a id="__codelineno-0-1424" name="__codelineno-0-1424"></a>
<a id="__codelineno-0-1425" name="__codelineno-0-1425"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">visible</span><span class="p">:</span>
<a id="__codelineno-0-1426" name="__codelineno-0-1426"></a>            <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1427" name="__codelineno-0-1427"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="n">visible</span><span class="p">)</span>
<a id="__codelineno-0-1428" name="__codelineno-0-1428"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1429" name="__codelineno-0-1429"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="n">visible</span><span class="p">)</span>
<a id="__codelineno-0-1430" name="__codelineno-0-1430"></a>
<a id="__codelineno-0-1431" name="__codelineno-0-1431"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a id="__codelineno-0-1432" name="__codelineno-0-1432"></a>
<a id="__codelineno-0-1433" name="__codelineno-0-1433"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">animate</span><span class="p">(</span>
<a id="__codelineno-0-1434" name="__codelineno-0-1434"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1435" name="__codelineno-0-1435"></a>        <span class="n">time</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span>
<a id="__codelineno-0-1436" name="__codelineno-0-1436"></a>        <span class="n">points</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1437" name="__codelineno-0-1437"></a>        <span class="n">text_colors</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="s2">&quot;black&quot;</span><span class="p">),</span>
<a id="__codelineno-0-1438" name="__codelineno-0-1438"></a>        <span class="n">interval</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
<a id="__codelineno-0-1439" name="__codelineno-0-1439"></a>        <span class="n">text_loc</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1440" name="__codelineno-0-1440"></a>        <span class="n">point_color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1441" name="__codelineno-0-1441"></a>        <span class="n">point_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<a id="__codelineno-0-1442" name="__codelineno-0-1442"></a>        <span class="n">pid_color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1443" name="__codelineno-0-1443"></a>        <span class="n">pid_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<a id="__codelineno-0-1444" name="__codelineno-0-1444"></a>        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-1445" name="__codelineno-0-1445"></a>    <span class="p">):</span>
<a id="__codelineno-0-1446" name="__codelineno-0-1446"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create an animation from a 3D array.</span>
<a id="__codelineno-0-1447" name="__codelineno-0-1447"></a>
<a id="__codelineno-0-1448" name="__codelineno-0-1448"></a><span class="sd">        This method creates an animation by iterating through the first dimension of a 3D array.</span>
<a id="__codelineno-0-1449" name="__codelineno-0-1449"></a><span class="sd">        Each slice of the array becomes a frame in the animation, with optional time labels,</span>
<a id="__codelineno-0-1450" name="__codelineno-0-1450"></a><span class="sd">        point annotations, and cell value displays.</span>
<a id="__codelineno-0-1451" name="__codelineno-0-1451"></a>
<a id="__codelineno-0-1452" name="__codelineno-0-1452"></a><span class="sd">        Parameters</span>
<a id="__codelineno-0-1453" name="__codelineno-0-1453"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-1454" name="__codelineno-0-1454"></a><span class="sd">        time : List[Any]</span>
<a id="__codelineno-0-1455" name="__codelineno-0-1455"></a><span class="sd">            A list containing labels for each frame in the animation.</span>
<a id="__codelineno-0-1456" name="__codelineno-0-1456"></a><span class="sd">            These could be timestamps, frame numbers, or any other identifiers.</span>
<a id="__codelineno-0-1457" name="__codelineno-0-1457"></a><span class="sd">            The length of this list should match the first dimension of the array.</span>
<a id="__codelineno-0-1458" name="__codelineno-0-1458"></a><span class="sd">        points : np.ndarray, optional</span>
<a id="__codelineno-0-1459" name="__codelineno-0-1459"></a><span class="sd">            Points to display on the array, by default None.</span>
<a id="__codelineno-0-1460" name="__codelineno-0-1460"></a><span class="sd">            Should be a 3-column array where:</span>
<a id="__codelineno-0-1461" name="__codelineno-0-1461"></a><span class="sd">            - First column: values to display for each point</span>
<a id="__codelineno-0-1462" name="__codelineno-0-1462"></a><span class="sd">            - Second column: row indices of the points in the array</span>
<a id="__codelineno-0-1463" name="__codelineno-0-1463"></a><span class="sd">            - Third column: column indices of the points in the array</span>
<a id="__codelineno-0-1464" name="__codelineno-0-1464"></a><span class="sd">        text_colors : Tuple[str, str], optional</span>
<a id="__codelineno-0-1465" name="__codelineno-0-1465"></a><span class="sd">            Two colors to be used for cell value text, by default (&quot;white&quot;, &quot;black&quot;).</span>
<a id="__codelineno-0-1466" name="__codelineno-0-1466"></a><span class="sd">            The first color is used when the cell value is below the background_color_threshold,</span>
<a id="__codelineno-0-1467" name="__codelineno-0-1467"></a><span class="sd">            and the second color is used when the cell value is above the threshold.</span>
<a id="__codelineno-0-1468" name="__codelineno-0-1468"></a><span class="sd">        interval : int, optional</span>
<a id="__codelineno-0-1469" name="__codelineno-0-1469"></a><span class="sd">            Delay between frames in milliseconds, by default 200.</span>
<a id="__codelineno-0-1470" name="__codelineno-0-1470"></a><span class="sd">            Controls the speed of the animation (smaller values = faster animation).</span>
<a id="__codelineno-0-1471" name="__codelineno-0-1471"></a><span class="sd">        text_loc : list[Any, Any], optional</span>
<a id="__codelineno-0-1472" name="__codelineno-0-1472"></a><span class="sd">            Location of the time label text as [x, y] coordinates, by default None.</span>
<a id="__codelineno-0-1473" name="__codelineno-0-1473"></a><span class="sd">            If None, defaults to [0.1, 0.2].</span>
<a id="__codelineno-0-1474" name="__codelineno-0-1474"></a><span class="sd">        point_color : str, optional</span>
<a id="__codelineno-0-1475" name="__codelineno-0-1475"></a><span class="sd">            Color of the points, by default &quot;red&quot;.</span>
<a id="__codelineno-0-1476" name="__codelineno-0-1476"></a><span class="sd">            Any valid matplotlib color string.</span>
<a id="__codelineno-0-1477" name="__codelineno-0-1477"></a><span class="sd">        point_size : int, optional</span>
<a id="__codelineno-0-1478" name="__codelineno-0-1478"></a><span class="sd">            Size of the points, by default 100.</span>
<a id="__codelineno-0-1479" name="__codelineno-0-1479"></a><span class="sd">            Controls the marker size.</span>
<a id="__codelineno-0-1480" name="__codelineno-0-1480"></a><span class="sd">        pid_color : str, optional</span>
<a id="__codelineno-0-1481" name="__codelineno-0-1481"></a><span class="sd">            Color of the point value annotations, by default &quot;blue&quot;.</span>
<a id="__codelineno-0-1482" name="__codelineno-0-1482"></a><span class="sd">            Any valid matplotlib color string.</span>
<a id="__codelineno-0-1483" name="__codelineno-0-1483"></a><span class="sd">        pid_size : int, optional</span>
<a id="__codelineno-0-1484" name="__codelineno-0-1484"></a><span class="sd">            Size of the point value annotations, by default 10.</span>
<a id="__codelineno-0-1485" name="__codelineno-0-1485"></a><span class="sd">            Controls the font size of the annotations.</span>
<a id="__codelineno-0-1486" name="__codelineno-0-1486"></a><span class="sd">        **kwargs : dict</span>
<a id="__codelineno-0-1487" name="__codelineno-0-1487"></a><span class="sd">            Additional keyword arguments for customizing the animation.</span>
<a id="__codelineno-0-1488" name="__codelineno-0-1488"></a>
<a id="__codelineno-0-1489" name="__codelineno-0-1489"></a><span class="sd">            Plot appearance:</span>
<a id="__codelineno-0-1490" name="__codelineno-0-1490"></a><span class="sd">            ---------------</span>
<a id="__codelineno-0-1491" name="__codelineno-0-1491"></a><span class="sd">            title : str, optional</span>
<a id="__codelineno-0-1492" name="__codelineno-0-1492"></a><span class="sd">                Title of the plot, by default &#39;Array Plot&#39;.</span>
<a id="__codelineno-0-1493" name="__codelineno-0-1493"></a><span class="sd">            title_size : int, optional</span>
<a id="__codelineno-0-1494" name="__codelineno-0-1494"></a><span class="sd">                Title font size, by default 15.</span>
<a id="__codelineno-0-1495" name="__codelineno-0-1495"></a><span class="sd">            cmap : str, optional</span>
<a id="__codelineno-0-1496" name="__codelineno-0-1496"></a><span class="sd">                Colormap name, by default &#39;coolwarm_r&#39;.</span>
<a id="__codelineno-0-1497" name="__codelineno-0-1497"></a><span class="sd">            vmin : float, optional</span>
<a id="__codelineno-0-1498" name="__codelineno-0-1498"></a><span class="sd">                Minimum value for color scaling, by default min(array).</span>
<a id="__codelineno-0-1499" name="__codelineno-0-1499"></a><span class="sd">            vmax : float, optional</span>
<a id="__codelineno-0-1500" name="__codelineno-0-1500"></a><span class="sd">                Maximum value for color scaling, by default max(array).</span>
<a id="__codelineno-0-1501" name="__codelineno-0-1501"></a>
<a id="__codelineno-0-1502" name="__codelineno-0-1502"></a><span class="sd">            Color bar options:</span>
<a id="__codelineno-0-1503" name="__codelineno-0-1503"></a><span class="sd">            ----------------</span>
<a id="__codelineno-0-1504" name="__codelineno-0-1504"></a><span class="sd">            cbar_orientation : str, optional</span>
<a id="__codelineno-0-1505" name="__codelineno-0-1505"></a><span class="sd">                Orientation of the color bar, by default &#39;vertical&#39;.</span>
<a id="__codelineno-0-1506" name="__codelineno-0-1506"></a><span class="sd">                Can be &#39;horizontal&#39; or &#39;vertical&#39;.</span>
<a id="__codelineno-0-1507" name="__codelineno-0-1507"></a><span class="sd">            cbar_label_rotation : float, optional</span>
<a id="__codelineno-0-1508" name="__codelineno-0-1508"></a><span class="sd">                Rotation angle of the color bar label, by default -90.</span>
<a id="__codelineno-0-1509" name="__codelineno-0-1509"></a><span class="sd">            cbar_label_location : str, optional</span>
<a id="__codelineno-0-1510" name="__codelineno-0-1510"></a><span class="sd">                Location of the color bar label, by default &#39;bottom&#39;.</span>
<a id="__codelineno-0-1511" name="__codelineno-0-1511"></a><span class="sd">                Options: &#39;top&#39;, &#39;bottom&#39;, &#39;center&#39;, &#39;baseline&#39;, &#39;center_baseline&#39;.</span>
<a id="__codelineno-0-1512" name="__codelineno-0-1512"></a><span class="sd">            cbar_length : float, optional</span>
<a id="__codelineno-0-1513" name="__codelineno-0-1513"></a><span class="sd">                Ratio to control the height/width of the color bar, by default 0.75.</span>
<a id="__codelineno-0-1514" name="__codelineno-0-1514"></a><span class="sd">            ticks_spacing : int, optional</span>
<a id="__codelineno-0-1515" name="__codelineno-0-1515"></a><span class="sd">                Spacing between ticks on the color bar, by default 2.</span>
<a id="__codelineno-0-1516" name="__codelineno-0-1516"></a><span class="sd">            cbar_label_size : int, optional</span>
<a id="__codelineno-0-1517" name="__codelineno-0-1517"></a><span class="sd">                Font size of the color bar label, by default 12.</span>
<a id="__codelineno-0-1518" name="__codelineno-0-1518"></a><span class="sd">            cbar_label : str, optional</span>
<a id="__codelineno-0-1519" name="__codelineno-0-1519"></a><span class="sd">                Label text for the color bar, by default &#39;Value&#39;.</span>
<a id="__codelineno-0-1520" name="__codelineno-0-1520"></a>
<a id="__codelineno-0-1521" name="__codelineno-0-1521"></a><span class="sd">            Color scale options:</span>
<a id="__codelineno-0-1522" name="__codelineno-0-1522"></a><span class="sd">            ------------------</span>
<a id="__codelineno-0-1523" name="__codelineno-0-1523"></a><span class="sd">            color_scale : str, optional</span>
<a id="__codelineno-0-1524" name="__codelineno-0-1524"></a><span class="sd">                Type of color scaling to use, by default &#39;linear&#39;.</span>
<a id="__codelineno-0-1525" name="__codelineno-0-1525"></a><span class="sd">                Options:</span>
<a id="__codelineno-0-1526" name="__codelineno-0-1526"></a><span class="sd">                - &#39;linear&#39;: Linear scale</span>
<a id="__codelineno-0-1527" name="__codelineno-0-1527"></a><span class="sd">                - &#39;power&#39;: Power-law normalization</span>
<a id="__codelineno-0-1528" name="__codelineno-0-1528"></a><span class="sd">                - &#39;sym-lognorm&#39;: Symmetrical logarithmic scale</span>
<a id="__codelineno-0-1529" name="__codelineno-0-1529"></a><span class="sd">                - &#39;boundary-norm&#39;: Discrete intervals based on boundaries</span>
<a id="__codelineno-0-1530" name="__codelineno-0-1530"></a><span class="sd">                - &#39;midpoint&#39;: Scale split at a specified midpoint</span>
<a id="__codelineno-0-1531" name="__codelineno-0-1531"></a><span class="sd">            gamma : float, optional</span>
<a id="__codelineno-0-1532" name="__codelineno-0-1532"></a><span class="sd">                Exponent for &#39;power&#39; color scale, by default 0.5.</span>
<a id="__codelineno-0-1533" name="__codelineno-0-1533"></a><span class="sd">                Values &lt; 1 emphasize lower values, values &gt; 1 emphasize higher values.</span>
<a id="__codelineno-0-1534" name="__codelineno-0-1534"></a><span class="sd">            line_threshold : float, optional</span>
<a id="__codelineno-0-1535" name="__codelineno-0-1535"></a><span class="sd">                Threshold for &#39;sym-lognorm&#39; color scale, by default 0.0001.</span>
<a id="__codelineno-0-1536" name="__codelineno-0-1536"></a><span class="sd">            line_scale : float, optional</span>
<a id="__codelineno-0-1537" name="__codelineno-0-1537"></a><span class="sd">                Scale factor for &#39;sym-lognorm&#39; color scale, by default 0.001.</span>
<a id="__codelineno-0-1538" name="__codelineno-0-1538"></a><span class="sd">            bounds : List, optional</span>
<a id="__codelineno-0-1539" name="__codelineno-0-1539"></a><span class="sd">                Boundaries for &#39;boundary-norm&#39; color scale, by default None.</span>
<a id="__codelineno-0-1540" name="__codelineno-0-1540"></a><span class="sd">                Defines the discrete intervals for color mapping.</span>
<a id="__codelineno-0-1541" name="__codelineno-0-1541"></a><span class="sd">            midpoint : float, optional</span>
<a id="__codelineno-0-1542" name="__codelineno-0-1542"></a><span class="sd">                Midpoint value for &#39;midpoint&#39; color scale, by default 0.</span>
<a id="__codelineno-0-1543" name="__codelineno-0-1543"></a>
<a id="__codelineno-0-1544" name="__codelineno-0-1544"></a><span class="sd">            Cell value display options:</span>
<a id="__codelineno-0-1545" name="__codelineno-0-1545"></a><span class="sd">            -------------------------</span>
<a id="__codelineno-0-1546" name="__codelineno-0-1546"></a><span class="sd">            display_cell_value : bool, optional</span>
<a id="__codelineno-0-1547" name="__codelineno-0-1547"></a><span class="sd">                Whether to display the values of cells as text, by default False.</span>
<a id="__codelineno-0-1548" name="__codelineno-0-1548"></a><span class="sd">            num_size : int, optional</span>
<a id="__codelineno-0-1549" name="__codelineno-0-1549"></a><span class="sd">                Font size of the cell value text, by default 8.</span>
<a id="__codelineno-0-1550" name="__codelineno-0-1550"></a><span class="sd">            background_color_threshold : float, optional</span>
<a id="__codelineno-0-1551" name="__codelineno-0-1551"></a><span class="sd">                Threshold for cell value text color, by default None.</span>
<a id="__codelineno-0-1552" name="__codelineno-0-1552"></a><span class="sd">                If cell value &gt; threshold, text is black; otherwise, text is white.</span>
<a id="__codelineno-0-1553" name="__codelineno-0-1553"></a><span class="sd">                If None, uses max(array)/2 as the threshold.</span>
<a id="__codelineno-0-1554" name="__codelineno-0-1554"></a>
<a id="__codelineno-0-1555" name="__codelineno-0-1555"></a><span class="sd">        Returns</span>
<a id="__codelineno-0-1556" name="__codelineno-0-1556"></a><span class="sd">        -------</span>
<a id="__codelineno-0-1557" name="__codelineno-0-1557"></a><span class="sd">        matplotlib.animation.FuncAnimation</span>
<a id="__codelineno-0-1558" name="__codelineno-0-1558"></a><span class="sd">            The animation object that can be displayed in a notebook or saved to a file.</span>
<a id="__codelineno-0-1559" name="__codelineno-0-1559"></a>
<a id="__codelineno-0-1560" name="__codelineno-0-1560"></a><span class="sd">        Raises</span>
<a id="__codelineno-0-1561" name="__codelineno-0-1561"></a><span class="sd">        ------</span>
<a id="__codelineno-0-1562" name="__codelineno-0-1562"></a><span class="sd">        ValueError</span>
<a id="__codelineno-0-1563" name="__codelineno-0-1563"></a><span class="sd">            If an invalid keyword argument is provided.</span>
<a id="__codelineno-0-1564" name="__codelineno-0-1564"></a><span class="sd">        ValueError</span>
<a id="__codelineno-0-1565" name="__codelineno-0-1565"></a><span class="sd">            If the length of the time list doesn&#39;t match the first dimension of the array.</span>
<a id="__codelineno-0-1566" name="__codelineno-0-1566"></a>
<a id="__codelineno-0-1567" name="__codelineno-0-1567"></a><span class="sd">        Notes</span>
<a id="__codelineno-0-1568" name="__codelineno-0-1568"></a><span class="sd">        -----</span>
<a id="__codelineno-0-1569" name="__codelineno-0-1569"></a><span class="sd">        The animation is created by iterating through the first dimension of the array.</span>
<a id="__codelineno-0-1570" name="__codelineno-0-1570"></a><span class="sd">        For example, if the array has shape (10, 20, 30), the animation will have 10 frames,</span>
<a id="__codelineno-0-1571" name="__codelineno-0-1571"></a><span class="sd">        each showing a 20x30 slice of the array.</span>
<a id="__codelineno-0-1572" name="__codelineno-0-1572"></a>
<a id="__codelineno-0-1573" name="__codelineno-0-1573"></a><span class="sd">        To display the animation in a Jupyter notebook, you may need to use:</span>
<a id="__codelineno-0-1574" name="__codelineno-0-1574"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-1575" name="__codelineno-0-1575"></a><span class="sd">        from IPython.display import HTML</span>
<a id="__codelineno-0-1576" name="__codelineno-0-1576"></a><span class="sd">        HTML(anim_obj.to_jshtml())</span>
<a id="__codelineno-0-1577" name="__codelineno-0-1577"></a><span class="sd">        ```</span>
<a id="__codelineno-0-1578" name="__codelineno-0-1578"></a>
<a id="__codelineno-0-1579" name="__codelineno-0-1579"></a><span class="sd">        To save the animation to a file, use the `save_animation` method after creating</span>
<a id="__codelineno-0-1580" name="__codelineno-0-1580"></a><span class="sd">        the animation.</span>
<a id="__codelineno-0-1581" name="__codelineno-0-1581"></a>
<a id="__codelineno-0-1582" name="__codelineno-0-1582"></a><span class="sd">        Examples</span>
<a id="__codelineno-0-1583" name="__codelineno-0-1583"></a><span class="sd">        --------</span>
<a id="__codelineno-0-1584" name="__codelineno-0-1584"></a><span class="sd">        Basic animation from a 3D array:</span>
<a id="__codelineno-0-1585" name="__codelineno-0-1585"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-1586" name="__codelineno-0-1586"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-1587" name="__codelineno-0-1587"></a><span class="sd">        &gt;&gt;&gt; from cleopatra.array_glyph import ArrayGlyph</span>
<a id="__codelineno-0-1588" name="__codelineno-0-1588"></a><span class="sd">        &gt;&gt;&gt; # Create a 3D array with 5 frames, each 10x10</span>
<a id="__codelineno-0-1589" name="__codelineno-0-1589"></a><span class="sd">        &gt;&gt;&gt; arr = np.random.randint(1, 10, size=(5, 10, 10))</span>
<a id="__codelineno-0-1590" name="__codelineno-0-1590"></a><span class="sd">        &gt;&gt;&gt; # Create labels for each frame</span>
<a id="__codelineno-0-1591" name="__codelineno-0-1591"></a><span class="sd">        &gt;&gt;&gt; frame_labels = [&quot;Frame 1&quot;, &quot;Frame 2&quot;, &quot;Frame 3&quot;, &quot;Frame 4&quot;, &quot;Frame 5&quot;]</span>
<a id="__codelineno-0-1592" name="__codelineno-0-1592"></a><span class="sd">        &gt;&gt;&gt; # Create the ArrayGlyph object</span>
<a id="__codelineno-0-1593" name="__codelineno-0-1593"></a><span class="sd">        &gt;&gt;&gt; animated_array = ArrayGlyph(arr, figsize=(8, 8), title=&quot;Animated Array&quot;)</span>
<a id="__codelineno-0-1594" name="__codelineno-0-1594"></a><span class="sd">        &gt;&gt;&gt; # Create the animation</span>
<a id="__codelineno-0-1595" name="__codelineno-0-1595"></a><span class="sd">        &gt;&gt;&gt; anim_obj = animated_array.animate(frame_labels)</span>
<a id="__codelineno-0-1596" name="__codelineno-0-1596"></a>
<a id="__codelineno-0-1597" name="__codelineno-0-1597"></a><span class="sd">        ```</span>
<a id="__codelineno-0-1598" name="__codelineno-0-1598"></a><span class="sd">        Animation with custom interval (speed):</span>
<a id="__codelineno-0-1599" name="__codelineno-0-1599"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-1600" name="__codelineno-0-1600"></a><span class="sd">        &gt;&gt;&gt; # Slower animation (500ms between frames)</span>
<a id="__codelineno-0-1601" name="__codelineno-0-1601"></a><span class="sd">        &gt;&gt;&gt; anim_obj = animated_array.animate(frame_labels, interval=500)</span>
<a id="__codelineno-0-1602" name="__codelineno-0-1602"></a><span class="sd">        &gt;&gt;&gt; # Faster animation (100ms between frames)</span>
<a id="__codelineno-0-1603" name="__codelineno-0-1603"></a><span class="sd">        &gt;&gt;&gt; anim_obj = animated_array.animate(frame_labels, interval=100)</span>
<a id="__codelineno-0-1604" name="__codelineno-0-1604"></a>
<a id="__codelineno-0-1605" name="__codelineno-0-1605"></a><span class="sd">        ```</span>
<a id="__codelineno-0-1606" name="__codelineno-0-1606"></a><span class="sd">        Animation with points:</span>
<a id="__codelineno-0-1607" name="__codelineno-0-1607"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-1608" name="__codelineno-0-1608"></a><span class="sd">        &gt;&gt;&gt; # Create points to display on the animation</span>
<a id="__codelineno-0-1609" name="__codelineno-0-1609"></a><span class="sd">        &gt;&gt;&gt; points = np.array([[1, 2, 3], [2, 5, 5], [3, 8, 8]])</span>
<a id="__codelineno-0-1610" name="__codelineno-0-1610"></a><span class="sd">        &gt;&gt;&gt; anim_obj = animated_array.animate(</span>
<a id="__codelineno-0-1611" name="__codelineno-0-1611"></a><span class="sd">        ...     frame_labels,</span>
<a id="__codelineno-0-1612" name="__codelineno-0-1612"></a><span class="sd">        ...     points=points,</span>
<a id="__codelineno-0-1613" name="__codelineno-0-1613"></a><span class="sd">        ...     point_color=&quot;black&quot;,</span>
<a id="__codelineno-0-1614" name="__codelineno-0-1614"></a><span class="sd">        ...     point_size=150,</span>
<a id="__codelineno-0-1615" name="__codelineno-0-1615"></a><span class="sd">        ...     pid_color=&quot;white&quot;,</span>
<a id="__codelineno-0-1616" name="__codelineno-0-1616"></a><span class="sd">        ...     pid_size=12</span>
<a id="__codelineno-0-1617" name="__codelineno-0-1617"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-1618" name="__codelineno-0-1618"></a>
<a id="__codelineno-0-1619" name="__codelineno-0-1619"></a><span class="sd">        ```</span>
<a id="__codelineno-0-1620" name="__codelineno-0-1620"></a><span class="sd">        Animation with cell values displayed:</span>
<a id="__codelineno-0-1621" name="__codelineno-0-1621"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-1622" name="__codelineno-0-1622"></a><span class="sd">        &gt;&gt;&gt; anim_obj = animated_array.animate(</span>
<a id="__codelineno-0-1623" name="__codelineno-0-1623"></a><span class="sd">        ...     frame_labels,</span>
<a id="__codelineno-0-1624" name="__codelineno-0-1624"></a><span class="sd">        ...     display_cell_value=True,</span>
<a id="__codelineno-0-1625" name="__codelineno-0-1625"></a><span class="sd">        ...     num_size=10,</span>
<a id="__codelineno-0-1626" name="__codelineno-0-1626"></a><span class="sd">        ...     text_colors=(&quot;yellow&quot;, &quot;blue&quot;)</span>
<a id="__codelineno-0-1627" name="__codelineno-0-1627"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-1628" name="__codelineno-0-1628"></a>
<a id="__codelineno-0-1629" name="__codelineno-0-1629"></a><span class="sd">        ```</span>
<a id="__codelineno-0-1630" name="__codelineno-0-1630"></a><span class="sd">        ![animated_array](./../_images/array_glyph/animated_array.gif)</span>
<a id="__codelineno-0-1631" name="__codelineno-0-1631"></a>
<a id="__codelineno-0-1632" name="__codelineno-0-1632"></a><span class="sd">        Saving the animation to a file:</span>
<a id="__codelineno-0-1633" name="__codelineno-0-1633"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-1634" name="__codelineno-0-1634"></a><span class="sd">        &gt;&gt;&gt; # Create the animation first</span>
<a id="__codelineno-0-1635" name="__codelineno-0-1635"></a><span class="sd">        &gt;&gt;&gt; anim_obj = animated_array.animate(frame_labels)</span>
<a id="__codelineno-0-1636" name="__codelineno-0-1636"></a><span class="sd">        &gt;&gt;&gt; # Then save it to a file</span>
<a id="__codelineno-0-1637" name="__codelineno-0-1637"></a><span class="sd">        &gt;&gt;&gt; animated_array.save_animation(&quot;animation.gif&quot;, fps=2)</span>
<a id="__codelineno-0-1638" name="__codelineno-0-1638"></a>
<a id="__codelineno-0-1639" name="__codelineno-0-1639"></a><span class="sd">        ```</span>
<a id="__codelineno-0-1640" name="__codelineno-0-1640"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1641" name="__codelineno-0-1641"></a>        <span class="k">if</span> <span class="n">text_loc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1642" name="__codelineno-0-1642"></a>            <span class="n">text_loc</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">]</span>
<a id="__codelineno-0-1643" name="__codelineno-0-1643"></a>
<a id="__codelineno-0-1644" name="__codelineno-0-1644"></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-1645" name="__codelineno-0-1645"></a>            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-1646" name="__codelineno-0-1646"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1647" name="__codelineno-0-1647"></a>                    <span class="sa">f</span><span class="s2">&quot;The given keyword argument:</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> is not correct, possible parameters are,&quot;</span>
<a id="__codelineno-0-1648" name="__codelineno-0-1648"></a>                    <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">DEFAULT_OPTIONS</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-1649" name="__codelineno-0-1649"></a>                <span class="p">)</span>
<a id="__codelineno-0-1650" name="__codelineno-0-1650"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1651" name="__codelineno-0-1651"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
<a id="__codelineno-0-1652" name="__codelineno-0-1652"></a>
<a id="__codelineno-0-1653" name="__codelineno-0-1653"></a>        <span class="c1"># if user did not input ticks spacing use the calculated one.</span>
<a id="__codelineno-0-1654" name="__codelineno-0-1654"></a>        <span class="k">if</span> <span class="s2">&quot;ticks_spacing&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-1655" name="__codelineno-0-1655"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;ticks_spacing&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;ticks_spacing&quot;</span><span class="p">]</span>
<a id="__codelineno-0-1656" name="__codelineno-0-1656"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1657" name="__codelineno-0-1657"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;ticks_spacing&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ticks_spacing</span>
<a id="__codelineno-0-1658" name="__codelineno-0-1658"></a>
<a id="__codelineno-0-1659" name="__codelineno-0-1659"></a>        <span class="k">if</span> <span class="s2">&quot;vmin&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-1660" name="__codelineno-0-1660"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;vmin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;vmin&quot;</span><span class="p">]</span>
<a id="__codelineno-0-1661" name="__codelineno-0-1661"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1662" name="__codelineno-0-1662"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;vmin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmin</span>
<a id="__codelineno-0-1663" name="__codelineno-0-1663"></a>
<a id="__codelineno-0-1664" name="__codelineno-0-1664"></a>        <span class="k">if</span> <span class="s2">&quot;vmax&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-1665" name="__codelineno-0-1665"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;vmax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;vmax&quot;</span><span class="p">]</span>
<a id="__codelineno-0-1666" name="__codelineno-0-1666"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1667" name="__codelineno-0-1667"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;vmax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmax</span>
<a id="__codelineno-0-1668" name="__codelineno-0-1668"></a>
<a id="__codelineno-0-1669" name="__codelineno-0-1669"></a>        <span class="c1"># if optional_display</span>
<a id="__codelineno-0-1670" name="__codelineno-0-1670"></a>        <span class="n">precision</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;precision&quot;</span><span class="p">]</span>
<a id="__codelineno-0-1671" name="__codelineno-0-1671"></a>        <span class="n">array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr</span>
<a id="__codelineno-0-1672" name="__codelineno-0-1672"></a>
<a id="__codelineno-0-1673" name="__codelineno-0-1673"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1674" name="__codelineno-0-1674"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_figure_axes</span><span class="p">()</span>
<a id="__codelineno-0-1675" name="__codelineno-0-1675"></a>
<a id="__codelineno-0-1676" name="__codelineno-0-1676"></a>        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span>
<a id="__codelineno-0-1677" name="__codelineno-0-1677"></a>
<a id="__codelineno-0-1678" name="__codelineno-0-1678"></a>        <span class="n">ticks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-0-1679" name="__codelineno-0-1679"></a>        <span class="n">im</span><span class="p">,</span> <span class="n">cbar_kw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_im_get_cbar_kw</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="n">ticks</span><span class="p">)</span>
<a id="__codelineno-0-1680" name="__codelineno-0-1680"></a>
<a id="__codelineno-0-1681" name="__codelineno-0-1681"></a>        <span class="c1"># Create colorbar</span>
<a id="__codelineno-0-1682" name="__codelineno-0-1682"></a>        <span class="n">cbar</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span>
<a id="__codelineno-0-1683" name="__codelineno-0-1683"></a>            <span class="n">im</span><span class="p">,</span>
<a id="__codelineno-0-1684" name="__codelineno-0-1684"></a>            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
<a id="__codelineno-0-1685" name="__codelineno-0-1685"></a>            <span class="n">shrink</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;cbar_length&quot;</span><span class="p">],</span>
<a id="__codelineno-0-1686" name="__codelineno-0-1686"></a>            <span class="n">orientation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;cbar_orientation&quot;</span><span class="p">],</span>
<a id="__codelineno-0-1687" name="__codelineno-0-1687"></a>            <span class="o">**</span><span class="n">cbar_kw</span><span class="p">,</span>
<a id="__codelineno-0-1688" name="__codelineno-0-1688"></a>        <span class="p">)</span>
<a id="__codelineno-0-1689" name="__codelineno-0-1689"></a>        <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span>
<a id="__codelineno-0-1690" name="__codelineno-0-1690"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;cbar_label&quot;</span><span class="p">],</span>
<a id="__codelineno-0-1691" name="__codelineno-0-1691"></a>            <span class="n">rotation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;cbar_label_rotation&quot;</span><span class="p">],</span>
<a id="__codelineno-0-1692" name="__codelineno-0-1692"></a>            <span class="n">va</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;cbar_label_location&quot;</span><span class="p">],</span>
<a id="__codelineno-0-1693" name="__codelineno-0-1693"></a>            <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;cbar_label_size&quot;</span><span class="p">],</span>
<a id="__codelineno-0-1694" name="__codelineno-0-1694"></a>        <span class="p">)</span>
<a id="__codelineno-0-1695" name="__codelineno-0-1695"></a>        <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-0-1696" name="__codelineno-0-1696"></a>
<a id="__codelineno-0-1697" name="__codelineno-0-1697"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
<a id="__codelineno-0-1698" name="__codelineno-0-1698"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;title_size&quot;</span><span class="p">]</span>
<a id="__codelineno-0-1699" name="__codelineno-0-1699"></a>        <span class="p">)</span>
<a id="__codelineno-0-1700" name="__codelineno-0-1700"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
<a id="__codelineno-0-1701" name="__codelineno-0-1701"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
<a id="__codelineno-0-1702" name="__codelineno-0-1702"></a>
<a id="__codelineno-0-1703" name="__codelineno-0-1703"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
<a id="__codelineno-0-1704" name="__codelineno-0-1704"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
<a id="__codelineno-0-1705" name="__codelineno-0-1705"></a>
<a id="__codelineno-0-1706" name="__codelineno-0-1706"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;display_cell_value&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-1707" name="__codelineno-0-1707"></a>            <span class="n">indices</span> <span class="o">=</span> <span class="n">get_indices2</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
<a id="__codelineno-0-1708" name="__codelineno-0-1708"></a>            <span class="n">cell_text_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_text</span><span class="p">(</span>
<a id="__codelineno-0-1709" name="__codelineno-0-1709"></a>                <span class="n">ax</span><span class="p">,</span> <span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="n">indices</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span>
<a id="__codelineno-0-1710" name="__codelineno-0-1710"></a>            <span class="p">)</span>
<a id="__codelineno-0-1711" name="__codelineno-0-1711"></a>            <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
<a id="__codelineno-0-1712" name="__codelineno-0-1712"></a>
<a id="__codelineno-0-1713" name="__codelineno-0-1713"></a>        <span class="k">if</span> <span class="n">points</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1714" name="__codelineno-0-1714"></a>            <span class="n">row</span> <span class="o">=</span> <span class="n">points</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-1715" name="__codelineno-0-1715"></a>            <span class="n">col</span> <span class="o">=</span> <span class="n">points</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-1716" name="__codelineno-0-1716"></a>            <span class="n">points_scatter</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">point_color</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">point_size</span><span class="p">)</span>
<a id="__codelineno-0-1717" name="__codelineno-0-1717"></a>            <span class="n">points_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_point_values</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">pid_color</span><span class="p">,</span> <span class="n">pid_size</span><span class="p">)</span>
<a id="__codelineno-0-1718" name="__codelineno-0-1718"></a>
<a id="__codelineno-0-1719" name="__codelineno-0-1719"></a>        <span class="c1"># Normalize the threshold to the image color range.</span>
<a id="__codelineno-0-1720" name="__codelineno-0-1720"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;background_color_threshold&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1721" name="__codelineno-0-1721"></a>            <span class="n">background_color_threshold</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span>
<a id="__codelineno-0-1722" name="__codelineno-0-1722"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;background_color_threshold&quot;</span><span class="p">]</span>
<a id="__codelineno-0-1723" name="__codelineno-0-1723"></a>            <span class="p">)</span>
<a id="__codelineno-0-1724" name="__codelineno-0-1724"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1725" name="__codelineno-0-1725"></a>            <span class="n">background_color_threshold</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">array</span><span class="p">))</span> <span class="o">/</span> <span class="mf">2.0</span>
<a id="__codelineno-0-1726" name="__codelineno-0-1726"></a>
<a id="__codelineno-0-1727" name="__codelineno-0-1727"></a>        <span class="n">day_text</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
<a id="__codelineno-0-1728" name="__codelineno-0-1728"></a>            <span class="n">text_loc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<a id="__codelineno-0-1729" name="__codelineno-0-1729"></a>            <span class="n">text_loc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-1730" name="__codelineno-0-1730"></a>            <span class="s2">&quot; &quot;</span><span class="p">,</span>
<a id="__codelineno-0-1731" name="__codelineno-0-1731"></a>            <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;cbar_label_size&quot;</span><span class="p">],</span>
<a id="__codelineno-0-1732" name="__codelineno-0-1732"></a>        <span class="p">)</span>
<a id="__codelineno-0-1733" name="__codelineno-0-1733"></a>
<a id="__codelineno-0-1734" name="__codelineno-0-1734"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">init</span><span class="p">():</span>
<a id="__codelineno-0-1735" name="__codelineno-0-1735"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;initialize the plot with the first array&quot;&quot;&quot;</span>
<a id="__codelineno-0-1736" name="__codelineno-0-1736"></a>            <span class="n">im</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:])</span>
<a id="__codelineno-0-1737" name="__codelineno-0-1737"></a>            <span class="n">day_text</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1738" name="__codelineno-0-1738"></a>            <span class="n">output</span> <span class="o">=</span> <span class="p">[</span><span class="n">im</span><span class="p">,</span> <span class="n">day_text</span><span class="p">]</span>
<a id="__codelineno-0-1739" name="__codelineno-0-1739"></a>
<a id="__codelineno-0-1740" name="__codelineno-0-1740"></a>            <span class="k">if</span> <span class="n">points</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1741" name="__codelineno-0-1741"></a>                <span class="n">points_scatter</span><span class="o">.</span><span class="n">set_offsets</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">col</span><span class="p">,</span> <span class="n">row</span><span class="p">])</span>
<a id="__codelineno-0-1742" name="__codelineno-0-1742"></a>                <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">points_scatter</span><span class="p">)</span>
<a id="__codelineno-0-1743" name="__codelineno-0-1743"></a>                <span class="n">update_points</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">points_id</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-1744" name="__codelineno-0-1744"></a>                <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">update_points</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">col</span><span class="p">))))</span>
<a id="__codelineno-0-1745" name="__codelineno-0-1745"></a>
<a id="__codelineno-0-1746" name="__codelineno-0-1746"></a>                <span class="n">output</span> <span class="o">+=</span> <span class="n">points_id</span>
<a id="__codelineno-0-1747" name="__codelineno-0-1747"></a>
<a id="__codelineno-0-1748" name="__codelineno-0-1748"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;display_cell_value&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-1749" name="__codelineno-0-1749"></a>                <span class="n">vals</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">indices</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">indices</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]]</span>
<a id="__codelineno-0-1750" name="__codelineno-0-1750"></a>                <span class="n">update_cell_value</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">cell_text_value</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
<a id="__codelineno-0-1751" name="__codelineno-0-1751"></a>                <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">update_cell_value</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">no_elem</span><span class="p">)))</span>
<a id="__codelineno-0-1752" name="__codelineno-0-1752"></a>                <span class="n">output</span> <span class="o">+=</span> <span class="n">cell_text_value</span>
<a id="__codelineno-0-1753" name="__codelineno-0-1753"></a>
<a id="__codelineno-0-1754" name="__codelineno-0-1754"></a>            <span class="k">return</span> <span class="n">output</span>
<a id="__codelineno-0-1755" name="__codelineno-0-1755"></a>
<a id="__codelineno-0-1756" name="__codelineno-0-1756"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">animate_a</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
<a id="__codelineno-0-1757" name="__codelineno-0-1757"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;plot for each element in the iterable.&quot;&quot;&quot;</span>
<a id="__codelineno-0-1758" name="__codelineno-0-1758"></a>            <span class="n">im</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:])</span>
<a id="__codelineno-0-1759" name="__codelineno-0-1759"></a>            <span class="n">day_text</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="s2">&quot;Date = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">])</span>
<a id="__codelineno-0-1760" name="__codelineno-0-1760"></a>            <span class="n">output</span> <span class="o">=</span> <span class="p">[</span><span class="n">im</span><span class="p">,</span> <span class="n">day_text</span><span class="p">]</span>
<a id="__codelineno-0-1761" name="__codelineno-0-1761"></a>
<a id="__codelineno-0-1762" name="__codelineno-0-1762"></a>            <span class="k">if</span> <span class="n">points</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1763" name="__codelineno-0-1763"></a>                <span class="n">points_scatter</span><span class="o">.</span><span class="n">set_offsets</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">col</span><span class="p">,</span> <span class="n">row</span><span class="p">])</span>
<a id="__codelineno-0-1764" name="__codelineno-0-1764"></a>                <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">points_scatter</span><span class="p">)</span>
<a id="__codelineno-0-1765" name="__codelineno-0-1765"></a>
<a id="__codelineno-0-1766" name="__codelineno-0-1766"></a>                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">col</span><span class="p">)):</span>
<a id="__codelineno-0-1767" name="__codelineno-0-1767"></a>                    <span class="n">points_id</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-1768" name="__codelineno-0-1768"></a>
<a id="__codelineno-0-1769" name="__codelineno-0-1769"></a>                <span class="n">output</span> <span class="o">+=</span> <span class="n">points_id</span>
<a id="__codelineno-0-1770" name="__codelineno-0-1770"></a>
<a id="__codelineno-0-1771" name="__codelineno-0-1771"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;display_cell_value&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-1772" name="__codelineno-0-1772"></a>                <span class="n">vals</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">indices</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">indices</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]]</span>
<a id="__codelineno-0-1773" name="__codelineno-0-1773"></a>
<a id="__codelineno-0-1774" name="__codelineno-0-1774"></a>                <span class="k">def</span><span class="w"> </span><span class="nf">update_cell_value</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<a id="__codelineno-0-1775" name="__codelineno-0-1775"></a><span class="w">                    </span><span class="sd">&quot;&quot;&quot;Update cell value&quot;&quot;&quot;</span>
<a id="__codelineno-0-1776" name="__codelineno-0-1776"></a>                    <span class="n">val</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">precision</span><span class="p">)</span>
<a id="__codelineno-0-1777" name="__codelineno-0-1777"></a>                    <span class="n">kw</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-1778" name="__codelineno-0-1778"></a>                        <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">text_colors</span><span class="p">[</span>
<a id="__codelineno-0-1779" name="__codelineno-0-1779"></a>                            <span class="nb">int</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="n">x</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">background_color_threshold</span><span class="p">)</span>
<a id="__codelineno-0-1780" name="__codelineno-0-1780"></a>                        <span class="p">]</span>
<a id="__codelineno-0-1781" name="__codelineno-0-1781"></a>                    <span class="p">}</span>
<a id="__codelineno-0-1782" name="__codelineno-0-1782"></a>                    <span class="n">cell_text_value</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kw</span><span class="p">)</span>
<a id="__codelineno-0-1783" name="__codelineno-0-1783"></a>                    <span class="n">cell_text_value</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
<a id="__codelineno-0-1784" name="__codelineno-0-1784"></a>
<a id="__codelineno-0-1785" name="__codelineno-0-1785"></a>                <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">update_cell_value</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">no_elem</span><span class="p">)))</span>
<a id="__codelineno-0-1786" name="__codelineno-0-1786"></a>
<a id="__codelineno-0-1787" name="__codelineno-0-1787"></a>                <span class="n">output</span> <span class="o">+=</span> <span class="n">cell_text_value</span>
<a id="__codelineno-0-1788" name="__codelineno-0-1788"></a>
<a id="__codelineno-0-1789" name="__codelineno-0-1789"></a>            <span class="k">return</span> <span class="n">output</span>
<a id="__codelineno-0-1790" name="__codelineno-0-1790"></a>
<a id="__codelineno-0-1791" name="__codelineno-0-1791"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a id="__codelineno-0-1792" name="__codelineno-0-1792"></a>        <span class="n">anim</span> <span class="o">=</span> <span class="n">FuncAnimation</span><span class="p">(</span>
<a id="__codelineno-0-1793" name="__codelineno-0-1793"></a>            <span class="n">fig</span><span class="p">,</span>
<a id="__codelineno-0-1794" name="__codelineno-0-1794"></a>            <span class="n">animate_a</span><span class="p">,</span>
<a id="__codelineno-0-1795" name="__codelineno-0-1795"></a>            <span class="n">init_func</span><span class="o">=</span><span class="n">init</span><span class="p">,</span>
<a id="__codelineno-0-1796" name="__codelineno-0-1796"></a>            <span class="n">frames</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">array</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
<a id="__codelineno-0-1797" name="__codelineno-0-1797"></a>            <span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span>
<a id="__codelineno-0-1798" name="__codelineno-0-1798"></a>            <span class="n">blit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1799" name="__codelineno-0-1799"></a>        <span class="p">)</span>
<a id="__codelineno-0-1800" name="__codelineno-0-1800"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_anim</span> <span class="o">=</span> <span class="n">anim</span>
<a id="__codelineno-0-1801" name="__codelineno-0-1801"></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a id="__codelineno-0-1802" name="__codelineno-0-1802"></a>        <span class="k">return</span> <span class="n">anim</span>
<a id="__codelineno-0-1803" name="__codelineno-0-1803"></a>
<a id="__codelineno-0-1804" name="__codelineno-0-1804"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">save_animation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">fps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">):</span>
<a id="__codelineno-0-1805" name="__codelineno-0-1805"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Save the animation to a file.</span>
<a id="__codelineno-0-1806" name="__codelineno-0-1806"></a>
<a id="__codelineno-0-1807" name="__codelineno-0-1807"></a><span class="sd">        This method saves the animation created by the `animate` method to a file.</span>
<a id="__codelineno-0-1808" name="__codelineno-0-1808"></a><span class="sd">        The format of the output file is determined by the file extension in the path.</span>
<a id="__codelineno-0-1809" name="__codelineno-0-1809"></a>
<a id="__codelineno-0-1810" name="__codelineno-0-1810"></a><span class="sd">        Parameters</span>
<a id="__codelineno-0-1811" name="__codelineno-0-1811"></a><span class="sd">        ----------</span>
<a id="__codelineno-0-1812" name="__codelineno-0-1812"></a><span class="sd">        path : str</span>
<a id="__codelineno-0-1813" name="__codelineno-0-1813"></a><span class="sd">            The file path where the animation will be saved.</span>
<a id="__codelineno-0-1814" name="__codelineno-0-1814"></a><span class="sd">            The file extension determines the output format.</span>
<a id="__codelineno-0-1815" name="__codelineno-0-1815"></a><span class="sd">            Supported formats: gif, mov, avi, mp4.</span>
<a id="__codelineno-0-1816" name="__codelineno-0-1816"></a><span class="sd">        fps : int, optional</span>
<a id="__codelineno-0-1817" name="__codelineno-0-1817"></a><span class="sd">            Frames per second for the saved animation, by default 2.</span>
<a id="__codelineno-0-1818" name="__codelineno-0-1818"></a><span class="sd">            Higher values create faster animations, lower values create slower animations.</span>
<a id="__codelineno-0-1819" name="__codelineno-0-1819"></a>
<a id="__codelineno-0-1820" name="__codelineno-0-1820"></a><span class="sd">        Raises</span>
<a id="__codelineno-0-1821" name="__codelineno-0-1821"></a><span class="sd">        ------</span>
<a id="__codelineno-0-1822" name="__codelineno-0-1822"></a><span class="sd">        ValueError</span>
<a id="__codelineno-0-1823" name="__codelineno-0-1823"></a><span class="sd">            If the file extension is not one of the supported formats.</span>
<a id="__codelineno-0-1824" name="__codelineno-0-1824"></a><span class="sd">        FileNotFoundError</span>
<a id="__codelineno-0-1825" name="__codelineno-0-1825"></a><span class="sd">            If FFmpeg is not installed (required for mov, avi, and mp4 formats).</span>
<a id="__codelineno-0-1826" name="__codelineno-0-1826"></a>
<a id="__codelineno-0-1827" name="__codelineno-0-1827"></a><span class="sd">        Notes</span>
<a id="__codelineno-0-1828" name="__codelineno-0-1828"></a><span class="sd">        -----</span>
<a id="__codelineno-0-1829" name="__codelineno-0-1829"></a><span class="sd">        - For GIF format, the PillowWriter is used.</span>
<a id="__codelineno-0-1830" name="__codelineno-0-1830"></a><span class="sd">        - For MOV, AVI, and MP4 formats, FFMpegWriter is used, which requires FFmpeg to be installed.</span>
<a id="__codelineno-0-1831" name="__codelineno-0-1831"></a><span class="sd">        - You can download FFmpeg from https://ffmpeg.org/</span>
<a id="__codelineno-0-1832" name="__codelineno-0-1832"></a>
<a id="__codelineno-0-1833" name="__codelineno-0-1833"></a><span class="sd">        Examples</span>
<a id="__codelineno-0-1834" name="__codelineno-0-1834"></a><span class="sd">        --------</span>
<a id="__codelineno-0-1835" name="__codelineno-0-1835"></a><span class="sd">        Save an animation as a GIF file:</span>
<a id="__codelineno-0-1836" name="__codelineno-0-1836"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-1837" name="__codelineno-0-1837"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-1838" name="__codelineno-0-1838"></a><span class="sd">        &gt;&gt;&gt; from cleopatra.array_glyph import ArrayGlyph</span>
<a id="__codelineno-0-1839" name="__codelineno-0-1839"></a><span class="sd">        &gt;&gt;&gt; # Create a 3D array with 5 frames, each 10x10</span>
<a id="__codelineno-0-1840" name="__codelineno-0-1840"></a><span class="sd">        &gt;&gt;&gt; arr = np.random.randint(1, 10, size=(5, 10, 10))</span>
<a id="__codelineno-0-1841" name="__codelineno-0-1841"></a><span class="sd">        &gt;&gt;&gt; frame_labels = [&quot;Frame 1&quot;, &quot;Frame 2&quot;, &quot;Frame 3&quot;, &quot;Frame 4&quot;, &quot;Frame 5&quot;]</span>
<a id="__codelineno-0-1842" name="__codelineno-0-1842"></a><span class="sd">        &gt;&gt;&gt; animated_array = ArrayGlyph(arr)</span>
<a id="__codelineno-0-1843" name="__codelineno-0-1843"></a><span class="sd">        &gt;&gt;&gt; anim_obj = animated_array.animate(frame_labels)</span>
<a id="__codelineno-0-1844" name="__codelineno-0-1844"></a><span class="sd">        &gt;&gt;&gt; animated_array.save_animation(&quot;animation.gif&quot;)</span>
<a id="__codelineno-0-1845" name="__codelineno-0-1845"></a>
<a id="__codelineno-0-1846" name="__codelineno-0-1846"></a><span class="sd">        ```</span>
<a id="__codelineno-0-1847" name="__codelineno-0-1847"></a><span class="sd">        Save with a higher frame rate for a faster animation:</span>
<a id="__codelineno-0-1848" name="__codelineno-0-1848"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-1849" name="__codelineno-0-1849"></a><span class="sd">        &gt;&gt;&gt; animated_array.save_animation(&quot;animation.gif&quot;, fps=5)</span>
<a id="__codelineno-0-1850" name="__codelineno-0-1850"></a>
<a id="__codelineno-0-1851" name="__codelineno-0-1851"></a><span class="sd">        ```</span>
<a id="__codelineno-0-1852" name="__codelineno-0-1852"></a><span class="sd">        Save in MP4 format (requires FFmpeg):</span>
<a id="__codelineno-0-1853" name="__codelineno-0-1853"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-1854" name="__codelineno-0-1854"></a><span class="sd">        &gt;&gt;&gt; animated_array.save_animation(&quot;animation.mp4&quot;, fps=10)</span>
<a id="__codelineno-0-1855" name="__codelineno-0-1855"></a>
<a id="__codelineno-0-1856" name="__codelineno-0-1856"></a><span class="sd">        ```</span>
<a id="__codelineno-0-1857" name="__codelineno-0-1857"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-1858" name="__codelineno-0-1858"></a>        <span class="n">video_format</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-1859" name="__codelineno-0-1859"></a>        <span class="k">if</span> <span class="n">video_format</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">SUPPORTED_VIDEO_FORMAT</span><span class="p">:</span>
<a id="__codelineno-0-1860" name="__codelineno-0-1860"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1861" name="__codelineno-0-1861"></a>                <span class="sa">f</span><span class="s2">&quot;The given extension </span><span class="si">{</span><span class="n">video_format</span><span class="si">}</span><span class="s2"> implies a format that is not supported, &quot;</span>
<a id="__codelineno-0-1862" name="__codelineno-0-1862"></a>                <span class="sa">f</span><span class="s2">&quot;only </span><span class="si">{</span><span class="n">SUPPORTED_VIDEO_FORMAT</span><span class="si">}</span><span class="s2"> are supported&quot;</span>
<a id="__codelineno-0-1863" name="__codelineno-0-1863"></a>            <span class="p">)</span>
<a id="__codelineno-0-1864" name="__codelineno-0-1864"></a>
<a id="__codelineno-0-1865" name="__codelineno-0-1865"></a>        <span class="k">if</span> <span class="n">video_format</span> <span class="o">==</span> <span class="s2">&quot;gif&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1866" name="__codelineno-0-1866"></a>            <span class="n">writer_gif</span> <span class="o">=</span> <span class="n">animation</span><span class="o">.</span><span class="n">PillowWriter</span><span class="p">(</span><span class="n">fps</span><span class="o">=</span><span class="n">fps</span><span class="p">)</span>
<a id="__codelineno-0-1867" name="__codelineno-0-1867"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">anim</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">writer</span><span class="o">=</span><span class="n">writer_gif</span><span class="p">)</span>
<a id="__codelineno-0-1868" name="__codelineno-0-1868"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1869" name="__codelineno-0-1869"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-1870" name="__codelineno-0-1870"></a>                <span class="k">if</span> <span class="n">video_format</span> <span class="o">==</span> <span class="s2">&quot;avi&quot;</span> <span class="ow">or</span> <span class="n">video_format</span> <span class="o">==</span> <span class="s2">&quot;mov&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1871" name="__codelineno-0-1871"></a>                    <span class="n">writer_video</span> <span class="o">=</span> <span class="n">animation</span><span class="o">.</span><span class="n">FFMpegWriter</span><span class="p">(</span><span class="n">fps</span><span class="o">=</span><span class="n">fps</span><span class="p">,</span> <span class="n">bitrate</span><span class="o">=</span><span class="mi">1800</span><span class="p">)</span>
<a id="__codelineno-0-1872" name="__codelineno-0-1872"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">anim</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">writer</span><span class="o">=</span><span class="n">writer_video</span><span class="p">)</span>
<a id="__codelineno-0-1873" name="__codelineno-0-1873"></a>                <span class="k">elif</span> <span class="n">video_format</span> <span class="o">==</span> <span class="s2">&quot;mp4&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1874" name="__codelineno-0-1874"></a>                    <span class="n">writer_mp4</span> <span class="o">=</span> <span class="n">animation</span><span class="o">.</span><span class="n">FFMpegWriter</span><span class="p">(</span><span class="n">fps</span><span class="o">=</span><span class="n">fps</span><span class="p">,</span> <span class="n">bitrate</span><span class="o">=</span><span class="mi">1800</span><span class="p">)</span>
<a id="__codelineno-0-1875" name="__codelineno-0-1875"></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">anim</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">writer</span><span class="o">=</span><span class="n">writer_mp4</span><span class="p">)</span>
<a id="__codelineno-0-1876" name="__codelineno-0-1876"></a>            <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
<a id="__codelineno-0-1877" name="__codelineno-0-1877"></a>                <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-1878" name="__codelineno-0-1878"></a>                    <span class="s2">&quot;Please visit https://ffmpeg.org/ and download a version of ffmpeg compatible with your operating&quot;</span>
<a id="__codelineno-0-1879" name="__codelineno-0-1879"></a>                    <span class="s2">&quot;system, for more details please check the method definition&quot;</span>
<a id="__codelineno-0-1880" name="__codelineno-0-1880"></a>                <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="cleopatra.array_glyph.ArrayGlyph.anim" class="doc doc-heading"><a href="#cleopatra.array_glyph.ArrayGlyph.anim" class="toclink">
            <code class="highlight language-python"><span class="n">anim</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</a><a href="#cleopatra.array_glyph.ArrayGlyph.anim" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Animation function</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cleopatra.array_glyph.ArrayGlyph.arr" class="doc doc-heading"><a href="#cleopatra.array_glyph.ArrayGlyph.arr" class="toclink">
            <code class="highlight language-python"><span class="n">arr</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</a><a href="#cleopatra.array_glyph.ArrayGlyph.arr" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>array</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cleopatra.array_glyph.ArrayGlyph.default_options" class="doc doc-heading"><a href="#cleopatra.array_glyph.ArrayGlyph.default_options" class="toclink">
            <code class="highlight language-python"><span class="n">default_options</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</a><a href="#cleopatra.array_glyph.ArrayGlyph.default_options" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Default plot options</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cleopatra.array_glyph.ArrayGlyph.exclude_value" class="doc doc-heading"><a href="#cleopatra.array_glyph.ArrayGlyph.exclude_value" class="toclink">
            <code class="highlight language-python"><span class="n">exclude_value</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</a><a href="#cleopatra.array_glyph.ArrayGlyph.exclude_value" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>exclude_value</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cleopatra.array_glyph.ArrayGlyph.vmax" class="doc doc-heading"><a href="#cleopatra.array_glyph.ArrayGlyph.vmax" class="toclink">
            <code class="highlight language-python"><span class="n">vmax</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</a><a href="#cleopatra.array_glyph.ArrayGlyph.vmax" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>max value in the array</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="cleopatra.array_glyph.ArrayGlyph.vmin" class="doc doc-heading"><a href="#cleopatra.array_glyph.ArrayGlyph.vmin" class="toclink">
            <code class="highlight language-python"><span class="n">vmin</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</a><a href="#cleopatra.array_glyph.ArrayGlyph.vmin" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>min value in the array</p>

    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="cleopatra.array_glyph.ArrayGlyph.__init__" class="doc doc-heading"><a href="#cleopatra.array_glyph.ArrayGlyph.__init__" class="toclink">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">exclude_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rgb</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">surface_reflectance</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">percentile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</a><a href="#cleopatra.array_glyph.ArrayGlyph.__init__" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Initialize the ArrayGlyph object with an array and optional parameters.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>array</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The array to be visualized. Can be a 2D array for single plots or a 3D array for RGB plots or animations.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exclude_value</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span> or <span title="numeric">numeric</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value(s) used to mask cells out of the domain, by default np.nan.
Can be a single value or a list of values to exclude.</p>
              </div>
            </td>
            <td>
                  <code><span title="numpy.nan">nan</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>extent</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The extent of the array in the format [xmin, ymin, xmax, ymax], by default None.
If provided, the array will be plotted with these spatial boundaries.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rgb</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The indices of the red, green, and blue bands in the given array, by default None.
If provided, the array will be treated as an RGB image.
Can be a list of three values [r, g, b], or four values if alpha band is included [r, g, b, a].</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>surface_reflectance</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Surface reflectance value for normalizing satellite data, by default None.
Typically 10000 for Sentinel-2 data.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cutoff</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Clip the range of pixel values for each band, by default None.
Takes only pixel values from 0 to the value of the cutoff and scales them back to between 0 and 1.
Should be a list with one value per band.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ax</code>
            </td>
            <td>
                  <code><span title="matplotlib.axes.Axes">Axes</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A pre-existing axes to plot on, by default None.
If None, a new axes will be created.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fig</code>
            </td>
            <td>
                  <code><span title="matplotlib.figure.Figure">Figure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A pre-existing figure to plot on, by default None.
If None, a new figure will be created.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>percentile</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The percentile value to be used for scaling the array values, by default None.
Used to enhance contrast by stretching the histogram.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments for customizing the plot.
Supported arguments include:
    figsize : tuple, optional
        Figure size, by default (8, 8).
    vmin : float, optional
        Minimum value for color scaling, by default min(array).
    vmax : float, optional
        Maximum value for color scaling, by default max(array).
    title : str, optional
        Title of the plot, by default 'Array Plot'.
    title_size : int, optional
        Title font size, by default 15.
    cmap : str, optional
        Colormap name, by default 'coolwarm_r'.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If an invalid keyword argument is provided.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If rgb is provided but the array doesn't have enough dimensions.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Basic initialization with a 2D array:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">cleopatra.array_glyph</span><span class="w"> </span><span class="kn">import</span> <span class="n">ArrayGlyph</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]])</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">array_glyph</span> <span class="o">=</span> <span class="n">ArrayGlyph</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">array_glyph</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</code></pre></div>
Initialization with custom figure size and title:
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">array_glyph</span> <span class="o">=</span> <span class="n">ArrayGlyph</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Custom Array Plot&quot;</span><span class="p">)</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">array_glyph</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</code></pre></div>
Initialization with RGB bands from a 3D array:
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">rgb_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">rgb_glyph</span> <span class="o">=</span> <span class="n">ArrayGlyph</span><span class="p">(</span><span class="n">rgb_array</span><span class="p">,</span> <span class="n">rgb</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">surface_reflectance</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">rgb_glyph</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</code></pre></div>
Initialization with custom extent:
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">array_glyph</span> <span class="o">=</span> <span class="n">ArrayGlyph</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">array_glyph</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</code></pre></div></p>


            <details class="quote">
              <summary>Source code in <code>cleopatra/array_glyph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span>
<span class="normal"><a href="#__codelineno-0-277">277</a></span>
<span class="normal"><a href="#__codelineno-0-278">278</a></span>
<span class="normal"><a href="#__codelineno-0-279">279</a></span>
<span class="normal"><a href="#__codelineno-0-280">280</a></span>
<span class="normal"><a href="#__codelineno-0-281">281</a></span>
<span class="normal"><a href="#__codelineno-0-282">282</a></span>
<span class="normal"><a href="#__codelineno-0-283">283</a></span>
<span class="normal"><a href="#__codelineno-0-284">284</a></span>
<span class="normal"><a href="#__codelineno-0-285">285</a></span>
<span class="normal"><a href="#__codelineno-0-286">286</a></span>
<span class="normal"><a href="#__codelineno-0-287">287</a></span>
<span class="normal"><a href="#__codelineno-0-288">288</a></span>
<span class="normal"><a href="#__codelineno-0-289">289</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="n">array</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="n">exclude_value</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>    <span class="n">extent</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="n">rgb</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="n">surface_reflectance</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="n">cutoff</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>    <span class="n">ax</span><span class="p">:</span> <span class="n">Axes</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="n">fig</span><span class="p">:</span> <span class="n">Figure</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="n">percentile</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="p">):</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the ArrayGlyph object with an array and optional parameters.</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">    array : np.ndarray</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">        The array to be visualized. Can be a 2D array for single plots or a 3D array for RGB plots or animations.</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">    exclude_value : List or numeric, optional</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a><span class="sd">        Value(s) used to mask cells out of the domain, by default np.nan.</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">        Can be a single value or a list of values to exclude.</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">    extent : List, optional</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">        The extent of the array in the format [xmin, ymin, xmax, ymax], by default None.</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a><span class="sd">        If provided, the array will be plotted with these spatial boundaries.</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="sd">    rgb : List[int], optional</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a><span class="sd">        The indices of the red, green, and blue bands in the given array, by default None.</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a><span class="sd">        If provided, the array will be treated as an RGB image.</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a><span class="sd">        Can be a list of three values [r, g, b], or four values if alpha band is included [r, g, b, a].</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="sd">    surface_reflectance : int, optional</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">        Surface reflectance value for normalizing satellite data, by default None.</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a><span class="sd">        Typically 10000 for Sentinel-2 data.</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">    cutoff : List, optional</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">        Clip the range of pixel values for each band, by default None.</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">        Takes only pixel values from 0 to the value of the cutoff and scales them back to between 0 and 1.</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">        Should be a list with one value per band.</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">    ax : matplotlib.axes.Axes, optional</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">        A pre-existing axes to plot on, by default None.</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">        If None, a new axes will be created.</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">    fig : matplotlib.figure.Figure, optional</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">        A pre-existing figure to plot on, by default None.</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">        If None, a new figure will be created.</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">    percentile : int, optional</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">        The percentile value to be used for scaling the array values, by default None.</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">        Used to enhance contrast by stretching the histogram.</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">    **kwargs : dict</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">        Additional keyword arguments for customizing the plot.</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">        Supported arguments include:</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">            figsize : tuple, optional</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">                Figure size, by default (8, 8).</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">            vmin : float, optional</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">                Minimum value for color scaling, by default min(array).</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">            vmax : float, optional</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">                Maximum value for color scaling, by default max(array).</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">            title : str, optional</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">                Title of the plot, by default &#39;Array Plot&#39;.</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="sd">            title_size : int, optional</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">                Title font size, by default 15.</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">            cmap : str, optional</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">                Colormap name, by default &#39;coolwarm_r&#39;.</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a><span class="sd">    Raises</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a><span class="sd">    ------</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a><span class="sd">    ValueError</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="sd">        If an invalid keyword argument is provided.</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="sd">    ValueError</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a><span class="sd">        If rgb is provided but the array doesn&#39;t have enough dimensions.</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">    --------</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">    Basic initialization with a 2D array:</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">    &gt;&gt;&gt; from cleopatra.array_glyph import ArrayGlyph</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">    &gt;&gt;&gt; arr = np.array([[1, 2, 3], [4, 5, 6], [7, 8, 9]])</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a><span class="sd">    &gt;&gt;&gt; array_glyph = ArrayGlyph(arr)</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">    &gt;&gt;&gt; fig, ax = array_glyph.plot()</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">    ```</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a><span class="sd">    Initialization with custom figure size and title:</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a><span class="sd">    &gt;&gt;&gt; array_glyph = ArrayGlyph(arr, figsize=(10, 8), title=&quot;Custom Array Plot&quot;)</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a><span class="sd">    &gt;&gt;&gt; fig, ax = array_glyph.plot()</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a><span class="sd">    ```</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a><span class="sd">    Initialization with RGB bands from a 3D array:</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a><span class="sd">    &gt;&gt;&gt; rgb_array = np.random.randint(0, 255, size=(3, 10, 10))</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a><span class="sd">    &gt;&gt;&gt; rgb_glyph = ArrayGlyph(rgb_array, rgb=[0, 1, 2], surface_reflectance=255)</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a><span class="sd">    &gt;&gt;&gt; fig, ax = rgb_glyph.plot()</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a><span class="sd">    ```</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a><span class="sd">    Initialization with custom extent:</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a><span class="sd">    &gt;&gt;&gt; array_glyph = ArrayGlyph(arr, extent=[0, 0, 10, 10])</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a><span class="sd">    &gt;&gt;&gt; fig, ax = array_glyph.plot()</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a><span class="sd">    ```</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_default_options</span> <span class="o">=</span> <span class="n">DEFAULT_OPTIONS</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>                <span class="sa">f</span><span class="s2">&quot;The given keyword argument:</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> is not correct, possible parameters are,&quot;</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>                <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">DEFAULT_OPTIONS</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>            <span class="p">)</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>    <span class="c1"># first replace the no_data_value by nan</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>    <span class="c1"># convert the array to float32 to be able to replace the no data value with nan</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>    <span class="k">if</span> <span class="n">exclude_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">:</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">exclude_value</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>            <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>                <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">exclude_value</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">0.001</span><span class="p">),</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>                <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">exclude_value</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">0.001</span><span class="p">),</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>            <span class="p">)</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>            <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">exclude_value</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">0.0000001</span><span class="p">)</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>        <span class="n">array</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">array</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>        <span class="n">array</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>    <span class="c1"># convert the extent from [xmin, ymin, xmax, ymax] to [xmin, xmax, ymin, ymax] as required by matplotlib.</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>    <span class="k">if</span> <span class="n">extent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>        <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="n">extent</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">extent</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">extent</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">extent</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">extent</span> <span class="o">=</span> <span class="n">extent</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>    <span class="k">if</span> <span class="n">rgb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>        <span class="c1"># prepare to plot rgb plot only if there are three arrays</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>        <span class="k">if</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>                <span class="sa">f</span><span class="s2">&quot;To plot RGB plot the given array should have only 3 arrays, given array have &quot;</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>            <span class="p">)</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>            <span class="n">array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prepare_array</span><span class="p">(</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>                <span class="n">array</span><span class="p">,</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>                <span class="n">rgb</span><span class="o">=</span><span class="n">rgb</span><span class="p">,</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>                <span class="n">surface_reflectance</span><span class="o">=</span><span class="n">surface_reflectance</span><span class="p">,</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>                <span class="n">cutoff</span><span class="o">=</span><span class="n">cutoff</span><span class="p">,</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>                <span class="n">percentile</span><span class="o">=</span><span class="n">percentile</span><span class="p">,</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>            <span class="p">)</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_exclude_value</span> <span class="o">=</span> <span class="n">exclude_value</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_vmax</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>        <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;vmax&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;vmax&quot;</span><span class="p">)</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>    <span class="p">)</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_vmin</span> <span class="o">=</span> <span class="p">(</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>        <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;vmin&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;vmin&quot;</span><span class="p">)</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>    <span class="p">)</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_arr</span> <span class="o">=</span> <span class="n">array</span>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>    <span class="c1"># get the tick spacing that has 10 ticks only</span>
<a id="__codelineno-0-277" name="__codelineno-0-277"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">ticks_spacing</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vmax</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vmin</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span>
<a id="__codelineno-0-278" name="__codelineno-0-278"></a>    <span class="n">shape</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-279" name="__codelineno-0-279"></a>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
<a id="__codelineno-0-280" name="__codelineno-0-280"></a>        <span class="n">no_elem</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<a id="__codelineno-0-281" name="__codelineno-0-281"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-282" name="__codelineno-0-282"></a>        <span class="n">no_elem</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<a id="__codelineno-0-283" name="__codelineno-0-283"></a>
<a id="__codelineno-0-284" name="__codelineno-0-284"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">no_elem</span> <span class="o">=</span> <span class="n">no_elem</span>
<a id="__codelineno-0-285" name="__codelineno-0-285"></a>
<a id="__codelineno-0-286" name="__codelineno-0-286"></a>    <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-287" name="__codelineno-0-287"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
<a id="__codelineno-0-288" name="__codelineno-0-288"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-289" name="__codelineno-0-289"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="cleopatra.array_glyph.ArrayGlyph.__str__" class="doc doc-heading"><a href="#cleopatra.array_glyph.ArrayGlyph.__str__" class="toclink">
            <code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span></code>

</a><a href="#cleopatra.array_glyph.ArrayGlyph.__str__" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>String representation of the Array object.</p>


            <details class="quote">
              <summary>Source code in <code>cleopatra/array_glyph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-618">618</a></span>
<span class="normal"><a href="#__codelineno-0-619">619</a></span>
<span class="normal"><a href="#__codelineno-0-620">620</a></span>
<span class="normal"><a href="#__codelineno-0-621">621</a></span>
<span class="normal"><a href="#__codelineno-0-622">622</a></span>
<span class="normal"><a href="#__codelineno-0-623">623</a></span>
<span class="normal"><a href="#__codelineno-0-624">624</a></span>
<span class="normal"><a href="#__codelineno-0-625">625</a></span>
<span class="normal"><a href="#__codelineno-0-626">626</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-618" name="__codelineno-0-618"></a><span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-619" name="__codelineno-0-619"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;String representation of the Array object.&quot;&quot;&quot;</span>
<a id="__codelineno-0-620" name="__codelineno-0-620"></a>    <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-0-621" name="__codelineno-0-621"></a><span class="s2">                Min: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">vmin</span><span class="si">}</span>
<a id="__codelineno-0-622" name="__codelineno-0-622"></a><span class="s2">                Max: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">vmax</span><span class="si">}</span>
<a id="__codelineno-0-623" name="__codelineno-0-623"></a><span class="s2">                Exclude values: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">exclude_value</span><span class="si">}</span>
<a id="__codelineno-0-624" name="__codelineno-0-624"></a><span class="s2">                RGB: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">rgb</span><span class="si">}</span>
<a id="__codelineno-0-625" name="__codelineno-0-625"></a><span class="s2">            &quot;&quot;&quot;</span>
<a id="__codelineno-0-626" name="__codelineno-0-626"></a>    <span class="k">return</span> <span class="n">message</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="cleopatra.array_glyph.ArrayGlyph.adjust_ticks" class="doc doc-heading"><a href="#cleopatra.array_glyph.ArrayGlyph.adjust_ticks" class="toclink">
            <code class="highlight language-python"><span class="n">adjust_ticks</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">multiply_value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">add_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{0:g}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</a><a href="#cleopatra.array_glyph.ArrayGlyph.adjust_ticks" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Adjust the ticks of the axes.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>axis</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>x or y.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>multiply_value</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="float">float</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>value to be multiplied.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>add_value</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="float">float</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>value to be added.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fmt</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>format of the ticks.
- 123.456 with the format "{0:f}" will give '123.456000'.
- 123.456 with the format "{0:.2f}" will give '123.46'.
- 123456.789 with the format "{0:e}" will give '1.234568e+05'.
- 123456.789 with the format "{0:.2e}" will give '1.23e+05'.
- 123456.789 with the format "{0:g}" will give '123457'.
- 123456.789 with the format "{0:.2g}" will give '1.2e+05'.
- 123 with the format "{0:d}" will give '123'.
visible: bool, optional, default is True.
Whether the ticks are visible or not.</p>
              </div>
            </td>
            <td>
                  <code>&#39;{0:g}&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <ul>
<li>
<p>Create an array and instantiate the <code>ArrayGlyph</code> object:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span> <span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">]])</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="mf">34.62</span><span class="p">,</span> <span class="mf">34.65</span><span class="p">,</span> <span class="mf">31.82</span><span class="p">,</span> <span class="mf">31.85</span><span class="p">]</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">my_glyph</span> <span class="o">=</span> <span class="n">ArrayGlyph</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">my_glyph</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</code></pre></div>
    <img alt="adjust_tick" src="../../_images/array_glyph/adjust_tick.png" /></p>
</li>
<li>
<p>Adjust the ticks of the x-axis:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">my_glyph</span><span class="o">.</span><span class="n">adjust_ticks</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">multiply_value</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">add_value</span><span class="o">=</span><span class="mf">34.62</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{0:.2f}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
    <img alt="adjust_tick" src="../../_images/array_glyph/adjust_tick-x.png" /></p>
</li>
<li>
<p>Adjust the ticks of the y-axis:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">my_glyph</span><span class="o">.</span><span class="n">adjust_ticks</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">multiply_value</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">add_value</span><span class="o">=</span><span class="mf">31.82</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{0:.2e}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
    <img alt="adjust_tick-y" src="../../_images/array_glyph/adjust_tick-y.png" /></p>
</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>cleopatra/array_glyph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1353">1353</a></span>
<span class="normal"><a href="#__codelineno-0-1354">1354</a></span>
<span class="normal"><a href="#__codelineno-0-1355">1355</a></span>
<span class="normal"><a href="#__codelineno-0-1356">1356</a></span>
<span class="normal"><a href="#__codelineno-0-1357">1357</a></span>
<span class="normal"><a href="#__codelineno-0-1358">1358</a></span>
<span class="normal"><a href="#__codelineno-0-1359">1359</a></span>
<span class="normal"><a href="#__codelineno-0-1360">1360</a></span>
<span class="normal"><a href="#__codelineno-0-1361">1361</a></span>
<span class="normal"><a href="#__codelineno-0-1362">1362</a></span>
<span class="normal"><a href="#__codelineno-0-1363">1363</a></span>
<span class="normal"><a href="#__codelineno-0-1364">1364</a></span>
<span class="normal"><a href="#__codelineno-0-1365">1365</a></span>
<span class="normal"><a href="#__codelineno-0-1366">1366</a></span>
<span class="normal"><a href="#__codelineno-0-1367">1367</a></span>
<span class="normal"><a href="#__codelineno-0-1368">1368</a></span>
<span class="normal"><a href="#__codelineno-0-1369">1369</a></span>
<span class="normal"><a href="#__codelineno-0-1370">1370</a></span>
<span class="normal"><a href="#__codelineno-0-1371">1371</a></span>
<span class="normal"><a href="#__codelineno-0-1372">1372</a></span>
<span class="normal"><a href="#__codelineno-0-1373">1373</a></span>
<span class="normal"><a href="#__codelineno-0-1374">1374</a></span>
<span class="normal"><a href="#__codelineno-0-1375">1375</a></span>
<span class="normal"><a href="#__codelineno-0-1376">1376</a></span>
<span class="normal"><a href="#__codelineno-0-1377">1377</a></span>
<span class="normal"><a href="#__codelineno-0-1378">1378</a></span>
<span class="normal"><a href="#__codelineno-0-1379">1379</a></span>
<span class="normal"><a href="#__codelineno-0-1380">1380</a></span>
<span class="normal"><a href="#__codelineno-0-1381">1381</a></span>
<span class="normal"><a href="#__codelineno-0-1382">1382</a></span>
<span class="normal"><a href="#__codelineno-0-1383">1383</a></span>
<span class="normal"><a href="#__codelineno-0-1384">1384</a></span>
<span class="normal"><a href="#__codelineno-0-1385">1385</a></span>
<span class="normal"><a href="#__codelineno-0-1386">1386</a></span>
<span class="normal"><a href="#__codelineno-0-1387">1387</a></span>
<span class="normal"><a href="#__codelineno-0-1388">1388</a></span>
<span class="normal"><a href="#__codelineno-0-1389">1389</a></span>
<span class="normal"><a href="#__codelineno-0-1390">1390</a></span>
<span class="normal"><a href="#__codelineno-0-1391">1391</a></span>
<span class="normal"><a href="#__codelineno-0-1392">1392</a></span>
<span class="normal"><a href="#__codelineno-0-1393">1393</a></span>
<span class="normal"><a href="#__codelineno-0-1394">1394</a></span>
<span class="normal"><a href="#__codelineno-0-1395">1395</a></span>
<span class="normal"><a href="#__codelineno-0-1396">1396</a></span>
<span class="normal"><a href="#__codelineno-0-1397">1397</a></span>
<span class="normal"><a href="#__codelineno-0-1398">1398</a></span>
<span class="normal"><a href="#__codelineno-0-1399">1399</a></span>
<span class="normal"><a href="#__codelineno-0-1400">1400</a></span>
<span class="normal"><a href="#__codelineno-0-1401">1401</a></span>
<span class="normal"><a href="#__codelineno-0-1402">1402</a></span>
<span class="normal"><a href="#__codelineno-0-1403">1403</a></span>
<span class="normal"><a href="#__codelineno-0-1404">1404</a></span>
<span class="normal"><a href="#__codelineno-0-1405">1405</a></span>
<span class="normal"><a href="#__codelineno-0-1406">1406</a></span>
<span class="normal"><a href="#__codelineno-0-1407">1407</a></span>
<span class="normal"><a href="#__codelineno-0-1408">1408</a></span>
<span class="normal"><a href="#__codelineno-0-1409">1409</a></span>
<span class="normal"><a href="#__codelineno-0-1410">1410</a></span>
<span class="normal"><a href="#__codelineno-0-1411">1411</a></span>
<span class="normal"><a href="#__codelineno-0-1412">1412</a></span>
<span class="normal"><a href="#__codelineno-0-1413">1413</a></span>
<span class="normal"><a href="#__codelineno-0-1414">1414</a></span>
<span class="normal"><a href="#__codelineno-0-1415">1415</a></span>
<span class="normal"><a href="#__codelineno-0-1416">1416</a></span>
<span class="normal"><a href="#__codelineno-0-1417">1417</a></span>
<span class="normal"><a href="#__codelineno-0-1418">1418</a></span>
<span class="normal"><a href="#__codelineno-0-1419">1419</a></span>
<span class="normal"><a href="#__codelineno-0-1420">1420</a></span>
<span class="normal"><a href="#__codelineno-0-1421">1421</a></span>
<span class="normal"><a href="#__codelineno-0-1422">1422</a></span>
<span class="normal"><a href="#__codelineno-0-1423">1423</a></span>
<span class="normal"><a href="#__codelineno-0-1424">1424</a></span>
<span class="normal"><a href="#__codelineno-0-1425">1425</a></span>
<span class="normal"><a href="#__codelineno-0-1426">1426</a></span>
<span class="normal"><a href="#__codelineno-0-1427">1427</a></span>
<span class="normal"><a href="#__codelineno-0-1428">1428</a></span>
<span class="normal"><a href="#__codelineno-0-1429">1429</a></span>
<span class="normal"><a href="#__codelineno-0-1430">1430</a></span>
<span class="normal"><a href="#__codelineno-0-1431">1431</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1353" name="__codelineno-0-1353"></a><span class="k">def</span><span class="w"> </span><span class="nf">adjust_ticks</span><span class="p">(</span>
<a id="__codelineno-0-1354" name="__codelineno-0-1354"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1355" name="__codelineno-0-1355"></a>    <span class="n">axis</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-1356" name="__codelineno-0-1356"></a>    <span class="n">multiply_value</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-1357" name="__codelineno-0-1357"></a>    <span class="n">add_value</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-1358" name="__codelineno-0-1358"></a>    <span class="n">fmt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{0:g}</span><span class="s2">&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1359" name="__codelineno-0-1359"></a>    <span class="n">visible</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1360" name="__codelineno-0-1360"></a><span class="p">):</span>
<a id="__codelineno-0-1361" name="__codelineno-0-1361"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Adjust the ticks of the axes.</span>
<a id="__codelineno-0-1362" name="__codelineno-0-1362"></a>
<a id="__codelineno-0-1363" name="__codelineno-0-1363"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-1364" name="__codelineno-0-1364"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-1365" name="__codelineno-0-1365"></a><span class="sd">    axis: str</span>
<a id="__codelineno-0-1366" name="__codelineno-0-1366"></a><span class="sd">        x or y.</span>
<a id="__codelineno-0-1367" name="__codelineno-0-1367"></a><span class="sd">    multiply_value: Union[float, int]</span>
<a id="__codelineno-0-1368" name="__codelineno-0-1368"></a><span class="sd">        value to be multiplied.</span>
<a id="__codelineno-0-1369" name="__codelineno-0-1369"></a><span class="sd">    add_value: Union[float, int]</span>
<a id="__codelineno-0-1370" name="__codelineno-0-1370"></a><span class="sd">        value to be added.</span>
<a id="__codelineno-0-1371" name="__codelineno-0-1371"></a><span class="sd">    fmt: str, default is &quot;{0:g}&quot;.</span>
<a id="__codelineno-0-1372" name="__codelineno-0-1372"></a><span class="sd">        format of the ticks.</span>
<a id="__codelineno-0-1373" name="__codelineno-0-1373"></a><span class="sd">        - 123.456 with the format &quot;{0:f}&quot; will give &#39;123.456000&#39;.</span>
<a id="__codelineno-0-1374" name="__codelineno-0-1374"></a><span class="sd">        - 123.456 with the format &quot;{0:.2f}&quot; will give &#39;123.46&#39;.</span>
<a id="__codelineno-0-1375" name="__codelineno-0-1375"></a><span class="sd">        - 123456.789 with the format &quot;{0:e}&quot; will give &#39;1.234568e+05&#39;.</span>
<a id="__codelineno-0-1376" name="__codelineno-0-1376"></a><span class="sd">        - 123456.789 with the format &quot;{0:.2e}&quot; will give &#39;1.23e+05&#39;.</span>
<a id="__codelineno-0-1377" name="__codelineno-0-1377"></a><span class="sd">        - 123456.789 with the format &quot;{0:g}&quot; will give &#39;123457&#39;.</span>
<a id="__codelineno-0-1378" name="__codelineno-0-1378"></a><span class="sd">        - 123456.789 with the format &quot;{0:.2g}&quot; will give &#39;1.2e+05&#39;.</span>
<a id="__codelineno-0-1379" name="__codelineno-0-1379"></a><span class="sd">        - 123 with the format &quot;{0:d}&quot; will give &#39;123&#39;.</span>
<a id="__codelineno-0-1380" name="__codelineno-0-1380"></a><span class="sd">     visible: bool, optional, default is True.</span>
<a id="__codelineno-0-1381" name="__codelineno-0-1381"></a><span class="sd">        Whether the ticks are visible or not.</span>
<a id="__codelineno-0-1382" name="__codelineno-0-1382"></a>
<a id="__codelineno-0-1383" name="__codelineno-0-1383"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-1384" name="__codelineno-0-1384"></a><span class="sd">    -------</span>
<a id="__codelineno-0-1385" name="__codelineno-0-1385"></a><span class="sd">    None</span>
<a id="__codelineno-0-1386" name="__codelineno-0-1386"></a>
<a id="__codelineno-0-1387" name="__codelineno-0-1387"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-1388" name="__codelineno-0-1388"></a><span class="sd">    --------</span>
<a id="__codelineno-0-1389" name="__codelineno-0-1389"></a><span class="sd">    - Create an array and instantiate the `ArrayGlyph` object:</span>
<a id="__codelineno-0-1390" name="__codelineno-0-1390"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-1391" name="__codelineno-0-1391"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-1392" name="__codelineno-0-1392"></a><span class="sd">        &gt;&gt;&gt; arr = np.array([[1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 11, 12], [13, 14, 15, 16]])</span>
<a id="__codelineno-0-1393" name="__codelineno-0-1393"></a><span class="sd">        &gt;&gt;&gt; extent = [34.62, 34.65, 31.82, 31.85]</span>
<a id="__codelineno-0-1394" name="__codelineno-0-1394"></a><span class="sd">        &gt;&gt;&gt; my_glyph = ArrayGlyph(arr, extent=extent)</span>
<a id="__codelineno-0-1395" name="__codelineno-0-1395"></a><span class="sd">        &gt;&gt;&gt; fig, ax = my_glyph.plot()</span>
<a id="__codelineno-0-1396" name="__codelineno-0-1396"></a>
<a id="__codelineno-0-1397" name="__codelineno-0-1397"></a><span class="sd">        ```</span>
<a id="__codelineno-0-1398" name="__codelineno-0-1398"></a><span class="sd">        ![adjust_tick](./../_images/array_glyph/adjust_tick.png)</span>
<a id="__codelineno-0-1399" name="__codelineno-0-1399"></a>
<a id="__codelineno-0-1400" name="__codelineno-0-1400"></a><span class="sd">    - Adjust the ticks of the x-axis:</span>
<a id="__codelineno-0-1401" name="__codelineno-0-1401"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-1402" name="__codelineno-0-1402"></a><span class="sd">        &gt;&gt;&gt; my_glyph.adjust_ticks(axis=&#39;x&#39;, multiply_value=0.01, add_value=34.62, fmt=&quot;{0:.2f}&quot;)</span>
<a id="__codelineno-0-1403" name="__codelineno-0-1403"></a>
<a id="__codelineno-0-1404" name="__codelineno-0-1404"></a><span class="sd">        ```</span>
<a id="__codelineno-0-1405" name="__codelineno-0-1405"></a><span class="sd">        ![adjust_tick](./../_images/array_glyph/adjust_tick-x.png)</span>
<a id="__codelineno-0-1406" name="__codelineno-0-1406"></a>
<a id="__codelineno-0-1407" name="__codelineno-0-1407"></a><span class="sd">    - Adjust the ticks of the y-axis:</span>
<a id="__codelineno-0-1408" name="__codelineno-0-1408"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-1409" name="__codelineno-0-1409"></a><span class="sd">        &gt;&gt;&gt; my_glyph.adjust_ticks(axis=&#39;y&#39;, multiply_value=0.01, add_value=31.82, fmt=&quot;{0:.2e}&quot;)</span>
<a id="__codelineno-0-1410" name="__codelineno-0-1410"></a>
<a id="__codelineno-0-1411" name="__codelineno-0-1411"></a><span class="sd">        ```</span>
<a id="__codelineno-0-1412" name="__codelineno-0-1412"></a><span class="sd">        ![adjust_tick-y](./../_images/array_glyph/adjust_tick-y.png)</span>
<a id="__codelineno-0-1413" name="__codelineno-0-1413"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1414" name="__codelineno-0-1414"></a>    <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1415" name="__codelineno-0-1415"></a>        <span class="n">ticks_x</span> <span class="o">=</span> <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span>
<a id="__codelineno-0-1416" name="__codelineno-0-1416"></a>            <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">multiply_value</span> <span class="o">+</span> <span class="n">add_value</span><span class="p">)</span>
<a id="__codelineno-0-1417" name="__codelineno-0-1417"></a>        <span class="p">)</span>
<a id="__codelineno-0-1418" name="__codelineno-0-1418"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">ticks_x</span><span class="p">)</span>
<a id="__codelineno-0-1419" name="__codelineno-0-1419"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1420" name="__codelineno-0-1420"></a>        <span class="n">ticks_y</span> <span class="o">=</span> <span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span>
<a id="__codelineno-0-1421" name="__codelineno-0-1421"></a>            <span class="k">lambda</span> <span class="n">y</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">y</span> <span class="o">*</span> <span class="n">multiply_value</span> <span class="o">+</span> <span class="n">add_value</span><span class="p">)</span>
<a id="__codelineno-0-1422" name="__codelineno-0-1422"></a>        <span class="p">)</span>
<a id="__codelineno-0-1423" name="__codelineno-0-1423"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">ticks_y</span><span class="p">)</span>
<a id="__codelineno-0-1424" name="__codelineno-0-1424"></a>
<a id="__codelineno-0-1425" name="__codelineno-0-1425"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">visible</span><span class="p">:</span>
<a id="__codelineno-0-1426" name="__codelineno-0-1426"></a>        <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1427" name="__codelineno-0-1427"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="n">visible</span><span class="p">)</span>
<a id="__codelineno-0-1428" name="__codelineno-0-1428"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1429" name="__codelineno-0-1429"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="n">visible</span><span class="p">)</span>
<a id="__codelineno-0-1430" name="__codelineno-0-1430"></a>
<a id="__codelineno-0-1431" name="__codelineno-0-1431"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="cleopatra.array_glyph.ArrayGlyph.animate" class="doc doc-heading"><a href="#cleopatra.array_glyph.ArrayGlyph.animate" class="toclink">
            <code class="highlight language-python"><span class="n">animate</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">points</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">text_colors</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="s1">&#39;black&#39;</span><span class="p">),</span> <span class="n">interval</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">text_loc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">point_color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">point_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">pid_color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">pid_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</a><a href="#cleopatra.array_glyph.ArrayGlyph.animate" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Create an animation from a 3D array.</p>
<p>This method creates an animation by iterating through the first dimension of a 3D array.
Each slice of the array becomes a frame in the animation, with optional time labels,
point annotations, and cell value displays.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>time</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list containing labels for each frame in the animation.
These could be timestamps, frame numbers, or any other identifiers.
The length of this list should match the first dimension of the array.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>points</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Points to display on the array, by default None.
Should be a 3-column array where:
- First column: values to display for each point
- Second column: row indices of the points in the array
- Third column: column indices of the points in the array</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>text_colors</code>
            </td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="str">str</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Two colors to be used for cell value text, by default ("white", "black").
The first color is used when the cell value is below the background_color_threshold,
and the second color is used when the cell value is above the threshold.</p>
              </div>
            </td>
            <td>
                  <code>(&#39;white&#39;, &#39;black&#39;)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>interval</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Delay between frames in milliseconds, by default 200.
Controls the speed of the animation (smaller values = faster animation).</p>
              </div>
            </td>
            <td>
                  <code>200</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>text_loc</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="typing.Any">Any</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Location of the time label text as [x, y] coordinates, by default None.
If None, defaults to [0.1, 0.2].</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>point_color</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Color of the points, by default "red".
Any valid matplotlib color string.</p>
              </div>
            </td>
            <td>
                  <code>&#39;red&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>point_size</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Size of the points, by default 100.
Controls the marker size.</p>
              </div>
            </td>
            <td>
                  <code>100</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pid_color</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Color of the point value annotations, by default "blue".
Any valid matplotlib color string.</p>
              </div>
            </td>
            <td>
                  <code>&#39;blue&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pid_size</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Size of the point value annotations, by default 10.
Controls the font size of the annotations.</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments for customizing the animation.</p>
<h6 id="cleopatra.array_glyph.ArrayGlyph.animate--plot-appearance"><a class="toclink" href="#cleopatra.array_glyph.ArrayGlyph.animate--plot-appearance">Plot appearance:</a><a class="headerlink" href="#cleopatra.array_glyph.ArrayGlyph.animate--plot-appearance" title="Permanent link">#</a></h6>
<p>title : str, optional
    Title of the plot, by default 'Array Plot'.
title_size : int, optional
    Title font size, by default 15.
cmap : str, optional
    Colormap name, by default 'coolwarm_r'.
vmin : float, optional
    Minimum value for color scaling, by default min(array).
vmax : float, optional
    Maximum value for color scaling, by default max(array).</p>
<h6 id="cleopatra.array_glyph.ArrayGlyph.animate--color-bar-options"><a class="toclink" href="#cleopatra.array_glyph.ArrayGlyph.animate--color-bar-options">Color bar options:</a><a class="headerlink" href="#cleopatra.array_glyph.ArrayGlyph.animate--color-bar-options" title="Permanent link">#</a></h6>
<p>cbar_orientation : str, optional
    Orientation of the color bar, by default 'vertical'.
    Can be 'horizontal' or 'vertical'.
cbar_label_rotation : float, optional
    Rotation angle of the color bar label, by default -90.
cbar_label_location : str, optional
    Location of the color bar label, by default 'bottom'.
    Options: 'top', 'bottom', 'center', 'baseline', 'center_baseline'.
cbar_length : float, optional
    Ratio to control the height/width of the color bar, by default 0.75.
ticks_spacing : int, optional
    Spacing between ticks on the color bar, by default 2.
cbar_label_size : int, optional
    Font size of the color bar label, by default 12.
cbar_label : str, optional
    Label text for the color bar, by default 'Value'.</p>
<h6 id="cleopatra.array_glyph.ArrayGlyph.animate--color-scale-options"><a class="toclink" href="#cleopatra.array_glyph.ArrayGlyph.animate--color-scale-options">Color scale options:</a><a class="headerlink" href="#cleopatra.array_glyph.ArrayGlyph.animate--color-scale-options" title="Permanent link">#</a></h6>
<p>color_scale : str, optional
    Type of color scaling to use, by default 'linear'.
    Options:
    - 'linear': Linear scale
    - 'power': Power-law normalization
    - 'sym-lognorm': Symmetrical logarithmic scale
    - 'boundary-norm': Discrete intervals based on boundaries
    - 'midpoint': Scale split at a specified midpoint
gamma : float, optional
    Exponent for 'power' color scale, by default 0.5.
    Values &lt; 1 emphasize lower values, values &gt; 1 emphasize higher values.
line_threshold : float, optional
    Threshold for 'sym-lognorm' color scale, by default 0.0001.
line_scale : float, optional
    Scale factor for 'sym-lognorm' color scale, by default 0.001.
bounds : List, optional
    Boundaries for 'boundary-norm' color scale, by default None.
    Defines the discrete intervals for color mapping.
midpoint : float, optional
    Midpoint value for 'midpoint' color scale, by default 0.</p>
<h6 id="cleopatra.array_glyph.ArrayGlyph.animate--cell-value-display-options"><a class="toclink" href="#cleopatra.array_glyph.ArrayGlyph.animate--cell-value-display-options">Cell value display options:</a><a class="headerlink" href="#cleopatra.array_glyph.ArrayGlyph.animate--cell-value-display-options" title="Permanent link">#</a></h6>
<p>display_cell_value : bool, optional
    Whether to display the values of cells as text, by default False.
num_size : int, optional
    Font size of the cell value text, by default 8.
background_color_threshold : float, optional
    Threshold for cell value text color, by default None.
    If cell value &gt; threshold, text is black; otherwise, text is white.
    If None, uses max(array)/2 as the threshold.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="matplotlib.animation.FuncAnimation">FuncAnimation</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The animation object that can be displayed in a notebook or saved to a file.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If an invalid keyword argument is provided.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the length of the time list doesn't match the first dimension of the array.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <p>The animation is created by iterating through the first dimension of the array.
For example, if the array has shape (10, 20, 30), the animation will have 10 frames,
each showing a 20x30 slice of the array.</p>
<p>To display the animation in a Jupyter notebook, you may need to use:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">HTML</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">HTML</span><span class="p">(</span><span class="n">anim_obj</span><span class="o">.</span><span class="n">to_jshtml</span><span class="p">())</span>
</code></pre></div></p>
<p>To save the animation to a file, use the <code>save_animation</code> method after creating
the animation.</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <p>Basic animation from a 3D array:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">cleopatra.array_glyph</span><span class="w"> </span><span class="kn">import</span> <span class="n">ArrayGlyph</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Create a 3D array with 5 frames, each 10x10</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Create labels for each frame</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">frame_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Frame 1&quot;</span><span class="p">,</span> <span class="s2">&quot;Frame 2&quot;</span><span class="p">,</span> <span class="s2">&quot;Frame 3&quot;</span><span class="p">,</span> <span class="s2">&quot;Frame 4&quot;</span><span class="p">,</span> <span class="s2">&quot;Frame 5&quot;</span><span class="p">]</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Create the ArrayGlyph object</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">animated_array</span> <span class="o">=</span> <span class="n">ArrayGlyph</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Animated Array&quot;</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Create the animation</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">anim_obj</span> <span class="o">=</span> <span class="n">animated_array</span><span class="o">.</span><span class="n">animate</span><span class="p">(</span><span class="n">frame_labels</span><span class="p">)</span>
</code></pre></div>
Animation with custom interval (speed):
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Slower animation (500ms between frames)</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">anim_obj</span> <span class="o">=</span> <span class="n">animated_array</span><span class="o">.</span><span class="n">animate</span><span class="p">(</span><span class="n">frame_labels</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Faster animation (100ms between frames)</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">anim_obj</span> <span class="o">=</span> <span class="n">animated_array</span><span class="o">.</span><span class="n">animate</span><span class="p">(</span><span class="n">frame_labels</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</code></pre></div>
Animation with points:
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Create points to display on the animation</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">]])</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">anim_obj</span> <span class="o">=</span> <span class="n">animated_array</span><span class="o">.</span><span class="n">animate</span><span class="p">(</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="o">...</span>     <span class="n">frame_labels</span><span class="p">,</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="o">...</span>     <span class="n">points</span><span class="o">=</span><span class="n">points</span><span class="p">,</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="o">...</span>     <span class="n">point_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="o">...</span>     <span class="n">point_size</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="o">...</span>     <span class="n">pid_color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="o">...</span>     <span class="n">pid_size</span><span class="o">=</span><span class="mi">12</span>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="o">...</span> <span class="p">)</span>
</code></pre></div>
Animation with cell values displayed:
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">anim_obj</span> <span class="o">=</span> <span class="n">animated_array</span><span class="o">.</span><span class="n">animate</span><span class="p">(</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="o">...</span>     <span class="n">frame_labels</span><span class="p">,</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="o">...</span>     <span class="n">display_cell_value</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="o">...</span>     <span class="n">num_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="o">...</span>     <span class="n">text_colors</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;yellow&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="o">...</span> <span class="p">)</span>
</code></pre></div>
<img alt="animated_array" src="./../_images/array_glyph/animated_array.gif" /></p>
<p>Saving the animation to a file:
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Create the animation first</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">anim_obj</span> <span class="o">=</span> <span class="n">animated_array</span><span class="o">.</span><span class="n">animate</span><span class="p">(</span><span class="n">frame_labels</span><span class="p">)</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Then save it to a file</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">animated_array</span><span class="o">.</span><span class="n">save_animation</span><span class="p">(</span><span class="s2">&quot;animation.gif&quot;</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div></p>


            <details class="quote">
              <summary>Source code in <code>cleopatra/array_glyph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1433">1433</a></span>
<span class="normal"><a href="#__codelineno-0-1434">1434</a></span>
<span class="normal"><a href="#__codelineno-0-1435">1435</a></span>
<span class="normal"><a href="#__codelineno-0-1436">1436</a></span>
<span class="normal"><a href="#__codelineno-0-1437">1437</a></span>
<span class="normal"><a href="#__codelineno-0-1438">1438</a></span>
<span class="normal"><a href="#__codelineno-0-1439">1439</a></span>
<span class="normal"><a href="#__codelineno-0-1440">1440</a></span>
<span class="normal"><a href="#__codelineno-0-1441">1441</a></span>
<span class="normal"><a href="#__codelineno-0-1442">1442</a></span>
<span class="normal"><a href="#__codelineno-0-1443">1443</a></span>
<span class="normal"><a href="#__codelineno-0-1444">1444</a></span>
<span class="normal"><a href="#__codelineno-0-1445">1445</a></span>
<span class="normal"><a href="#__codelineno-0-1446">1446</a></span>
<span class="normal"><a href="#__codelineno-0-1447">1447</a></span>
<span class="normal"><a href="#__codelineno-0-1448">1448</a></span>
<span class="normal"><a href="#__codelineno-0-1449">1449</a></span>
<span class="normal"><a href="#__codelineno-0-1450">1450</a></span>
<span class="normal"><a href="#__codelineno-0-1451">1451</a></span>
<span class="normal"><a href="#__codelineno-0-1452">1452</a></span>
<span class="normal"><a href="#__codelineno-0-1453">1453</a></span>
<span class="normal"><a href="#__codelineno-0-1454">1454</a></span>
<span class="normal"><a href="#__codelineno-0-1455">1455</a></span>
<span class="normal"><a href="#__codelineno-0-1456">1456</a></span>
<span class="normal"><a href="#__codelineno-0-1457">1457</a></span>
<span class="normal"><a href="#__codelineno-0-1458">1458</a></span>
<span class="normal"><a href="#__codelineno-0-1459">1459</a></span>
<span class="normal"><a href="#__codelineno-0-1460">1460</a></span>
<span class="normal"><a href="#__codelineno-0-1461">1461</a></span>
<span class="normal"><a href="#__codelineno-0-1462">1462</a></span>
<span class="normal"><a href="#__codelineno-0-1463">1463</a></span>
<span class="normal"><a href="#__codelineno-0-1464">1464</a></span>
<span class="normal"><a href="#__codelineno-0-1465">1465</a></span>
<span class="normal"><a href="#__codelineno-0-1466">1466</a></span>
<span class="normal"><a href="#__codelineno-0-1467">1467</a></span>
<span class="normal"><a href="#__codelineno-0-1468">1468</a></span>
<span class="normal"><a href="#__codelineno-0-1469">1469</a></span>
<span class="normal"><a href="#__codelineno-0-1470">1470</a></span>
<span class="normal"><a href="#__codelineno-0-1471">1471</a></span>
<span class="normal"><a href="#__codelineno-0-1472">1472</a></span>
<span class="normal"><a href="#__codelineno-0-1473">1473</a></span>
<span class="normal"><a href="#__codelineno-0-1474">1474</a></span>
<span class="normal"><a href="#__codelineno-0-1475">1475</a></span>
<span class="normal"><a href="#__codelineno-0-1476">1476</a></span>
<span class="normal"><a href="#__codelineno-0-1477">1477</a></span>
<span class="normal"><a href="#__codelineno-0-1478">1478</a></span>
<span class="normal"><a href="#__codelineno-0-1479">1479</a></span>
<span class="normal"><a href="#__codelineno-0-1480">1480</a></span>
<span class="normal"><a href="#__codelineno-0-1481">1481</a></span>
<span class="normal"><a href="#__codelineno-0-1482">1482</a></span>
<span class="normal"><a href="#__codelineno-0-1483">1483</a></span>
<span class="normal"><a href="#__codelineno-0-1484">1484</a></span>
<span class="normal"><a href="#__codelineno-0-1485">1485</a></span>
<span class="normal"><a href="#__codelineno-0-1486">1486</a></span>
<span class="normal"><a href="#__codelineno-0-1487">1487</a></span>
<span class="normal"><a href="#__codelineno-0-1488">1488</a></span>
<span class="normal"><a href="#__codelineno-0-1489">1489</a></span>
<span class="normal"><a href="#__codelineno-0-1490">1490</a></span>
<span class="normal"><a href="#__codelineno-0-1491">1491</a></span>
<span class="normal"><a href="#__codelineno-0-1492">1492</a></span>
<span class="normal"><a href="#__codelineno-0-1493">1493</a></span>
<span class="normal"><a href="#__codelineno-0-1494">1494</a></span>
<span class="normal"><a href="#__codelineno-0-1495">1495</a></span>
<span class="normal"><a href="#__codelineno-0-1496">1496</a></span>
<span class="normal"><a href="#__codelineno-0-1497">1497</a></span>
<span class="normal"><a href="#__codelineno-0-1498">1498</a></span>
<span class="normal"><a href="#__codelineno-0-1499">1499</a></span>
<span class="normal"><a href="#__codelineno-0-1500">1500</a></span>
<span class="normal"><a href="#__codelineno-0-1501">1501</a></span>
<span class="normal"><a href="#__codelineno-0-1502">1502</a></span>
<span class="normal"><a href="#__codelineno-0-1503">1503</a></span>
<span class="normal"><a href="#__codelineno-0-1504">1504</a></span>
<span class="normal"><a href="#__codelineno-0-1505">1505</a></span>
<span class="normal"><a href="#__codelineno-0-1506">1506</a></span>
<span class="normal"><a href="#__codelineno-0-1507">1507</a></span>
<span class="normal"><a href="#__codelineno-0-1508">1508</a></span>
<span class="normal"><a href="#__codelineno-0-1509">1509</a></span>
<span class="normal"><a href="#__codelineno-0-1510">1510</a></span>
<span class="normal"><a href="#__codelineno-0-1511">1511</a></span>
<span class="normal"><a href="#__codelineno-0-1512">1512</a></span>
<span class="normal"><a href="#__codelineno-0-1513">1513</a></span>
<span class="normal"><a href="#__codelineno-0-1514">1514</a></span>
<span class="normal"><a href="#__codelineno-0-1515">1515</a></span>
<span class="normal"><a href="#__codelineno-0-1516">1516</a></span>
<span class="normal"><a href="#__codelineno-0-1517">1517</a></span>
<span class="normal"><a href="#__codelineno-0-1518">1518</a></span>
<span class="normal"><a href="#__codelineno-0-1519">1519</a></span>
<span class="normal"><a href="#__codelineno-0-1520">1520</a></span>
<span class="normal"><a href="#__codelineno-0-1521">1521</a></span>
<span class="normal"><a href="#__codelineno-0-1522">1522</a></span>
<span class="normal"><a href="#__codelineno-0-1523">1523</a></span>
<span class="normal"><a href="#__codelineno-0-1524">1524</a></span>
<span class="normal"><a href="#__codelineno-0-1525">1525</a></span>
<span class="normal"><a href="#__codelineno-0-1526">1526</a></span>
<span class="normal"><a href="#__codelineno-0-1527">1527</a></span>
<span class="normal"><a href="#__codelineno-0-1528">1528</a></span>
<span class="normal"><a href="#__codelineno-0-1529">1529</a></span>
<span class="normal"><a href="#__codelineno-0-1530">1530</a></span>
<span class="normal"><a href="#__codelineno-0-1531">1531</a></span>
<span class="normal"><a href="#__codelineno-0-1532">1532</a></span>
<span class="normal"><a href="#__codelineno-0-1533">1533</a></span>
<span class="normal"><a href="#__codelineno-0-1534">1534</a></span>
<span class="normal"><a href="#__codelineno-0-1535">1535</a></span>
<span class="normal"><a href="#__codelineno-0-1536">1536</a></span>
<span class="normal"><a href="#__codelineno-0-1537">1537</a></span>
<span class="normal"><a href="#__codelineno-0-1538">1538</a></span>
<span class="normal"><a href="#__codelineno-0-1539">1539</a></span>
<span class="normal"><a href="#__codelineno-0-1540">1540</a></span>
<span class="normal"><a href="#__codelineno-0-1541">1541</a></span>
<span class="normal"><a href="#__codelineno-0-1542">1542</a></span>
<span class="normal"><a href="#__codelineno-0-1543">1543</a></span>
<span class="normal"><a href="#__codelineno-0-1544">1544</a></span>
<span class="normal"><a href="#__codelineno-0-1545">1545</a></span>
<span class="normal"><a href="#__codelineno-0-1546">1546</a></span>
<span class="normal"><a href="#__codelineno-0-1547">1547</a></span>
<span class="normal"><a href="#__codelineno-0-1548">1548</a></span>
<span class="normal"><a href="#__codelineno-0-1549">1549</a></span>
<span class="normal"><a href="#__codelineno-0-1550">1550</a></span>
<span class="normal"><a href="#__codelineno-0-1551">1551</a></span>
<span class="normal"><a href="#__codelineno-0-1552">1552</a></span>
<span class="normal"><a href="#__codelineno-0-1553">1553</a></span>
<span class="normal"><a href="#__codelineno-0-1554">1554</a></span>
<span class="normal"><a href="#__codelineno-0-1555">1555</a></span>
<span class="normal"><a href="#__codelineno-0-1556">1556</a></span>
<span class="normal"><a href="#__codelineno-0-1557">1557</a></span>
<span class="normal"><a href="#__codelineno-0-1558">1558</a></span>
<span class="normal"><a href="#__codelineno-0-1559">1559</a></span>
<span class="normal"><a href="#__codelineno-0-1560">1560</a></span>
<span class="normal"><a href="#__codelineno-0-1561">1561</a></span>
<span class="normal"><a href="#__codelineno-0-1562">1562</a></span>
<span class="normal"><a href="#__codelineno-0-1563">1563</a></span>
<span class="normal"><a href="#__codelineno-0-1564">1564</a></span>
<span class="normal"><a href="#__codelineno-0-1565">1565</a></span>
<span class="normal"><a href="#__codelineno-0-1566">1566</a></span>
<span class="normal"><a href="#__codelineno-0-1567">1567</a></span>
<span class="normal"><a href="#__codelineno-0-1568">1568</a></span>
<span class="normal"><a href="#__codelineno-0-1569">1569</a></span>
<span class="normal"><a href="#__codelineno-0-1570">1570</a></span>
<span class="normal"><a href="#__codelineno-0-1571">1571</a></span>
<span class="normal"><a href="#__codelineno-0-1572">1572</a></span>
<span class="normal"><a href="#__codelineno-0-1573">1573</a></span>
<span class="normal"><a href="#__codelineno-0-1574">1574</a></span>
<span class="normal"><a href="#__codelineno-0-1575">1575</a></span>
<span class="normal"><a href="#__codelineno-0-1576">1576</a></span>
<span class="normal"><a href="#__codelineno-0-1577">1577</a></span>
<span class="normal"><a href="#__codelineno-0-1578">1578</a></span>
<span class="normal"><a href="#__codelineno-0-1579">1579</a></span>
<span class="normal"><a href="#__codelineno-0-1580">1580</a></span>
<span class="normal"><a href="#__codelineno-0-1581">1581</a></span>
<span class="normal"><a href="#__codelineno-0-1582">1582</a></span>
<span class="normal"><a href="#__codelineno-0-1583">1583</a></span>
<span class="normal"><a href="#__codelineno-0-1584">1584</a></span>
<span class="normal"><a href="#__codelineno-0-1585">1585</a></span>
<span class="normal"><a href="#__codelineno-0-1586">1586</a></span>
<span class="normal"><a href="#__codelineno-0-1587">1587</a></span>
<span class="normal"><a href="#__codelineno-0-1588">1588</a></span>
<span class="normal"><a href="#__codelineno-0-1589">1589</a></span>
<span class="normal"><a href="#__codelineno-0-1590">1590</a></span>
<span class="normal"><a href="#__codelineno-0-1591">1591</a></span>
<span class="normal"><a href="#__codelineno-0-1592">1592</a></span>
<span class="normal"><a href="#__codelineno-0-1593">1593</a></span>
<span class="normal"><a href="#__codelineno-0-1594">1594</a></span>
<span class="normal"><a href="#__codelineno-0-1595">1595</a></span>
<span class="normal"><a href="#__codelineno-0-1596">1596</a></span>
<span class="normal"><a href="#__codelineno-0-1597">1597</a></span>
<span class="normal"><a href="#__codelineno-0-1598">1598</a></span>
<span class="normal"><a href="#__codelineno-0-1599">1599</a></span>
<span class="normal"><a href="#__codelineno-0-1600">1600</a></span>
<span class="normal"><a href="#__codelineno-0-1601">1601</a></span>
<span class="normal"><a href="#__codelineno-0-1602">1602</a></span>
<span class="normal"><a href="#__codelineno-0-1603">1603</a></span>
<span class="normal"><a href="#__codelineno-0-1604">1604</a></span>
<span class="normal"><a href="#__codelineno-0-1605">1605</a></span>
<span class="normal"><a href="#__codelineno-0-1606">1606</a></span>
<span class="normal"><a href="#__codelineno-0-1607">1607</a></span>
<span class="normal"><a href="#__codelineno-0-1608">1608</a></span>
<span class="normal"><a href="#__codelineno-0-1609">1609</a></span>
<span class="normal"><a href="#__codelineno-0-1610">1610</a></span>
<span class="normal"><a href="#__codelineno-0-1611">1611</a></span>
<span class="normal"><a href="#__codelineno-0-1612">1612</a></span>
<span class="normal"><a href="#__codelineno-0-1613">1613</a></span>
<span class="normal"><a href="#__codelineno-0-1614">1614</a></span>
<span class="normal"><a href="#__codelineno-0-1615">1615</a></span>
<span class="normal"><a href="#__codelineno-0-1616">1616</a></span>
<span class="normal"><a href="#__codelineno-0-1617">1617</a></span>
<span class="normal"><a href="#__codelineno-0-1618">1618</a></span>
<span class="normal"><a href="#__codelineno-0-1619">1619</a></span>
<span class="normal"><a href="#__codelineno-0-1620">1620</a></span>
<span class="normal"><a href="#__codelineno-0-1621">1621</a></span>
<span class="normal"><a href="#__codelineno-0-1622">1622</a></span>
<span class="normal"><a href="#__codelineno-0-1623">1623</a></span>
<span class="normal"><a href="#__codelineno-0-1624">1624</a></span>
<span class="normal"><a href="#__codelineno-0-1625">1625</a></span>
<span class="normal"><a href="#__codelineno-0-1626">1626</a></span>
<span class="normal"><a href="#__codelineno-0-1627">1627</a></span>
<span class="normal"><a href="#__codelineno-0-1628">1628</a></span>
<span class="normal"><a href="#__codelineno-0-1629">1629</a></span>
<span class="normal"><a href="#__codelineno-0-1630">1630</a></span>
<span class="normal"><a href="#__codelineno-0-1631">1631</a></span>
<span class="normal"><a href="#__codelineno-0-1632">1632</a></span>
<span class="normal"><a href="#__codelineno-0-1633">1633</a></span>
<span class="normal"><a href="#__codelineno-0-1634">1634</a></span>
<span class="normal"><a href="#__codelineno-0-1635">1635</a></span>
<span class="normal"><a href="#__codelineno-0-1636">1636</a></span>
<span class="normal"><a href="#__codelineno-0-1637">1637</a></span>
<span class="normal"><a href="#__codelineno-0-1638">1638</a></span>
<span class="normal"><a href="#__codelineno-0-1639">1639</a></span>
<span class="normal"><a href="#__codelineno-0-1640">1640</a></span>
<span class="normal"><a href="#__codelineno-0-1641">1641</a></span>
<span class="normal"><a href="#__codelineno-0-1642">1642</a></span>
<span class="normal"><a href="#__codelineno-0-1643">1643</a></span>
<span class="normal"><a href="#__codelineno-0-1644">1644</a></span>
<span class="normal"><a href="#__codelineno-0-1645">1645</a></span>
<span class="normal"><a href="#__codelineno-0-1646">1646</a></span>
<span class="normal"><a href="#__codelineno-0-1647">1647</a></span>
<span class="normal"><a href="#__codelineno-0-1648">1648</a></span>
<span class="normal"><a href="#__codelineno-0-1649">1649</a></span>
<span class="normal"><a href="#__codelineno-0-1650">1650</a></span>
<span class="normal"><a href="#__codelineno-0-1651">1651</a></span>
<span class="normal"><a href="#__codelineno-0-1652">1652</a></span>
<span class="normal"><a href="#__codelineno-0-1653">1653</a></span>
<span class="normal"><a href="#__codelineno-0-1654">1654</a></span>
<span class="normal"><a href="#__codelineno-0-1655">1655</a></span>
<span class="normal"><a href="#__codelineno-0-1656">1656</a></span>
<span class="normal"><a href="#__codelineno-0-1657">1657</a></span>
<span class="normal"><a href="#__codelineno-0-1658">1658</a></span>
<span class="normal"><a href="#__codelineno-0-1659">1659</a></span>
<span class="normal"><a href="#__codelineno-0-1660">1660</a></span>
<span class="normal"><a href="#__codelineno-0-1661">1661</a></span>
<span class="normal"><a href="#__codelineno-0-1662">1662</a></span>
<span class="normal"><a href="#__codelineno-0-1663">1663</a></span>
<span class="normal"><a href="#__codelineno-0-1664">1664</a></span>
<span class="normal"><a href="#__codelineno-0-1665">1665</a></span>
<span class="normal"><a href="#__codelineno-0-1666">1666</a></span>
<span class="normal"><a href="#__codelineno-0-1667">1667</a></span>
<span class="normal"><a href="#__codelineno-0-1668">1668</a></span>
<span class="normal"><a href="#__codelineno-0-1669">1669</a></span>
<span class="normal"><a href="#__codelineno-0-1670">1670</a></span>
<span class="normal"><a href="#__codelineno-0-1671">1671</a></span>
<span class="normal"><a href="#__codelineno-0-1672">1672</a></span>
<span class="normal"><a href="#__codelineno-0-1673">1673</a></span>
<span class="normal"><a href="#__codelineno-0-1674">1674</a></span>
<span class="normal"><a href="#__codelineno-0-1675">1675</a></span>
<span class="normal"><a href="#__codelineno-0-1676">1676</a></span>
<span class="normal"><a href="#__codelineno-0-1677">1677</a></span>
<span class="normal"><a href="#__codelineno-0-1678">1678</a></span>
<span class="normal"><a href="#__codelineno-0-1679">1679</a></span>
<span class="normal"><a href="#__codelineno-0-1680">1680</a></span>
<span class="normal"><a href="#__codelineno-0-1681">1681</a></span>
<span class="normal"><a href="#__codelineno-0-1682">1682</a></span>
<span class="normal"><a href="#__codelineno-0-1683">1683</a></span>
<span class="normal"><a href="#__codelineno-0-1684">1684</a></span>
<span class="normal"><a href="#__codelineno-0-1685">1685</a></span>
<span class="normal"><a href="#__codelineno-0-1686">1686</a></span>
<span class="normal"><a href="#__codelineno-0-1687">1687</a></span>
<span class="normal"><a href="#__codelineno-0-1688">1688</a></span>
<span class="normal"><a href="#__codelineno-0-1689">1689</a></span>
<span class="normal"><a href="#__codelineno-0-1690">1690</a></span>
<span class="normal"><a href="#__codelineno-0-1691">1691</a></span>
<span class="normal"><a href="#__codelineno-0-1692">1692</a></span>
<span class="normal"><a href="#__codelineno-0-1693">1693</a></span>
<span class="normal"><a href="#__codelineno-0-1694">1694</a></span>
<span class="normal"><a href="#__codelineno-0-1695">1695</a></span>
<span class="normal"><a href="#__codelineno-0-1696">1696</a></span>
<span class="normal"><a href="#__codelineno-0-1697">1697</a></span>
<span class="normal"><a href="#__codelineno-0-1698">1698</a></span>
<span class="normal"><a href="#__codelineno-0-1699">1699</a></span>
<span class="normal"><a href="#__codelineno-0-1700">1700</a></span>
<span class="normal"><a href="#__codelineno-0-1701">1701</a></span>
<span class="normal"><a href="#__codelineno-0-1702">1702</a></span>
<span class="normal"><a href="#__codelineno-0-1703">1703</a></span>
<span class="normal"><a href="#__codelineno-0-1704">1704</a></span>
<span class="normal"><a href="#__codelineno-0-1705">1705</a></span>
<span class="normal"><a href="#__codelineno-0-1706">1706</a></span>
<span class="normal"><a href="#__codelineno-0-1707">1707</a></span>
<span class="normal"><a href="#__codelineno-0-1708">1708</a></span>
<span class="normal"><a href="#__codelineno-0-1709">1709</a></span>
<span class="normal"><a href="#__codelineno-0-1710">1710</a></span>
<span class="normal"><a href="#__codelineno-0-1711">1711</a></span>
<span class="normal"><a href="#__codelineno-0-1712">1712</a></span>
<span class="normal"><a href="#__codelineno-0-1713">1713</a></span>
<span class="normal"><a href="#__codelineno-0-1714">1714</a></span>
<span class="normal"><a href="#__codelineno-0-1715">1715</a></span>
<span class="normal"><a href="#__codelineno-0-1716">1716</a></span>
<span class="normal"><a href="#__codelineno-0-1717">1717</a></span>
<span class="normal"><a href="#__codelineno-0-1718">1718</a></span>
<span class="normal"><a href="#__codelineno-0-1719">1719</a></span>
<span class="normal"><a href="#__codelineno-0-1720">1720</a></span>
<span class="normal"><a href="#__codelineno-0-1721">1721</a></span>
<span class="normal"><a href="#__codelineno-0-1722">1722</a></span>
<span class="normal"><a href="#__codelineno-0-1723">1723</a></span>
<span class="normal"><a href="#__codelineno-0-1724">1724</a></span>
<span class="normal"><a href="#__codelineno-0-1725">1725</a></span>
<span class="normal"><a href="#__codelineno-0-1726">1726</a></span>
<span class="normal"><a href="#__codelineno-0-1727">1727</a></span>
<span class="normal"><a href="#__codelineno-0-1728">1728</a></span>
<span class="normal"><a href="#__codelineno-0-1729">1729</a></span>
<span class="normal"><a href="#__codelineno-0-1730">1730</a></span>
<span class="normal"><a href="#__codelineno-0-1731">1731</a></span>
<span class="normal"><a href="#__codelineno-0-1732">1732</a></span>
<span class="normal"><a href="#__codelineno-0-1733">1733</a></span>
<span class="normal"><a href="#__codelineno-0-1734">1734</a></span>
<span class="normal"><a href="#__codelineno-0-1735">1735</a></span>
<span class="normal"><a href="#__codelineno-0-1736">1736</a></span>
<span class="normal"><a href="#__codelineno-0-1737">1737</a></span>
<span class="normal"><a href="#__codelineno-0-1738">1738</a></span>
<span class="normal"><a href="#__codelineno-0-1739">1739</a></span>
<span class="normal"><a href="#__codelineno-0-1740">1740</a></span>
<span class="normal"><a href="#__codelineno-0-1741">1741</a></span>
<span class="normal"><a href="#__codelineno-0-1742">1742</a></span>
<span class="normal"><a href="#__codelineno-0-1743">1743</a></span>
<span class="normal"><a href="#__codelineno-0-1744">1744</a></span>
<span class="normal"><a href="#__codelineno-0-1745">1745</a></span>
<span class="normal"><a href="#__codelineno-0-1746">1746</a></span>
<span class="normal"><a href="#__codelineno-0-1747">1747</a></span>
<span class="normal"><a href="#__codelineno-0-1748">1748</a></span>
<span class="normal"><a href="#__codelineno-0-1749">1749</a></span>
<span class="normal"><a href="#__codelineno-0-1750">1750</a></span>
<span class="normal"><a href="#__codelineno-0-1751">1751</a></span>
<span class="normal"><a href="#__codelineno-0-1752">1752</a></span>
<span class="normal"><a href="#__codelineno-0-1753">1753</a></span>
<span class="normal"><a href="#__codelineno-0-1754">1754</a></span>
<span class="normal"><a href="#__codelineno-0-1755">1755</a></span>
<span class="normal"><a href="#__codelineno-0-1756">1756</a></span>
<span class="normal"><a href="#__codelineno-0-1757">1757</a></span>
<span class="normal"><a href="#__codelineno-0-1758">1758</a></span>
<span class="normal"><a href="#__codelineno-0-1759">1759</a></span>
<span class="normal"><a href="#__codelineno-0-1760">1760</a></span>
<span class="normal"><a href="#__codelineno-0-1761">1761</a></span>
<span class="normal"><a href="#__codelineno-0-1762">1762</a></span>
<span class="normal"><a href="#__codelineno-0-1763">1763</a></span>
<span class="normal"><a href="#__codelineno-0-1764">1764</a></span>
<span class="normal"><a href="#__codelineno-0-1765">1765</a></span>
<span class="normal"><a href="#__codelineno-0-1766">1766</a></span>
<span class="normal"><a href="#__codelineno-0-1767">1767</a></span>
<span class="normal"><a href="#__codelineno-0-1768">1768</a></span>
<span class="normal"><a href="#__codelineno-0-1769">1769</a></span>
<span class="normal"><a href="#__codelineno-0-1770">1770</a></span>
<span class="normal"><a href="#__codelineno-0-1771">1771</a></span>
<span class="normal"><a href="#__codelineno-0-1772">1772</a></span>
<span class="normal"><a href="#__codelineno-0-1773">1773</a></span>
<span class="normal"><a href="#__codelineno-0-1774">1774</a></span>
<span class="normal"><a href="#__codelineno-0-1775">1775</a></span>
<span class="normal"><a href="#__codelineno-0-1776">1776</a></span>
<span class="normal"><a href="#__codelineno-0-1777">1777</a></span>
<span class="normal"><a href="#__codelineno-0-1778">1778</a></span>
<span class="normal"><a href="#__codelineno-0-1779">1779</a></span>
<span class="normal"><a href="#__codelineno-0-1780">1780</a></span>
<span class="normal"><a href="#__codelineno-0-1781">1781</a></span>
<span class="normal"><a href="#__codelineno-0-1782">1782</a></span>
<span class="normal"><a href="#__codelineno-0-1783">1783</a></span>
<span class="normal"><a href="#__codelineno-0-1784">1784</a></span>
<span class="normal"><a href="#__codelineno-0-1785">1785</a></span>
<span class="normal"><a href="#__codelineno-0-1786">1786</a></span>
<span class="normal"><a href="#__codelineno-0-1787">1787</a></span>
<span class="normal"><a href="#__codelineno-0-1788">1788</a></span>
<span class="normal"><a href="#__codelineno-0-1789">1789</a></span>
<span class="normal"><a href="#__codelineno-0-1790">1790</a></span>
<span class="normal"><a href="#__codelineno-0-1791">1791</a></span>
<span class="normal"><a href="#__codelineno-0-1792">1792</a></span>
<span class="normal"><a href="#__codelineno-0-1793">1793</a></span>
<span class="normal"><a href="#__codelineno-0-1794">1794</a></span>
<span class="normal"><a href="#__codelineno-0-1795">1795</a></span>
<span class="normal"><a href="#__codelineno-0-1796">1796</a></span>
<span class="normal"><a href="#__codelineno-0-1797">1797</a></span>
<span class="normal"><a href="#__codelineno-0-1798">1798</a></span>
<span class="normal"><a href="#__codelineno-0-1799">1799</a></span>
<span class="normal"><a href="#__codelineno-0-1800">1800</a></span>
<span class="normal"><a href="#__codelineno-0-1801">1801</a></span>
<span class="normal"><a href="#__codelineno-0-1802">1802</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1433" name="__codelineno-0-1433"></a><span class="k">def</span><span class="w"> </span><span class="nf">animate</span><span class="p">(</span>
<a id="__codelineno-0-1434" name="__codelineno-0-1434"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-1435" name="__codelineno-0-1435"></a>    <span class="n">time</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span>
<a id="__codelineno-0-1436" name="__codelineno-0-1436"></a>    <span class="n">points</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1437" name="__codelineno-0-1437"></a>    <span class="n">text_colors</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="s2">&quot;black&quot;</span><span class="p">),</span>
<a id="__codelineno-0-1438" name="__codelineno-0-1438"></a>    <span class="n">interval</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
<a id="__codelineno-0-1439" name="__codelineno-0-1439"></a>    <span class="n">text_loc</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-1440" name="__codelineno-0-1440"></a>    <span class="n">point_color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1441" name="__codelineno-0-1441"></a>    <span class="n">point_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<a id="__codelineno-0-1442" name="__codelineno-0-1442"></a>    <span class="n">pid_color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span>
<a id="__codelineno-0-1443" name="__codelineno-0-1443"></a>    <span class="n">pid_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<a id="__codelineno-0-1444" name="__codelineno-0-1444"></a>    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-1445" name="__codelineno-0-1445"></a><span class="p">):</span>
<a id="__codelineno-0-1446" name="__codelineno-0-1446"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an animation from a 3D array.</span>
<a id="__codelineno-0-1447" name="__codelineno-0-1447"></a>
<a id="__codelineno-0-1448" name="__codelineno-0-1448"></a><span class="sd">    This method creates an animation by iterating through the first dimension of a 3D array.</span>
<a id="__codelineno-0-1449" name="__codelineno-0-1449"></a><span class="sd">    Each slice of the array becomes a frame in the animation, with optional time labels,</span>
<a id="__codelineno-0-1450" name="__codelineno-0-1450"></a><span class="sd">    point annotations, and cell value displays.</span>
<a id="__codelineno-0-1451" name="__codelineno-0-1451"></a>
<a id="__codelineno-0-1452" name="__codelineno-0-1452"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-1453" name="__codelineno-0-1453"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-1454" name="__codelineno-0-1454"></a><span class="sd">    time : List[Any]</span>
<a id="__codelineno-0-1455" name="__codelineno-0-1455"></a><span class="sd">        A list containing labels for each frame in the animation.</span>
<a id="__codelineno-0-1456" name="__codelineno-0-1456"></a><span class="sd">        These could be timestamps, frame numbers, or any other identifiers.</span>
<a id="__codelineno-0-1457" name="__codelineno-0-1457"></a><span class="sd">        The length of this list should match the first dimension of the array.</span>
<a id="__codelineno-0-1458" name="__codelineno-0-1458"></a><span class="sd">    points : np.ndarray, optional</span>
<a id="__codelineno-0-1459" name="__codelineno-0-1459"></a><span class="sd">        Points to display on the array, by default None.</span>
<a id="__codelineno-0-1460" name="__codelineno-0-1460"></a><span class="sd">        Should be a 3-column array where:</span>
<a id="__codelineno-0-1461" name="__codelineno-0-1461"></a><span class="sd">        - First column: values to display for each point</span>
<a id="__codelineno-0-1462" name="__codelineno-0-1462"></a><span class="sd">        - Second column: row indices of the points in the array</span>
<a id="__codelineno-0-1463" name="__codelineno-0-1463"></a><span class="sd">        - Third column: column indices of the points in the array</span>
<a id="__codelineno-0-1464" name="__codelineno-0-1464"></a><span class="sd">    text_colors : Tuple[str, str], optional</span>
<a id="__codelineno-0-1465" name="__codelineno-0-1465"></a><span class="sd">        Two colors to be used for cell value text, by default (&quot;white&quot;, &quot;black&quot;).</span>
<a id="__codelineno-0-1466" name="__codelineno-0-1466"></a><span class="sd">        The first color is used when the cell value is below the background_color_threshold,</span>
<a id="__codelineno-0-1467" name="__codelineno-0-1467"></a><span class="sd">        and the second color is used when the cell value is above the threshold.</span>
<a id="__codelineno-0-1468" name="__codelineno-0-1468"></a><span class="sd">    interval : int, optional</span>
<a id="__codelineno-0-1469" name="__codelineno-0-1469"></a><span class="sd">        Delay between frames in milliseconds, by default 200.</span>
<a id="__codelineno-0-1470" name="__codelineno-0-1470"></a><span class="sd">        Controls the speed of the animation (smaller values = faster animation).</span>
<a id="__codelineno-0-1471" name="__codelineno-0-1471"></a><span class="sd">    text_loc : list[Any, Any], optional</span>
<a id="__codelineno-0-1472" name="__codelineno-0-1472"></a><span class="sd">        Location of the time label text as [x, y] coordinates, by default None.</span>
<a id="__codelineno-0-1473" name="__codelineno-0-1473"></a><span class="sd">        If None, defaults to [0.1, 0.2].</span>
<a id="__codelineno-0-1474" name="__codelineno-0-1474"></a><span class="sd">    point_color : str, optional</span>
<a id="__codelineno-0-1475" name="__codelineno-0-1475"></a><span class="sd">        Color of the points, by default &quot;red&quot;.</span>
<a id="__codelineno-0-1476" name="__codelineno-0-1476"></a><span class="sd">        Any valid matplotlib color string.</span>
<a id="__codelineno-0-1477" name="__codelineno-0-1477"></a><span class="sd">    point_size : int, optional</span>
<a id="__codelineno-0-1478" name="__codelineno-0-1478"></a><span class="sd">        Size of the points, by default 100.</span>
<a id="__codelineno-0-1479" name="__codelineno-0-1479"></a><span class="sd">        Controls the marker size.</span>
<a id="__codelineno-0-1480" name="__codelineno-0-1480"></a><span class="sd">    pid_color : str, optional</span>
<a id="__codelineno-0-1481" name="__codelineno-0-1481"></a><span class="sd">        Color of the point value annotations, by default &quot;blue&quot;.</span>
<a id="__codelineno-0-1482" name="__codelineno-0-1482"></a><span class="sd">        Any valid matplotlib color string.</span>
<a id="__codelineno-0-1483" name="__codelineno-0-1483"></a><span class="sd">    pid_size : int, optional</span>
<a id="__codelineno-0-1484" name="__codelineno-0-1484"></a><span class="sd">        Size of the point value annotations, by default 10.</span>
<a id="__codelineno-0-1485" name="__codelineno-0-1485"></a><span class="sd">        Controls the font size of the annotations.</span>
<a id="__codelineno-0-1486" name="__codelineno-0-1486"></a><span class="sd">    **kwargs : dict</span>
<a id="__codelineno-0-1487" name="__codelineno-0-1487"></a><span class="sd">        Additional keyword arguments for customizing the animation.</span>
<a id="__codelineno-0-1488" name="__codelineno-0-1488"></a>
<a id="__codelineno-0-1489" name="__codelineno-0-1489"></a><span class="sd">        Plot appearance:</span>
<a id="__codelineno-0-1490" name="__codelineno-0-1490"></a><span class="sd">        ---------------</span>
<a id="__codelineno-0-1491" name="__codelineno-0-1491"></a><span class="sd">        title : str, optional</span>
<a id="__codelineno-0-1492" name="__codelineno-0-1492"></a><span class="sd">            Title of the plot, by default &#39;Array Plot&#39;.</span>
<a id="__codelineno-0-1493" name="__codelineno-0-1493"></a><span class="sd">        title_size : int, optional</span>
<a id="__codelineno-0-1494" name="__codelineno-0-1494"></a><span class="sd">            Title font size, by default 15.</span>
<a id="__codelineno-0-1495" name="__codelineno-0-1495"></a><span class="sd">        cmap : str, optional</span>
<a id="__codelineno-0-1496" name="__codelineno-0-1496"></a><span class="sd">            Colormap name, by default &#39;coolwarm_r&#39;.</span>
<a id="__codelineno-0-1497" name="__codelineno-0-1497"></a><span class="sd">        vmin : float, optional</span>
<a id="__codelineno-0-1498" name="__codelineno-0-1498"></a><span class="sd">            Minimum value for color scaling, by default min(array).</span>
<a id="__codelineno-0-1499" name="__codelineno-0-1499"></a><span class="sd">        vmax : float, optional</span>
<a id="__codelineno-0-1500" name="__codelineno-0-1500"></a><span class="sd">            Maximum value for color scaling, by default max(array).</span>
<a id="__codelineno-0-1501" name="__codelineno-0-1501"></a>
<a id="__codelineno-0-1502" name="__codelineno-0-1502"></a><span class="sd">        Color bar options:</span>
<a id="__codelineno-0-1503" name="__codelineno-0-1503"></a><span class="sd">        ----------------</span>
<a id="__codelineno-0-1504" name="__codelineno-0-1504"></a><span class="sd">        cbar_orientation : str, optional</span>
<a id="__codelineno-0-1505" name="__codelineno-0-1505"></a><span class="sd">            Orientation of the color bar, by default &#39;vertical&#39;.</span>
<a id="__codelineno-0-1506" name="__codelineno-0-1506"></a><span class="sd">            Can be &#39;horizontal&#39; or &#39;vertical&#39;.</span>
<a id="__codelineno-0-1507" name="__codelineno-0-1507"></a><span class="sd">        cbar_label_rotation : float, optional</span>
<a id="__codelineno-0-1508" name="__codelineno-0-1508"></a><span class="sd">            Rotation angle of the color bar label, by default -90.</span>
<a id="__codelineno-0-1509" name="__codelineno-0-1509"></a><span class="sd">        cbar_label_location : str, optional</span>
<a id="__codelineno-0-1510" name="__codelineno-0-1510"></a><span class="sd">            Location of the color bar label, by default &#39;bottom&#39;.</span>
<a id="__codelineno-0-1511" name="__codelineno-0-1511"></a><span class="sd">            Options: &#39;top&#39;, &#39;bottom&#39;, &#39;center&#39;, &#39;baseline&#39;, &#39;center_baseline&#39;.</span>
<a id="__codelineno-0-1512" name="__codelineno-0-1512"></a><span class="sd">        cbar_length : float, optional</span>
<a id="__codelineno-0-1513" name="__codelineno-0-1513"></a><span class="sd">            Ratio to control the height/width of the color bar, by default 0.75.</span>
<a id="__codelineno-0-1514" name="__codelineno-0-1514"></a><span class="sd">        ticks_spacing : int, optional</span>
<a id="__codelineno-0-1515" name="__codelineno-0-1515"></a><span class="sd">            Spacing between ticks on the color bar, by default 2.</span>
<a id="__codelineno-0-1516" name="__codelineno-0-1516"></a><span class="sd">        cbar_label_size : int, optional</span>
<a id="__codelineno-0-1517" name="__codelineno-0-1517"></a><span class="sd">            Font size of the color bar label, by default 12.</span>
<a id="__codelineno-0-1518" name="__codelineno-0-1518"></a><span class="sd">        cbar_label : str, optional</span>
<a id="__codelineno-0-1519" name="__codelineno-0-1519"></a><span class="sd">            Label text for the color bar, by default &#39;Value&#39;.</span>
<a id="__codelineno-0-1520" name="__codelineno-0-1520"></a>
<a id="__codelineno-0-1521" name="__codelineno-0-1521"></a><span class="sd">        Color scale options:</span>
<a id="__codelineno-0-1522" name="__codelineno-0-1522"></a><span class="sd">        ------------------</span>
<a id="__codelineno-0-1523" name="__codelineno-0-1523"></a><span class="sd">        color_scale : str, optional</span>
<a id="__codelineno-0-1524" name="__codelineno-0-1524"></a><span class="sd">            Type of color scaling to use, by default &#39;linear&#39;.</span>
<a id="__codelineno-0-1525" name="__codelineno-0-1525"></a><span class="sd">            Options:</span>
<a id="__codelineno-0-1526" name="__codelineno-0-1526"></a><span class="sd">            - &#39;linear&#39;: Linear scale</span>
<a id="__codelineno-0-1527" name="__codelineno-0-1527"></a><span class="sd">            - &#39;power&#39;: Power-law normalization</span>
<a id="__codelineno-0-1528" name="__codelineno-0-1528"></a><span class="sd">            - &#39;sym-lognorm&#39;: Symmetrical logarithmic scale</span>
<a id="__codelineno-0-1529" name="__codelineno-0-1529"></a><span class="sd">            - &#39;boundary-norm&#39;: Discrete intervals based on boundaries</span>
<a id="__codelineno-0-1530" name="__codelineno-0-1530"></a><span class="sd">            - &#39;midpoint&#39;: Scale split at a specified midpoint</span>
<a id="__codelineno-0-1531" name="__codelineno-0-1531"></a><span class="sd">        gamma : float, optional</span>
<a id="__codelineno-0-1532" name="__codelineno-0-1532"></a><span class="sd">            Exponent for &#39;power&#39; color scale, by default 0.5.</span>
<a id="__codelineno-0-1533" name="__codelineno-0-1533"></a><span class="sd">            Values &lt; 1 emphasize lower values, values &gt; 1 emphasize higher values.</span>
<a id="__codelineno-0-1534" name="__codelineno-0-1534"></a><span class="sd">        line_threshold : float, optional</span>
<a id="__codelineno-0-1535" name="__codelineno-0-1535"></a><span class="sd">            Threshold for &#39;sym-lognorm&#39; color scale, by default 0.0001.</span>
<a id="__codelineno-0-1536" name="__codelineno-0-1536"></a><span class="sd">        line_scale : float, optional</span>
<a id="__codelineno-0-1537" name="__codelineno-0-1537"></a><span class="sd">            Scale factor for &#39;sym-lognorm&#39; color scale, by default 0.001.</span>
<a id="__codelineno-0-1538" name="__codelineno-0-1538"></a><span class="sd">        bounds : List, optional</span>
<a id="__codelineno-0-1539" name="__codelineno-0-1539"></a><span class="sd">            Boundaries for &#39;boundary-norm&#39; color scale, by default None.</span>
<a id="__codelineno-0-1540" name="__codelineno-0-1540"></a><span class="sd">            Defines the discrete intervals for color mapping.</span>
<a id="__codelineno-0-1541" name="__codelineno-0-1541"></a><span class="sd">        midpoint : float, optional</span>
<a id="__codelineno-0-1542" name="__codelineno-0-1542"></a><span class="sd">            Midpoint value for &#39;midpoint&#39; color scale, by default 0.</span>
<a id="__codelineno-0-1543" name="__codelineno-0-1543"></a>
<a id="__codelineno-0-1544" name="__codelineno-0-1544"></a><span class="sd">        Cell value display options:</span>
<a id="__codelineno-0-1545" name="__codelineno-0-1545"></a><span class="sd">        -------------------------</span>
<a id="__codelineno-0-1546" name="__codelineno-0-1546"></a><span class="sd">        display_cell_value : bool, optional</span>
<a id="__codelineno-0-1547" name="__codelineno-0-1547"></a><span class="sd">            Whether to display the values of cells as text, by default False.</span>
<a id="__codelineno-0-1548" name="__codelineno-0-1548"></a><span class="sd">        num_size : int, optional</span>
<a id="__codelineno-0-1549" name="__codelineno-0-1549"></a><span class="sd">            Font size of the cell value text, by default 8.</span>
<a id="__codelineno-0-1550" name="__codelineno-0-1550"></a><span class="sd">        background_color_threshold : float, optional</span>
<a id="__codelineno-0-1551" name="__codelineno-0-1551"></a><span class="sd">            Threshold for cell value text color, by default None.</span>
<a id="__codelineno-0-1552" name="__codelineno-0-1552"></a><span class="sd">            If cell value &gt; threshold, text is black; otherwise, text is white.</span>
<a id="__codelineno-0-1553" name="__codelineno-0-1553"></a><span class="sd">            If None, uses max(array)/2 as the threshold.</span>
<a id="__codelineno-0-1554" name="__codelineno-0-1554"></a>
<a id="__codelineno-0-1555" name="__codelineno-0-1555"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-1556" name="__codelineno-0-1556"></a><span class="sd">    -------</span>
<a id="__codelineno-0-1557" name="__codelineno-0-1557"></a><span class="sd">    matplotlib.animation.FuncAnimation</span>
<a id="__codelineno-0-1558" name="__codelineno-0-1558"></a><span class="sd">        The animation object that can be displayed in a notebook or saved to a file.</span>
<a id="__codelineno-0-1559" name="__codelineno-0-1559"></a>
<a id="__codelineno-0-1560" name="__codelineno-0-1560"></a><span class="sd">    Raises</span>
<a id="__codelineno-0-1561" name="__codelineno-0-1561"></a><span class="sd">    ------</span>
<a id="__codelineno-0-1562" name="__codelineno-0-1562"></a><span class="sd">    ValueError</span>
<a id="__codelineno-0-1563" name="__codelineno-0-1563"></a><span class="sd">        If an invalid keyword argument is provided.</span>
<a id="__codelineno-0-1564" name="__codelineno-0-1564"></a><span class="sd">    ValueError</span>
<a id="__codelineno-0-1565" name="__codelineno-0-1565"></a><span class="sd">        If the length of the time list doesn&#39;t match the first dimension of the array.</span>
<a id="__codelineno-0-1566" name="__codelineno-0-1566"></a>
<a id="__codelineno-0-1567" name="__codelineno-0-1567"></a><span class="sd">    Notes</span>
<a id="__codelineno-0-1568" name="__codelineno-0-1568"></a><span class="sd">    -----</span>
<a id="__codelineno-0-1569" name="__codelineno-0-1569"></a><span class="sd">    The animation is created by iterating through the first dimension of the array.</span>
<a id="__codelineno-0-1570" name="__codelineno-0-1570"></a><span class="sd">    For example, if the array has shape (10, 20, 30), the animation will have 10 frames,</span>
<a id="__codelineno-0-1571" name="__codelineno-0-1571"></a><span class="sd">    each showing a 20x30 slice of the array.</span>
<a id="__codelineno-0-1572" name="__codelineno-0-1572"></a>
<a id="__codelineno-0-1573" name="__codelineno-0-1573"></a><span class="sd">    To display the animation in a Jupyter notebook, you may need to use:</span>
<a id="__codelineno-0-1574" name="__codelineno-0-1574"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-1575" name="__codelineno-0-1575"></a><span class="sd">    from IPython.display import HTML</span>
<a id="__codelineno-0-1576" name="__codelineno-0-1576"></a><span class="sd">    HTML(anim_obj.to_jshtml())</span>
<a id="__codelineno-0-1577" name="__codelineno-0-1577"></a><span class="sd">    ```</span>
<a id="__codelineno-0-1578" name="__codelineno-0-1578"></a>
<a id="__codelineno-0-1579" name="__codelineno-0-1579"></a><span class="sd">    To save the animation to a file, use the `save_animation` method after creating</span>
<a id="__codelineno-0-1580" name="__codelineno-0-1580"></a><span class="sd">    the animation.</span>
<a id="__codelineno-0-1581" name="__codelineno-0-1581"></a>
<a id="__codelineno-0-1582" name="__codelineno-0-1582"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-1583" name="__codelineno-0-1583"></a><span class="sd">    --------</span>
<a id="__codelineno-0-1584" name="__codelineno-0-1584"></a><span class="sd">    Basic animation from a 3D array:</span>
<a id="__codelineno-0-1585" name="__codelineno-0-1585"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-1586" name="__codelineno-0-1586"></a><span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-1587" name="__codelineno-0-1587"></a><span class="sd">    &gt;&gt;&gt; from cleopatra.array_glyph import ArrayGlyph</span>
<a id="__codelineno-0-1588" name="__codelineno-0-1588"></a><span class="sd">    &gt;&gt;&gt; # Create a 3D array with 5 frames, each 10x10</span>
<a id="__codelineno-0-1589" name="__codelineno-0-1589"></a><span class="sd">    &gt;&gt;&gt; arr = np.random.randint(1, 10, size=(5, 10, 10))</span>
<a id="__codelineno-0-1590" name="__codelineno-0-1590"></a><span class="sd">    &gt;&gt;&gt; # Create labels for each frame</span>
<a id="__codelineno-0-1591" name="__codelineno-0-1591"></a><span class="sd">    &gt;&gt;&gt; frame_labels = [&quot;Frame 1&quot;, &quot;Frame 2&quot;, &quot;Frame 3&quot;, &quot;Frame 4&quot;, &quot;Frame 5&quot;]</span>
<a id="__codelineno-0-1592" name="__codelineno-0-1592"></a><span class="sd">    &gt;&gt;&gt; # Create the ArrayGlyph object</span>
<a id="__codelineno-0-1593" name="__codelineno-0-1593"></a><span class="sd">    &gt;&gt;&gt; animated_array = ArrayGlyph(arr, figsize=(8, 8), title=&quot;Animated Array&quot;)</span>
<a id="__codelineno-0-1594" name="__codelineno-0-1594"></a><span class="sd">    &gt;&gt;&gt; # Create the animation</span>
<a id="__codelineno-0-1595" name="__codelineno-0-1595"></a><span class="sd">    &gt;&gt;&gt; anim_obj = animated_array.animate(frame_labels)</span>
<a id="__codelineno-0-1596" name="__codelineno-0-1596"></a>
<a id="__codelineno-0-1597" name="__codelineno-0-1597"></a><span class="sd">    ```</span>
<a id="__codelineno-0-1598" name="__codelineno-0-1598"></a><span class="sd">    Animation with custom interval (speed):</span>
<a id="__codelineno-0-1599" name="__codelineno-0-1599"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-1600" name="__codelineno-0-1600"></a><span class="sd">    &gt;&gt;&gt; # Slower animation (500ms between frames)</span>
<a id="__codelineno-0-1601" name="__codelineno-0-1601"></a><span class="sd">    &gt;&gt;&gt; anim_obj = animated_array.animate(frame_labels, interval=500)</span>
<a id="__codelineno-0-1602" name="__codelineno-0-1602"></a><span class="sd">    &gt;&gt;&gt; # Faster animation (100ms between frames)</span>
<a id="__codelineno-0-1603" name="__codelineno-0-1603"></a><span class="sd">    &gt;&gt;&gt; anim_obj = animated_array.animate(frame_labels, interval=100)</span>
<a id="__codelineno-0-1604" name="__codelineno-0-1604"></a>
<a id="__codelineno-0-1605" name="__codelineno-0-1605"></a><span class="sd">    ```</span>
<a id="__codelineno-0-1606" name="__codelineno-0-1606"></a><span class="sd">    Animation with points:</span>
<a id="__codelineno-0-1607" name="__codelineno-0-1607"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-1608" name="__codelineno-0-1608"></a><span class="sd">    &gt;&gt;&gt; # Create points to display on the animation</span>
<a id="__codelineno-0-1609" name="__codelineno-0-1609"></a><span class="sd">    &gt;&gt;&gt; points = np.array([[1, 2, 3], [2, 5, 5], [3, 8, 8]])</span>
<a id="__codelineno-0-1610" name="__codelineno-0-1610"></a><span class="sd">    &gt;&gt;&gt; anim_obj = animated_array.animate(</span>
<a id="__codelineno-0-1611" name="__codelineno-0-1611"></a><span class="sd">    ...     frame_labels,</span>
<a id="__codelineno-0-1612" name="__codelineno-0-1612"></a><span class="sd">    ...     points=points,</span>
<a id="__codelineno-0-1613" name="__codelineno-0-1613"></a><span class="sd">    ...     point_color=&quot;black&quot;,</span>
<a id="__codelineno-0-1614" name="__codelineno-0-1614"></a><span class="sd">    ...     point_size=150,</span>
<a id="__codelineno-0-1615" name="__codelineno-0-1615"></a><span class="sd">    ...     pid_color=&quot;white&quot;,</span>
<a id="__codelineno-0-1616" name="__codelineno-0-1616"></a><span class="sd">    ...     pid_size=12</span>
<a id="__codelineno-0-1617" name="__codelineno-0-1617"></a><span class="sd">    ... )</span>
<a id="__codelineno-0-1618" name="__codelineno-0-1618"></a>
<a id="__codelineno-0-1619" name="__codelineno-0-1619"></a><span class="sd">    ```</span>
<a id="__codelineno-0-1620" name="__codelineno-0-1620"></a><span class="sd">    Animation with cell values displayed:</span>
<a id="__codelineno-0-1621" name="__codelineno-0-1621"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-1622" name="__codelineno-0-1622"></a><span class="sd">    &gt;&gt;&gt; anim_obj = animated_array.animate(</span>
<a id="__codelineno-0-1623" name="__codelineno-0-1623"></a><span class="sd">    ...     frame_labels,</span>
<a id="__codelineno-0-1624" name="__codelineno-0-1624"></a><span class="sd">    ...     display_cell_value=True,</span>
<a id="__codelineno-0-1625" name="__codelineno-0-1625"></a><span class="sd">    ...     num_size=10,</span>
<a id="__codelineno-0-1626" name="__codelineno-0-1626"></a><span class="sd">    ...     text_colors=(&quot;yellow&quot;, &quot;blue&quot;)</span>
<a id="__codelineno-0-1627" name="__codelineno-0-1627"></a><span class="sd">    ... )</span>
<a id="__codelineno-0-1628" name="__codelineno-0-1628"></a>
<a id="__codelineno-0-1629" name="__codelineno-0-1629"></a><span class="sd">    ```</span>
<a id="__codelineno-0-1630" name="__codelineno-0-1630"></a><span class="sd">    ![animated_array](./../_images/array_glyph/animated_array.gif)</span>
<a id="__codelineno-0-1631" name="__codelineno-0-1631"></a>
<a id="__codelineno-0-1632" name="__codelineno-0-1632"></a><span class="sd">    Saving the animation to a file:</span>
<a id="__codelineno-0-1633" name="__codelineno-0-1633"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-1634" name="__codelineno-0-1634"></a><span class="sd">    &gt;&gt;&gt; # Create the animation first</span>
<a id="__codelineno-0-1635" name="__codelineno-0-1635"></a><span class="sd">    &gt;&gt;&gt; anim_obj = animated_array.animate(frame_labels)</span>
<a id="__codelineno-0-1636" name="__codelineno-0-1636"></a><span class="sd">    &gt;&gt;&gt; # Then save it to a file</span>
<a id="__codelineno-0-1637" name="__codelineno-0-1637"></a><span class="sd">    &gt;&gt;&gt; animated_array.save_animation(&quot;animation.gif&quot;, fps=2)</span>
<a id="__codelineno-0-1638" name="__codelineno-0-1638"></a>
<a id="__codelineno-0-1639" name="__codelineno-0-1639"></a><span class="sd">    ```</span>
<a id="__codelineno-0-1640" name="__codelineno-0-1640"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1641" name="__codelineno-0-1641"></a>    <span class="k">if</span> <span class="n">text_loc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1642" name="__codelineno-0-1642"></a>        <span class="n">text_loc</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">]</span>
<a id="__codelineno-0-1643" name="__codelineno-0-1643"></a>
<a id="__codelineno-0-1644" name="__codelineno-0-1644"></a>    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-1645" name="__codelineno-0-1645"></a>        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-1646" name="__codelineno-0-1646"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1647" name="__codelineno-0-1647"></a>                <span class="sa">f</span><span class="s2">&quot;The given keyword argument:</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> is not correct, possible parameters are,&quot;</span>
<a id="__codelineno-0-1648" name="__codelineno-0-1648"></a>                <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">DEFAULT_OPTIONS</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-1649" name="__codelineno-0-1649"></a>            <span class="p">)</span>
<a id="__codelineno-0-1650" name="__codelineno-0-1650"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1651" name="__codelineno-0-1651"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
<a id="__codelineno-0-1652" name="__codelineno-0-1652"></a>
<a id="__codelineno-0-1653" name="__codelineno-0-1653"></a>    <span class="c1"># if user did not input ticks spacing use the calculated one.</span>
<a id="__codelineno-0-1654" name="__codelineno-0-1654"></a>    <span class="k">if</span> <span class="s2">&quot;ticks_spacing&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-1655" name="__codelineno-0-1655"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;ticks_spacing&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;ticks_spacing&quot;</span><span class="p">]</span>
<a id="__codelineno-0-1656" name="__codelineno-0-1656"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1657" name="__codelineno-0-1657"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;ticks_spacing&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ticks_spacing</span>
<a id="__codelineno-0-1658" name="__codelineno-0-1658"></a>
<a id="__codelineno-0-1659" name="__codelineno-0-1659"></a>    <span class="k">if</span> <span class="s2">&quot;vmin&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-1660" name="__codelineno-0-1660"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;vmin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;vmin&quot;</span><span class="p">]</span>
<a id="__codelineno-0-1661" name="__codelineno-0-1661"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1662" name="__codelineno-0-1662"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;vmin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmin</span>
<a id="__codelineno-0-1663" name="__codelineno-0-1663"></a>
<a id="__codelineno-0-1664" name="__codelineno-0-1664"></a>    <span class="k">if</span> <span class="s2">&quot;vmax&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-1665" name="__codelineno-0-1665"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;vmax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;vmax&quot;</span><span class="p">]</span>
<a id="__codelineno-0-1666" name="__codelineno-0-1666"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1667" name="__codelineno-0-1667"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;vmax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmax</span>
<a id="__codelineno-0-1668" name="__codelineno-0-1668"></a>
<a id="__codelineno-0-1669" name="__codelineno-0-1669"></a>    <span class="c1"># if optional_display</span>
<a id="__codelineno-0-1670" name="__codelineno-0-1670"></a>    <span class="n">precision</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;precision&quot;</span><span class="p">]</span>
<a id="__codelineno-0-1671" name="__codelineno-0-1671"></a>    <span class="n">array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr</span>
<a id="__codelineno-0-1672" name="__codelineno-0-1672"></a>
<a id="__codelineno-0-1673" name="__codelineno-0-1673"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1674" name="__codelineno-0-1674"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_figure_axes</span><span class="p">()</span>
<a id="__codelineno-0-1675" name="__codelineno-0-1675"></a>
<a id="__codelineno-0-1676" name="__codelineno-0-1676"></a>    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span>
<a id="__codelineno-0-1677" name="__codelineno-0-1677"></a>
<a id="__codelineno-0-1678" name="__codelineno-0-1678"></a>    <span class="n">ticks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-0-1679" name="__codelineno-0-1679"></a>    <span class="n">im</span><span class="p">,</span> <span class="n">cbar_kw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_im_get_cbar_kw</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="n">ticks</span><span class="p">)</span>
<a id="__codelineno-0-1680" name="__codelineno-0-1680"></a>
<a id="__codelineno-0-1681" name="__codelineno-0-1681"></a>    <span class="c1"># Create colorbar</span>
<a id="__codelineno-0-1682" name="__codelineno-0-1682"></a>    <span class="n">cbar</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span>
<a id="__codelineno-0-1683" name="__codelineno-0-1683"></a>        <span class="n">im</span><span class="p">,</span>
<a id="__codelineno-0-1684" name="__codelineno-0-1684"></a>        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
<a id="__codelineno-0-1685" name="__codelineno-0-1685"></a>        <span class="n">shrink</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;cbar_length&quot;</span><span class="p">],</span>
<a id="__codelineno-0-1686" name="__codelineno-0-1686"></a>        <span class="n">orientation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;cbar_orientation&quot;</span><span class="p">],</span>
<a id="__codelineno-0-1687" name="__codelineno-0-1687"></a>        <span class="o">**</span><span class="n">cbar_kw</span><span class="p">,</span>
<a id="__codelineno-0-1688" name="__codelineno-0-1688"></a>    <span class="p">)</span>
<a id="__codelineno-0-1689" name="__codelineno-0-1689"></a>    <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span>
<a id="__codelineno-0-1690" name="__codelineno-0-1690"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;cbar_label&quot;</span><span class="p">],</span>
<a id="__codelineno-0-1691" name="__codelineno-0-1691"></a>        <span class="n">rotation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;cbar_label_rotation&quot;</span><span class="p">],</span>
<a id="__codelineno-0-1692" name="__codelineno-0-1692"></a>        <span class="n">va</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;cbar_label_location&quot;</span><span class="p">],</span>
<a id="__codelineno-0-1693" name="__codelineno-0-1693"></a>        <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;cbar_label_size&quot;</span><span class="p">],</span>
<a id="__codelineno-0-1694" name="__codelineno-0-1694"></a>    <span class="p">)</span>
<a id="__codelineno-0-1695" name="__codelineno-0-1695"></a>    <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-0-1696" name="__codelineno-0-1696"></a>
<a id="__codelineno-0-1697" name="__codelineno-0-1697"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
<a id="__codelineno-0-1698" name="__codelineno-0-1698"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;title_size&quot;</span><span class="p">]</span>
<a id="__codelineno-0-1699" name="__codelineno-0-1699"></a>    <span class="p">)</span>
<a id="__codelineno-0-1700" name="__codelineno-0-1700"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
<a id="__codelineno-0-1701" name="__codelineno-0-1701"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
<a id="__codelineno-0-1702" name="__codelineno-0-1702"></a>
<a id="__codelineno-0-1703" name="__codelineno-0-1703"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
<a id="__codelineno-0-1704" name="__codelineno-0-1704"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
<a id="__codelineno-0-1705" name="__codelineno-0-1705"></a>
<a id="__codelineno-0-1706" name="__codelineno-0-1706"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;display_cell_value&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-1707" name="__codelineno-0-1707"></a>        <span class="n">indices</span> <span class="o">=</span> <span class="n">get_indices2</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
<a id="__codelineno-0-1708" name="__codelineno-0-1708"></a>        <span class="n">cell_text_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_text</span><span class="p">(</span>
<a id="__codelineno-0-1709" name="__codelineno-0-1709"></a>            <span class="n">ax</span><span class="p">,</span> <span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="n">indices</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span>
<a id="__codelineno-0-1710" name="__codelineno-0-1710"></a>        <span class="p">)</span>
<a id="__codelineno-0-1711" name="__codelineno-0-1711"></a>        <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
<a id="__codelineno-0-1712" name="__codelineno-0-1712"></a>
<a id="__codelineno-0-1713" name="__codelineno-0-1713"></a>    <span class="k">if</span> <span class="n">points</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1714" name="__codelineno-0-1714"></a>        <span class="n">row</span> <span class="o">=</span> <span class="n">points</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-1715" name="__codelineno-0-1715"></a>        <span class="n">col</span> <span class="o">=</span> <span class="n">points</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-1716" name="__codelineno-0-1716"></a>        <span class="n">points_scatter</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">point_color</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">point_size</span><span class="p">)</span>
<a id="__codelineno-0-1717" name="__codelineno-0-1717"></a>        <span class="n">points_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_point_values</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">pid_color</span><span class="p">,</span> <span class="n">pid_size</span><span class="p">)</span>
<a id="__codelineno-0-1718" name="__codelineno-0-1718"></a>
<a id="__codelineno-0-1719" name="__codelineno-0-1719"></a>    <span class="c1"># Normalize the threshold to the image color range.</span>
<a id="__codelineno-0-1720" name="__codelineno-0-1720"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;background_color_threshold&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1721" name="__codelineno-0-1721"></a>        <span class="n">background_color_threshold</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span>
<a id="__codelineno-0-1722" name="__codelineno-0-1722"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;background_color_threshold&quot;</span><span class="p">]</span>
<a id="__codelineno-0-1723" name="__codelineno-0-1723"></a>        <span class="p">)</span>
<a id="__codelineno-0-1724" name="__codelineno-0-1724"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1725" name="__codelineno-0-1725"></a>        <span class="n">background_color_threshold</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">array</span><span class="p">))</span> <span class="o">/</span> <span class="mf">2.0</span>
<a id="__codelineno-0-1726" name="__codelineno-0-1726"></a>
<a id="__codelineno-0-1727" name="__codelineno-0-1727"></a>    <span class="n">day_text</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
<a id="__codelineno-0-1728" name="__codelineno-0-1728"></a>        <span class="n">text_loc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<a id="__codelineno-0-1729" name="__codelineno-0-1729"></a>        <span class="n">text_loc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-1730" name="__codelineno-0-1730"></a>        <span class="s2">&quot; &quot;</span><span class="p">,</span>
<a id="__codelineno-0-1731" name="__codelineno-0-1731"></a>        <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;cbar_label_size&quot;</span><span class="p">],</span>
<a id="__codelineno-0-1732" name="__codelineno-0-1732"></a>    <span class="p">)</span>
<a id="__codelineno-0-1733" name="__codelineno-0-1733"></a>
<a id="__codelineno-0-1734" name="__codelineno-0-1734"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">init</span><span class="p">():</span>
<a id="__codelineno-0-1735" name="__codelineno-0-1735"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;initialize the plot with the first array&quot;&quot;&quot;</span>
<a id="__codelineno-0-1736" name="__codelineno-0-1736"></a>        <span class="n">im</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:])</span>
<a id="__codelineno-0-1737" name="__codelineno-0-1737"></a>        <span class="n">day_text</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-0-1738" name="__codelineno-0-1738"></a>        <span class="n">output</span> <span class="o">=</span> <span class="p">[</span><span class="n">im</span><span class="p">,</span> <span class="n">day_text</span><span class="p">]</span>
<a id="__codelineno-0-1739" name="__codelineno-0-1739"></a>
<a id="__codelineno-0-1740" name="__codelineno-0-1740"></a>        <span class="k">if</span> <span class="n">points</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1741" name="__codelineno-0-1741"></a>            <span class="n">points_scatter</span><span class="o">.</span><span class="n">set_offsets</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">col</span><span class="p">,</span> <span class="n">row</span><span class="p">])</span>
<a id="__codelineno-0-1742" name="__codelineno-0-1742"></a>            <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">points_scatter</span><span class="p">)</span>
<a id="__codelineno-0-1743" name="__codelineno-0-1743"></a>            <span class="n">update_points</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">points_id</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-1744" name="__codelineno-0-1744"></a>            <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">update_points</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">col</span><span class="p">))))</span>
<a id="__codelineno-0-1745" name="__codelineno-0-1745"></a>
<a id="__codelineno-0-1746" name="__codelineno-0-1746"></a>            <span class="n">output</span> <span class="o">+=</span> <span class="n">points_id</span>
<a id="__codelineno-0-1747" name="__codelineno-0-1747"></a>
<a id="__codelineno-0-1748" name="__codelineno-0-1748"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;display_cell_value&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-1749" name="__codelineno-0-1749"></a>            <span class="n">vals</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">indices</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">indices</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]]</span>
<a id="__codelineno-0-1750" name="__codelineno-0-1750"></a>            <span class="n">update_cell_value</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">cell_text_value</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
<a id="__codelineno-0-1751" name="__codelineno-0-1751"></a>            <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">update_cell_value</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">no_elem</span><span class="p">)))</span>
<a id="__codelineno-0-1752" name="__codelineno-0-1752"></a>            <span class="n">output</span> <span class="o">+=</span> <span class="n">cell_text_value</span>
<a id="__codelineno-0-1753" name="__codelineno-0-1753"></a>
<a id="__codelineno-0-1754" name="__codelineno-0-1754"></a>        <span class="k">return</span> <span class="n">output</span>
<a id="__codelineno-0-1755" name="__codelineno-0-1755"></a>
<a id="__codelineno-0-1756" name="__codelineno-0-1756"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">animate_a</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
<a id="__codelineno-0-1757" name="__codelineno-0-1757"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;plot for each element in the iterable.&quot;&quot;&quot;</span>
<a id="__codelineno-0-1758" name="__codelineno-0-1758"></a>        <span class="n">im</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:])</span>
<a id="__codelineno-0-1759" name="__codelineno-0-1759"></a>        <span class="n">day_text</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="s2">&quot;Date = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">])</span>
<a id="__codelineno-0-1760" name="__codelineno-0-1760"></a>        <span class="n">output</span> <span class="o">=</span> <span class="p">[</span><span class="n">im</span><span class="p">,</span> <span class="n">day_text</span><span class="p">]</span>
<a id="__codelineno-0-1761" name="__codelineno-0-1761"></a>
<a id="__codelineno-0-1762" name="__codelineno-0-1762"></a>        <span class="k">if</span> <span class="n">points</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1763" name="__codelineno-0-1763"></a>            <span class="n">points_scatter</span><span class="o">.</span><span class="n">set_offsets</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">col</span><span class="p">,</span> <span class="n">row</span><span class="p">])</span>
<a id="__codelineno-0-1764" name="__codelineno-0-1764"></a>            <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">points_scatter</span><span class="p">)</span>
<a id="__codelineno-0-1765" name="__codelineno-0-1765"></a>
<a id="__codelineno-0-1766" name="__codelineno-0-1766"></a>            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">col</span><span class="p">)):</span>
<a id="__codelineno-0-1767" name="__codelineno-0-1767"></a>                <span class="n">points_id</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-1768" name="__codelineno-0-1768"></a>
<a id="__codelineno-0-1769" name="__codelineno-0-1769"></a>            <span class="n">output</span> <span class="o">+=</span> <span class="n">points_id</span>
<a id="__codelineno-0-1770" name="__codelineno-0-1770"></a>
<a id="__codelineno-0-1771" name="__codelineno-0-1771"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;display_cell_value&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-1772" name="__codelineno-0-1772"></a>            <span class="n">vals</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">indices</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">indices</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]]</span>
<a id="__codelineno-0-1773" name="__codelineno-0-1773"></a>
<a id="__codelineno-0-1774" name="__codelineno-0-1774"></a>            <span class="k">def</span><span class="w"> </span><span class="nf">update_cell_value</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<a id="__codelineno-0-1775" name="__codelineno-0-1775"></a><span class="w">                </span><span class="sd">&quot;&quot;&quot;Update cell value&quot;&quot;&quot;</span>
<a id="__codelineno-0-1776" name="__codelineno-0-1776"></a>                <span class="n">val</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">precision</span><span class="p">)</span>
<a id="__codelineno-0-1777" name="__codelineno-0-1777"></a>                <span class="n">kw</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-1778" name="__codelineno-0-1778"></a>                    <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="n">text_colors</span><span class="p">[</span>
<a id="__codelineno-0-1779" name="__codelineno-0-1779"></a>                        <span class="nb">int</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="n">x</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">background_color_threshold</span><span class="p">)</span>
<a id="__codelineno-0-1780" name="__codelineno-0-1780"></a>                    <span class="p">]</span>
<a id="__codelineno-0-1781" name="__codelineno-0-1781"></a>                <span class="p">}</span>
<a id="__codelineno-0-1782" name="__codelineno-0-1782"></a>                <span class="n">cell_text_value</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kw</span><span class="p">)</span>
<a id="__codelineno-0-1783" name="__codelineno-0-1783"></a>                <span class="n">cell_text_value</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
<a id="__codelineno-0-1784" name="__codelineno-0-1784"></a>
<a id="__codelineno-0-1785" name="__codelineno-0-1785"></a>            <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">update_cell_value</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">no_elem</span><span class="p">)))</span>
<a id="__codelineno-0-1786" name="__codelineno-0-1786"></a>
<a id="__codelineno-0-1787" name="__codelineno-0-1787"></a>            <span class="n">output</span> <span class="o">+=</span> <span class="n">cell_text_value</span>
<a id="__codelineno-0-1788" name="__codelineno-0-1788"></a>
<a id="__codelineno-0-1789" name="__codelineno-0-1789"></a>        <span class="k">return</span> <span class="n">output</span>
<a id="__codelineno-0-1790" name="__codelineno-0-1790"></a>
<a id="__codelineno-0-1791" name="__codelineno-0-1791"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<a id="__codelineno-0-1792" name="__codelineno-0-1792"></a>    <span class="n">anim</span> <span class="o">=</span> <span class="n">FuncAnimation</span><span class="p">(</span>
<a id="__codelineno-0-1793" name="__codelineno-0-1793"></a>        <span class="n">fig</span><span class="p">,</span>
<a id="__codelineno-0-1794" name="__codelineno-0-1794"></a>        <span class="n">animate_a</span><span class="p">,</span>
<a id="__codelineno-0-1795" name="__codelineno-0-1795"></a>        <span class="n">init_func</span><span class="o">=</span><span class="n">init</span><span class="p">,</span>
<a id="__codelineno-0-1796" name="__codelineno-0-1796"></a>        <span class="n">frames</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">array</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
<a id="__codelineno-0-1797" name="__codelineno-0-1797"></a>        <span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span>
<a id="__codelineno-0-1798" name="__codelineno-0-1798"></a>        <span class="n">blit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-1799" name="__codelineno-0-1799"></a>    <span class="p">)</span>
<a id="__codelineno-0-1800" name="__codelineno-0-1800"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">_anim</span> <span class="o">=</span> <span class="n">anim</span>
<a id="__codelineno-0-1801" name="__codelineno-0-1801"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a id="__codelineno-0-1802" name="__codelineno-0-1802"></a>    <span class="k">return</span> <span class="n">anim</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="cleopatra.array_glyph.ArrayGlyph.apply_colormap" class="doc doc-heading"><a href="#cleopatra.array_glyph.ArrayGlyph.apply_colormap" class="toclink">
            <code class="highlight language-python"><span class="n">apply_colormap</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span></code>

</a><a href="#cleopatra.array_glyph.ArrayGlyph.apply_colormap" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Apply a matplotlib colormap to an array.</p>
<div class="highlight"><pre><span></span><code>Create an RGB channel from the given array using the given colormap.
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cmap</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="matplotlib.colors.Colormap">Colormap</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>colormap.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>np.ndarray: 8-bit array</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the array with the colormap applied.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <ul>
<li>Create an array and instantiate the <code>Array</code> object:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]])</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">array</span> <span class="o">=</span> <span class="n">ArrayGlyph</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">rgb_array</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">apply_colormap</span><span class="p">(</span><span class="s2">&quot;coolwarm_r&quot;</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">rgb_array</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="p">[[[</span><span class="mi">179</span>   <span class="mi">3</span>  <span class="mi">38</span><span class="p">]</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>  <span class="p">[</span><span class="mi">221</span>  <span class="mi">96</span>  <span class="mi">76</span><span class="p">]</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>  <span class="p">[</span><span class="mi">244</span> <span class="mi">154</span> <span class="mi">123</span><span class="p">]]</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a> <span class="p">[[</span><span class="mi">244</span> <span class="mi">196</span> <span class="mi">173</span><span class="p">]</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>  <span class="p">[</span><span class="mi">220</span> <span class="mi">220</span> <span class="mi">221</span><span class="p">]</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>  <span class="p">[</span><span class="mi">183</span> <span class="mi">207</span> <span class="mi">249</span><span class="p">]]</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a> <span class="p">[[</span><span class="mi">139</span> <span class="mi">17</span> <span class="mi">4</span> <span class="mi">253</span><span class="p">]</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>  <span class="p">[</span> <span class="mi">96</span> <span class="mi">128</span> <span class="mi">232</span><span class="p">]</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>  <span class="p">[</span> <span class="mi">58</span>  <span class="mi">76</span> <span class="mi">192</span><span class="p">]]]</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>  <span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">rgb_array</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>    <span class="n">uint8</span>
</code></pre></div></li>
</ul>


            <details class="quote">
              <summary>Source code in <code>cleopatra/array_glyph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-786">786</a></span>
<span class="normal"><a href="#__codelineno-0-787">787</a></span>
<span class="normal"><a href="#__codelineno-0-788">788</a></span>
<span class="normal"><a href="#__codelineno-0-789">789</a></span>
<span class="normal"><a href="#__codelineno-0-790">790</a></span>
<span class="normal"><a href="#__codelineno-0-791">791</a></span>
<span class="normal"><a href="#__codelineno-0-792">792</a></span>
<span class="normal"><a href="#__codelineno-0-793">793</a></span>
<span class="normal"><a href="#__codelineno-0-794">794</a></span>
<span class="normal"><a href="#__codelineno-0-795">795</a></span>
<span class="normal"><a href="#__codelineno-0-796">796</a></span>
<span class="normal"><a href="#__codelineno-0-797">797</a></span>
<span class="normal"><a href="#__codelineno-0-798">798</a></span>
<span class="normal"><a href="#__codelineno-0-799">799</a></span>
<span class="normal"><a href="#__codelineno-0-800">800</a></span>
<span class="normal"><a href="#__codelineno-0-801">801</a></span>
<span class="normal"><a href="#__codelineno-0-802">802</a></span>
<span class="normal"><a href="#__codelineno-0-803">803</a></span>
<span class="normal"><a href="#__codelineno-0-804">804</a></span>
<span class="normal"><a href="#__codelineno-0-805">805</a></span>
<span class="normal"><a href="#__codelineno-0-806">806</a></span>
<span class="normal"><a href="#__codelineno-0-807">807</a></span>
<span class="normal"><a href="#__codelineno-0-808">808</a></span>
<span class="normal"><a href="#__codelineno-0-809">809</a></span>
<span class="normal"><a href="#__codelineno-0-810">810</a></span>
<span class="normal"><a href="#__codelineno-0-811">811</a></span>
<span class="normal"><a href="#__codelineno-0-812">812</a></span>
<span class="normal"><a href="#__codelineno-0-813">813</a></span>
<span class="normal"><a href="#__codelineno-0-814">814</a></span>
<span class="normal"><a href="#__codelineno-0-815">815</a></span>
<span class="normal"><a href="#__codelineno-0-816">816</a></span>
<span class="normal"><a href="#__codelineno-0-817">817</a></span>
<span class="normal"><a href="#__codelineno-0-818">818</a></span>
<span class="normal"><a href="#__codelineno-0-819">819</a></span>
<span class="normal"><a href="#__codelineno-0-820">820</a></span>
<span class="normal"><a href="#__codelineno-0-821">821</a></span>
<span class="normal"><a href="#__codelineno-0-822">822</a></span>
<span class="normal"><a href="#__codelineno-0-823">823</a></span>
<span class="normal"><a href="#__codelineno-0-824">824</a></span>
<span class="normal"><a href="#__codelineno-0-825">825</a></span>
<span class="normal"><a href="#__codelineno-0-826">826</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-786" name="__codelineno-0-786"></a><span class="k">def</span><span class="w"> </span><span class="nf">apply_colormap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmap</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Colormap</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-787" name="__codelineno-0-787"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply a matplotlib colormap to an array.</span>
<a id="__codelineno-0-788" name="__codelineno-0-788"></a>
<a id="__codelineno-0-789" name="__codelineno-0-789"></a><span class="sd">        Create an RGB channel from the given array using the given colormap.</span>
<a id="__codelineno-0-790" name="__codelineno-0-790"></a>
<a id="__codelineno-0-791" name="__codelineno-0-791"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-792" name="__codelineno-0-792"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-793" name="__codelineno-0-793"></a><span class="sd">    cmap: Colormap/str</span>
<a id="__codelineno-0-794" name="__codelineno-0-794"></a><span class="sd">        colormap.</span>
<a id="__codelineno-0-795" name="__codelineno-0-795"></a>
<a id="__codelineno-0-796" name="__codelineno-0-796"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-797" name="__codelineno-0-797"></a><span class="sd">    -------</span>
<a id="__codelineno-0-798" name="__codelineno-0-798"></a><span class="sd">    np.ndarray: 8-bit array</span>
<a id="__codelineno-0-799" name="__codelineno-0-799"></a><span class="sd">        the array with the colormap applied.</span>
<a id="__codelineno-0-800" name="__codelineno-0-800"></a>
<a id="__codelineno-0-801" name="__codelineno-0-801"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-802" name="__codelineno-0-802"></a><span class="sd">    --------</span>
<a id="__codelineno-0-803" name="__codelineno-0-803"></a><span class="sd">    - Create an array and instantiate the `Array` object:</span>
<a id="__codelineno-0-804" name="__codelineno-0-804"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-805" name="__codelineno-0-805"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-806" name="__codelineno-0-806"></a><span class="sd">        &gt;&gt;&gt; arr = np.array([[1, 2, 3], [4, 5, 6], [7, 8, 9]])</span>
<a id="__codelineno-0-807" name="__codelineno-0-807"></a><span class="sd">        &gt;&gt;&gt; array = ArrayGlyph(arr)</span>
<a id="__codelineno-0-808" name="__codelineno-0-808"></a><span class="sd">        &gt;&gt;&gt; rgb_array = array.apply_colormap(&quot;coolwarm_r&quot;)</span>
<a id="__codelineno-0-809" name="__codelineno-0-809"></a><span class="sd">        &gt;&gt;&gt; print(rgb_array)</span>
<a id="__codelineno-0-810" name="__codelineno-0-810"></a><span class="sd">        [[[179   3  38]</span>
<a id="__codelineno-0-811" name="__codelineno-0-811"></a><span class="sd">          [221  96  76]</span>
<a id="__codelineno-0-812" name="__codelineno-0-812"></a><span class="sd">          [244 154 123]]</span>
<a id="__codelineno-0-813" name="__codelineno-0-813"></a><span class="sd">         [[244 196 173]</span>
<a id="__codelineno-0-814" name="__codelineno-0-814"></a><span class="sd">          [220 220 221]</span>
<a id="__codelineno-0-815" name="__codelineno-0-815"></a><span class="sd">          [183 207 249]]</span>
<a id="__codelineno-0-816" name="__codelineno-0-816"></a><span class="sd">         [[139 17 4 253]</span>
<a id="__codelineno-0-817" name="__codelineno-0-817"></a><span class="sd">          [ 96 128 232]</span>
<a id="__codelineno-0-818" name="__codelineno-0-818"></a><span class="sd">          [ 58  76 192]]]</span>
<a id="__codelineno-0-819" name="__codelineno-0-819"></a><span class="sd">          &gt;&gt;&gt; print(rgb_array.dtype)</span>
<a id="__codelineno-0-820" name="__codelineno-0-820"></a><span class="sd">            uint8</span>
<a id="__codelineno-0-821" name="__codelineno-0-821"></a><span class="sd">        ```</span>
<a id="__codelineno-0-822" name="__codelineno-0-822"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-823" name="__codelineno-0-823"></a>    <span class="n">colormap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">cmap</span>
<a id="__codelineno-0-824" name="__codelineno-0-824"></a>    <span class="n">normed_data</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arr</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="o">.</span><span class="n">min</span><span class="p">())</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
<a id="__codelineno-0-825" name="__codelineno-0-825"></a>    <span class="n">colored</span> <span class="o">=</span> <span class="n">colormap</span><span class="p">(</span><span class="n">normed_data</span><span class="p">)</span>
<a id="__codelineno-0-826" name="__codelineno-0-826"></a>    <span class="k">return</span> <span class="p">(</span><span class="n">colored</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;uint8&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="cleopatra.array_glyph.ArrayGlyph.create_color_bar" class="doc doc-heading"><a href="#cleopatra.array_glyph.ArrayGlyph.create_color_bar" class="toclink">
            <code class="highlight language-python"><span class="n">create_color_bar</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">im</span><span class="p">,</span> <span class="n">cbar_kw</span><span class="p">)</span></code>

</a><a href="#cleopatra.array_glyph.ArrayGlyph.create_color_bar" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Create Color bar.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ax</code>
            </td>
            <td>
                  <code><span title="matplotlib.axes.Axes">Axes</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>matplotlib axes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>im</code>
            </td>
            <td>
                  <code><span title="matplotlib.image.AxesImage">AxesImage</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Image axes.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cbar_kw</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>color bar keyword arguments.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Colorbar</code></td>            <td>
                  <code><span title="matplotlib.colorbar.Colorbar">Colorbar</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>colorbar object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cleopatra/array_glyph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-924">924</a></span>
<span class="normal"><a href="#__codelineno-0-925">925</a></span>
<span class="normal"><a href="#__codelineno-0-926">926</a></span>
<span class="normal"><a href="#__codelineno-0-927">927</a></span>
<span class="normal"><a href="#__codelineno-0-928">928</a></span>
<span class="normal"><a href="#__codelineno-0-929">929</a></span>
<span class="normal"><a href="#__codelineno-0-930">930</a></span>
<span class="normal"><a href="#__codelineno-0-931">931</a></span>
<span class="normal"><a href="#__codelineno-0-932">932</a></span>
<span class="normal"><a href="#__codelineno-0-933">933</a></span>
<span class="normal"><a href="#__codelineno-0-934">934</a></span>
<span class="normal"><a href="#__codelineno-0-935">935</a></span>
<span class="normal"><a href="#__codelineno-0-936">936</a></span>
<span class="normal"><a href="#__codelineno-0-937">937</a></span>
<span class="normal"><a href="#__codelineno-0-938">938</a></span>
<span class="normal"><a href="#__codelineno-0-939">939</a></span>
<span class="normal"><a href="#__codelineno-0-940">940</a></span>
<span class="normal"><a href="#__codelineno-0-941">941</a></span>
<span class="normal"><a href="#__codelineno-0-942">942</a></span>
<span class="normal"><a href="#__codelineno-0-943">943</a></span>
<span class="normal"><a href="#__codelineno-0-944">944</a></span>
<span class="normal"><a href="#__codelineno-0-945">945</a></span>
<span class="normal"><a href="#__codelineno-0-946">946</a></span>
<span class="normal"><a href="#__codelineno-0-947">947</a></span>
<span class="normal"><a href="#__codelineno-0-948">948</a></span>
<span class="normal"><a href="#__codelineno-0-949">949</a></span>
<span class="normal"><a href="#__codelineno-0-950">950</a></span>
<span class="normal"><a href="#__codelineno-0-951">951</a></span>
<span class="normal"><a href="#__codelineno-0-952">952</a></span>
<span class="normal"><a href="#__codelineno-0-953">953</a></span>
<span class="normal"><a href="#__codelineno-0-954">954</a></span>
<span class="normal"><a href="#__codelineno-0-955">955</a></span>
<span class="normal"><a href="#__codelineno-0-956">956</a></span>
<span class="normal"><a href="#__codelineno-0-957">957</a></span>
<span class="normal"><a href="#__codelineno-0-958">958</a></span>
<span class="normal"><a href="#__codelineno-0-959">959</a></span>
<span class="normal"><a href="#__codelineno-0-960">960</a></span>
<span class="normal"><a href="#__codelineno-0-961">961</a></span>
<span class="normal"><a href="#__codelineno-0-962">962</a></span>
<span class="normal"><a href="#__codelineno-0-963">963</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-924" name="__codelineno-0-924"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_color_bar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">:</span> <span class="n">Axes</span><span class="p">,</span> <span class="n">im</span><span class="p">:</span> <span class="n">AxesImage</span><span class="p">,</span> <span class="n">cbar_kw</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Colorbar</span><span class="p">:</span>
<a id="__codelineno-0-925" name="__codelineno-0-925"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create Color bar.</span>
<a id="__codelineno-0-926" name="__codelineno-0-926"></a>
<a id="__codelineno-0-927" name="__codelineno-0-927"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-928" name="__codelineno-0-928"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-929" name="__codelineno-0-929"></a><span class="sd">    ax: Axes</span>
<a id="__codelineno-0-930" name="__codelineno-0-930"></a><span class="sd">        matplotlib axes.</span>
<a id="__codelineno-0-931" name="__codelineno-0-931"></a><span class="sd">    im: AxesImage</span>
<a id="__codelineno-0-932" name="__codelineno-0-932"></a><span class="sd">        Image axes.</span>
<a id="__codelineno-0-933" name="__codelineno-0-933"></a><span class="sd">    cbar_kw: dict</span>
<a id="__codelineno-0-934" name="__codelineno-0-934"></a><span class="sd">        color bar keyword arguments.</span>
<a id="__codelineno-0-935" name="__codelineno-0-935"></a>
<a id="__codelineno-0-936" name="__codelineno-0-936"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-937" name="__codelineno-0-937"></a><span class="sd">    -------</span>
<a id="__codelineno-0-938" name="__codelineno-0-938"></a><span class="sd">    Colorbar:</span>
<a id="__codelineno-0-939" name="__codelineno-0-939"></a><span class="sd">        colorbar object.</span>
<a id="__codelineno-0-940" name="__codelineno-0-940"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-941" name="__codelineno-0-941"></a>    <span class="c1"># im or cax is the last image added to the axes</span>
<a id="__codelineno-0-942" name="__codelineno-0-942"></a>    <span class="c1"># im = ax.images[-1]</span>
<a id="__codelineno-0-943" name="__codelineno-0-943"></a>    <span class="n">cbar</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span>
<a id="__codelineno-0-944" name="__codelineno-0-944"></a>        <span class="n">im</span><span class="p">,</span>
<a id="__codelineno-0-945" name="__codelineno-0-945"></a>        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
<a id="__codelineno-0-946" name="__codelineno-0-946"></a>        <span class="n">shrink</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;cbar_length&quot;</span><span class="p">],</span>
<a id="__codelineno-0-947" name="__codelineno-0-947"></a>        <span class="n">orientation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;cbar_orientation&quot;</span><span class="p">],</span>
<a id="__codelineno-0-948" name="__codelineno-0-948"></a>        <span class="o">**</span><span class="n">cbar_kw</span><span class="p">,</span>
<a id="__codelineno-0-949" name="__codelineno-0-949"></a>    <span class="p">)</span>
<a id="__codelineno-0-950" name="__codelineno-0-950"></a>    <span class="c1"># cbar.ax.set_ylabel(</span>
<a id="__codelineno-0-951" name="__codelineno-0-951"></a>    <span class="c1">#     self.default_options[&quot;cbar_label&quot;],</span>
<a id="__codelineno-0-952" name="__codelineno-0-952"></a>    <span class="c1">#     rotation=self.default_options[&quot;cbar_label_rotation&quot;],</span>
<a id="__codelineno-0-953" name="__codelineno-0-953"></a>    <span class="c1">#     va=self.default_options[&quot;cbar_label_location&quot;],</span>
<a id="__codelineno-0-954" name="__codelineno-0-954"></a>    <span class="c1">#     fontsize=self.default_options[&quot;cbar_label_size&quot;],</span>
<a id="__codelineno-0-955" name="__codelineno-0-955"></a>    <span class="c1"># )</span>
<a id="__codelineno-0-956" name="__codelineno-0-956"></a>    <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-0-957" name="__codelineno-0-957"></a>    <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span>
<a id="__codelineno-0-958" name="__codelineno-0-958"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;cbar_label&quot;</span><span class="p">],</span>
<a id="__codelineno-0-959" name="__codelineno-0-959"></a>        <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;cbar_label_size&quot;</span><span class="p">],</span>
<a id="__codelineno-0-960" name="__codelineno-0-960"></a>        <span class="n">loc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;cbar_label_location&quot;</span><span class="p">],</span>
<a id="__codelineno-0-961" name="__codelineno-0-961"></a>    <span class="p">)</span>
<a id="__codelineno-0-962" name="__codelineno-0-962"></a>
<a id="__codelineno-0-963" name="__codelineno-0-963"></a>    <span class="k">return</span> <span class="n">cbar</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="cleopatra.array_glyph.ArrayGlyph.create_figure_axes" class="doc doc-heading"><a href="#cleopatra.array_glyph.ArrayGlyph.create_figure_axes" class="toclink">
            <code class="highlight language-python"><span class="n">create_figure_axes</span><span class="p">()</span></code>

</a><a href="#cleopatra.array_glyph.ArrayGlyph.create_figure_axes" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Create the figure and the axes.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>fig</code></td>            <td>
                  <code><span title="matplotlib.figure.Figure">Figure</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the created figure.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>ax</code></td>            <td>
                  <code><span title="matplotlib.axes.Axes">Axes</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the created axes.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>cleopatra/array_glyph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-663">663</a></span>
<span class="normal"><a href="#__codelineno-0-664">664</a></span>
<span class="normal"><a href="#__codelineno-0-665">665</a></span>
<span class="normal"><a href="#__codelineno-0-666">666</a></span>
<span class="normal"><a href="#__codelineno-0-667">667</a></span>
<span class="normal"><a href="#__codelineno-0-668">668</a></span>
<span class="normal"><a href="#__codelineno-0-669">669</a></span>
<span class="normal"><a href="#__codelineno-0-670">670</a></span>
<span class="normal"><a href="#__codelineno-0-671">671</a></span>
<span class="normal"><a href="#__codelineno-0-672">672</a></span>
<span class="normal"><a href="#__codelineno-0-673">673</a></span>
<span class="normal"><a href="#__codelineno-0-674">674</a></span>
<span class="normal"><a href="#__codelineno-0-675">675</a></span>
<span class="normal"><a href="#__codelineno-0-676">676</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-663" name="__codelineno-0-663"></a><span class="k">def</span><span class="w"> </span><span class="nf">create_figure_axes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Figure</span><span class="p">,</span> <span class="n">Axes</span><span class="p">]:</span>
<a id="__codelineno-0-664" name="__codelineno-0-664"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create the figure and the axes.</span>
<a id="__codelineno-0-665" name="__codelineno-0-665"></a>
<a id="__codelineno-0-666" name="__codelineno-0-666"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-667" name="__codelineno-0-667"></a><span class="sd">    -------</span>
<a id="__codelineno-0-668" name="__codelineno-0-668"></a><span class="sd">    fig: matplotlib.figure.Figure</span>
<a id="__codelineno-0-669" name="__codelineno-0-669"></a><span class="sd">        the created figure.</span>
<a id="__codelineno-0-670" name="__codelineno-0-670"></a><span class="sd">    ax: matplotlib.axes.Axes</span>
<a id="__codelineno-0-671" name="__codelineno-0-671"></a><span class="sd">        the created axes.</span>
<a id="__codelineno-0-672" name="__codelineno-0-672"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-673" name="__codelineno-0-673"></a>    <span class="c1"># plt.ioff()  # to prevent the empty figure from being displayed</span>
<a id="__codelineno-0-674" name="__codelineno-0-674"></a>    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;figsize&quot;</span><span class="p">])</span>
<a id="__codelineno-0-675" name="__codelineno-0-675"></a>
<a id="__codelineno-0-676" name="__codelineno-0-676"></a>    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="cleopatra.array_glyph.ArrayGlyph.get_ticks" class="doc doc-heading"><a href="#cleopatra.array_glyph.ArrayGlyph.get_ticks" class="toclink">
            <code class="highlight language-python"><span class="n">get_ticks</span><span class="p">()</span></code>

</a><a href="#cleopatra.array_glyph.ArrayGlyph.get_ticks" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>get a list of ticks for the color bar</p>


            <details class="quote">
              <summary>Source code in <code>cleopatra/array_glyph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-678">678</a></span>
<span class="normal"><a href="#__codelineno-0-679">679</a></span>
<span class="normal"><a href="#__codelineno-0-680">680</a></span>
<span class="normal"><a href="#__codelineno-0-681">681</a></span>
<span class="normal"><a href="#__codelineno-0-682">682</a></span>
<span class="normal"><a href="#__codelineno-0-683">683</a></span>
<span class="normal"><a href="#__codelineno-0-684">684</a></span>
<span class="normal"><a href="#__codelineno-0-685">685</a></span>
<span class="normal"><a href="#__codelineno-0-686">686</a></span>
<span class="normal"><a href="#__codelineno-0-687">687</a></span>
<span class="normal"><a href="#__codelineno-0-688">688</a></span>
<span class="normal"><a href="#__codelineno-0-689">689</a></span>
<span class="normal"><a href="#__codelineno-0-690">690</a></span>
<span class="normal"><a href="#__codelineno-0-691">691</a></span>
<span class="normal"><a href="#__codelineno-0-692">692</a></span>
<span class="normal"><a href="#__codelineno-0-693">693</a></span>
<span class="normal"><a href="#__codelineno-0-694">694</a></span>
<span class="normal"><a href="#__codelineno-0-695">695</a></span>
<span class="normal"><a href="#__codelineno-0-696">696</a></span>
<span class="normal"><a href="#__codelineno-0-697">697</a></span>
<span class="normal"><a href="#__codelineno-0-698">698</a></span>
<span class="normal"><a href="#__codelineno-0-699">699</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-678" name="__codelineno-0-678"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_ticks</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-679" name="__codelineno-0-679"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;get a list of ticks for the color bar&quot;&quot;&quot;</span>
<a id="__codelineno-0-680" name="__codelineno-0-680"></a>    <span class="n">ticks_spacing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;ticks_spacing&quot;</span><span class="p">]</span>
<a id="__codelineno-0-681" name="__codelineno-0-681"></a>    <span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;vmax&quot;</span><span class="p">]</span>
<a id="__codelineno-0-682" name="__codelineno-0-682"></a>    <span class="n">vmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;vmin&quot;</span><span class="p">]</span>
<a id="__codelineno-0-683" name="__codelineno-0-683"></a>    <span class="n">remainder</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">remainder</span><span class="p">(</span><span class="n">vmax</span><span class="p">,</span> <span class="n">ticks_spacing</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-684" name="__codelineno-0-684"></a>    <span class="c1"># np.mod(vmax, ticks_spacing) gives float point error, so we use the round function.</span>
<a id="__codelineno-0-685" name="__codelineno-0-685"></a>    <span class="k">if</span> <span class="n">remainder</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-686" name="__codelineno-0-686"></a>        <span class="n">ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">+</span> <span class="n">ticks_spacing</span><span class="p">,</span> <span class="n">ticks_spacing</span><span class="p">)</span>
<a id="__codelineno-0-687" name="__codelineno-0-687"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-688" name="__codelineno-0-688"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-689" name="__codelineno-0-689"></a>            <span class="n">ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">+</span> <span class="n">ticks_spacing</span><span class="p">,</span> <span class="n">ticks_spacing</span><span class="p">)</span>
<a id="__codelineno-0-690" name="__codelineno-0-690"></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
<a id="__codelineno-0-691" name="__codelineno-0-691"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-692" name="__codelineno-0-692"></a>                <span class="s2">&quot;The number of ticks exceeded the max allowed size, possible errors&quot;</span>
<a id="__codelineno-0-693" name="__codelineno-0-693"></a>                <span class="sa">f</span><span class="s2">&quot; is the value of the NodataValue you entered-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">exclude_value</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-694" name="__codelineno-0-694"></a>            <span class="p">)</span>
<a id="__codelineno-0-695" name="__codelineno-0-695"></a>        <span class="n">ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<a id="__codelineno-0-696" name="__codelineno-0-696"></a>            <span class="n">ticks</span><span class="p">,</span>
<a id="__codelineno-0-697" name="__codelineno-0-697"></a>            <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">vmax</span> <span class="o">/</span> <span class="n">ticks_spacing</span><span class="p">)</span> <span class="o">*</span> <span class="n">ticks_spacing</span> <span class="o">+</span> <span class="n">ticks_spacing</span><span class="p">],</span>
<a id="__codelineno-0-698" name="__codelineno-0-698"></a>        <span class="p">)</span>
<a id="__codelineno-0-699" name="__codelineno-0-699"></a>    <span class="k">return</span> <span class="n">ticks</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="cleopatra.array_glyph.ArrayGlyph.plot" class="doc doc-heading"><a href="#cleopatra.array_glyph.ArrayGlyph.plot" class="toclink">
            <code class="highlight language-python"><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">point_color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">point_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">pid_color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">pid_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</a><a href="#cleopatra.array_glyph.ArrayGlyph.plot" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Plot the array with customizable visualization options.</p>
<p>This method creates a visualization of the array with various customization options
including color scales, color bars, cell value display, and point annotations.
It supports both regular arrays and RGB arrays.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>points</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Points to display on the array, by default None.
Should be a 3-column array where:
- First column: values to display for each point
- Second column: row indices of the points in the array
- Third column: column indices of the points in the array</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>point_color</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Color of the points, by default "red".
Any valid matplotlib color string.</p>
              </div>
            </td>
            <td>
                  <code>&#39;red&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>point_size</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="int">int</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Size of the points, by default 100.
Controls the marker size.</p>
              </div>
            </td>
            <td>
                  <code>100</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pid_color</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Color of the point value annotations, by default "blue".
Any valid matplotlib color string.</p>
              </div>
            </td>
            <td>
                  <code>&#39;blue&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pid_size</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="int">int</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Size of the point value annotations, by default 10.
Controls the font size of the annotations.</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments for customizing the plot.</p>
<h6 id="cleopatra.array_glyph.ArrayGlyph.plot--plot-appearance"><a class="toclink" href="#cleopatra.array_glyph.ArrayGlyph.plot--plot-appearance">Plot appearance:</a><a class="headerlink" href="#cleopatra.array_glyph.ArrayGlyph.plot--plot-appearance" title="Permanent link">#</a></h6>
<p>title : str, optional
    Title of the plot, by default 'Array Plot'.
title_size : int, optional
    Title font size, by default 15.
cmap : str, optional
    Colormap name, by default 'coolwarm_r'.
vmin : float, optional
    Minimum value for color scaling, by default min(array).
vmax : float, optional
    Maximum value for color scaling, by default max(array).</p>
<h6 id="cleopatra.array_glyph.ArrayGlyph.plot--color-bar-options"><a class="toclink" href="#cleopatra.array_glyph.ArrayGlyph.plot--color-bar-options">Color bar options:</a><a class="headerlink" href="#cleopatra.array_glyph.ArrayGlyph.plot--color-bar-options" title="Permanent link">#</a></h6>
<p>cbar_orientation : str, optional
    Orientation of the color bar, by default 'vertical'.
    Can be 'horizontal' or 'vertical'.
cbar_label_rotation : float, optional
    Rotation angle of the color bar label, by default -90.
cbar_label_location : str, optional
    Location of the color bar label, by default 'bottom'.
    Options: 'top', 'bottom', 'center', 'baseline', 'center_baseline'.
cbar_length : float, optional
    Ratio to control the height/width of the color bar, by default 0.75.
ticks_spacing : int, optional
    Spacing between ticks on the color bar, by default 2.
cbar_label_size : int, optional
    Font size of the color bar label, by default 12.
cbar_label : str, optional
    Label text for the color bar, by default 'Value'.</p>
<h6 id="cleopatra.array_glyph.ArrayGlyph.plot--color-scale-options"><a class="toclink" href="#cleopatra.array_glyph.ArrayGlyph.plot--color-scale-options">Color scale options:</a><a class="headerlink" href="#cleopatra.array_glyph.ArrayGlyph.plot--color-scale-options" title="Permanent link">#</a></h6>
<p>color_scale : str, optional
    Type of color scaling to use, by default 'linear'.
    Options:
    - 'linear': Linear scale
    - 'power': Power-law normalization
    - 'sym-lognorm': Symmetrical logarithmic scale
    - 'boundary-norm': Discrete intervals based on boundaries
    - 'midpoint': Scale split at a specified midpoint
gamma : float, optional
    Exponent for 'power' color scale, by default 0.5.
    Values &lt; 1 emphasize lower values, values &gt; 1 emphasize higher values.
line_threshold : float, optional
    Threshold for 'sym-lognorm' color scale, by default 0.0001.
line_scale : float, optional
    Scale factor for 'sym-lognorm' color scale, by default 0.001.
bounds : List, optional
    Boundaries for 'boundary-norm' color scale, by default None.
    Defines the discrete intervals for color mapping.
midpoint : float, optional
    Midpoint value for 'midpoint' color scale, by default 0.</p>
<h6 id="cleopatra.array_glyph.ArrayGlyph.plot--cell-value-display-options"><a class="toclink" href="#cleopatra.array_glyph.ArrayGlyph.plot--cell-value-display-options">Cell value display options:</a><a class="headerlink" href="#cleopatra.array_glyph.ArrayGlyph.plot--cell-value-display-options" title="Permanent link">#</a></h6>
<p>display_cell_value : bool, optional
    Whether to display the values of cells as text, by default False.
num_size : int, optional
    Font size of the cell value text, by default 8.
background_color_threshold : float, optional
    Threshold for cell value text color, by default None.
    If cell value &gt; threshold, text is black; otherwise, text is white.
    If None, uses max(array)/2 as the threshold.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="matplotlib.figure.Figure">Figure</span>, <span title="matplotlib.axes.Axes">Axes</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple containing:
- fig: The matplotlib Figure object
- ax: The matplotlib Axes object</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If an invalid keyword argument is provided.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <ul>
<li>
<p>Basic array plot:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">cleopatra.array_glyph</span><span class="w"> </span><span class="kn">import</span> <span class="n">ArrayGlyph</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]])</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">array</span> <span class="o">=</span> <span class="n">ArrayGlyph</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Customized Plot&quot;</span><span class="p">,</span> <span class="n">title_size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</code></pre></div>
<img alt="array-plot" src="../../_images/array_glyph/array-plot.png" /></p>
</li>
<li>
<p>Color bar customization:</p>
<ul>
<li>Create an array and instantiate the <code>Array</code> object with custom options.
    <div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">array</span> <span class="o">=</span> <span class="n">ArrayGlyph</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Customized color bar&quot;</span><span class="p">,</span> <span class="n">title_size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="o">...</span>     <span class="n">cbar_orientation</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">,</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="o">...</span>     <span class="n">cbar_label_rotation</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="o">...</span>     <span class="n">cbar_label_location</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="o">...</span>     <span class="n">cbar_length</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="o">...</span>     <span class="n">cbar_label_size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="o">...</span>     <span class="n">cbar_label</span><span class="o">=</span><span class="s2">&quot;Discharge m3/s&quot;</span><span class="p">,</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="o">...</span>     <span class="n">ticks_spacing</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="o">...</span>     <span class="n">color_scale</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="o">...</span>     <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;coolwarm_r&quot;</span><span class="p">,</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="o">...</span> <span class="p">)</span>
</code></pre></div>
    <img alt="color-bar-customization" src="../../_images/array_glyph/color-bar-customization.png" /></li>
</ul>
</li>
<li>
<p>Display values for each cell:</p>
<ul>
<li>
<p>you can display the values for each cell by using thr parameter <code>display_cell_value</code>, and customize how
    the values are displayed using the parameter <code>background_color_threshold</code> and <code>num_size</code>.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">array</span> <span class="o">=</span> <span class="n">ArrayGlyph</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Display array values&quot;</span><span class="p">,</span> <span class="n">title_size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="o">...</span>     <span class="n">display_cell_value</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="o">...</span>     <span class="n">num_size</span><span class="o">=</span><span class="mi">12</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="o">...</span> <span class="p">)</span>
</code></pre></div>
<img alt="display-cell-values" src="../../_images/array_glyph/display-cell-values.png" /></p>
</li>
</ul>
</li>
<li>
<p>Plot points at specific locations in the array:</p>
<ul>
<li>you can display points in specific cells in the array and also display a value for each of these points.
    The point parameter takes an array with the first column as the values to be displayed on top of the
    points, the second and third columns are the row and column index of the point in the array.</li>
<li>
<p>The <code>point_color</code> and <code>point_size</code> parameters are used to customize the appearance of the points,
    while the <code>pid_color</code> and <code>pid_size</code> parameters are used to customize the appearance of the point
    IDs/text.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">array</span> <span class="o">=</span> <span class="n">ArrayGlyph</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Display Points&quot;</span><span class="p">,</span> <span class="n">title_size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="o">...</span>     <span class="n">points</span><span class="o">=</span><span class="n">points</span><span class="p">,</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="o">...</span>     <span class="n">point_color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="o">...</span>     <span class="n">point_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="o">...</span>     <span class="n">pid_color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="o">...</span>     <span class="n">pid_size</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="o">...</span> <span class="p">)</span>
</code></pre></div>
<img alt="display-points" src="../../_images/array_glyph/display-points.png" /></p>
</li>
</ul>
</li>
<li>
<p>Color scale customization:</p>
<ul>
<li>
<p>Power scale (with different gamma values).</p>
<ul>
<li>
<p>The default power scale uses a gamma value of 0.5.</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">array</span> <span class="o">=</span> <span class="n">ArrayGlyph</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Power scale&quot;</span><span class="p">,</span> <span class="n">title_size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="o">...</span>     <span class="n">cbar_label</span><span class="o">=</span><span class="s2">&quot;Discharge m3/s&quot;</span><span class="p">,</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="o">...</span>     <span class="n">color_scale</span><span class="o">=</span><span class="s2">&quot;power&quot;</span><span class="p">,</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="o">...</span>     <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;coolwarm_r&quot;</span><span class="p">,</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="o">...</span>     <span class="n">cbar_label_rotation</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="o">...</span> <span class="p">)</span>
</code></pre></div>
<img alt="power-scale" src="../../_images/array_glyph/power-scale.png" /></p>
</li>
<li>
<p>change the gamma of 0.8 (emphasizes higher values less).</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="o">...</span>     <span class="n">color_scale</span><span class="o">=</span><span class="s2">&quot;power&quot;</span><span class="p">,</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="o">...</span>     <span class="n">gamma</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="o">...</span>     <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;coolwarm_r&quot;</span><span class="p">,</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="o">...</span>     <span class="n">cbar_label_rotation</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="o">...</span>     <span class="n">cbar_label</span><span class="o">=</span><span class="s2">&quot;Discharge m3/s&quot;</span><span class="p">,</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="o">...</span> <span class="p">)</span>
</code></pre></div>
<img alt="power-scale-gamma-0.8" src="../../_images/array_glyph/power-scale-gamma-0.8.png" /></p>
</li>
<li>
<p>change the gamma of 0.1 (emphasizes higher values more).</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="o">...</span>     <span class="n">color_scale</span><span class="o">=</span><span class="s2">&quot;power&quot;</span><span class="p">,</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="o">...</span>     <span class="n">gamma</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="o">...</span>     <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;coolwarm_r&quot;</span><span class="p">,</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="o">...</span>     <span class="n">cbar_label_rotation</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="o">...</span>     <span class="n">cbar_label</span><span class="o">=</span><span class="s2">&quot;Discharge m3/s&quot;</span><span class="p">,</span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="o">...</span> <span class="p">)</span>
</code></pre></div>
<img alt="power-scale-gamma-0.1" src="../../_images/array_glyph/power-scale-gamma-0.1.png" /></p>
</li>
</ul>
</li>
<li>
<p>Logarithmic scale.</p>
<ul>
<li>
<p>the logarithmic scale uses to parameters <code>line_threshold</code> and <code>line_scale</code> with a default
value if 0.0001, and 0.001 respectively.
    <div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="o">...</span>     <span class="n">cbar_label</span><span class="o">=</span><span class="s2">&quot;Discharge m3/s&quot;</span><span class="p">,</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="o">...</span>     <span class="n">color_scale</span><span class="o">=</span><span class="s2">&quot;sym-lognorm&quot;</span><span class="p">,</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="o">...</span>     <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;coolwarm_r&quot;</span><span class="p">,</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="o">...</span>     <span class="n">cbar_label_rotation</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="o">...</span> <span class="p">)</span>
</code></pre></div>
    <img alt="log-scale" src="../../_images/array_glyph/log-scale.png" /></p>
</li>
<li>
<p>you can change the <code>line_threshold</code> and <code>line_scale</code> values.
    <div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">array</span> <span class="o">=</span> <span class="n">ArrayGlyph</span><span class="p">(</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="o">...</span>     <span class="n">arr</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Logarithmic scale: Customized Parameter&quot;</span><span class="p">,</span> <span class="n">title_size</span><span class="o">=</span><span class="mi">12</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="o">...</span> <span class="p">)</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="o">...</span>     <span class="n">cbar_label_rotation</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="o">...</span>     <span class="n">cbar_label</span><span class="o">=</span><span class="s2">&quot;Discharge m3/s&quot;</span><span class="p">,</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="o">...</span>     <span class="n">color_scale</span><span class="o">=</span><span class="s2">&quot;sym-lognorm&quot;</span><span class="p">,</span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="o">...</span>     <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;coolwarm_r&quot;</span><span class="p">,</span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="o">...</span>     <span class="n">line_threshold</span><span class="o">=</span><span class="mf">0.015</span><span class="p">,</span>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="o">...</span>     <span class="n">line_scale</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="o">...</span> <span class="p">)</span>
</code></pre></div>
    <img alt="log-scale" src="../../_images/array_glyph/log-scale-custom-parameters.png" /></p>
</li>
</ul>
</li>
<li>
<p>Defined boundary scale.
    <div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">array</span> <span class="o">=</span> <span class="n">ArrayGlyph</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Defined boundary scale&quot;</span><span class="p">,</span> <span class="n">title_size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="o">...</span>     <span class="n">cbar_label_rotation</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="o">...</span>     <span class="n">cbar_label</span><span class="o">=</span><span class="s2">&quot;Discharge m3/s&quot;</span><span class="p">,</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="o">...</span>     <span class="n">color_scale</span><span class="o">=</span><span class="s2">&quot;boundary-norm&quot;</span><span class="p">,</span>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="o">...</span>     <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;coolwarm_r&quot;</span><span class="p">,</span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="o">...</span> <span class="p">)</span>
</code></pre></div>
    <img alt="boundary-scale" src="../../_images/array_glyph/boundary-scale.png" /></p>
<ul>
<li>You can also define the boundaries.
    <div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">array</span> <span class="o">=</span> <span class="n">ArrayGlyph</span><span class="p">(</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="o">...</span>     <span class="n">arr</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Defined boundary scale: defined bounds&quot;</span><span class="p">,</span> <span class="n">title_size</span><span class="o">=</span><span class="mi">18</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="o">...</span> <span class="p">)</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">bounds</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="o">...</span>     <span class="n">cbar_label_rotation</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="o">...</span>     <span class="n">cbar_label</span><span class="o">=</span><span class="s2">&quot;Discharge m3/s&quot;</span><span class="p">,</span>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="o">...</span>     <span class="n">color_scale</span><span class="o">=</span><span class="s2">&quot;boundary-norm&quot;</span><span class="p">,</span>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="o">...</span>     <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="o">...</span>     <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;coolwarm_r&quot;</span><span class="p">,</span>
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="o">...</span> <span class="p">)</span>
</code></pre></div>
    <img alt="boundary-scale-defined-bounds" src="../../_images/array_glyph/boundary-scale-defined-bounds.png" /></li>
</ul>
</li>
<li>
<p>Midpoint scale.</p>
<p>in the midpoint scale you can define a value that splits the scale into half.
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">array</span> <span class="o">=</span> <span class="n">ArrayGlyph</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Midpoint scale&quot;</span><span class="p">,</span> <span class="n">title_size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="o">...</span>     <span class="n">cbar_label_rotation</span><span class="o">=-</span><span class="mi">90</span><span class="p">,</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="o">...</span>     <span class="n">cbar_label</span><span class="o">=</span><span class="s2">&quot;Discharge m3/s&quot;</span><span class="p">,</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="o">...</span>     <span class="n">color_scale</span><span class="o">=</span><span class="s2">&quot;midpoint&quot;</span><span class="p">,</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="o">...</span>     <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;coolwarm_r&quot;</span><span class="p">,</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="o">...</span>     <span class="n">midpoint</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="o">...</span> <span class="p">)</span>
</code></pre></div>
<img alt="midpoint-scale-costom-parameters" src="../../_images/array_glyph/midpoint-scale-costom-parameters.png" /></p>
</li>
</ul>
</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>cleopatra/array_glyph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-965"> 965</a></span>
<span class="normal"><a href="#__codelineno-0-966"> 966</a></span>
<span class="normal"><a href="#__codelineno-0-967"> 967</a></span>
<span class="normal"><a href="#__codelineno-0-968"> 968</a></span>
<span class="normal"><a href="#__codelineno-0-969"> 969</a></span>
<span class="normal"><a href="#__codelineno-0-970"> 970</a></span>
<span class="normal"><a href="#__codelineno-0-971"> 971</a></span>
<span class="normal"><a href="#__codelineno-0-972"> 972</a></span>
<span class="normal"><a href="#__codelineno-0-973"> 973</a></span>
<span class="normal"><a href="#__codelineno-0-974"> 974</a></span>
<span class="normal"><a href="#__codelineno-0-975"> 975</a></span>
<span class="normal"><a href="#__codelineno-0-976"> 976</a></span>
<span class="normal"><a href="#__codelineno-0-977"> 977</a></span>
<span class="normal"><a href="#__codelineno-0-978"> 978</a></span>
<span class="normal"><a href="#__codelineno-0-979"> 979</a></span>
<span class="normal"><a href="#__codelineno-0-980"> 980</a></span>
<span class="normal"><a href="#__codelineno-0-981"> 981</a></span>
<span class="normal"><a href="#__codelineno-0-982"> 982</a></span>
<span class="normal"><a href="#__codelineno-0-983"> 983</a></span>
<span class="normal"><a href="#__codelineno-0-984"> 984</a></span>
<span class="normal"><a href="#__codelineno-0-985"> 985</a></span>
<span class="normal"><a href="#__codelineno-0-986"> 986</a></span>
<span class="normal"><a href="#__codelineno-0-987"> 987</a></span>
<span class="normal"><a href="#__codelineno-0-988"> 988</a></span>
<span class="normal"><a href="#__codelineno-0-989"> 989</a></span>
<span class="normal"><a href="#__codelineno-0-990"> 990</a></span>
<span class="normal"><a href="#__codelineno-0-991"> 991</a></span>
<span class="normal"><a href="#__codelineno-0-992"> 992</a></span>
<span class="normal"><a href="#__codelineno-0-993"> 993</a></span>
<span class="normal"><a href="#__codelineno-0-994"> 994</a></span>
<span class="normal"><a href="#__codelineno-0-995"> 995</a></span>
<span class="normal"><a href="#__codelineno-0-996"> 996</a></span>
<span class="normal"><a href="#__codelineno-0-997"> 997</a></span>
<span class="normal"><a href="#__codelineno-0-998"> 998</a></span>
<span class="normal"><a href="#__codelineno-0-999"> 999</a></span>
<span class="normal"><a href="#__codelineno-0-1000">1000</a></span>
<span class="normal"><a href="#__codelineno-0-1001">1001</a></span>
<span class="normal"><a href="#__codelineno-0-1002">1002</a></span>
<span class="normal"><a href="#__codelineno-0-1003">1003</a></span>
<span class="normal"><a href="#__codelineno-0-1004">1004</a></span>
<span class="normal"><a href="#__codelineno-0-1005">1005</a></span>
<span class="normal"><a href="#__codelineno-0-1006">1006</a></span>
<span class="normal"><a href="#__codelineno-0-1007">1007</a></span>
<span class="normal"><a href="#__codelineno-0-1008">1008</a></span>
<span class="normal"><a href="#__codelineno-0-1009">1009</a></span>
<span class="normal"><a href="#__codelineno-0-1010">1010</a></span>
<span class="normal"><a href="#__codelineno-0-1011">1011</a></span>
<span class="normal"><a href="#__codelineno-0-1012">1012</a></span>
<span class="normal"><a href="#__codelineno-0-1013">1013</a></span>
<span class="normal"><a href="#__codelineno-0-1014">1014</a></span>
<span class="normal"><a href="#__codelineno-0-1015">1015</a></span>
<span class="normal"><a href="#__codelineno-0-1016">1016</a></span>
<span class="normal"><a href="#__codelineno-0-1017">1017</a></span>
<span class="normal"><a href="#__codelineno-0-1018">1018</a></span>
<span class="normal"><a href="#__codelineno-0-1019">1019</a></span>
<span class="normal"><a href="#__codelineno-0-1020">1020</a></span>
<span class="normal"><a href="#__codelineno-0-1021">1021</a></span>
<span class="normal"><a href="#__codelineno-0-1022">1022</a></span>
<span class="normal"><a href="#__codelineno-0-1023">1023</a></span>
<span class="normal"><a href="#__codelineno-0-1024">1024</a></span>
<span class="normal"><a href="#__codelineno-0-1025">1025</a></span>
<span class="normal"><a href="#__codelineno-0-1026">1026</a></span>
<span class="normal"><a href="#__codelineno-0-1027">1027</a></span>
<span class="normal"><a href="#__codelineno-0-1028">1028</a></span>
<span class="normal"><a href="#__codelineno-0-1029">1029</a></span>
<span class="normal"><a href="#__codelineno-0-1030">1030</a></span>
<span class="normal"><a href="#__codelineno-0-1031">1031</a></span>
<span class="normal"><a href="#__codelineno-0-1032">1032</a></span>
<span class="normal"><a href="#__codelineno-0-1033">1033</a></span>
<span class="normal"><a href="#__codelineno-0-1034">1034</a></span>
<span class="normal"><a href="#__codelineno-0-1035">1035</a></span>
<span class="normal"><a href="#__codelineno-0-1036">1036</a></span>
<span class="normal"><a href="#__codelineno-0-1037">1037</a></span>
<span class="normal"><a href="#__codelineno-0-1038">1038</a></span>
<span class="normal"><a href="#__codelineno-0-1039">1039</a></span>
<span class="normal"><a href="#__codelineno-0-1040">1040</a></span>
<span class="normal"><a href="#__codelineno-0-1041">1041</a></span>
<span class="normal"><a href="#__codelineno-0-1042">1042</a></span>
<span class="normal"><a href="#__codelineno-0-1043">1043</a></span>
<span class="normal"><a href="#__codelineno-0-1044">1044</a></span>
<span class="normal"><a href="#__codelineno-0-1045">1045</a></span>
<span class="normal"><a href="#__codelineno-0-1046">1046</a></span>
<span class="normal"><a href="#__codelineno-0-1047">1047</a></span>
<span class="normal"><a href="#__codelineno-0-1048">1048</a></span>
<span class="normal"><a href="#__codelineno-0-1049">1049</a></span>
<span class="normal"><a href="#__codelineno-0-1050">1050</a></span>
<span class="normal"><a href="#__codelineno-0-1051">1051</a></span>
<span class="normal"><a href="#__codelineno-0-1052">1052</a></span>
<span class="normal"><a href="#__codelineno-0-1053">1053</a></span>
<span class="normal"><a href="#__codelineno-0-1054">1054</a></span>
<span class="normal"><a href="#__codelineno-0-1055">1055</a></span>
<span class="normal"><a href="#__codelineno-0-1056">1056</a></span>
<span class="normal"><a href="#__codelineno-0-1057">1057</a></span>
<span class="normal"><a href="#__codelineno-0-1058">1058</a></span>
<span class="normal"><a href="#__codelineno-0-1059">1059</a></span>
<span class="normal"><a href="#__codelineno-0-1060">1060</a></span>
<span class="normal"><a href="#__codelineno-0-1061">1061</a></span>
<span class="normal"><a href="#__codelineno-0-1062">1062</a></span>
<span class="normal"><a href="#__codelineno-0-1063">1063</a></span>
<span class="normal"><a href="#__codelineno-0-1064">1064</a></span>
<span class="normal"><a href="#__codelineno-0-1065">1065</a></span>
<span class="normal"><a href="#__codelineno-0-1066">1066</a></span>
<span class="normal"><a href="#__codelineno-0-1067">1067</a></span>
<span class="normal"><a href="#__codelineno-0-1068">1068</a></span>
<span class="normal"><a href="#__codelineno-0-1069">1069</a></span>
<span class="normal"><a href="#__codelineno-0-1070">1070</a></span>
<span class="normal"><a href="#__codelineno-0-1071">1071</a></span>
<span class="normal"><a href="#__codelineno-0-1072">1072</a></span>
<span class="normal"><a href="#__codelineno-0-1073">1073</a></span>
<span class="normal"><a href="#__codelineno-0-1074">1074</a></span>
<span class="normal"><a href="#__codelineno-0-1075">1075</a></span>
<span class="normal"><a href="#__codelineno-0-1076">1076</a></span>
<span class="normal"><a href="#__codelineno-0-1077">1077</a></span>
<span class="normal"><a href="#__codelineno-0-1078">1078</a></span>
<span class="normal"><a href="#__codelineno-0-1079">1079</a></span>
<span class="normal"><a href="#__codelineno-0-1080">1080</a></span>
<span class="normal"><a href="#__codelineno-0-1081">1081</a></span>
<span class="normal"><a href="#__codelineno-0-1082">1082</a></span>
<span class="normal"><a href="#__codelineno-0-1083">1083</a></span>
<span class="normal"><a href="#__codelineno-0-1084">1084</a></span>
<span class="normal"><a href="#__codelineno-0-1085">1085</a></span>
<span class="normal"><a href="#__codelineno-0-1086">1086</a></span>
<span class="normal"><a href="#__codelineno-0-1087">1087</a></span>
<span class="normal"><a href="#__codelineno-0-1088">1088</a></span>
<span class="normal"><a href="#__codelineno-0-1089">1089</a></span>
<span class="normal"><a href="#__codelineno-0-1090">1090</a></span>
<span class="normal"><a href="#__codelineno-0-1091">1091</a></span>
<span class="normal"><a href="#__codelineno-0-1092">1092</a></span>
<span class="normal"><a href="#__codelineno-0-1093">1093</a></span>
<span class="normal"><a href="#__codelineno-0-1094">1094</a></span>
<span class="normal"><a href="#__codelineno-0-1095">1095</a></span>
<span class="normal"><a href="#__codelineno-0-1096">1096</a></span>
<span class="normal"><a href="#__codelineno-0-1097">1097</a></span>
<span class="normal"><a href="#__codelineno-0-1098">1098</a></span>
<span class="normal"><a href="#__codelineno-0-1099">1099</a></span>
<span class="normal"><a href="#__codelineno-0-1100">1100</a></span>
<span class="normal"><a href="#__codelineno-0-1101">1101</a></span>
<span class="normal"><a href="#__codelineno-0-1102">1102</a></span>
<span class="normal"><a href="#__codelineno-0-1103">1103</a></span>
<span class="normal"><a href="#__codelineno-0-1104">1104</a></span>
<span class="normal"><a href="#__codelineno-0-1105">1105</a></span>
<span class="normal"><a href="#__codelineno-0-1106">1106</a></span>
<span class="normal"><a href="#__codelineno-0-1107">1107</a></span>
<span class="normal"><a href="#__codelineno-0-1108">1108</a></span>
<span class="normal"><a href="#__codelineno-0-1109">1109</a></span>
<span class="normal"><a href="#__codelineno-0-1110">1110</a></span>
<span class="normal"><a href="#__codelineno-0-1111">1111</a></span>
<span class="normal"><a href="#__codelineno-0-1112">1112</a></span>
<span class="normal"><a href="#__codelineno-0-1113">1113</a></span>
<span class="normal"><a href="#__codelineno-0-1114">1114</a></span>
<span class="normal"><a href="#__codelineno-0-1115">1115</a></span>
<span class="normal"><a href="#__codelineno-0-1116">1116</a></span>
<span class="normal"><a href="#__codelineno-0-1117">1117</a></span>
<span class="normal"><a href="#__codelineno-0-1118">1118</a></span>
<span class="normal"><a href="#__codelineno-0-1119">1119</a></span>
<span class="normal"><a href="#__codelineno-0-1120">1120</a></span>
<span class="normal"><a href="#__codelineno-0-1121">1121</a></span>
<span class="normal"><a href="#__codelineno-0-1122">1122</a></span>
<span class="normal"><a href="#__codelineno-0-1123">1123</a></span>
<span class="normal"><a href="#__codelineno-0-1124">1124</a></span>
<span class="normal"><a href="#__codelineno-0-1125">1125</a></span>
<span class="normal"><a href="#__codelineno-0-1126">1126</a></span>
<span class="normal"><a href="#__codelineno-0-1127">1127</a></span>
<span class="normal"><a href="#__codelineno-0-1128">1128</a></span>
<span class="normal"><a href="#__codelineno-0-1129">1129</a></span>
<span class="normal"><a href="#__codelineno-0-1130">1130</a></span>
<span class="normal"><a href="#__codelineno-0-1131">1131</a></span>
<span class="normal"><a href="#__codelineno-0-1132">1132</a></span>
<span class="normal"><a href="#__codelineno-0-1133">1133</a></span>
<span class="normal"><a href="#__codelineno-0-1134">1134</a></span>
<span class="normal"><a href="#__codelineno-0-1135">1135</a></span>
<span class="normal"><a href="#__codelineno-0-1136">1136</a></span>
<span class="normal"><a href="#__codelineno-0-1137">1137</a></span>
<span class="normal"><a href="#__codelineno-0-1138">1138</a></span>
<span class="normal"><a href="#__codelineno-0-1139">1139</a></span>
<span class="normal"><a href="#__codelineno-0-1140">1140</a></span>
<span class="normal"><a href="#__codelineno-0-1141">1141</a></span>
<span class="normal"><a href="#__codelineno-0-1142">1142</a></span>
<span class="normal"><a href="#__codelineno-0-1143">1143</a></span>
<span class="normal"><a href="#__codelineno-0-1144">1144</a></span>
<span class="normal"><a href="#__codelineno-0-1145">1145</a></span>
<span class="normal"><a href="#__codelineno-0-1146">1146</a></span>
<span class="normal"><a href="#__codelineno-0-1147">1147</a></span>
<span class="normal"><a href="#__codelineno-0-1148">1148</a></span>
<span class="normal"><a href="#__codelineno-0-1149">1149</a></span>
<span class="normal"><a href="#__codelineno-0-1150">1150</a></span>
<span class="normal"><a href="#__codelineno-0-1151">1151</a></span>
<span class="normal"><a href="#__codelineno-0-1152">1152</a></span>
<span class="normal"><a href="#__codelineno-0-1153">1153</a></span>
<span class="normal"><a href="#__codelineno-0-1154">1154</a></span>
<span class="normal"><a href="#__codelineno-0-1155">1155</a></span>
<span class="normal"><a href="#__codelineno-0-1156">1156</a></span>
<span class="normal"><a href="#__codelineno-0-1157">1157</a></span>
<span class="normal"><a href="#__codelineno-0-1158">1158</a></span>
<span class="normal"><a href="#__codelineno-0-1159">1159</a></span>
<span class="normal"><a href="#__codelineno-0-1160">1160</a></span>
<span class="normal"><a href="#__codelineno-0-1161">1161</a></span>
<span class="normal"><a href="#__codelineno-0-1162">1162</a></span>
<span class="normal"><a href="#__codelineno-0-1163">1163</a></span>
<span class="normal"><a href="#__codelineno-0-1164">1164</a></span>
<span class="normal"><a href="#__codelineno-0-1165">1165</a></span>
<span class="normal"><a href="#__codelineno-0-1166">1166</a></span>
<span class="normal"><a href="#__codelineno-0-1167">1167</a></span>
<span class="normal"><a href="#__codelineno-0-1168">1168</a></span>
<span class="normal"><a href="#__codelineno-0-1169">1169</a></span>
<span class="normal"><a href="#__codelineno-0-1170">1170</a></span>
<span class="normal"><a href="#__codelineno-0-1171">1171</a></span>
<span class="normal"><a href="#__codelineno-0-1172">1172</a></span>
<span class="normal"><a href="#__codelineno-0-1173">1173</a></span>
<span class="normal"><a href="#__codelineno-0-1174">1174</a></span>
<span class="normal"><a href="#__codelineno-0-1175">1175</a></span>
<span class="normal"><a href="#__codelineno-0-1176">1176</a></span>
<span class="normal"><a href="#__codelineno-0-1177">1177</a></span>
<span class="normal"><a href="#__codelineno-0-1178">1178</a></span>
<span class="normal"><a href="#__codelineno-0-1179">1179</a></span>
<span class="normal"><a href="#__codelineno-0-1180">1180</a></span>
<span class="normal"><a href="#__codelineno-0-1181">1181</a></span>
<span class="normal"><a href="#__codelineno-0-1182">1182</a></span>
<span class="normal"><a href="#__codelineno-0-1183">1183</a></span>
<span class="normal"><a href="#__codelineno-0-1184">1184</a></span>
<span class="normal"><a href="#__codelineno-0-1185">1185</a></span>
<span class="normal"><a href="#__codelineno-0-1186">1186</a></span>
<span class="normal"><a href="#__codelineno-0-1187">1187</a></span>
<span class="normal"><a href="#__codelineno-0-1188">1188</a></span>
<span class="normal"><a href="#__codelineno-0-1189">1189</a></span>
<span class="normal"><a href="#__codelineno-0-1190">1190</a></span>
<span class="normal"><a href="#__codelineno-0-1191">1191</a></span>
<span class="normal"><a href="#__codelineno-0-1192">1192</a></span>
<span class="normal"><a href="#__codelineno-0-1193">1193</a></span>
<span class="normal"><a href="#__codelineno-0-1194">1194</a></span>
<span class="normal"><a href="#__codelineno-0-1195">1195</a></span>
<span class="normal"><a href="#__codelineno-0-1196">1196</a></span>
<span class="normal"><a href="#__codelineno-0-1197">1197</a></span>
<span class="normal"><a href="#__codelineno-0-1198">1198</a></span>
<span class="normal"><a href="#__codelineno-0-1199">1199</a></span>
<span class="normal"><a href="#__codelineno-0-1200">1200</a></span>
<span class="normal"><a href="#__codelineno-0-1201">1201</a></span>
<span class="normal"><a href="#__codelineno-0-1202">1202</a></span>
<span class="normal"><a href="#__codelineno-0-1203">1203</a></span>
<span class="normal"><a href="#__codelineno-0-1204">1204</a></span>
<span class="normal"><a href="#__codelineno-0-1205">1205</a></span>
<span class="normal"><a href="#__codelineno-0-1206">1206</a></span>
<span class="normal"><a href="#__codelineno-0-1207">1207</a></span>
<span class="normal"><a href="#__codelineno-0-1208">1208</a></span>
<span class="normal"><a href="#__codelineno-0-1209">1209</a></span>
<span class="normal"><a href="#__codelineno-0-1210">1210</a></span>
<span class="normal"><a href="#__codelineno-0-1211">1211</a></span>
<span class="normal"><a href="#__codelineno-0-1212">1212</a></span>
<span class="normal"><a href="#__codelineno-0-1213">1213</a></span>
<span class="normal"><a href="#__codelineno-0-1214">1214</a></span>
<span class="normal"><a href="#__codelineno-0-1215">1215</a></span>
<span class="normal"><a href="#__codelineno-0-1216">1216</a></span>
<span class="normal"><a href="#__codelineno-0-1217">1217</a></span>
<span class="normal"><a href="#__codelineno-0-1218">1218</a></span>
<span class="normal"><a href="#__codelineno-0-1219">1219</a></span>
<span class="normal"><a href="#__codelineno-0-1220">1220</a></span>
<span class="normal"><a href="#__codelineno-0-1221">1221</a></span>
<span class="normal"><a href="#__codelineno-0-1222">1222</a></span>
<span class="normal"><a href="#__codelineno-0-1223">1223</a></span>
<span class="normal"><a href="#__codelineno-0-1224">1224</a></span>
<span class="normal"><a href="#__codelineno-0-1225">1225</a></span>
<span class="normal"><a href="#__codelineno-0-1226">1226</a></span>
<span class="normal"><a href="#__codelineno-0-1227">1227</a></span>
<span class="normal"><a href="#__codelineno-0-1228">1228</a></span>
<span class="normal"><a href="#__codelineno-0-1229">1229</a></span>
<span class="normal"><a href="#__codelineno-0-1230">1230</a></span>
<span class="normal"><a href="#__codelineno-0-1231">1231</a></span>
<span class="normal"><a href="#__codelineno-0-1232">1232</a></span>
<span class="normal"><a href="#__codelineno-0-1233">1233</a></span>
<span class="normal"><a href="#__codelineno-0-1234">1234</a></span>
<span class="normal"><a href="#__codelineno-0-1235">1235</a></span>
<span class="normal"><a href="#__codelineno-0-1236">1236</a></span>
<span class="normal"><a href="#__codelineno-0-1237">1237</a></span>
<span class="normal"><a href="#__codelineno-0-1238">1238</a></span>
<span class="normal"><a href="#__codelineno-0-1239">1239</a></span>
<span class="normal"><a href="#__codelineno-0-1240">1240</a></span>
<span class="normal"><a href="#__codelineno-0-1241">1241</a></span>
<span class="normal"><a href="#__codelineno-0-1242">1242</a></span>
<span class="normal"><a href="#__codelineno-0-1243">1243</a></span>
<span class="normal"><a href="#__codelineno-0-1244">1244</a></span>
<span class="normal"><a href="#__codelineno-0-1245">1245</a></span>
<span class="normal"><a href="#__codelineno-0-1246">1246</a></span>
<span class="normal"><a href="#__codelineno-0-1247">1247</a></span>
<span class="normal"><a href="#__codelineno-0-1248">1248</a></span>
<span class="normal"><a href="#__codelineno-0-1249">1249</a></span>
<span class="normal"><a href="#__codelineno-0-1250">1250</a></span>
<span class="normal"><a href="#__codelineno-0-1251">1251</a></span>
<span class="normal"><a href="#__codelineno-0-1252">1252</a></span>
<span class="normal"><a href="#__codelineno-0-1253">1253</a></span>
<span class="normal"><a href="#__codelineno-0-1254">1254</a></span>
<span class="normal"><a href="#__codelineno-0-1255">1255</a></span>
<span class="normal"><a href="#__codelineno-0-1256">1256</a></span>
<span class="normal"><a href="#__codelineno-0-1257">1257</a></span>
<span class="normal"><a href="#__codelineno-0-1258">1258</a></span>
<span class="normal"><a href="#__codelineno-0-1259">1259</a></span>
<span class="normal"><a href="#__codelineno-0-1260">1260</a></span>
<span class="normal"><a href="#__codelineno-0-1261">1261</a></span>
<span class="normal"><a href="#__codelineno-0-1262">1262</a></span>
<span class="normal"><a href="#__codelineno-0-1263">1263</a></span>
<span class="normal"><a href="#__codelineno-0-1264">1264</a></span>
<span class="normal"><a href="#__codelineno-0-1265">1265</a></span>
<span class="normal"><a href="#__codelineno-0-1266">1266</a></span>
<span class="normal"><a href="#__codelineno-0-1267">1267</a></span>
<span class="normal"><a href="#__codelineno-0-1268">1268</a></span>
<span class="normal"><a href="#__codelineno-0-1269">1269</a></span>
<span class="normal"><a href="#__codelineno-0-1270">1270</a></span>
<span class="normal"><a href="#__codelineno-0-1271">1271</a></span>
<span class="normal"><a href="#__codelineno-0-1272">1272</a></span>
<span class="normal"><a href="#__codelineno-0-1273">1273</a></span>
<span class="normal"><a href="#__codelineno-0-1274">1274</a></span>
<span class="normal"><a href="#__codelineno-0-1275">1275</a></span>
<span class="normal"><a href="#__codelineno-0-1276">1276</a></span>
<span class="normal"><a href="#__codelineno-0-1277">1277</a></span>
<span class="normal"><a href="#__codelineno-0-1278">1278</a></span>
<span class="normal"><a href="#__codelineno-0-1279">1279</a></span>
<span class="normal"><a href="#__codelineno-0-1280">1280</a></span>
<span class="normal"><a href="#__codelineno-0-1281">1281</a></span>
<span class="normal"><a href="#__codelineno-0-1282">1282</a></span>
<span class="normal"><a href="#__codelineno-0-1283">1283</a></span>
<span class="normal"><a href="#__codelineno-0-1284">1284</a></span>
<span class="normal"><a href="#__codelineno-0-1285">1285</a></span>
<span class="normal"><a href="#__codelineno-0-1286">1286</a></span>
<span class="normal"><a href="#__codelineno-0-1287">1287</a></span>
<span class="normal"><a href="#__codelineno-0-1288">1288</a></span>
<span class="normal"><a href="#__codelineno-0-1289">1289</a></span>
<span class="normal"><a href="#__codelineno-0-1290">1290</a></span>
<span class="normal"><a href="#__codelineno-0-1291">1291</a></span>
<span class="normal"><a href="#__codelineno-0-1292">1292</a></span>
<span class="normal"><a href="#__codelineno-0-1293">1293</a></span>
<span class="normal"><a href="#__codelineno-0-1294">1294</a></span>
<span class="normal"><a href="#__codelineno-0-1295">1295</a></span>
<span class="normal"><a href="#__codelineno-0-1296">1296</a></span>
<span class="normal"><a href="#__codelineno-0-1297">1297</a></span>
<span class="normal"><a href="#__codelineno-0-1298">1298</a></span>
<span class="normal"><a href="#__codelineno-0-1299">1299</a></span>
<span class="normal"><a href="#__codelineno-0-1300">1300</a></span>
<span class="normal"><a href="#__codelineno-0-1301">1301</a></span>
<span class="normal"><a href="#__codelineno-0-1302">1302</a></span>
<span class="normal"><a href="#__codelineno-0-1303">1303</a></span>
<span class="normal"><a href="#__codelineno-0-1304">1304</a></span>
<span class="normal"><a href="#__codelineno-0-1305">1305</a></span>
<span class="normal"><a href="#__codelineno-0-1306">1306</a></span>
<span class="normal"><a href="#__codelineno-0-1307">1307</a></span>
<span class="normal"><a href="#__codelineno-0-1308">1308</a></span>
<span class="normal"><a href="#__codelineno-0-1309">1309</a></span>
<span class="normal"><a href="#__codelineno-0-1310">1310</a></span>
<span class="normal"><a href="#__codelineno-0-1311">1311</a></span>
<span class="normal"><a href="#__codelineno-0-1312">1312</a></span>
<span class="normal"><a href="#__codelineno-0-1313">1313</a></span>
<span class="normal"><a href="#__codelineno-0-1314">1314</a></span>
<span class="normal"><a href="#__codelineno-0-1315">1315</a></span>
<span class="normal"><a href="#__codelineno-0-1316">1316</a></span>
<span class="normal"><a href="#__codelineno-0-1317">1317</a></span>
<span class="normal"><a href="#__codelineno-0-1318">1318</a></span>
<span class="normal"><a href="#__codelineno-0-1319">1319</a></span>
<span class="normal"><a href="#__codelineno-0-1320">1320</a></span>
<span class="normal"><a href="#__codelineno-0-1321">1321</a></span>
<span class="normal"><a href="#__codelineno-0-1322">1322</a></span>
<span class="normal"><a href="#__codelineno-0-1323">1323</a></span>
<span class="normal"><a href="#__codelineno-0-1324">1324</a></span>
<span class="normal"><a href="#__codelineno-0-1325">1325</a></span>
<span class="normal"><a href="#__codelineno-0-1326">1326</a></span>
<span class="normal"><a href="#__codelineno-0-1327">1327</a></span>
<span class="normal"><a href="#__codelineno-0-1328">1328</a></span>
<span class="normal"><a href="#__codelineno-0-1329">1329</a></span>
<span class="normal"><a href="#__codelineno-0-1330">1330</a></span>
<span class="normal"><a href="#__codelineno-0-1331">1331</a></span>
<span class="normal"><a href="#__codelineno-0-1332">1332</a></span>
<span class="normal"><a href="#__codelineno-0-1333">1333</a></span>
<span class="normal"><a href="#__codelineno-0-1334">1334</a></span>
<span class="normal"><a href="#__codelineno-0-1335">1335</a></span>
<span class="normal"><a href="#__codelineno-0-1336">1336</a></span>
<span class="normal"><a href="#__codelineno-0-1337">1337</a></span>
<span class="normal"><a href="#__codelineno-0-1338">1338</a></span>
<span class="normal"><a href="#__codelineno-0-1339">1339</a></span>
<span class="normal"><a href="#__codelineno-0-1340">1340</a></span>
<span class="normal"><a href="#__codelineno-0-1341">1341</a></span>
<span class="normal"><a href="#__codelineno-0-1342">1342</a></span>
<span class="normal"><a href="#__codelineno-0-1343">1343</a></span>
<span class="normal"><a href="#__codelineno-0-1344">1344</a></span>
<span class="normal"><a href="#__codelineno-0-1345">1345</a></span>
<span class="normal"><a href="#__codelineno-0-1346">1346</a></span>
<span class="normal"><a href="#__codelineno-0-1347">1347</a></span>
<span class="normal"><a href="#__codelineno-0-1348">1348</a></span>
<span class="normal"><a href="#__codelineno-0-1349">1349</a></span>
<span class="normal"><a href="#__codelineno-0-1350">1350</a></span>
<span class="normal"><a href="#__codelineno-0-1351">1351</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-965" name="__codelineno-0-965"></a><span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
<a id="__codelineno-0-966" name="__codelineno-0-966"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-967" name="__codelineno-0-967"></a>    <span class="n">points</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-968" name="__codelineno-0-968"></a>    <span class="n">point_color</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span>
<a id="__codelineno-0-969" name="__codelineno-0-969"></a>    <span class="n">point_size</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
<a id="__codelineno-0-970" name="__codelineno-0-970"></a>    <span class="n">pid_color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span>
<a id="__codelineno-0-971" name="__codelineno-0-971"></a>    <span class="n">pid_size</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
<a id="__codelineno-0-972" name="__codelineno-0-972"></a>    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<a id="__codelineno-0-973" name="__codelineno-0-973"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Figure</span><span class="p">,</span> <span class="n">Axes</span><span class="p">]:</span>
<a id="__codelineno-0-974" name="__codelineno-0-974"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot the array with customizable visualization options.</span>
<a id="__codelineno-0-975" name="__codelineno-0-975"></a>
<a id="__codelineno-0-976" name="__codelineno-0-976"></a><span class="sd">    This method creates a visualization of the array with various customization options</span>
<a id="__codelineno-0-977" name="__codelineno-0-977"></a><span class="sd">    including color scales, color bars, cell value display, and point annotations.</span>
<a id="__codelineno-0-978" name="__codelineno-0-978"></a><span class="sd">    It supports both regular arrays and RGB arrays.</span>
<a id="__codelineno-0-979" name="__codelineno-0-979"></a>
<a id="__codelineno-0-980" name="__codelineno-0-980"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-981" name="__codelineno-0-981"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-982" name="__codelineno-0-982"></a><span class="sd">    points : np.ndarray, optional</span>
<a id="__codelineno-0-983" name="__codelineno-0-983"></a><span class="sd">        Points to display on the array, by default None.</span>
<a id="__codelineno-0-984" name="__codelineno-0-984"></a><span class="sd">        Should be a 3-column array where:</span>
<a id="__codelineno-0-985" name="__codelineno-0-985"></a><span class="sd">        - First column: values to display for each point</span>
<a id="__codelineno-0-986" name="__codelineno-0-986"></a><span class="sd">        - Second column: row indices of the points in the array</span>
<a id="__codelineno-0-987" name="__codelineno-0-987"></a><span class="sd">        - Third column: column indices of the points in the array</span>
<a id="__codelineno-0-988" name="__codelineno-0-988"></a><span class="sd">    point_color : str, optional</span>
<a id="__codelineno-0-989" name="__codelineno-0-989"></a><span class="sd">        Color of the points, by default &quot;red&quot;.</span>
<a id="__codelineno-0-990" name="__codelineno-0-990"></a><span class="sd">        Any valid matplotlib color string.</span>
<a id="__codelineno-0-991" name="__codelineno-0-991"></a><span class="sd">    point_size : Union[int, float], optional</span>
<a id="__codelineno-0-992" name="__codelineno-0-992"></a><span class="sd">        Size of the points, by default 100.</span>
<a id="__codelineno-0-993" name="__codelineno-0-993"></a><span class="sd">        Controls the marker size.</span>
<a id="__codelineno-0-994" name="__codelineno-0-994"></a><span class="sd">    pid_color : str, optional</span>
<a id="__codelineno-0-995" name="__codelineno-0-995"></a><span class="sd">        Color of the point value annotations, by default &quot;blue&quot;.</span>
<a id="__codelineno-0-996" name="__codelineno-0-996"></a><span class="sd">        Any valid matplotlib color string.</span>
<a id="__codelineno-0-997" name="__codelineno-0-997"></a><span class="sd">    pid_size : Union[int, float], optional</span>
<a id="__codelineno-0-998" name="__codelineno-0-998"></a><span class="sd">        Size of the point value annotations, by default 10.</span>
<a id="__codelineno-0-999" name="__codelineno-0-999"></a><span class="sd">        Controls the font size of the annotations.</span>
<a id="__codelineno-0-1000" name="__codelineno-0-1000"></a><span class="sd">    **kwargs : dict</span>
<a id="__codelineno-0-1001" name="__codelineno-0-1001"></a><span class="sd">        Additional keyword arguments for customizing the plot.</span>
<a id="__codelineno-0-1002" name="__codelineno-0-1002"></a>
<a id="__codelineno-0-1003" name="__codelineno-0-1003"></a><span class="sd">        Plot appearance:</span>
<a id="__codelineno-0-1004" name="__codelineno-0-1004"></a><span class="sd">        ---------------</span>
<a id="__codelineno-0-1005" name="__codelineno-0-1005"></a><span class="sd">        title : str, optional</span>
<a id="__codelineno-0-1006" name="__codelineno-0-1006"></a><span class="sd">            Title of the plot, by default &#39;Array Plot&#39;.</span>
<a id="__codelineno-0-1007" name="__codelineno-0-1007"></a><span class="sd">        title_size : int, optional</span>
<a id="__codelineno-0-1008" name="__codelineno-0-1008"></a><span class="sd">            Title font size, by default 15.</span>
<a id="__codelineno-0-1009" name="__codelineno-0-1009"></a><span class="sd">        cmap : str, optional</span>
<a id="__codelineno-0-1010" name="__codelineno-0-1010"></a><span class="sd">            Colormap name, by default &#39;coolwarm_r&#39;.</span>
<a id="__codelineno-0-1011" name="__codelineno-0-1011"></a><span class="sd">        vmin : float, optional</span>
<a id="__codelineno-0-1012" name="__codelineno-0-1012"></a><span class="sd">            Minimum value for color scaling, by default min(array).</span>
<a id="__codelineno-0-1013" name="__codelineno-0-1013"></a><span class="sd">        vmax : float, optional</span>
<a id="__codelineno-0-1014" name="__codelineno-0-1014"></a><span class="sd">            Maximum value for color scaling, by default max(array).</span>
<a id="__codelineno-0-1015" name="__codelineno-0-1015"></a>
<a id="__codelineno-0-1016" name="__codelineno-0-1016"></a><span class="sd">        Color bar options:</span>
<a id="__codelineno-0-1017" name="__codelineno-0-1017"></a><span class="sd">        ----------------</span>
<a id="__codelineno-0-1018" name="__codelineno-0-1018"></a><span class="sd">        cbar_orientation : str, optional</span>
<a id="__codelineno-0-1019" name="__codelineno-0-1019"></a><span class="sd">            Orientation of the color bar, by default &#39;vertical&#39;.</span>
<a id="__codelineno-0-1020" name="__codelineno-0-1020"></a><span class="sd">            Can be &#39;horizontal&#39; or &#39;vertical&#39;.</span>
<a id="__codelineno-0-1021" name="__codelineno-0-1021"></a><span class="sd">        cbar_label_rotation : float, optional</span>
<a id="__codelineno-0-1022" name="__codelineno-0-1022"></a><span class="sd">            Rotation angle of the color bar label, by default -90.</span>
<a id="__codelineno-0-1023" name="__codelineno-0-1023"></a><span class="sd">        cbar_label_location : str, optional</span>
<a id="__codelineno-0-1024" name="__codelineno-0-1024"></a><span class="sd">            Location of the color bar label, by default &#39;bottom&#39;.</span>
<a id="__codelineno-0-1025" name="__codelineno-0-1025"></a><span class="sd">            Options: &#39;top&#39;, &#39;bottom&#39;, &#39;center&#39;, &#39;baseline&#39;, &#39;center_baseline&#39;.</span>
<a id="__codelineno-0-1026" name="__codelineno-0-1026"></a><span class="sd">        cbar_length : float, optional</span>
<a id="__codelineno-0-1027" name="__codelineno-0-1027"></a><span class="sd">            Ratio to control the height/width of the color bar, by default 0.75.</span>
<a id="__codelineno-0-1028" name="__codelineno-0-1028"></a><span class="sd">        ticks_spacing : int, optional</span>
<a id="__codelineno-0-1029" name="__codelineno-0-1029"></a><span class="sd">            Spacing between ticks on the color bar, by default 2.</span>
<a id="__codelineno-0-1030" name="__codelineno-0-1030"></a><span class="sd">        cbar_label_size : int, optional</span>
<a id="__codelineno-0-1031" name="__codelineno-0-1031"></a><span class="sd">            Font size of the color bar label, by default 12.</span>
<a id="__codelineno-0-1032" name="__codelineno-0-1032"></a><span class="sd">        cbar_label : str, optional</span>
<a id="__codelineno-0-1033" name="__codelineno-0-1033"></a><span class="sd">            Label text for the color bar, by default &#39;Value&#39;.</span>
<a id="__codelineno-0-1034" name="__codelineno-0-1034"></a>
<a id="__codelineno-0-1035" name="__codelineno-0-1035"></a><span class="sd">        Color scale options:</span>
<a id="__codelineno-0-1036" name="__codelineno-0-1036"></a><span class="sd">        ------------------</span>
<a id="__codelineno-0-1037" name="__codelineno-0-1037"></a><span class="sd">        color_scale : str, optional</span>
<a id="__codelineno-0-1038" name="__codelineno-0-1038"></a><span class="sd">            Type of color scaling to use, by default &#39;linear&#39;.</span>
<a id="__codelineno-0-1039" name="__codelineno-0-1039"></a><span class="sd">            Options:</span>
<a id="__codelineno-0-1040" name="__codelineno-0-1040"></a><span class="sd">            - &#39;linear&#39;: Linear scale</span>
<a id="__codelineno-0-1041" name="__codelineno-0-1041"></a><span class="sd">            - &#39;power&#39;: Power-law normalization</span>
<a id="__codelineno-0-1042" name="__codelineno-0-1042"></a><span class="sd">            - &#39;sym-lognorm&#39;: Symmetrical logarithmic scale</span>
<a id="__codelineno-0-1043" name="__codelineno-0-1043"></a><span class="sd">            - &#39;boundary-norm&#39;: Discrete intervals based on boundaries</span>
<a id="__codelineno-0-1044" name="__codelineno-0-1044"></a><span class="sd">            - &#39;midpoint&#39;: Scale split at a specified midpoint</span>
<a id="__codelineno-0-1045" name="__codelineno-0-1045"></a><span class="sd">        gamma : float, optional</span>
<a id="__codelineno-0-1046" name="__codelineno-0-1046"></a><span class="sd">            Exponent for &#39;power&#39; color scale, by default 0.5.</span>
<a id="__codelineno-0-1047" name="__codelineno-0-1047"></a><span class="sd">            Values &lt; 1 emphasize lower values, values &gt; 1 emphasize higher values.</span>
<a id="__codelineno-0-1048" name="__codelineno-0-1048"></a><span class="sd">        line_threshold : float, optional</span>
<a id="__codelineno-0-1049" name="__codelineno-0-1049"></a><span class="sd">            Threshold for &#39;sym-lognorm&#39; color scale, by default 0.0001.</span>
<a id="__codelineno-0-1050" name="__codelineno-0-1050"></a><span class="sd">        line_scale : float, optional</span>
<a id="__codelineno-0-1051" name="__codelineno-0-1051"></a><span class="sd">            Scale factor for &#39;sym-lognorm&#39; color scale, by default 0.001.</span>
<a id="__codelineno-0-1052" name="__codelineno-0-1052"></a><span class="sd">        bounds : List, optional</span>
<a id="__codelineno-0-1053" name="__codelineno-0-1053"></a><span class="sd">            Boundaries for &#39;boundary-norm&#39; color scale, by default None.</span>
<a id="__codelineno-0-1054" name="__codelineno-0-1054"></a><span class="sd">            Defines the discrete intervals for color mapping.</span>
<a id="__codelineno-0-1055" name="__codelineno-0-1055"></a><span class="sd">        midpoint : float, optional</span>
<a id="__codelineno-0-1056" name="__codelineno-0-1056"></a><span class="sd">            Midpoint value for &#39;midpoint&#39; color scale, by default 0.</span>
<a id="__codelineno-0-1057" name="__codelineno-0-1057"></a>
<a id="__codelineno-0-1058" name="__codelineno-0-1058"></a><span class="sd">        Cell value display options:</span>
<a id="__codelineno-0-1059" name="__codelineno-0-1059"></a><span class="sd">        -------------------------</span>
<a id="__codelineno-0-1060" name="__codelineno-0-1060"></a><span class="sd">        display_cell_value : bool, optional</span>
<a id="__codelineno-0-1061" name="__codelineno-0-1061"></a><span class="sd">            Whether to display the values of cells as text, by default False.</span>
<a id="__codelineno-0-1062" name="__codelineno-0-1062"></a><span class="sd">        num_size : int, optional</span>
<a id="__codelineno-0-1063" name="__codelineno-0-1063"></a><span class="sd">            Font size of the cell value text, by default 8.</span>
<a id="__codelineno-0-1064" name="__codelineno-0-1064"></a><span class="sd">        background_color_threshold : float, optional</span>
<a id="__codelineno-0-1065" name="__codelineno-0-1065"></a><span class="sd">            Threshold for cell value text color, by default None.</span>
<a id="__codelineno-0-1066" name="__codelineno-0-1066"></a><span class="sd">            If cell value &gt; threshold, text is black; otherwise, text is white.</span>
<a id="__codelineno-0-1067" name="__codelineno-0-1067"></a><span class="sd">            If None, uses max(array)/2 as the threshold.</span>
<a id="__codelineno-0-1068" name="__codelineno-0-1068"></a>
<a id="__codelineno-0-1069" name="__codelineno-0-1069"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-1070" name="__codelineno-0-1070"></a><span class="sd">    -------</span>
<a id="__codelineno-0-1071" name="__codelineno-0-1071"></a><span class="sd">    Tuple[matplotlib.figure.Figure, matplotlib.axes.Axes]</span>
<a id="__codelineno-0-1072" name="__codelineno-0-1072"></a><span class="sd">        A tuple containing:</span>
<a id="__codelineno-0-1073" name="__codelineno-0-1073"></a><span class="sd">        - fig: The matplotlib Figure object</span>
<a id="__codelineno-0-1074" name="__codelineno-0-1074"></a><span class="sd">        - ax: The matplotlib Axes object</span>
<a id="__codelineno-0-1075" name="__codelineno-0-1075"></a>
<a id="__codelineno-0-1076" name="__codelineno-0-1076"></a><span class="sd">    Raises</span>
<a id="__codelineno-0-1077" name="__codelineno-0-1077"></a><span class="sd">    ------</span>
<a id="__codelineno-0-1078" name="__codelineno-0-1078"></a><span class="sd">    ValueError</span>
<a id="__codelineno-0-1079" name="__codelineno-0-1079"></a><span class="sd">        If an invalid keyword argument is provided.</span>
<a id="__codelineno-0-1080" name="__codelineno-0-1080"></a>
<a id="__codelineno-0-1081" name="__codelineno-0-1081"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-1082" name="__codelineno-0-1082"></a><span class="sd">    --------</span>
<a id="__codelineno-0-1083" name="__codelineno-0-1083"></a><span class="sd">    - Basic array plot:</span>
<a id="__codelineno-0-1084" name="__codelineno-0-1084"></a>
<a id="__codelineno-0-1085" name="__codelineno-0-1085"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-1086" name="__codelineno-0-1086"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-1087" name="__codelineno-0-1087"></a><span class="sd">        &gt;&gt;&gt; from cleopatra.array_glyph import ArrayGlyph</span>
<a id="__codelineno-0-1088" name="__codelineno-0-1088"></a><span class="sd">        &gt;&gt;&gt; arr = np.array([[1, 2, 3], [4, 5, 6], [7, 8, 9]])</span>
<a id="__codelineno-0-1089" name="__codelineno-0-1089"></a><span class="sd">        &gt;&gt;&gt; array = ArrayGlyph(arr, figsize=(6, 6), title=&quot;Customized Plot&quot;, title_size=18)</span>
<a id="__codelineno-0-1090" name="__codelineno-0-1090"></a><span class="sd">        &gt;&gt;&gt; fig, ax = array.plot()</span>
<a id="__codelineno-0-1091" name="__codelineno-0-1091"></a>
<a id="__codelineno-0-1092" name="__codelineno-0-1092"></a><span class="sd">        ```</span>
<a id="__codelineno-0-1093" name="__codelineno-0-1093"></a><span class="sd">    ![array-plot](./../_images/array_glyph/array-plot.png)</span>
<a id="__codelineno-0-1094" name="__codelineno-0-1094"></a>
<a id="__codelineno-0-1095" name="__codelineno-0-1095"></a><span class="sd">    - Color bar customization:</span>
<a id="__codelineno-0-1096" name="__codelineno-0-1096"></a>
<a id="__codelineno-0-1097" name="__codelineno-0-1097"></a><span class="sd">        - Create an array and instantiate the `Array` object with custom options.</span>
<a id="__codelineno-0-1098" name="__codelineno-0-1098"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-1099" name="__codelineno-0-1099"></a><span class="sd">            &gt;&gt;&gt; array = ArrayGlyph(arr, figsize=(6, 6), title=&quot;Customized color bar&quot;, title_size=18)</span>
<a id="__codelineno-0-1100" name="__codelineno-0-1100"></a><span class="sd">            &gt;&gt;&gt; fig, ax = array.plot(</span>
<a id="__codelineno-0-1101" name="__codelineno-0-1101"></a><span class="sd">            ...     cbar_orientation=&quot;horizontal&quot;,</span>
<a id="__codelineno-0-1102" name="__codelineno-0-1102"></a><span class="sd">            ...     cbar_label_rotation=-90,</span>
<a id="__codelineno-0-1103" name="__codelineno-0-1103"></a><span class="sd">            ...     cbar_label_location=&quot;center&quot;,</span>
<a id="__codelineno-0-1104" name="__codelineno-0-1104"></a><span class="sd">            ...     cbar_length=0.7,</span>
<a id="__codelineno-0-1105" name="__codelineno-0-1105"></a><span class="sd">            ...     cbar_label_size=12,</span>
<a id="__codelineno-0-1106" name="__codelineno-0-1106"></a><span class="sd">            ...     cbar_label=&quot;Discharge m3/s&quot;,</span>
<a id="__codelineno-0-1107" name="__codelineno-0-1107"></a><span class="sd">            ...     ticks_spacing=5,</span>
<a id="__codelineno-0-1108" name="__codelineno-0-1108"></a><span class="sd">            ...     color_scale=&quot;linear&quot;,</span>
<a id="__codelineno-0-1109" name="__codelineno-0-1109"></a><span class="sd">            ...     cmap=&quot;coolwarm_r&quot;,</span>
<a id="__codelineno-0-1110" name="__codelineno-0-1110"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-1111" name="__codelineno-0-1111"></a>
<a id="__codelineno-0-1112" name="__codelineno-0-1112"></a><span class="sd">            ```</span>
<a id="__codelineno-0-1113" name="__codelineno-0-1113"></a><span class="sd">            ![color-bar-customization](./../_images/array_glyph/color-bar-customization.png)</span>
<a id="__codelineno-0-1114" name="__codelineno-0-1114"></a>
<a id="__codelineno-0-1115" name="__codelineno-0-1115"></a><span class="sd">    - Display values for each cell:</span>
<a id="__codelineno-0-1116" name="__codelineno-0-1116"></a>
<a id="__codelineno-0-1117" name="__codelineno-0-1117"></a><span class="sd">        - you can display the values for each cell by using thr parameter `display_cell_value`, and customize how</span>
<a id="__codelineno-0-1118" name="__codelineno-0-1118"></a><span class="sd">            the values are displayed using the parameter `background_color_threshold` and `num_size`.</span>
<a id="__codelineno-0-1119" name="__codelineno-0-1119"></a>
<a id="__codelineno-0-1120" name="__codelineno-0-1120"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-1121" name="__codelineno-0-1121"></a><span class="sd">            &gt;&gt;&gt; array = ArrayGlyph(arr, figsize=(6, 6), title=&quot;Display array values&quot;, title_size=18)</span>
<a id="__codelineno-0-1122" name="__codelineno-0-1122"></a><span class="sd">            &gt;&gt;&gt; fig, ax = array.plot(</span>
<a id="__codelineno-0-1123" name="__codelineno-0-1123"></a><span class="sd">            ...     display_cell_value=True,</span>
<a id="__codelineno-0-1124" name="__codelineno-0-1124"></a><span class="sd">            ...     num_size=12</span>
<a id="__codelineno-0-1125" name="__codelineno-0-1125"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-1126" name="__codelineno-0-1126"></a>
<a id="__codelineno-0-1127" name="__codelineno-0-1127"></a><span class="sd">            ```</span>
<a id="__codelineno-0-1128" name="__codelineno-0-1128"></a><span class="sd">            ![display-cell-values](./../_images/array_glyph/display-cell-values.png)</span>
<a id="__codelineno-0-1129" name="__codelineno-0-1129"></a>
<a id="__codelineno-0-1130" name="__codelineno-0-1130"></a><span class="sd">    - Plot points at specific locations in the array:</span>
<a id="__codelineno-0-1131" name="__codelineno-0-1131"></a>
<a id="__codelineno-0-1132" name="__codelineno-0-1132"></a><span class="sd">        - you can display points in specific cells in the array and also display a value for each of these points.</span>
<a id="__codelineno-0-1133" name="__codelineno-0-1133"></a><span class="sd">            The point parameter takes an array with the first column as the values to be displayed on top of the</span>
<a id="__codelineno-0-1134" name="__codelineno-0-1134"></a><span class="sd">            points, the second and third columns are the row and column index of the point in the array.</span>
<a id="__codelineno-0-1135" name="__codelineno-0-1135"></a><span class="sd">        - The `point_color` and `point_size` parameters are used to customize the appearance of the points,</span>
<a id="__codelineno-0-1136" name="__codelineno-0-1136"></a><span class="sd">            while the `pid_color` and `pid_size` parameters are used to customize the appearance of the point</span>
<a id="__codelineno-0-1137" name="__codelineno-0-1137"></a><span class="sd">            IDs/text.</span>
<a id="__codelineno-0-1138" name="__codelineno-0-1138"></a>
<a id="__codelineno-0-1139" name="__codelineno-0-1139"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-1140" name="__codelineno-0-1140"></a><span class="sd">            &gt;&gt;&gt; array = ArrayGlyph(arr, figsize=(6, 6), title=&quot;Display Points&quot;, title_size=14)</span>
<a id="__codelineno-0-1141" name="__codelineno-0-1141"></a><span class="sd">            &gt;&gt;&gt; points = np.array([[1, 0, 0], [2, 1, 1], [3, 2, 2]])</span>
<a id="__codelineno-0-1142" name="__codelineno-0-1142"></a><span class="sd">            &gt;&gt;&gt; fig, ax = array.plot(</span>
<a id="__codelineno-0-1143" name="__codelineno-0-1143"></a><span class="sd">            ...     points=points,</span>
<a id="__codelineno-0-1144" name="__codelineno-0-1144"></a><span class="sd">            ...     point_color=&quot;black&quot;,</span>
<a id="__codelineno-0-1145" name="__codelineno-0-1145"></a><span class="sd">            ...     point_size=100,</span>
<a id="__codelineno-0-1146" name="__codelineno-0-1146"></a><span class="sd">            ...     pid_color=&quot;orange&quot;,</span>
<a id="__codelineno-0-1147" name="__codelineno-0-1147"></a><span class="sd">            ...     pid_size=30,</span>
<a id="__codelineno-0-1148" name="__codelineno-0-1148"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-1149" name="__codelineno-0-1149"></a>
<a id="__codelineno-0-1150" name="__codelineno-0-1150"></a><span class="sd">            ```</span>
<a id="__codelineno-0-1151" name="__codelineno-0-1151"></a><span class="sd">            ![display-points](./../_images/array_glyph/display-points.png)</span>
<a id="__codelineno-0-1152" name="__codelineno-0-1152"></a>
<a id="__codelineno-0-1153" name="__codelineno-0-1153"></a><span class="sd">    - Color scale customization:</span>
<a id="__codelineno-0-1154" name="__codelineno-0-1154"></a>
<a id="__codelineno-0-1155" name="__codelineno-0-1155"></a><span class="sd">        - Power scale (with different gamma values).</span>
<a id="__codelineno-0-1156" name="__codelineno-0-1156"></a>
<a id="__codelineno-0-1157" name="__codelineno-0-1157"></a><span class="sd">            - The default power scale uses a gamma value of 0.5.</span>
<a id="__codelineno-0-1158" name="__codelineno-0-1158"></a>
<a id="__codelineno-0-1159" name="__codelineno-0-1159"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-1160" name="__codelineno-0-1160"></a><span class="sd">                &gt;&gt;&gt; array = ArrayGlyph(arr, figsize=(6, 6), title=&quot;Power scale&quot;, title_size=18)</span>
<a id="__codelineno-0-1161" name="__codelineno-0-1161"></a><span class="sd">                &gt;&gt;&gt; fig, ax = array.plot(</span>
<a id="__codelineno-0-1162" name="__codelineno-0-1162"></a><span class="sd">                ...     cbar_label=&quot;Discharge m3/s&quot;,</span>
<a id="__codelineno-0-1163" name="__codelineno-0-1163"></a><span class="sd">                ...     color_scale=&quot;power&quot;,</span>
<a id="__codelineno-0-1164" name="__codelineno-0-1164"></a><span class="sd">                ...     cmap=&quot;coolwarm_r&quot;,</span>
<a id="__codelineno-0-1165" name="__codelineno-0-1165"></a><span class="sd">                ...     cbar_label_rotation=-90,</span>
<a id="__codelineno-0-1166" name="__codelineno-0-1166"></a><span class="sd">                ... )</span>
<a id="__codelineno-0-1167" name="__codelineno-0-1167"></a>
<a id="__codelineno-0-1168" name="__codelineno-0-1168"></a><span class="sd">                ```</span>
<a id="__codelineno-0-1169" name="__codelineno-0-1169"></a><span class="sd">                ![power-scale](./../_images/array_glyph/power-scale.png)</span>
<a id="__codelineno-0-1170" name="__codelineno-0-1170"></a>
<a id="__codelineno-0-1171" name="__codelineno-0-1171"></a><span class="sd">            - change the gamma of 0.8 (emphasizes higher values less).</span>
<a id="__codelineno-0-1172" name="__codelineno-0-1172"></a>
<a id="__codelineno-0-1173" name="__codelineno-0-1173"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-1174" name="__codelineno-0-1174"></a><span class="sd">                &gt;&gt;&gt; fig, ax = array.plot(</span>
<a id="__codelineno-0-1175" name="__codelineno-0-1175"></a><span class="sd">                ...     color_scale=&quot;power&quot;,</span>
<a id="__codelineno-0-1176" name="__codelineno-0-1176"></a><span class="sd">                ...     gamma=0.8,</span>
<a id="__codelineno-0-1177" name="__codelineno-0-1177"></a><span class="sd">                ...     cmap=&quot;coolwarm_r&quot;,</span>
<a id="__codelineno-0-1178" name="__codelineno-0-1178"></a><span class="sd">                ...     cbar_label_rotation=-90,</span>
<a id="__codelineno-0-1179" name="__codelineno-0-1179"></a><span class="sd">                ...     cbar_label=&quot;Discharge m3/s&quot;,</span>
<a id="__codelineno-0-1180" name="__codelineno-0-1180"></a><span class="sd">                ... )</span>
<a id="__codelineno-0-1181" name="__codelineno-0-1181"></a>
<a id="__codelineno-0-1182" name="__codelineno-0-1182"></a><span class="sd">                ```</span>
<a id="__codelineno-0-1183" name="__codelineno-0-1183"></a><span class="sd">                ![power-scale-gamma-0.8](./../_images/array_glyph/power-scale-gamma-0.8.png)</span>
<a id="__codelineno-0-1184" name="__codelineno-0-1184"></a>
<a id="__codelineno-0-1185" name="__codelineno-0-1185"></a><span class="sd">            - change the gamma of 0.1 (emphasizes higher values more).</span>
<a id="__codelineno-0-1186" name="__codelineno-0-1186"></a>
<a id="__codelineno-0-1187" name="__codelineno-0-1187"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-1188" name="__codelineno-0-1188"></a><span class="sd">                &gt;&gt;&gt; fig, ax = array.plot(</span>
<a id="__codelineno-0-1189" name="__codelineno-0-1189"></a><span class="sd">                ...     color_scale=&quot;power&quot;,</span>
<a id="__codelineno-0-1190" name="__codelineno-0-1190"></a><span class="sd">                ...     gamma=0.1,</span>
<a id="__codelineno-0-1191" name="__codelineno-0-1191"></a><span class="sd">                ...     cmap=&quot;coolwarm_r&quot;,</span>
<a id="__codelineno-0-1192" name="__codelineno-0-1192"></a><span class="sd">                ...     cbar_label_rotation=-90,</span>
<a id="__codelineno-0-1193" name="__codelineno-0-1193"></a><span class="sd">                ...     cbar_label=&quot;Discharge m3/s&quot;,</span>
<a id="__codelineno-0-1194" name="__codelineno-0-1194"></a><span class="sd">                ... )</span>
<a id="__codelineno-0-1195" name="__codelineno-0-1195"></a>
<a id="__codelineno-0-1196" name="__codelineno-0-1196"></a><span class="sd">                ```</span>
<a id="__codelineno-0-1197" name="__codelineno-0-1197"></a><span class="sd">                ![power-scale-gamma-0.1](./../_images/array_glyph/power-scale-gamma-0.1.png)</span>
<a id="__codelineno-0-1198" name="__codelineno-0-1198"></a>
<a id="__codelineno-0-1199" name="__codelineno-0-1199"></a><span class="sd">        - Logarithmic scale.</span>
<a id="__codelineno-0-1200" name="__codelineno-0-1200"></a>
<a id="__codelineno-0-1201" name="__codelineno-0-1201"></a><span class="sd">            - the logarithmic scale uses to parameters `line_threshold` and `line_scale` with a default</span>
<a id="__codelineno-0-1202" name="__codelineno-0-1202"></a><span class="sd">            value if 0.0001, and 0.001 respectively.</span>
<a id="__codelineno-0-1203" name="__codelineno-0-1203"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-1204" name="__codelineno-0-1204"></a><span class="sd">                &gt;&gt;&gt; fig, ax = array.plot(</span>
<a id="__codelineno-0-1205" name="__codelineno-0-1205"></a><span class="sd">                ...     cbar_label=&quot;Discharge m3/s&quot;,</span>
<a id="__codelineno-0-1206" name="__codelineno-0-1206"></a><span class="sd">                ...     color_scale=&quot;sym-lognorm&quot;,</span>
<a id="__codelineno-0-1207" name="__codelineno-0-1207"></a><span class="sd">                ...     cmap=&quot;coolwarm_r&quot;,</span>
<a id="__codelineno-0-1208" name="__codelineno-0-1208"></a><span class="sd">                ...     cbar_label_rotation=-90,</span>
<a id="__codelineno-0-1209" name="__codelineno-0-1209"></a><span class="sd">                ... )</span>
<a id="__codelineno-0-1210" name="__codelineno-0-1210"></a>
<a id="__codelineno-0-1211" name="__codelineno-0-1211"></a><span class="sd">                ```</span>
<a id="__codelineno-0-1212" name="__codelineno-0-1212"></a><span class="sd">                ![log-scale](./../_images/array_glyph/log-scale.png)</span>
<a id="__codelineno-0-1213" name="__codelineno-0-1213"></a>
<a id="__codelineno-0-1214" name="__codelineno-0-1214"></a><span class="sd">            - you can change the `line_threshold` and `line_scale` values.</span>
<a id="__codelineno-0-1215" name="__codelineno-0-1215"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-1216" name="__codelineno-0-1216"></a><span class="sd">                &gt;&gt;&gt; array = ArrayGlyph(</span>
<a id="__codelineno-0-1217" name="__codelineno-0-1217"></a><span class="sd">                ...     arr, figsize=(6, 6), title=&quot;Logarithmic scale: Customized Parameter&quot;, title_size=12</span>
<a id="__codelineno-0-1218" name="__codelineno-0-1218"></a><span class="sd">                ... )</span>
<a id="__codelineno-0-1219" name="__codelineno-0-1219"></a><span class="sd">                &gt;&gt;&gt; fig, ax = array.plot(</span>
<a id="__codelineno-0-1220" name="__codelineno-0-1220"></a><span class="sd">                ...     cbar_label_rotation=-90,</span>
<a id="__codelineno-0-1221" name="__codelineno-0-1221"></a><span class="sd">                ...     cbar_label=&quot;Discharge m3/s&quot;,</span>
<a id="__codelineno-0-1222" name="__codelineno-0-1222"></a><span class="sd">                ...     color_scale=&quot;sym-lognorm&quot;,</span>
<a id="__codelineno-0-1223" name="__codelineno-0-1223"></a><span class="sd">                ...     cmap=&quot;coolwarm_r&quot;,</span>
<a id="__codelineno-0-1224" name="__codelineno-0-1224"></a><span class="sd">                ...     line_threshold=0.015,</span>
<a id="__codelineno-0-1225" name="__codelineno-0-1225"></a><span class="sd">                ...     line_scale=0.1,</span>
<a id="__codelineno-0-1226" name="__codelineno-0-1226"></a><span class="sd">                ... )</span>
<a id="__codelineno-0-1227" name="__codelineno-0-1227"></a>
<a id="__codelineno-0-1228" name="__codelineno-0-1228"></a><span class="sd">                ```</span>
<a id="__codelineno-0-1229" name="__codelineno-0-1229"></a><span class="sd">                ![log-scale](./../_images/array_glyph/log-scale-custom-parameters.png)</span>
<a id="__codelineno-0-1230" name="__codelineno-0-1230"></a>
<a id="__codelineno-0-1231" name="__codelineno-0-1231"></a><span class="sd">        - Defined boundary scale.</span>
<a id="__codelineno-0-1232" name="__codelineno-0-1232"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-1233" name="__codelineno-0-1233"></a><span class="sd">            &gt;&gt;&gt; array = ArrayGlyph(arr, figsize=(6, 6), title=&quot;Defined boundary scale&quot;, title_size=18)</span>
<a id="__codelineno-0-1234" name="__codelineno-0-1234"></a><span class="sd">            &gt;&gt;&gt; fig, ax = array.plot(</span>
<a id="__codelineno-0-1235" name="__codelineno-0-1235"></a><span class="sd">            ...     cbar_label_rotation=-90,</span>
<a id="__codelineno-0-1236" name="__codelineno-0-1236"></a><span class="sd">            ...     cbar_label=&quot;Discharge m3/s&quot;,</span>
<a id="__codelineno-0-1237" name="__codelineno-0-1237"></a><span class="sd">            ...     color_scale=&quot;boundary-norm&quot;,</span>
<a id="__codelineno-0-1238" name="__codelineno-0-1238"></a><span class="sd">            ...     cmap=&quot;coolwarm_r&quot;,</span>
<a id="__codelineno-0-1239" name="__codelineno-0-1239"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-1240" name="__codelineno-0-1240"></a>
<a id="__codelineno-0-1241" name="__codelineno-0-1241"></a><span class="sd">            ```</span>
<a id="__codelineno-0-1242" name="__codelineno-0-1242"></a><span class="sd">            ![boundary-scale](./../_images/array_glyph/boundary-scale.png)</span>
<a id="__codelineno-0-1243" name="__codelineno-0-1243"></a>
<a id="__codelineno-0-1244" name="__codelineno-0-1244"></a><span class="sd">            - You can also define the boundaries.</span>
<a id="__codelineno-0-1245" name="__codelineno-0-1245"></a><span class="sd">                ```python</span>
<a id="__codelineno-0-1246" name="__codelineno-0-1246"></a><span class="sd">                &gt;&gt;&gt; array = ArrayGlyph(</span>
<a id="__codelineno-0-1247" name="__codelineno-0-1247"></a><span class="sd">                ...     arr, figsize=(6, 6), title=&quot;Defined boundary scale: defined bounds&quot;, title_size=18</span>
<a id="__codelineno-0-1248" name="__codelineno-0-1248"></a><span class="sd">                ... )</span>
<a id="__codelineno-0-1249" name="__codelineno-0-1249"></a><span class="sd">                &gt;&gt;&gt; bounds = [0, 5, 10]</span>
<a id="__codelineno-0-1250" name="__codelineno-0-1250"></a><span class="sd">                &gt;&gt;&gt; fig, ax = array.plot(</span>
<a id="__codelineno-0-1251" name="__codelineno-0-1251"></a><span class="sd">                ...     cbar_label_rotation=-90,</span>
<a id="__codelineno-0-1252" name="__codelineno-0-1252"></a><span class="sd">                ...     cbar_label=&quot;Discharge m3/s&quot;,</span>
<a id="__codelineno-0-1253" name="__codelineno-0-1253"></a><span class="sd">                ...     color_scale=&quot;boundary-norm&quot;,</span>
<a id="__codelineno-0-1254" name="__codelineno-0-1254"></a><span class="sd">                ...     bounds=bounds,</span>
<a id="__codelineno-0-1255" name="__codelineno-0-1255"></a><span class="sd">                ...     cmap=&quot;coolwarm_r&quot;,</span>
<a id="__codelineno-0-1256" name="__codelineno-0-1256"></a><span class="sd">                ... )</span>
<a id="__codelineno-0-1257" name="__codelineno-0-1257"></a>
<a id="__codelineno-0-1258" name="__codelineno-0-1258"></a><span class="sd">                ```</span>
<a id="__codelineno-0-1259" name="__codelineno-0-1259"></a><span class="sd">                ![boundary-scale-defined-bounds](./../_images/array_glyph/boundary-scale-defined-bounds.png)</span>
<a id="__codelineno-0-1260" name="__codelineno-0-1260"></a>
<a id="__codelineno-0-1261" name="__codelineno-0-1261"></a><span class="sd">        - Midpoint scale.</span>
<a id="__codelineno-0-1262" name="__codelineno-0-1262"></a>
<a id="__codelineno-0-1263" name="__codelineno-0-1263"></a><span class="sd">            in the midpoint scale you can define a value that splits the scale into half.</span>
<a id="__codelineno-0-1264" name="__codelineno-0-1264"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-1265" name="__codelineno-0-1265"></a><span class="sd">            &gt;&gt;&gt; array = ArrayGlyph(arr, figsize=(6, 6), title=&quot;Midpoint scale&quot;, title_size=18)</span>
<a id="__codelineno-0-1266" name="__codelineno-0-1266"></a><span class="sd">            &gt;&gt;&gt; fig, ax = array.plot(</span>
<a id="__codelineno-0-1267" name="__codelineno-0-1267"></a><span class="sd">            ...     cbar_label_rotation=-90,</span>
<a id="__codelineno-0-1268" name="__codelineno-0-1268"></a><span class="sd">            ...     cbar_label=&quot;Discharge m3/s&quot;,</span>
<a id="__codelineno-0-1269" name="__codelineno-0-1269"></a><span class="sd">            ...     color_scale=&quot;midpoint&quot;,</span>
<a id="__codelineno-0-1270" name="__codelineno-0-1270"></a><span class="sd">            ...     cmap=&quot;coolwarm_r&quot;,</span>
<a id="__codelineno-0-1271" name="__codelineno-0-1271"></a><span class="sd">            ...     midpoint=2,</span>
<a id="__codelineno-0-1272" name="__codelineno-0-1272"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-1273" name="__codelineno-0-1273"></a>
<a id="__codelineno-0-1274" name="__codelineno-0-1274"></a><span class="sd">            ```</span>
<a id="__codelineno-0-1275" name="__codelineno-0-1275"></a><span class="sd">            ![midpoint-scale-costom-parameters](./../_images/array_glyph/midpoint-scale-costom-parameters.png)</span>
<a id="__codelineno-0-1276" name="__codelineno-0-1276"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1277" name="__codelineno-0-1277"></a>    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-1278" name="__codelineno-0-1278"></a>        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-1279" name="__codelineno-0-1279"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1280" name="__codelineno-0-1280"></a>                <span class="sa">f</span><span class="s2">&quot;The given keyword argument:</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> is not correct, possible parameters are,&quot;</span>
<a id="__codelineno-0-1281" name="__codelineno-0-1281"></a>                <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">DEFAULT_OPTIONS</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-0-1282" name="__codelineno-0-1282"></a>            <span class="p">)</span>
<a id="__codelineno-0-1283" name="__codelineno-0-1283"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1284" name="__codelineno-0-1284"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
<a id="__codelineno-0-1285" name="__codelineno-0-1285"></a>
<a id="__codelineno-0-1286" name="__codelineno-0-1286"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1287" name="__codelineno-0-1287"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_figure_axes</span><span class="p">()</span>
<a id="__codelineno-0-1288" name="__codelineno-0-1288"></a>
<a id="__codelineno-0-1289" name="__codelineno-0-1289"></a>    <span class="n">arr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr</span>
<a id="__codelineno-0-1290" name="__codelineno-0-1290"></a>    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span>
<a id="__codelineno-0-1291" name="__codelineno-0-1291"></a>
<a id="__codelineno-0-1292" name="__codelineno-0-1292"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span><span class="p">:</span>
<a id="__codelineno-0-1293" name="__codelineno-0-1293"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extent</span><span class="p">)</span>
<a id="__codelineno-0-1294" name="__codelineno-0-1294"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1295" name="__codelineno-0-1295"></a>        <span class="c1"># if user did not input ticks spacing use the calculated one.</span>
<a id="__codelineno-0-1296" name="__codelineno-0-1296"></a>        <span class="k">if</span> <span class="s2">&quot;ticks_spacing&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-1297" name="__codelineno-0-1297"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;ticks_spacing&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;ticks_spacing&quot;</span><span class="p">]</span>
<a id="__codelineno-0-1298" name="__codelineno-0-1298"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1299" name="__codelineno-0-1299"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;ticks_spacing&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ticks_spacing</span>
<a id="__codelineno-0-1300" name="__codelineno-0-1300"></a>
<a id="__codelineno-0-1301" name="__codelineno-0-1301"></a>        <span class="k">if</span> <span class="s2">&quot;vmin&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-1302" name="__codelineno-0-1302"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;vmin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;vmin&quot;</span><span class="p">]</span>
<a id="__codelineno-0-1303" name="__codelineno-0-1303"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1304" name="__codelineno-0-1304"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;vmin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmin</span>
<a id="__codelineno-0-1305" name="__codelineno-0-1305"></a>
<a id="__codelineno-0-1306" name="__codelineno-0-1306"></a>        <span class="k">if</span> <span class="s2">&quot;vmax&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a id="__codelineno-0-1307" name="__codelineno-0-1307"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;vmax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;vmax&quot;</span><span class="p">]</span>
<a id="__codelineno-0-1308" name="__codelineno-0-1308"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1309" name="__codelineno-0-1309"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;vmax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmax</span>
<a id="__codelineno-0-1310" name="__codelineno-0-1310"></a>
<a id="__codelineno-0-1311" name="__codelineno-0-1311"></a>        <span class="c1"># creating the ticks/bounds</span>
<a id="__codelineno-0-1312" name="__codelineno-0-1312"></a>        <span class="n">ticks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ticks</span><span class="p">()</span>
<a id="__codelineno-0-1313" name="__codelineno-0-1313"></a>        <span class="n">im</span><span class="p">,</span> <span class="n">cbar_kw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_im_get_cbar_kw</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="n">ticks</span><span class="p">)</span>
<a id="__codelineno-0-1314" name="__codelineno-0-1314"></a>
<a id="__codelineno-0-1315" name="__codelineno-0-1315"></a>        <span class="c1"># Create colorbar</span>
<a id="__codelineno-0-1316" name="__codelineno-0-1316"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">create_color_bar</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">im</span><span class="p">,</span> <span class="n">cbar_kw</span><span class="p">)</span>
<a id="__codelineno-0-1317" name="__codelineno-0-1317"></a>
<a id="__codelineno-0-1318" name="__codelineno-0-1318"></a>    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
<a id="__codelineno-0-1319" name="__codelineno-0-1319"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;title_size&quot;</span><span class="p">]</span>
<a id="__codelineno-0-1320" name="__codelineno-0-1320"></a>    <span class="p">)</span>
<a id="__codelineno-0-1321" name="__codelineno-0-1321"></a>
<a id="__codelineno-0-1322" name="__codelineno-0-1322"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1323" name="__codelineno-0-1323"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([])</span>
<a id="__codelineno-0-1324" name="__codelineno-0-1324"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
<a id="__codelineno-0-1325" name="__codelineno-0-1325"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
<a id="__codelineno-0-1326" name="__codelineno-0-1326"></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
<a id="__codelineno-0-1327" name="__codelineno-0-1327"></a>
<a id="__codelineno-0-1328" name="__codelineno-0-1328"></a>    <span class="n">optional_display</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-1329" name="__codelineno-0-1329"></a>    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span><span class="p">[</span><span class="s2">&quot;display_cell_value&quot;</span><span class="p">]:</span>
<a id="__codelineno-0-1330" name="__codelineno-0-1330"></a>        <span class="n">indices</span> <span class="o">=</span> <span class="n">get_indices2</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
<a id="__codelineno-0-1331" name="__codelineno-0-1331"></a>        <span class="n">optional_display</span><span class="p">[</span><span class="s2">&quot;cell_text_value&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_text</span><span class="p">(</span>
<a id="__codelineno-0-1332" name="__codelineno-0-1332"></a>            <span class="n">ax</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_options</span>
<a id="__codelineno-0-1333" name="__codelineno-0-1333"></a>        <span class="p">)</span>
<a id="__codelineno-0-1334" name="__codelineno-0-1334"></a>
<a id="__codelineno-0-1335" name="__codelineno-0-1335"></a>    <span class="k">if</span> <span class="n">points</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-1336" name="__codelineno-0-1336"></a>        <span class="n">row</span> <span class="o">=</span> <span class="n">points</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-1337" name="__codelineno-0-1337"></a>        <span class="n">col</span> <span class="o">=</span> <span class="n">points</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-1338" name="__codelineno-0-1338"></a>        <span class="n">optional_display</span><span class="p">[</span><span class="s2">&quot;points_scatter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
<a id="__codelineno-0-1339" name="__codelineno-0-1339"></a>            <span class="n">col</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">point_color</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">point_size</span>
<a id="__codelineno-0-1340" name="__codelineno-0-1340"></a>        <span class="p">)</span>
<a id="__codelineno-0-1341" name="__codelineno-0-1341"></a>        <span class="n">optional_display</span><span class="p">[</span><span class="s2">&quot;points_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_point_values</span><span class="p">(</span>
<a id="__codelineno-0-1342" name="__codelineno-0-1342"></a>            <span class="n">ax</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">pid_color</span><span class="p">,</span> <span class="n">pid_size</span>
<a id="__codelineno-0-1343" name="__codelineno-0-1343"></a>        <span class="p">)</span>
<a id="__codelineno-0-1344" name="__codelineno-0-1344"></a>
<a id="__codelineno-0-1345" name="__codelineno-0-1345"></a>    <span class="c1"># # Normalize the threshold to the image color range.</span>
<a id="__codelineno-0-1346" name="__codelineno-0-1346"></a>    <span class="c1"># if self.default_options[&quot;background_color_threshold&quot;] is not None:</span>
<a id="__codelineno-0-1347" name="__codelineno-0-1347"></a>    <span class="c1">#     im.norm(self.default_options[&quot;background_color_threshold&quot;])</span>
<a id="__codelineno-0-1348" name="__codelineno-0-1348"></a>    <span class="c1"># else:</span>
<a id="__codelineno-0-1349" name="__codelineno-0-1349"></a>    <span class="c1">#     im.norm(self.vmax) / 2.0</span>
<a id="__codelineno-0-1350" name="__codelineno-0-1350"></a>    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<a id="__codelineno-0-1351" name="__codelineno-0-1351"></a>    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="cleopatra.array_glyph.ArrayGlyph.prepare_array" class="doc doc-heading"><a href="#cleopatra.array_glyph.ArrayGlyph.prepare_array" class="toclink">
            <code class="highlight language-python"><span class="n">prepare_array</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">rgb</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">surface_reflectance</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">percentile</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</a><a href="#cleopatra.array_glyph.ArrayGlyph.prepare_array" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Prepare an array for RGB visualization.</p>
<p>This method processes a multi-band array to create an RGB image suitable for visualization.
It can normalize the data using either percentile-based scaling or surface reflectance values.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>array</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input array containing multiple bands. For RGB visualization,
this should be a 3D array where the first dimension represents the bands.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rgb</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The indices of the red, green, and blue bands in the given array, by default None.
If None, assumes the order is [3, 2, 1] (common for Sentinel-2 data).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>surface_reflectance</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Surface reflectance value for normalizing satellite data, by default None.
Typically 10000 for Sentinel-2 data or 255 for 8-bit imagery.
Used to scale values to the range [0, 1].</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cutoff</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Clip the range of pixel values for each band, by default None.
Takes only pixel values from 0 to the value of the cutoff and scales them back to between 0 and 1.
Should be a list with one value per band.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>percentile</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The percentile value to be used for scaling the array values, by default None.
Used to enhance contrast by stretching the histogram.
If provided, this takes precedence over surface_reflectance.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The prepared array with shape (height, width, 3) suitable for RGB visualization.
Values are normalized to the range [0, 1].
the rgb 3d array is converted into 2d array to be plotted using the plt.imshow function.
a float32 array normalized between 0 and 1 using the <code>percentile</code> values or the <code>surface_reflectance</code>.
if the <code>percentile</code> or <code>surface_reflectance</code> values are not given, the function just reorders the values
to have the red-green-blue order.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the array shape is incompatible with the provided RGB indices.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <div class="highlight"><pre><span></span><code>- The `prepare_array` function is called in the constructor of the `ArrayGlyph` class to prepare the array,
  so you can provide the same parameters of the `prepare_array` function to the `ArrayGlyph constructor`.
- The prepare function moves the first axes (the channel axis) to the last axes, and then scales the array
  using the percentile values. If the percentile is not given, the function scales the array using the
  surface reflectance values. If the surface reflectance is not given, the function scales the array using
  the cutoff values. If the cutoff is not given, the function scales the array using the sentinel data
</code></pre></div>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <p>Prepare an array using percentile-based scaling:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">cleopatra.array_glyph</span><span class="w"> </span><span class="kn">import</span> <span class="n">ArrayGlyph</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Create a 3-band array (e.g., satellite image)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">bands</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">glyph</span> <span class="o">=</span> <span class="n">ArrayGlyph</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>  <span class="c1"># Dummy initialization</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">rgb_array</span> <span class="o">=</span> <span class="n">glyph</span><span class="o">.</span><span class="n">prepare_array</span><span class="p">(</span><span class="n">bands</span><span class="p">,</span> <span class="n">rgb</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">percentile</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">rgb_array</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">rgb_array</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rgb_array</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="kc">True</span>
</code></pre></div>
Prepare an array using surface reflectance normalization:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">rgb_array</span> <span class="o">=</span> <span class="n">glyph</span><span class="o">.</span><span class="n">prepare_array</span><span class="p">(</span><span class="n">bands</span><span class="p">,</span> <span class="n">rgb</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">surface_reflectance</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">rgb_array</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">rgb_array</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rgb_array</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="kc">True</span>
</code></pre></div>
Prepare an array with cutoff values:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">rgb_array</span> <span class="o">=</span> <span class="n">glyph</span><span class="o">.</span><span class="n">prepare_array</span><span class="p">(</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="o">...</span>     <span class="n">bands</span><span class="p">,</span> <span class="n">rgb</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">surface_reflectance</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="p">[</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">]</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="o">...</span> <span class="p">)</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">rgb_array</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">rgb_array</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rgb_array</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="kc">True</span>
</code></pre></div></p>
<ul>
<li>Create an array and instantiate the <code>ArrayGlyph</code> class.
    <div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">array_glyph</span> <span class="o">=</span> <span class="n">ArrayGlyph</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">array_glyph</span><span class="o">.</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</code></pre></div>
<code>rgb</code> channels:<ul>
<li>Now let's use the <code>prepare_array</code> function with <code>rgb</code> channels as [0, 1, 2]. so the finction does not to
    reorder the chennels. but it just needs to move the first axis to the last axis.
    <div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">rgb_array</span> <span class="o">=</span> <span class="n">array_glyph</span><span class="o">.</span><span class="n">prepare_array</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">rgb</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">rgb_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</code></pre></div></li>
<li>If we compare the values of the first channel in the original array with the first array in the rgb array it
    should be the same.
    <div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_equal</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span><span class="n">rgb_array</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">])</span>
</code></pre></div>
surface_reflectance:</li>
<li>if you provide the surface reflectance value, the function will scale the array using the surface reflectance
    value to a normalized rgb values.
    <div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">array_glyph</span> <span class="o">=</span> <span class="n">ArrayGlyph</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">rgb_array</span> <span class="o">=</span> <span class="n">array_glyph</span><span class="o">.</span><span class="n">prepare_array</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">surface_reflectance</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">rgb</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">rgb_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</code></pre></div></li>
<li>if you print the values of the first channel, you will find all the values are between 0 and 1.
    <div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">rgb_array</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="p">[[</span><span class="mf">0.0195</span> <span class="mf">0.02</span>   <span class="mf">0.0109</span> <span class="mf">0.0211</span> <span class="mf">0.0087</span><span class="p">]</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a> <span class="p">[</span><span class="mf">0.0112</span> <span class="mf">0.0221</span> <span class="mf">0.0035</span> <span class="mf">0.0234</span> <span class="mf">0.0141</span><span class="p">]</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a> <span class="p">[</span><span class="mf">0.0116</span> <span class="mf">0.0188</span> <span class="mf">0.0001</span> <span class="mf">0.0176</span> <span class="mf">0.</span>    <span class="p">]</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a> <span class="p">[</span><span class="mf">0.0014</span> <span class="mf">0.0147</span> <span class="mf">0.0043</span> <span class="mf">0.0167</span> <span class="mf">0.0117</span><span class="p">]</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a> <span class="p">[</span><span class="mf">0.0083</span> <span class="mf">0.0139</span> <span class="mf">0.0186</span> <span class="mf">0.02</span>   <span class="mf">0.0058</span><span class="p">]]</span>
</code></pre></div></li>
<li>With the <code>surface_reflectance</code> parameter, you can also use the <code>cutoff</code> parameter to affect values that
    are above it, by rescaling them.
    <div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">rgb_array</span> <span class="o">=</span> <span class="n">array_glyph</span><span class="o">.</span><span class="n">prepare_array</span><span class="p">(</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="o">...</span>     <span class="n">arr</span><span class="p">,</span> <span class="n">surface_reflectance</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">rgb</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">cutoff</span><span class="o">=</span><span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="o">...</span> <span class="p">)</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">rgb_array</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="p">[[</span><span class="mf">0.</span>     <span class="mf">0.</span>     <span class="mf">0.</span>     <span class="mf">0.</span>     <span class="mf">0.</span>    <span class="p">]</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a> <span class="p">[</span><span class="mf">1.</span>     <span class="mf">1.</span>     <span class="mf">1.</span>     <span class="mf">1.</span>     <span class="mf">1.</span>    <span class="p">]</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a> <span class="p">[</span><span class="mf">1.</span>     <span class="mf">1.</span>     <span class="mf">1.</span>     <span class="mf">1.</span>     <span class="mf">1.</span>    <span class="p">]</span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a> <span class="p">[</span><span class="mf">0.0014</span> <span class="mf">0.0147</span> <span class="mf">0.0043</span> <span class="mf">0.0167</span> <span class="mf">0.0117</span><span class="p">]</span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a> <span class="p">[</span><span class="mf">0.0083</span> <span class="mf">0.0139</span> <span class="mf">0.0186</span> <span class="mf">0.02</span>   <span class="mf">0.0058</span><span class="p">]]</span>
</code></pre></div></li>
</ul>
</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>cleopatra/array_glyph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-300">300</a></span>
<span class="normal"><a href="#__codelineno-0-301">301</a></span>
<span class="normal"><a href="#__codelineno-0-302">302</a></span>
<span class="normal"><a href="#__codelineno-0-303">303</a></span>
<span class="normal"><a href="#__codelineno-0-304">304</a></span>
<span class="normal"><a href="#__codelineno-0-305">305</a></span>
<span class="normal"><a href="#__codelineno-0-306">306</a></span>
<span class="normal"><a href="#__codelineno-0-307">307</a></span>
<span class="normal"><a href="#__codelineno-0-308">308</a></span>
<span class="normal"><a href="#__codelineno-0-309">309</a></span>
<span class="normal"><a href="#__codelineno-0-310">310</a></span>
<span class="normal"><a href="#__codelineno-0-311">311</a></span>
<span class="normal"><a href="#__codelineno-0-312">312</a></span>
<span class="normal"><a href="#__codelineno-0-313">313</a></span>
<span class="normal"><a href="#__codelineno-0-314">314</a></span>
<span class="normal"><a href="#__codelineno-0-315">315</a></span>
<span class="normal"><a href="#__codelineno-0-316">316</a></span>
<span class="normal"><a href="#__codelineno-0-317">317</a></span>
<span class="normal"><a href="#__codelineno-0-318">318</a></span>
<span class="normal"><a href="#__codelineno-0-319">319</a></span>
<span class="normal"><a href="#__codelineno-0-320">320</a></span>
<span class="normal"><a href="#__codelineno-0-321">321</a></span>
<span class="normal"><a href="#__codelineno-0-322">322</a></span>
<span class="normal"><a href="#__codelineno-0-323">323</a></span>
<span class="normal"><a href="#__codelineno-0-324">324</a></span>
<span class="normal"><a href="#__codelineno-0-325">325</a></span>
<span class="normal"><a href="#__codelineno-0-326">326</a></span>
<span class="normal"><a href="#__codelineno-0-327">327</a></span>
<span class="normal"><a href="#__codelineno-0-328">328</a></span>
<span class="normal"><a href="#__codelineno-0-329">329</a></span>
<span class="normal"><a href="#__codelineno-0-330">330</a></span>
<span class="normal"><a href="#__codelineno-0-331">331</a></span>
<span class="normal"><a href="#__codelineno-0-332">332</a></span>
<span class="normal"><a href="#__codelineno-0-333">333</a></span>
<span class="normal"><a href="#__codelineno-0-334">334</a></span>
<span class="normal"><a href="#__codelineno-0-335">335</a></span>
<span class="normal"><a href="#__codelineno-0-336">336</a></span>
<span class="normal"><a href="#__codelineno-0-337">337</a></span>
<span class="normal"><a href="#__codelineno-0-338">338</a></span>
<span class="normal"><a href="#__codelineno-0-339">339</a></span>
<span class="normal"><a href="#__codelineno-0-340">340</a></span>
<span class="normal"><a href="#__codelineno-0-341">341</a></span>
<span class="normal"><a href="#__codelineno-0-342">342</a></span>
<span class="normal"><a href="#__codelineno-0-343">343</a></span>
<span class="normal"><a href="#__codelineno-0-344">344</a></span>
<span class="normal"><a href="#__codelineno-0-345">345</a></span>
<span class="normal"><a href="#__codelineno-0-346">346</a></span>
<span class="normal"><a href="#__codelineno-0-347">347</a></span>
<span class="normal"><a href="#__codelineno-0-348">348</a></span>
<span class="normal"><a href="#__codelineno-0-349">349</a></span>
<span class="normal"><a href="#__codelineno-0-350">350</a></span>
<span class="normal"><a href="#__codelineno-0-351">351</a></span>
<span class="normal"><a href="#__codelineno-0-352">352</a></span>
<span class="normal"><a href="#__codelineno-0-353">353</a></span>
<span class="normal"><a href="#__codelineno-0-354">354</a></span>
<span class="normal"><a href="#__codelineno-0-355">355</a></span>
<span class="normal"><a href="#__codelineno-0-356">356</a></span>
<span class="normal"><a href="#__codelineno-0-357">357</a></span>
<span class="normal"><a href="#__codelineno-0-358">358</a></span>
<span class="normal"><a href="#__codelineno-0-359">359</a></span>
<span class="normal"><a href="#__codelineno-0-360">360</a></span>
<span class="normal"><a href="#__codelineno-0-361">361</a></span>
<span class="normal"><a href="#__codelineno-0-362">362</a></span>
<span class="normal"><a href="#__codelineno-0-363">363</a></span>
<span class="normal"><a href="#__codelineno-0-364">364</a></span>
<span class="normal"><a href="#__codelineno-0-365">365</a></span>
<span class="normal"><a href="#__codelineno-0-366">366</a></span>
<span class="normal"><a href="#__codelineno-0-367">367</a></span>
<span class="normal"><a href="#__codelineno-0-368">368</a></span>
<span class="normal"><a href="#__codelineno-0-369">369</a></span>
<span class="normal"><a href="#__codelineno-0-370">370</a></span>
<span class="normal"><a href="#__codelineno-0-371">371</a></span>
<span class="normal"><a href="#__codelineno-0-372">372</a></span>
<span class="normal"><a href="#__codelineno-0-373">373</a></span>
<span class="normal"><a href="#__codelineno-0-374">374</a></span>
<span class="normal"><a href="#__codelineno-0-375">375</a></span>
<span class="normal"><a href="#__codelineno-0-376">376</a></span>
<span class="normal"><a href="#__codelineno-0-377">377</a></span>
<span class="normal"><a href="#__codelineno-0-378">378</a></span>
<span class="normal"><a href="#__codelineno-0-379">379</a></span>
<span class="normal"><a href="#__codelineno-0-380">380</a></span>
<span class="normal"><a href="#__codelineno-0-381">381</a></span>
<span class="normal"><a href="#__codelineno-0-382">382</a></span>
<span class="normal"><a href="#__codelineno-0-383">383</a></span>
<span class="normal"><a href="#__codelineno-0-384">384</a></span>
<span class="normal"><a href="#__codelineno-0-385">385</a></span>
<span class="normal"><a href="#__codelineno-0-386">386</a></span>
<span class="normal"><a href="#__codelineno-0-387">387</a></span>
<span class="normal"><a href="#__codelineno-0-388">388</a></span>
<span class="normal"><a href="#__codelineno-0-389">389</a></span>
<span class="normal"><a href="#__codelineno-0-390">390</a></span>
<span class="normal"><a href="#__codelineno-0-391">391</a></span>
<span class="normal"><a href="#__codelineno-0-392">392</a></span>
<span class="normal"><a href="#__codelineno-0-393">393</a></span>
<span class="normal"><a href="#__codelineno-0-394">394</a></span>
<span class="normal"><a href="#__codelineno-0-395">395</a></span>
<span class="normal"><a href="#__codelineno-0-396">396</a></span>
<span class="normal"><a href="#__codelineno-0-397">397</a></span>
<span class="normal"><a href="#__codelineno-0-398">398</a></span>
<span class="normal"><a href="#__codelineno-0-399">399</a></span>
<span class="normal"><a href="#__codelineno-0-400">400</a></span>
<span class="normal"><a href="#__codelineno-0-401">401</a></span>
<span class="normal"><a href="#__codelineno-0-402">402</a></span>
<span class="normal"><a href="#__codelineno-0-403">403</a></span>
<span class="normal"><a href="#__codelineno-0-404">404</a></span>
<span class="normal"><a href="#__codelineno-0-405">405</a></span>
<span class="normal"><a href="#__codelineno-0-406">406</a></span>
<span class="normal"><a href="#__codelineno-0-407">407</a></span>
<span class="normal"><a href="#__codelineno-0-408">408</a></span>
<span class="normal"><a href="#__codelineno-0-409">409</a></span>
<span class="normal"><a href="#__codelineno-0-410">410</a></span>
<span class="normal"><a href="#__codelineno-0-411">411</a></span>
<span class="normal"><a href="#__codelineno-0-412">412</a></span>
<span class="normal"><a href="#__codelineno-0-413">413</a></span>
<span class="normal"><a href="#__codelineno-0-414">414</a></span>
<span class="normal"><a href="#__codelineno-0-415">415</a></span>
<span class="normal"><a href="#__codelineno-0-416">416</a></span>
<span class="normal"><a href="#__codelineno-0-417">417</a></span>
<span class="normal"><a href="#__codelineno-0-418">418</a></span>
<span class="normal"><a href="#__codelineno-0-419">419</a></span>
<span class="normal"><a href="#__codelineno-0-420">420</a></span>
<span class="normal"><a href="#__codelineno-0-421">421</a></span>
<span class="normal"><a href="#__codelineno-0-422">422</a></span>
<span class="normal"><a href="#__codelineno-0-423">423</a></span>
<span class="normal"><a href="#__codelineno-0-424">424</a></span>
<span class="normal"><a href="#__codelineno-0-425">425</a></span>
<span class="normal"><a href="#__codelineno-0-426">426</a></span>
<span class="normal"><a href="#__codelineno-0-427">427</a></span>
<span class="normal"><a href="#__codelineno-0-428">428</a></span>
<span class="normal"><a href="#__codelineno-0-429">429</a></span>
<span class="normal"><a href="#__codelineno-0-430">430</a></span>
<span class="normal"><a href="#__codelineno-0-431">431</a></span>
<span class="normal"><a href="#__codelineno-0-432">432</a></span>
<span class="normal"><a href="#__codelineno-0-433">433</a></span>
<span class="normal"><a href="#__codelineno-0-434">434</a></span>
<span class="normal"><a href="#__codelineno-0-435">435</a></span>
<span class="normal"><a href="#__codelineno-0-436">436</a></span>
<span class="normal"><a href="#__codelineno-0-437">437</a></span>
<span class="normal"><a href="#__codelineno-0-438">438</a></span>
<span class="normal"><a href="#__codelineno-0-439">439</a></span>
<span class="normal"><a href="#__codelineno-0-440">440</a></span>
<span class="normal"><a href="#__codelineno-0-441">441</a></span>
<span class="normal"><a href="#__codelineno-0-442">442</a></span>
<span class="normal"><a href="#__codelineno-0-443">443</a></span>
<span class="normal"><a href="#__codelineno-0-444">444</a></span>
<span class="normal"><a href="#__codelineno-0-445">445</a></span>
<span class="normal"><a href="#__codelineno-0-446">446</a></span>
<span class="normal"><a href="#__codelineno-0-447">447</a></span>
<span class="normal"><a href="#__codelineno-0-448">448</a></span>
<span class="normal"><a href="#__codelineno-0-449">449</a></span>
<span class="normal"><a href="#__codelineno-0-450">450</a></span>
<span class="normal"><a href="#__codelineno-0-451">451</a></span>
<span class="normal"><a href="#__codelineno-0-452">452</a></span>
<span class="normal"><a href="#__codelineno-0-453">453</a></span>
<span class="normal"><a href="#__codelineno-0-454">454</a></span>
<span class="normal"><a href="#__codelineno-0-455">455</a></span>
<span class="normal"><a href="#__codelineno-0-456">456</a></span>
<span class="normal"><a href="#__codelineno-0-457">457</a></span>
<span class="normal"><a href="#__codelineno-0-458">458</a></span>
<span class="normal"><a href="#__codelineno-0-459">459</a></span>
<span class="normal"><a href="#__codelineno-0-460">460</a></span>
<span class="normal"><a href="#__codelineno-0-461">461</a></span>
<span class="normal"><a href="#__codelineno-0-462">462</a></span>
<span class="normal"><a href="#__codelineno-0-463">463</a></span>
<span class="normal"><a href="#__codelineno-0-464">464</a></span>
<span class="normal"><a href="#__codelineno-0-465">465</a></span>
<span class="normal"><a href="#__codelineno-0-466">466</a></span>
<span class="normal"><a href="#__codelineno-0-467">467</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-300" name="__codelineno-0-300"></a><span class="k">def</span><span class="w"> </span><span class="nf">prepare_array</span><span class="p">(</span>
<a id="__codelineno-0-301" name="__codelineno-0-301"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-302" name="__codelineno-0-302"></a>    <span class="n">array</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
<a id="__codelineno-0-303" name="__codelineno-0-303"></a>    <span class="n">rgb</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-304" name="__codelineno-0-304"></a>    <span class="n">surface_reflectance</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-305" name="__codelineno-0-305"></a>    <span class="n">cutoff</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-306" name="__codelineno-0-306"></a>    <span class="n">percentile</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-307" name="__codelineno-0-307"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-308" name="__codelineno-0-308"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Prepare an array for RGB visualization.</span>
<a id="__codelineno-0-309" name="__codelineno-0-309"></a>
<a id="__codelineno-0-310" name="__codelineno-0-310"></a><span class="sd">    This method processes a multi-band array to create an RGB image suitable for visualization.</span>
<a id="__codelineno-0-311" name="__codelineno-0-311"></a><span class="sd">    It can normalize the data using either percentile-based scaling or surface reflectance values.</span>
<a id="__codelineno-0-312" name="__codelineno-0-312"></a>
<a id="__codelineno-0-313" name="__codelineno-0-313"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-314" name="__codelineno-0-314"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-315" name="__codelineno-0-315"></a><span class="sd">    array : np.ndarray</span>
<a id="__codelineno-0-316" name="__codelineno-0-316"></a><span class="sd">        The input array containing multiple bands. For RGB visualization,</span>
<a id="__codelineno-0-317" name="__codelineno-0-317"></a><span class="sd">        this should be a 3D array where the first dimension represents the bands.</span>
<a id="__codelineno-0-318" name="__codelineno-0-318"></a><span class="sd">    rgb : List[int], optional</span>
<a id="__codelineno-0-319" name="__codelineno-0-319"></a><span class="sd">        The indices of the red, green, and blue bands in the given array, by default None.</span>
<a id="__codelineno-0-320" name="__codelineno-0-320"></a><span class="sd">        If None, assumes the order is [3, 2, 1] (common for Sentinel-2 data).</span>
<a id="__codelineno-0-321" name="__codelineno-0-321"></a><span class="sd">    surface_reflectance : int, optional</span>
<a id="__codelineno-0-322" name="__codelineno-0-322"></a><span class="sd">        Surface reflectance value for normalizing satellite data, by default None.</span>
<a id="__codelineno-0-323" name="__codelineno-0-323"></a><span class="sd">        Typically 10000 for Sentinel-2 data or 255 for 8-bit imagery.</span>
<a id="__codelineno-0-324" name="__codelineno-0-324"></a><span class="sd">        Used to scale values to the range [0, 1].</span>
<a id="__codelineno-0-325" name="__codelineno-0-325"></a><span class="sd">    cutoff : List, optional</span>
<a id="__codelineno-0-326" name="__codelineno-0-326"></a><span class="sd">        Clip the range of pixel values for each band, by default None.</span>
<a id="__codelineno-0-327" name="__codelineno-0-327"></a><span class="sd">        Takes only pixel values from 0 to the value of the cutoff and scales them back to between 0 and 1.</span>
<a id="__codelineno-0-328" name="__codelineno-0-328"></a><span class="sd">        Should be a list with one value per band.</span>
<a id="__codelineno-0-329" name="__codelineno-0-329"></a><span class="sd">    percentile : int, optional</span>
<a id="__codelineno-0-330" name="__codelineno-0-330"></a><span class="sd">        The percentile value to be used for scaling the array values, by default None.</span>
<a id="__codelineno-0-331" name="__codelineno-0-331"></a><span class="sd">        Used to enhance contrast by stretching the histogram.</span>
<a id="__codelineno-0-332" name="__codelineno-0-332"></a><span class="sd">        If provided, this takes precedence over surface_reflectance.</span>
<a id="__codelineno-0-333" name="__codelineno-0-333"></a>
<a id="__codelineno-0-334" name="__codelineno-0-334"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-335" name="__codelineno-0-335"></a><span class="sd">    -------</span>
<a id="__codelineno-0-336" name="__codelineno-0-336"></a><span class="sd">    np.ndarray</span>
<a id="__codelineno-0-337" name="__codelineno-0-337"></a><span class="sd">        The prepared array with shape (height, width, 3) suitable for RGB visualization.</span>
<a id="__codelineno-0-338" name="__codelineno-0-338"></a><span class="sd">        Values are normalized to the range [0, 1].</span>
<a id="__codelineno-0-339" name="__codelineno-0-339"></a><span class="sd">        the rgb 3d array is converted into 2d array to be plotted using the plt.imshow function.</span>
<a id="__codelineno-0-340" name="__codelineno-0-340"></a><span class="sd">        a float32 array normalized between 0 and 1 using the `percentile` values or the `surface_reflectance`.</span>
<a id="__codelineno-0-341" name="__codelineno-0-341"></a><span class="sd">        if the `percentile` or `surface_reflectance` values are not given, the function just reorders the values</span>
<a id="__codelineno-0-342" name="__codelineno-0-342"></a><span class="sd">        to have the red-green-blue order.</span>
<a id="__codelineno-0-343" name="__codelineno-0-343"></a>
<a id="__codelineno-0-344" name="__codelineno-0-344"></a><span class="sd">    Raises</span>
<a id="__codelineno-0-345" name="__codelineno-0-345"></a><span class="sd">    ------</span>
<a id="__codelineno-0-346" name="__codelineno-0-346"></a><span class="sd">    ValueError</span>
<a id="__codelineno-0-347" name="__codelineno-0-347"></a><span class="sd">        If the array shape is incompatible with the provided RGB indices.</span>
<a id="__codelineno-0-348" name="__codelineno-0-348"></a>
<a id="__codelineno-0-349" name="__codelineno-0-349"></a><span class="sd">    Notes</span>
<a id="__codelineno-0-350" name="__codelineno-0-350"></a><span class="sd">    -----</span>
<a id="__codelineno-0-351" name="__codelineno-0-351"></a><span class="sd">        - The `prepare_array` function is called in the constructor of the `ArrayGlyph` class to prepare the array,</span>
<a id="__codelineno-0-352" name="__codelineno-0-352"></a><span class="sd">          so you can provide the same parameters of the `prepare_array` function to the `ArrayGlyph constructor`.</span>
<a id="__codelineno-0-353" name="__codelineno-0-353"></a><span class="sd">        - The prepare function moves the first axes (the channel axis) to the last axes, and then scales the array</span>
<a id="__codelineno-0-354" name="__codelineno-0-354"></a><span class="sd">          using the percentile values. If the percentile is not given, the function scales the array using the</span>
<a id="__codelineno-0-355" name="__codelineno-0-355"></a><span class="sd">          surface reflectance values. If the surface reflectance is not given, the function scales the array using</span>
<a id="__codelineno-0-356" name="__codelineno-0-356"></a><span class="sd">          the cutoff values. If the cutoff is not given, the function scales the array using the sentinel data</span>
<a id="__codelineno-0-357" name="__codelineno-0-357"></a>
<a id="__codelineno-0-358" name="__codelineno-0-358"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-359" name="__codelineno-0-359"></a><span class="sd">    --------</span>
<a id="__codelineno-0-360" name="__codelineno-0-360"></a><span class="sd">    Prepare an array using percentile-based scaling:</span>
<a id="__codelineno-0-361" name="__codelineno-0-361"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-362" name="__codelineno-0-362"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-363" name="__codelineno-0-363"></a><span class="sd">        &gt;&gt;&gt; from cleopatra.array_glyph import ArrayGlyph</span>
<a id="__codelineno-0-364" name="__codelineno-0-364"></a><span class="sd">        &gt;&gt;&gt; # Create a 3-band array (e.g., satellite image)</span>
<a id="__codelineno-0-365" name="__codelineno-0-365"></a><span class="sd">        &gt;&gt;&gt; bands = np.random.randint(0, 10000, size=(3, 100, 100))</span>
<a id="__codelineno-0-366" name="__codelineno-0-366"></a><span class="sd">        &gt;&gt;&gt; glyph = ArrayGlyph(np.zeros((1, 1)))  # Dummy initialization</span>
<a id="__codelineno-0-367" name="__codelineno-0-367"></a><span class="sd">        &gt;&gt;&gt; rgb_array = glyph.prepare_array(bands, rgb=[0, 1, 2], percentile=2)</span>
<a id="__codelineno-0-368" name="__codelineno-0-368"></a><span class="sd">        &gt;&gt;&gt; rgb_array.shape</span>
<a id="__codelineno-0-369" name="__codelineno-0-369"></a><span class="sd">        (100, 100, 3)</span>
<a id="__codelineno-0-370" name="__codelineno-0-370"></a><span class="sd">        &gt;&gt;&gt; np.all((0 &lt;= rgb_array) &amp; (rgb_array &lt;= 1))</span>
<a id="__codelineno-0-371" name="__codelineno-0-371"></a><span class="sd">        True</span>
<a id="__codelineno-0-372" name="__codelineno-0-372"></a>
<a id="__codelineno-0-373" name="__codelineno-0-373"></a><span class="sd">        ```</span>
<a id="__codelineno-0-374" name="__codelineno-0-374"></a><span class="sd">    Prepare an array using surface reflectance normalization:</span>
<a id="__codelineno-0-375" name="__codelineno-0-375"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-376" name="__codelineno-0-376"></a><span class="sd">        &gt;&gt;&gt; rgb_array = glyph.prepare_array(bands, rgb=[0, 1, 2], surface_reflectance=10000)</span>
<a id="__codelineno-0-377" name="__codelineno-0-377"></a><span class="sd">        &gt;&gt;&gt; rgb_array.shape</span>
<a id="__codelineno-0-378" name="__codelineno-0-378"></a><span class="sd">        (100, 100, 3)</span>
<a id="__codelineno-0-379" name="__codelineno-0-379"></a><span class="sd">        &gt;&gt;&gt; np.all((0 &lt;= rgb_array) &amp; (rgb_array &lt;= 1))</span>
<a id="__codelineno-0-380" name="__codelineno-0-380"></a><span class="sd">        True</span>
<a id="__codelineno-0-381" name="__codelineno-0-381"></a>
<a id="__codelineno-0-382" name="__codelineno-0-382"></a><span class="sd">        ```</span>
<a id="__codelineno-0-383" name="__codelineno-0-383"></a><span class="sd">    Prepare an array with cutoff values:</span>
<a id="__codelineno-0-384" name="__codelineno-0-384"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-385" name="__codelineno-0-385"></a><span class="sd">        &gt;&gt;&gt; rgb_array = glyph.prepare_array(</span>
<a id="__codelineno-0-386" name="__codelineno-0-386"></a><span class="sd">        ...     bands, rgb=[0, 1, 2], surface_reflectance=10000, cutoff=[5000, 5000, 5000]</span>
<a id="__codelineno-0-387" name="__codelineno-0-387"></a><span class="sd">        ... )</span>
<a id="__codelineno-0-388" name="__codelineno-0-388"></a><span class="sd">        &gt;&gt;&gt; rgb_array.shape</span>
<a id="__codelineno-0-389" name="__codelineno-0-389"></a><span class="sd">        (100, 100, 3)</span>
<a id="__codelineno-0-390" name="__codelineno-0-390"></a><span class="sd">        &gt;&gt;&gt; np.all((0 &lt;= rgb_array) &amp; (rgb_array &lt;= 1))</span>
<a id="__codelineno-0-391" name="__codelineno-0-391"></a><span class="sd">        True</span>
<a id="__codelineno-0-392" name="__codelineno-0-392"></a>
<a id="__codelineno-0-393" name="__codelineno-0-393"></a><span class="sd">        ```</span>
<a id="__codelineno-0-394" name="__codelineno-0-394"></a>
<a id="__codelineno-0-395" name="__codelineno-0-395"></a><span class="sd">    - Create an array and instantiate the `ArrayGlyph` class.</span>
<a id="__codelineno-0-396" name="__codelineno-0-396"></a><span class="sd">        ```python</span>
<a id="__codelineno-0-397" name="__codelineno-0-397"></a><span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-398" name="__codelineno-0-398"></a><span class="sd">        &gt;&gt;&gt; arr = np.random.randint(0, 255, size=(3, 5, 5)).astype(np.float32)</span>
<a id="__codelineno-0-399" name="__codelineno-0-399"></a><span class="sd">        &gt;&gt;&gt; array_glyph = ArrayGlyph(arr)</span>
<a id="__codelineno-0-400" name="__codelineno-0-400"></a><span class="sd">        &gt;&gt;&gt; print(array_glyph.arr.shape)</span>
<a id="__codelineno-0-401" name="__codelineno-0-401"></a><span class="sd">        (3, 5, 5)</span>
<a id="__codelineno-0-402" name="__codelineno-0-402"></a>
<a id="__codelineno-0-403" name="__codelineno-0-403"></a><span class="sd">        ```</span>
<a id="__codelineno-0-404" name="__codelineno-0-404"></a><span class="sd">    `rgb` channels:</span>
<a id="__codelineno-0-405" name="__codelineno-0-405"></a><span class="sd">        - Now let&#39;s use the `prepare_array` function with `rgb` channels as [0, 1, 2]. so the finction does not to</span>
<a id="__codelineno-0-406" name="__codelineno-0-406"></a><span class="sd">            reorder the chennels. but it just needs to move the first axis to the last axis.</span>
<a id="__codelineno-0-407" name="__codelineno-0-407"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-408" name="__codelineno-0-408"></a><span class="sd">            &gt;&gt;&gt; rgb_array = array_glyph.prepare_array(arr, rgb=[0, 1, 2])</span>
<a id="__codelineno-0-409" name="__codelineno-0-409"></a><span class="sd">            &gt;&gt;&gt; print(rgb_array.shape)</span>
<a id="__codelineno-0-410" name="__codelineno-0-410"></a><span class="sd">            (5, 5, 3)</span>
<a id="__codelineno-0-411" name="__codelineno-0-411"></a>
<a id="__codelineno-0-412" name="__codelineno-0-412"></a><span class="sd">            ```</span>
<a id="__codelineno-0-413" name="__codelineno-0-413"></a><span class="sd">        - If we compare the values of the first channel in the original array with the first array in the rgb array it</span>
<a id="__codelineno-0-414" name="__codelineno-0-414"></a><span class="sd">            should be the same.</span>
<a id="__codelineno-0-415" name="__codelineno-0-415"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-416" name="__codelineno-0-416"></a><span class="sd">            &gt;&gt;&gt; np.testing.assert_equal(arr[0, :, :],rgb_array[:, :, 0])</span>
<a id="__codelineno-0-417" name="__codelineno-0-417"></a>
<a id="__codelineno-0-418" name="__codelineno-0-418"></a><span class="sd">            ```</span>
<a id="__codelineno-0-419" name="__codelineno-0-419"></a><span class="sd">    surface_reflectance:</span>
<a id="__codelineno-0-420" name="__codelineno-0-420"></a><span class="sd">        - if you provide the surface reflectance value, the function will scale the array using the surface reflectance</span>
<a id="__codelineno-0-421" name="__codelineno-0-421"></a><span class="sd">            value to a normalized rgb values.</span>
<a id="__codelineno-0-422" name="__codelineno-0-422"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-423" name="__codelineno-0-423"></a><span class="sd">            &gt;&gt;&gt; array_glyph = ArrayGlyph(arr)</span>
<a id="__codelineno-0-424" name="__codelineno-0-424"></a><span class="sd">            &gt;&gt;&gt; rgb_array = array_glyph.prepare_array(arr, surface_reflectance=10000, rgb=[0, 1, 2])</span>
<a id="__codelineno-0-425" name="__codelineno-0-425"></a><span class="sd">            &gt;&gt;&gt; print(rgb_array.shape)</span>
<a id="__codelineno-0-426" name="__codelineno-0-426"></a><span class="sd">            (5, 5, 3)</span>
<a id="__codelineno-0-427" name="__codelineno-0-427"></a>
<a id="__codelineno-0-428" name="__codelineno-0-428"></a><span class="sd">            ```</span>
<a id="__codelineno-0-429" name="__codelineno-0-429"></a><span class="sd">        - if you print the values of the first channel, you will find all the values are between 0 and 1.</span>
<a id="__codelineno-0-430" name="__codelineno-0-430"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-431" name="__codelineno-0-431"></a><span class="sd">            &gt;&gt;&gt; print(rgb_array[:, :, 0])</span>
<a id="__codelineno-0-432" name="__codelineno-0-432"></a><span class="sd">            [[0.0195 0.02   0.0109 0.0211 0.0087]</span>
<a id="__codelineno-0-433" name="__codelineno-0-433"></a><span class="sd">             [0.0112 0.0221 0.0035 0.0234 0.0141]</span>
<a id="__codelineno-0-434" name="__codelineno-0-434"></a><span class="sd">             [0.0116 0.0188 0.0001 0.0176 0.    ]</span>
<a id="__codelineno-0-435" name="__codelineno-0-435"></a><span class="sd">             [0.0014 0.0147 0.0043 0.0167 0.0117]</span>
<a id="__codelineno-0-436" name="__codelineno-0-436"></a><span class="sd">             [0.0083 0.0139 0.0186 0.02   0.0058]]</span>
<a id="__codelineno-0-437" name="__codelineno-0-437"></a>
<a id="__codelineno-0-438" name="__codelineno-0-438"></a><span class="sd">            ```</span>
<a id="__codelineno-0-439" name="__codelineno-0-439"></a><span class="sd">        - With the `surface_reflectance` parameter, you can also use the `cutoff` parameter to affect values that</span>
<a id="__codelineno-0-440" name="__codelineno-0-440"></a><span class="sd">            are above it, by rescaling them.</span>
<a id="__codelineno-0-441" name="__codelineno-0-441"></a><span class="sd">            ```python</span>
<a id="__codelineno-0-442" name="__codelineno-0-442"></a><span class="sd">            &gt;&gt;&gt; rgb_array = array_glyph.prepare_array(</span>
<a id="__codelineno-0-443" name="__codelineno-0-443"></a><span class="sd">            ...     arr, surface_reflectance=10000, rgb=[0, 1, 2], cutoff=[0.8, 0.8, 0.8]</span>
<a id="__codelineno-0-444" name="__codelineno-0-444"></a><span class="sd">            ... )</span>
<a id="__codelineno-0-445" name="__codelineno-0-445"></a><span class="sd">            &gt;&gt;&gt; print(rgb_array[:, :, 0])</span>
<a id="__codelineno-0-446" name="__codelineno-0-446"></a><span class="sd">            [[0.     0.     0.     0.     0.    ]</span>
<a id="__codelineno-0-447" name="__codelineno-0-447"></a><span class="sd">             [1.     1.     1.     1.     1.    ]</span>
<a id="__codelineno-0-448" name="__codelineno-0-448"></a><span class="sd">             [1.     1.     1.     1.     1.    ]</span>
<a id="__codelineno-0-449" name="__codelineno-0-449"></a><span class="sd">             [0.0014 0.0147 0.0043 0.0167 0.0117]</span>
<a id="__codelineno-0-450" name="__codelineno-0-450"></a><span class="sd">             [0.0083 0.0139 0.0186 0.02   0.0058]]</span>
<a id="__codelineno-0-451" name="__codelineno-0-451"></a>
<a id="__codelineno-0-452" name="__codelineno-0-452"></a><span class="sd">            ```</span>
<a id="__codelineno-0-453" name="__codelineno-0-453"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-454" name="__codelineno-0-454"></a>    <span class="c1"># take the rgb arrays and reorder them to have the red-green-blue, if the order is not given, assume the</span>
<a id="__codelineno-0-455" name="__codelineno-0-455"></a>    <span class="c1"># order as sentinel data. [3, 2, 1]</span>
<a id="__codelineno-0-456" name="__codelineno-0-456"></a>    <span class="n">array</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">rgb</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-457" name="__codelineno-0-457"></a>
<a id="__codelineno-0-458" name="__codelineno-0-458"></a>    <span class="k">if</span> <span class="n">percentile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-459" name="__codelineno-0-459"></a>        <span class="n">array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale_percentile</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">percentile</span><span class="o">=</span><span class="n">percentile</span><span class="p">)</span>
<a id="__codelineno-0-460" name="__codelineno-0-460"></a>    <span class="k">elif</span> <span class="n">surface_reflectance</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-461" name="__codelineno-0-461"></a>        <span class="n">array</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_sentinel_rgb</span><span class="p">(</span>
<a id="__codelineno-0-462" name="__codelineno-0-462"></a>            <span class="n">array</span><span class="p">,</span>
<a id="__codelineno-0-463" name="__codelineno-0-463"></a>            <span class="n">rgb</span><span class="o">=</span><span class="n">rgb</span><span class="p">,</span>
<a id="__codelineno-0-464" name="__codelineno-0-464"></a>            <span class="n">surface_reflectance</span><span class="o">=</span><span class="n">surface_reflectance</span><span class="p">,</span>
<a id="__codelineno-0-465" name="__codelineno-0-465"></a>            <span class="n">cutoff</span><span class="o">=</span><span class="n">cutoff</span><span class="p">,</span>
<a id="__codelineno-0-466" name="__codelineno-0-466"></a>        <span class="p">)</span>
<a id="__codelineno-0-467" name="__codelineno-0-467"></a>    <span class="k">return</span> <span class="n">array</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="cleopatra.array_glyph.ArrayGlyph.save_animation" class="doc doc-heading"><a href="#cleopatra.array_glyph.ArrayGlyph.save_animation" class="toclink">
            <code class="highlight language-python"><span class="n">save_animation</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></code>

</a><a href="#cleopatra.array_glyph.ArrayGlyph.save_animation" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Save the animation to a file.</p>
<p>This method saves the animation created by the <code>animate</code> method to a file.
The format of the output file is determined by the file extension in the path.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The file path where the animation will be saved.
The file extension determines the output format.
Supported formats: gif, mov, avi, mp4.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fps</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Frames per second for the saved animation, by default 2.
Higher values create faster animations, lower values create slower animations.</p>
              </div>
            </td>
            <td>
                  <code>2</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the file extension is not one of the supported formats.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="FileNotFoundError">FileNotFoundError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If FFmpeg is not installed (required for mov, avi, and mp4 formats).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <ul>
<li>For GIF format, the PillowWriter is used.</li>
<li>For MOV, AVI, and MP4 formats, FFMpegWriter is used, which requires FFmpeg to be installed.</li>
<li>You can download FFmpeg from https://ffmpeg.org/</li>
</ul>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <p>Save an animation as a GIF file:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">cleopatra.array_glyph</span><span class="w"> </span><span class="kn">import</span> <span class="n">ArrayGlyph</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Create a 3D array with 5 frames, each 10x10</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">frame_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Frame 1&quot;</span><span class="p">,</span> <span class="s2">&quot;Frame 2&quot;</span><span class="p">,</span> <span class="s2">&quot;Frame 3&quot;</span><span class="p">,</span> <span class="s2">&quot;Frame 4&quot;</span><span class="p">,</span> <span class="s2">&quot;Frame 5&quot;</span><span class="p">]</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">animated_array</span> <span class="o">=</span> <span class="n">ArrayGlyph</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">anim_obj</span> <span class="o">=</span> <span class="n">animated_array</span><span class="o">.</span><span class="n">animate</span><span class="p">(</span><span class="n">frame_labels</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">animated_array</span><span class="o">.</span><span class="n">save_animation</span><span class="p">(</span><span class="s2">&quot;animation.gif&quot;</span><span class="p">)</span>
</code></pre></div>
Save with a higher frame rate for a faster animation:
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">animated_array</span><span class="o">.</span><span class="n">save_animation</span><span class="p">(</span><span class="s2">&quot;animation.gif&quot;</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div>
Save in MP4 format (requires FFmpeg):
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">animated_array</span><span class="o">.</span><span class="n">save_animation</span><span class="p">(</span><span class="s2">&quot;animation.mp4&quot;</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div></p>


            <details class="quote">
              <summary>Source code in <code>cleopatra/array_glyph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1804">1804</a></span>
<span class="normal"><a href="#__codelineno-0-1805">1805</a></span>
<span class="normal"><a href="#__codelineno-0-1806">1806</a></span>
<span class="normal"><a href="#__codelineno-0-1807">1807</a></span>
<span class="normal"><a href="#__codelineno-0-1808">1808</a></span>
<span class="normal"><a href="#__codelineno-0-1809">1809</a></span>
<span class="normal"><a href="#__codelineno-0-1810">1810</a></span>
<span class="normal"><a href="#__codelineno-0-1811">1811</a></span>
<span class="normal"><a href="#__codelineno-0-1812">1812</a></span>
<span class="normal"><a href="#__codelineno-0-1813">1813</a></span>
<span class="normal"><a href="#__codelineno-0-1814">1814</a></span>
<span class="normal"><a href="#__codelineno-0-1815">1815</a></span>
<span class="normal"><a href="#__codelineno-0-1816">1816</a></span>
<span class="normal"><a href="#__codelineno-0-1817">1817</a></span>
<span class="normal"><a href="#__codelineno-0-1818">1818</a></span>
<span class="normal"><a href="#__codelineno-0-1819">1819</a></span>
<span class="normal"><a href="#__codelineno-0-1820">1820</a></span>
<span class="normal"><a href="#__codelineno-0-1821">1821</a></span>
<span class="normal"><a href="#__codelineno-0-1822">1822</a></span>
<span class="normal"><a href="#__codelineno-0-1823">1823</a></span>
<span class="normal"><a href="#__codelineno-0-1824">1824</a></span>
<span class="normal"><a href="#__codelineno-0-1825">1825</a></span>
<span class="normal"><a href="#__codelineno-0-1826">1826</a></span>
<span class="normal"><a href="#__codelineno-0-1827">1827</a></span>
<span class="normal"><a href="#__codelineno-0-1828">1828</a></span>
<span class="normal"><a href="#__codelineno-0-1829">1829</a></span>
<span class="normal"><a href="#__codelineno-0-1830">1830</a></span>
<span class="normal"><a href="#__codelineno-0-1831">1831</a></span>
<span class="normal"><a href="#__codelineno-0-1832">1832</a></span>
<span class="normal"><a href="#__codelineno-0-1833">1833</a></span>
<span class="normal"><a href="#__codelineno-0-1834">1834</a></span>
<span class="normal"><a href="#__codelineno-0-1835">1835</a></span>
<span class="normal"><a href="#__codelineno-0-1836">1836</a></span>
<span class="normal"><a href="#__codelineno-0-1837">1837</a></span>
<span class="normal"><a href="#__codelineno-0-1838">1838</a></span>
<span class="normal"><a href="#__codelineno-0-1839">1839</a></span>
<span class="normal"><a href="#__codelineno-0-1840">1840</a></span>
<span class="normal"><a href="#__codelineno-0-1841">1841</a></span>
<span class="normal"><a href="#__codelineno-0-1842">1842</a></span>
<span class="normal"><a href="#__codelineno-0-1843">1843</a></span>
<span class="normal"><a href="#__codelineno-0-1844">1844</a></span>
<span class="normal"><a href="#__codelineno-0-1845">1845</a></span>
<span class="normal"><a href="#__codelineno-0-1846">1846</a></span>
<span class="normal"><a href="#__codelineno-0-1847">1847</a></span>
<span class="normal"><a href="#__codelineno-0-1848">1848</a></span>
<span class="normal"><a href="#__codelineno-0-1849">1849</a></span>
<span class="normal"><a href="#__codelineno-0-1850">1850</a></span>
<span class="normal"><a href="#__codelineno-0-1851">1851</a></span>
<span class="normal"><a href="#__codelineno-0-1852">1852</a></span>
<span class="normal"><a href="#__codelineno-0-1853">1853</a></span>
<span class="normal"><a href="#__codelineno-0-1854">1854</a></span>
<span class="normal"><a href="#__codelineno-0-1855">1855</a></span>
<span class="normal"><a href="#__codelineno-0-1856">1856</a></span>
<span class="normal"><a href="#__codelineno-0-1857">1857</a></span>
<span class="normal"><a href="#__codelineno-0-1858">1858</a></span>
<span class="normal"><a href="#__codelineno-0-1859">1859</a></span>
<span class="normal"><a href="#__codelineno-0-1860">1860</a></span>
<span class="normal"><a href="#__codelineno-0-1861">1861</a></span>
<span class="normal"><a href="#__codelineno-0-1862">1862</a></span>
<span class="normal"><a href="#__codelineno-0-1863">1863</a></span>
<span class="normal"><a href="#__codelineno-0-1864">1864</a></span>
<span class="normal"><a href="#__codelineno-0-1865">1865</a></span>
<span class="normal"><a href="#__codelineno-0-1866">1866</a></span>
<span class="normal"><a href="#__codelineno-0-1867">1867</a></span>
<span class="normal"><a href="#__codelineno-0-1868">1868</a></span>
<span class="normal"><a href="#__codelineno-0-1869">1869</a></span>
<span class="normal"><a href="#__codelineno-0-1870">1870</a></span>
<span class="normal"><a href="#__codelineno-0-1871">1871</a></span>
<span class="normal"><a href="#__codelineno-0-1872">1872</a></span>
<span class="normal"><a href="#__codelineno-0-1873">1873</a></span>
<span class="normal"><a href="#__codelineno-0-1874">1874</a></span>
<span class="normal"><a href="#__codelineno-0-1875">1875</a></span>
<span class="normal"><a href="#__codelineno-0-1876">1876</a></span>
<span class="normal"><a href="#__codelineno-0-1877">1877</a></span>
<span class="normal"><a href="#__codelineno-0-1878">1878</a></span>
<span class="normal"><a href="#__codelineno-0-1879">1879</a></span>
<span class="normal"><a href="#__codelineno-0-1880">1880</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1804" name="__codelineno-0-1804"></a><span class="k">def</span><span class="w"> </span><span class="nf">save_animation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">fps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">):</span>
<a id="__codelineno-0-1805" name="__codelineno-0-1805"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Save the animation to a file.</span>
<a id="__codelineno-0-1806" name="__codelineno-0-1806"></a>
<a id="__codelineno-0-1807" name="__codelineno-0-1807"></a><span class="sd">    This method saves the animation created by the `animate` method to a file.</span>
<a id="__codelineno-0-1808" name="__codelineno-0-1808"></a><span class="sd">    The format of the output file is determined by the file extension in the path.</span>
<a id="__codelineno-0-1809" name="__codelineno-0-1809"></a>
<a id="__codelineno-0-1810" name="__codelineno-0-1810"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-1811" name="__codelineno-0-1811"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-1812" name="__codelineno-0-1812"></a><span class="sd">    path : str</span>
<a id="__codelineno-0-1813" name="__codelineno-0-1813"></a><span class="sd">        The file path where the animation will be saved.</span>
<a id="__codelineno-0-1814" name="__codelineno-0-1814"></a><span class="sd">        The file extension determines the output format.</span>
<a id="__codelineno-0-1815" name="__codelineno-0-1815"></a><span class="sd">        Supported formats: gif, mov, avi, mp4.</span>
<a id="__codelineno-0-1816" name="__codelineno-0-1816"></a><span class="sd">    fps : int, optional</span>
<a id="__codelineno-0-1817" name="__codelineno-0-1817"></a><span class="sd">        Frames per second for the saved animation, by default 2.</span>
<a id="__codelineno-0-1818" name="__codelineno-0-1818"></a><span class="sd">        Higher values create faster animations, lower values create slower animations.</span>
<a id="__codelineno-0-1819" name="__codelineno-0-1819"></a>
<a id="__codelineno-0-1820" name="__codelineno-0-1820"></a><span class="sd">    Raises</span>
<a id="__codelineno-0-1821" name="__codelineno-0-1821"></a><span class="sd">    ------</span>
<a id="__codelineno-0-1822" name="__codelineno-0-1822"></a><span class="sd">    ValueError</span>
<a id="__codelineno-0-1823" name="__codelineno-0-1823"></a><span class="sd">        If the file extension is not one of the supported formats.</span>
<a id="__codelineno-0-1824" name="__codelineno-0-1824"></a><span class="sd">    FileNotFoundError</span>
<a id="__codelineno-0-1825" name="__codelineno-0-1825"></a><span class="sd">        If FFmpeg is not installed (required for mov, avi, and mp4 formats).</span>
<a id="__codelineno-0-1826" name="__codelineno-0-1826"></a>
<a id="__codelineno-0-1827" name="__codelineno-0-1827"></a><span class="sd">    Notes</span>
<a id="__codelineno-0-1828" name="__codelineno-0-1828"></a><span class="sd">    -----</span>
<a id="__codelineno-0-1829" name="__codelineno-0-1829"></a><span class="sd">    - For GIF format, the PillowWriter is used.</span>
<a id="__codelineno-0-1830" name="__codelineno-0-1830"></a><span class="sd">    - For MOV, AVI, and MP4 formats, FFMpegWriter is used, which requires FFmpeg to be installed.</span>
<a id="__codelineno-0-1831" name="__codelineno-0-1831"></a><span class="sd">    - You can download FFmpeg from https://ffmpeg.org/</span>
<a id="__codelineno-0-1832" name="__codelineno-0-1832"></a>
<a id="__codelineno-0-1833" name="__codelineno-0-1833"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-1834" name="__codelineno-0-1834"></a><span class="sd">    --------</span>
<a id="__codelineno-0-1835" name="__codelineno-0-1835"></a><span class="sd">    Save an animation as a GIF file:</span>
<a id="__codelineno-0-1836" name="__codelineno-0-1836"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-1837" name="__codelineno-0-1837"></a><span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-1838" name="__codelineno-0-1838"></a><span class="sd">    &gt;&gt;&gt; from cleopatra.array_glyph import ArrayGlyph</span>
<a id="__codelineno-0-1839" name="__codelineno-0-1839"></a><span class="sd">    &gt;&gt;&gt; # Create a 3D array with 5 frames, each 10x10</span>
<a id="__codelineno-0-1840" name="__codelineno-0-1840"></a><span class="sd">    &gt;&gt;&gt; arr = np.random.randint(1, 10, size=(5, 10, 10))</span>
<a id="__codelineno-0-1841" name="__codelineno-0-1841"></a><span class="sd">    &gt;&gt;&gt; frame_labels = [&quot;Frame 1&quot;, &quot;Frame 2&quot;, &quot;Frame 3&quot;, &quot;Frame 4&quot;, &quot;Frame 5&quot;]</span>
<a id="__codelineno-0-1842" name="__codelineno-0-1842"></a><span class="sd">    &gt;&gt;&gt; animated_array = ArrayGlyph(arr)</span>
<a id="__codelineno-0-1843" name="__codelineno-0-1843"></a><span class="sd">    &gt;&gt;&gt; anim_obj = animated_array.animate(frame_labels)</span>
<a id="__codelineno-0-1844" name="__codelineno-0-1844"></a><span class="sd">    &gt;&gt;&gt; animated_array.save_animation(&quot;animation.gif&quot;)</span>
<a id="__codelineno-0-1845" name="__codelineno-0-1845"></a>
<a id="__codelineno-0-1846" name="__codelineno-0-1846"></a><span class="sd">    ```</span>
<a id="__codelineno-0-1847" name="__codelineno-0-1847"></a><span class="sd">    Save with a higher frame rate for a faster animation:</span>
<a id="__codelineno-0-1848" name="__codelineno-0-1848"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-1849" name="__codelineno-0-1849"></a><span class="sd">    &gt;&gt;&gt; animated_array.save_animation(&quot;animation.gif&quot;, fps=5)</span>
<a id="__codelineno-0-1850" name="__codelineno-0-1850"></a>
<a id="__codelineno-0-1851" name="__codelineno-0-1851"></a><span class="sd">    ```</span>
<a id="__codelineno-0-1852" name="__codelineno-0-1852"></a><span class="sd">    Save in MP4 format (requires FFmpeg):</span>
<a id="__codelineno-0-1853" name="__codelineno-0-1853"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-1854" name="__codelineno-0-1854"></a><span class="sd">    &gt;&gt;&gt; animated_array.save_animation(&quot;animation.mp4&quot;, fps=10)</span>
<a id="__codelineno-0-1855" name="__codelineno-0-1855"></a>
<a id="__codelineno-0-1856" name="__codelineno-0-1856"></a><span class="sd">    ```</span>
<a id="__codelineno-0-1857" name="__codelineno-0-1857"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-1858" name="__codelineno-0-1858"></a>    <span class="n">video_format</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-0-1859" name="__codelineno-0-1859"></a>    <span class="k">if</span> <span class="n">video_format</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">SUPPORTED_VIDEO_FORMAT</span><span class="p">:</span>
<a id="__codelineno-0-1860" name="__codelineno-0-1860"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<a id="__codelineno-0-1861" name="__codelineno-0-1861"></a>            <span class="sa">f</span><span class="s2">&quot;The given extension </span><span class="si">{</span><span class="n">video_format</span><span class="si">}</span><span class="s2"> implies a format that is not supported, &quot;</span>
<a id="__codelineno-0-1862" name="__codelineno-0-1862"></a>            <span class="sa">f</span><span class="s2">&quot;only </span><span class="si">{</span><span class="n">SUPPORTED_VIDEO_FORMAT</span><span class="si">}</span><span class="s2"> are supported&quot;</span>
<a id="__codelineno-0-1863" name="__codelineno-0-1863"></a>        <span class="p">)</span>
<a id="__codelineno-0-1864" name="__codelineno-0-1864"></a>
<a id="__codelineno-0-1865" name="__codelineno-0-1865"></a>    <span class="k">if</span> <span class="n">video_format</span> <span class="o">==</span> <span class="s2">&quot;gif&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1866" name="__codelineno-0-1866"></a>        <span class="n">writer_gif</span> <span class="o">=</span> <span class="n">animation</span><span class="o">.</span><span class="n">PillowWriter</span><span class="p">(</span><span class="n">fps</span><span class="o">=</span><span class="n">fps</span><span class="p">)</span>
<a id="__codelineno-0-1867" name="__codelineno-0-1867"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">anim</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">writer</span><span class="o">=</span><span class="n">writer_gif</span><span class="p">)</span>
<a id="__codelineno-0-1868" name="__codelineno-0-1868"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-1869" name="__codelineno-0-1869"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-1870" name="__codelineno-0-1870"></a>            <span class="k">if</span> <span class="n">video_format</span> <span class="o">==</span> <span class="s2">&quot;avi&quot;</span> <span class="ow">or</span> <span class="n">video_format</span> <span class="o">==</span> <span class="s2">&quot;mov&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1871" name="__codelineno-0-1871"></a>                <span class="n">writer_video</span> <span class="o">=</span> <span class="n">animation</span><span class="o">.</span><span class="n">FFMpegWriter</span><span class="p">(</span><span class="n">fps</span><span class="o">=</span><span class="n">fps</span><span class="p">,</span> <span class="n">bitrate</span><span class="o">=</span><span class="mi">1800</span><span class="p">)</span>
<a id="__codelineno-0-1872" name="__codelineno-0-1872"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">anim</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">writer</span><span class="o">=</span><span class="n">writer_video</span><span class="p">)</span>
<a id="__codelineno-0-1873" name="__codelineno-0-1873"></a>            <span class="k">elif</span> <span class="n">video_format</span> <span class="o">==</span> <span class="s2">&quot;mp4&quot;</span><span class="p">:</span>
<a id="__codelineno-0-1874" name="__codelineno-0-1874"></a>                <span class="n">writer_mp4</span> <span class="o">=</span> <span class="n">animation</span><span class="o">.</span><span class="n">FFMpegWriter</span><span class="p">(</span><span class="n">fps</span><span class="o">=</span><span class="n">fps</span><span class="p">,</span> <span class="n">bitrate</span><span class="o">=</span><span class="mi">1800</span><span class="p">)</span>
<a id="__codelineno-0-1875" name="__codelineno-0-1875"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">anim</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">writer</span><span class="o">=</span><span class="n">writer_mp4</span><span class="p">)</span>
<a id="__codelineno-0-1876" name="__codelineno-0-1876"></a>        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
<a id="__codelineno-0-1877" name="__codelineno-0-1877"></a>            <span class="nb">print</span><span class="p">(</span>
<a id="__codelineno-0-1878" name="__codelineno-0-1878"></a>                <span class="s2">&quot;Please visit https://ffmpeg.org/ and download a version of ffmpeg compatible with your operating&quot;</span>
<a id="__codelineno-0-1879" name="__codelineno-0-1879"></a>                <span class="s2">&quot;system, for more details please check the method definition&quot;</span>
<a id="__codelineno-0-1880" name="__codelineno-0-1880"></a>            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="cleopatra.array_glyph.ArrayGlyph.scale_percentile" class="doc doc-heading"><a href="#cleopatra.array_glyph.ArrayGlyph.scale_percentile" class="toclink">
            <code class="highlight language-python"><span class="n">scale_percentile</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">percentile</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</a><a href="#cleopatra.array_glyph.ArrayGlyph.scale_percentile" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Scale an array using percentile-based contrast stretching.</p>
<p>This method enhances the contrast of an image by stretching the histogram
based on percentile values. It calculates the lower and upper percentile values
for each band and normalizes the data to the range [0, 1].</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>arr</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The array to be scaled, with shape (height, width, bands).
Typically an RGB image with 3 bands.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>percentile</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The percentile value to be used for scaling, by default 1.
This value determines how much of the histogram tails to exclude.
Higher values result in more contrast stretching.
Typical values range from 1 to 5.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The scaled array, normalized between 0 and 1, with the same shape as input.
Data type is float32.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <p>The method works by:
1. Computing the lower percentile value for each band
2. Computing the upper percentile value (100 - percentile) for each band
3. Normalizing each band using these percentile values
4. Clipping values to the range [0, 1]</p>
<p>This is particularly useful for visualizing satellite imagery with high dynamic range.</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <p>Scale a single-band array:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span><span class="w"> </span><span class="nn">cleopatra.array_glyph</span><span class="w"> </span><span class="kn">import</span> <span class="n">ArrayGlyph</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Create a test array with values between 0 and 10000</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">test_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">scaled</span> <span class="o">=</span> <span class="n">ArrayGlyph</span><span class="o">.</span><span class="n">scale_percentile</span><span class="p">(</span><span class="n">test_array</span><span class="p">,</span> <span class="n">percentile</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">scaled</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">scaled</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">scaled</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="n">np</span><span class="o">.</span><span class="n">True_</span>
</code></pre></div>
Scale an RGB array:
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">rgb_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">scaled</span> <span class="o">=</span> <span class="n">ArrayGlyph</span><span class="o">.</span><span class="n">scale_percentile</span><span class="p">(</span><span class="n">rgb_array</span><span class="p">,</span> <span class="n">percentile</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">scaled</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">scaled</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">scaled</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="n">np</span><span class="o">.</span><span class="n">True_</span>
</code></pre></div>
Using different percentile values affects contrast:
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">low_contrast</span> <span class="o">=</span> <span class="n">ArrayGlyph</span><span class="o">.</span><span class="n">scale_percentile</span><span class="p">(</span><span class="n">rgb_array</span><span class="p">,</span> <span class="n">percentile</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="o">&gt;&gt;&gt;</span> <span class="n">high_contrast</span> <span class="o">=</span> <span class="n">ArrayGlyph</span><span class="o">.</span><span class="n">scale_percentile</span><span class="p">(</span><span class="n">rgb_array</span><span class="p">,</span> <span class="n">percentile</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Higher percentile typically results in higher contrast</span>
</code></pre></div></p>


            <details class="quote">
              <summary>Source code in <code>cleopatra/array_glyph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-535">535</a></span>
<span class="normal"><a href="#__codelineno-0-536">536</a></span>
<span class="normal"><a href="#__codelineno-0-537">537</a></span>
<span class="normal"><a href="#__codelineno-0-538">538</a></span>
<span class="normal"><a href="#__codelineno-0-539">539</a></span>
<span class="normal"><a href="#__codelineno-0-540">540</a></span>
<span class="normal"><a href="#__codelineno-0-541">541</a></span>
<span class="normal"><a href="#__codelineno-0-542">542</a></span>
<span class="normal"><a href="#__codelineno-0-543">543</a></span>
<span class="normal"><a href="#__codelineno-0-544">544</a></span>
<span class="normal"><a href="#__codelineno-0-545">545</a></span>
<span class="normal"><a href="#__codelineno-0-546">546</a></span>
<span class="normal"><a href="#__codelineno-0-547">547</a></span>
<span class="normal"><a href="#__codelineno-0-548">548</a></span>
<span class="normal"><a href="#__codelineno-0-549">549</a></span>
<span class="normal"><a href="#__codelineno-0-550">550</a></span>
<span class="normal"><a href="#__codelineno-0-551">551</a></span>
<span class="normal"><a href="#__codelineno-0-552">552</a></span>
<span class="normal"><a href="#__codelineno-0-553">553</a></span>
<span class="normal"><a href="#__codelineno-0-554">554</a></span>
<span class="normal"><a href="#__codelineno-0-555">555</a></span>
<span class="normal"><a href="#__codelineno-0-556">556</a></span>
<span class="normal"><a href="#__codelineno-0-557">557</a></span>
<span class="normal"><a href="#__codelineno-0-558">558</a></span>
<span class="normal"><a href="#__codelineno-0-559">559</a></span>
<span class="normal"><a href="#__codelineno-0-560">560</a></span>
<span class="normal"><a href="#__codelineno-0-561">561</a></span>
<span class="normal"><a href="#__codelineno-0-562">562</a></span>
<span class="normal"><a href="#__codelineno-0-563">563</a></span>
<span class="normal"><a href="#__codelineno-0-564">564</a></span>
<span class="normal"><a href="#__codelineno-0-565">565</a></span>
<span class="normal"><a href="#__codelineno-0-566">566</a></span>
<span class="normal"><a href="#__codelineno-0-567">567</a></span>
<span class="normal"><a href="#__codelineno-0-568">568</a></span>
<span class="normal"><a href="#__codelineno-0-569">569</a></span>
<span class="normal"><a href="#__codelineno-0-570">570</a></span>
<span class="normal"><a href="#__codelineno-0-571">571</a></span>
<span class="normal"><a href="#__codelineno-0-572">572</a></span>
<span class="normal"><a href="#__codelineno-0-573">573</a></span>
<span class="normal"><a href="#__codelineno-0-574">574</a></span>
<span class="normal"><a href="#__codelineno-0-575">575</a></span>
<span class="normal"><a href="#__codelineno-0-576">576</a></span>
<span class="normal"><a href="#__codelineno-0-577">577</a></span>
<span class="normal"><a href="#__codelineno-0-578">578</a></span>
<span class="normal"><a href="#__codelineno-0-579">579</a></span>
<span class="normal"><a href="#__codelineno-0-580">580</a></span>
<span class="normal"><a href="#__codelineno-0-581">581</a></span>
<span class="normal"><a href="#__codelineno-0-582">582</a></span>
<span class="normal"><a href="#__codelineno-0-583">583</a></span>
<span class="normal"><a href="#__codelineno-0-584">584</a></span>
<span class="normal"><a href="#__codelineno-0-585">585</a></span>
<span class="normal"><a href="#__codelineno-0-586">586</a></span>
<span class="normal"><a href="#__codelineno-0-587">587</a></span>
<span class="normal"><a href="#__codelineno-0-588">588</a></span>
<span class="normal"><a href="#__codelineno-0-589">589</a></span>
<span class="normal"><a href="#__codelineno-0-590">590</a></span>
<span class="normal"><a href="#__codelineno-0-591">591</a></span>
<span class="normal"><a href="#__codelineno-0-592">592</a></span>
<span class="normal"><a href="#__codelineno-0-593">593</a></span>
<span class="normal"><a href="#__codelineno-0-594">594</a></span>
<span class="normal"><a href="#__codelineno-0-595">595</a></span>
<span class="normal"><a href="#__codelineno-0-596">596</a></span>
<span class="normal"><a href="#__codelineno-0-597">597</a></span>
<span class="normal"><a href="#__codelineno-0-598">598</a></span>
<span class="normal"><a href="#__codelineno-0-599">599</a></span>
<span class="normal"><a href="#__codelineno-0-600">600</a></span>
<span class="normal"><a href="#__codelineno-0-601">601</a></span>
<span class="normal"><a href="#__codelineno-0-602">602</a></span>
<span class="normal"><a href="#__codelineno-0-603">603</a></span>
<span class="normal"><a href="#__codelineno-0-604">604</a></span>
<span class="normal"><a href="#__codelineno-0-605">605</a></span>
<span class="normal"><a href="#__codelineno-0-606">606</a></span>
<span class="normal"><a href="#__codelineno-0-607">607</a></span>
<span class="normal"><a href="#__codelineno-0-608">608</a></span>
<span class="normal"><a href="#__codelineno-0-609">609</a></span>
<span class="normal"><a href="#__codelineno-0-610">610</a></span>
<span class="normal"><a href="#__codelineno-0-611">611</a></span>
<span class="normal"><a href="#__codelineno-0-612">612</a></span>
<span class="normal"><a href="#__codelineno-0-613">613</a></span>
<span class="normal"><a href="#__codelineno-0-614">614</a></span>
<span class="normal"><a href="#__codelineno-0-615">615</a></span>
<span class="normal"><a href="#__codelineno-0-616">616</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-535" name="__codelineno-0-535"></a><span class="nd">@staticmethod</span>
<a id="__codelineno-0-536" name="__codelineno-0-536"></a><span class="k">def</span><span class="w"> </span><span class="nf">scale_percentile</span><span class="p">(</span><span class="n">arr</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">percentile</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-537" name="__codelineno-0-537"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Scale an array using percentile-based contrast stretching.</span>
<a id="__codelineno-0-538" name="__codelineno-0-538"></a>
<a id="__codelineno-0-539" name="__codelineno-0-539"></a><span class="sd">    This method enhances the contrast of an image by stretching the histogram</span>
<a id="__codelineno-0-540" name="__codelineno-0-540"></a><span class="sd">    based on percentile values. It calculates the lower and upper percentile values</span>
<a id="__codelineno-0-541" name="__codelineno-0-541"></a><span class="sd">    for each band and normalizes the data to the range [0, 1].</span>
<a id="__codelineno-0-542" name="__codelineno-0-542"></a>
<a id="__codelineno-0-543" name="__codelineno-0-543"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-544" name="__codelineno-0-544"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-545" name="__codelineno-0-545"></a><span class="sd">    arr : np.ndarray</span>
<a id="__codelineno-0-546" name="__codelineno-0-546"></a><span class="sd">        The array to be scaled, with shape (height, width, bands).</span>
<a id="__codelineno-0-547" name="__codelineno-0-547"></a><span class="sd">        Typically an RGB image with 3 bands.</span>
<a id="__codelineno-0-548" name="__codelineno-0-548"></a><span class="sd">    percentile : int, optional</span>
<a id="__codelineno-0-549" name="__codelineno-0-549"></a><span class="sd">        The percentile value to be used for scaling, by default 1.</span>
<a id="__codelineno-0-550" name="__codelineno-0-550"></a><span class="sd">        This value determines how much of the histogram tails to exclude.</span>
<a id="__codelineno-0-551" name="__codelineno-0-551"></a><span class="sd">        Higher values result in more contrast stretching.</span>
<a id="__codelineno-0-552" name="__codelineno-0-552"></a><span class="sd">        Typical values range from 1 to 5.</span>
<a id="__codelineno-0-553" name="__codelineno-0-553"></a>
<a id="__codelineno-0-554" name="__codelineno-0-554"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-555" name="__codelineno-0-555"></a><span class="sd">    -------</span>
<a id="__codelineno-0-556" name="__codelineno-0-556"></a><span class="sd">    np.ndarray</span>
<a id="__codelineno-0-557" name="__codelineno-0-557"></a><span class="sd">        The scaled array, normalized between 0 and 1, with the same shape as input.</span>
<a id="__codelineno-0-558" name="__codelineno-0-558"></a><span class="sd">        Data type is float32.</span>
<a id="__codelineno-0-559" name="__codelineno-0-559"></a>
<a id="__codelineno-0-560" name="__codelineno-0-560"></a><span class="sd">    Notes</span>
<a id="__codelineno-0-561" name="__codelineno-0-561"></a><span class="sd">    -----</span>
<a id="__codelineno-0-562" name="__codelineno-0-562"></a><span class="sd">    The method works by:</span>
<a id="__codelineno-0-563" name="__codelineno-0-563"></a><span class="sd">    1. Computing the lower percentile value for each band</span>
<a id="__codelineno-0-564" name="__codelineno-0-564"></a><span class="sd">    2. Computing the upper percentile value (100 - percentile) for each band</span>
<a id="__codelineno-0-565" name="__codelineno-0-565"></a><span class="sd">    3. Normalizing each band using these percentile values</span>
<a id="__codelineno-0-566" name="__codelineno-0-566"></a><span class="sd">    4. Clipping values to the range [0, 1]</span>
<a id="__codelineno-0-567" name="__codelineno-0-567"></a>
<a id="__codelineno-0-568" name="__codelineno-0-568"></a><span class="sd">    This is particularly useful for visualizing satellite imagery with high dynamic range.</span>
<a id="__codelineno-0-569" name="__codelineno-0-569"></a>
<a id="__codelineno-0-570" name="__codelineno-0-570"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-571" name="__codelineno-0-571"></a><span class="sd">    --------</span>
<a id="__codelineno-0-572" name="__codelineno-0-572"></a><span class="sd">    Scale a single-band array:</span>
<a id="__codelineno-0-573" name="__codelineno-0-573"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-574" name="__codelineno-0-574"></a><span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-575" name="__codelineno-0-575"></a><span class="sd">    &gt;&gt;&gt; from cleopatra.array_glyph import ArrayGlyph</span>
<a id="__codelineno-0-576" name="__codelineno-0-576"></a><span class="sd">    &gt;&gt;&gt; # Create a test array with values between 0 and 10000</span>
<a id="__codelineno-0-577" name="__codelineno-0-577"></a><span class="sd">    &gt;&gt;&gt; test_array = np.random.randint(0, 10000, size=(100, 100, 1))</span>
<a id="__codelineno-0-578" name="__codelineno-0-578"></a><span class="sd">    &gt;&gt;&gt; scaled = ArrayGlyph.scale_percentile(test_array, percentile=2)</span>
<a id="__codelineno-0-579" name="__codelineno-0-579"></a><span class="sd">    &gt;&gt;&gt; scaled.shape</span>
<a id="__codelineno-0-580" name="__codelineno-0-580"></a><span class="sd">    (100, 100, 1)</span>
<a id="__codelineno-0-581" name="__codelineno-0-581"></a><span class="sd">    &gt;&gt;&gt; np.all((0 &lt;= scaled) &amp; (scaled &lt;= 1))</span>
<a id="__codelineno-0-582" name="__codelineno-0-582"></a><span class="sd">    np.True_</span>
<a id="__codelineno-0-583" name="__codelineno-0-583"></a>
<a id="__codelineno-0-584" name="__codelineno-0-584"></a><span class="sd">    ```</span>
<a id="__codelineno-0-585" name="__codelineno-0-585"></a><span class="sd">    Scale an RGB array:</span>
<a id="__codelineno-0-586" name="__codelineno-0-586"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-587" name="__codelineno-0-587"></a><span class="sd">    &gt;&gt;&gt; rgb_array = np.random.randint(0, 10000, size=(100, 100, 3))</span>
<a id="__codelineno-0-588" name="__codelineno-0-588"></a><span class="sd">    &gt;&gt;&gt; scaled = ArrayGlyph.scale_percentile(rgb_array, percentile=2)</span>
<a id="__codelineno-0-589" name="__codelineno-0-589"></a><span class="sd">    &gt;&gt;&gt; scaled.shape</span>
<a id="__codelineno-0-590" name="__codelineno-0-590"></a><span class="sd">    (100, 100, 3)</span>
<a id="__codelineno-0-591" name="__codelineno-0-591"></a><span class="sd">    &gt;&gt;&gt; np.all((0 &lt;= scaled) &amp; (scaled &lt;= 1))</span>
<a id="__codelineno-0-592" name="__codelineno-0-592"></a><span class="sd">    np.True_</span>
<a id="__codelineno-0-593" name="__codelineno-0-593"></a>
<a id="__codelineno-0-594" name="__codelineno-0-594"></a><span class="sd">    ```</span>
<a id="__codelineno-0-595" name="__codelineno-0-595"></a><span class="sd">    Using different percentile values affects contrast:</span>
<a id="__codelineno-0-596" name="__codelineno-0-596"></a><span class="sd">    ```python</span>
<a id="__codelineno-0-597" name="__codelineno-0-597"></a><span class="sd">    &gt;&gt;&gt; low_contrast = ArrayGlyph.scale_percentile(rgb_array, percentile=1)</span>
<a id="__codelineno-0-598" name="__codelineno-0-598"></a><span class="sd">    &gt;&gt;&gt; high_contrast = ArrayGlyph.scale_percentile(rgb_array, percentile=5)</span>
<a id="__codelineno-0-599" name="__codelineno-0-599"></a><span class="sd">    &gt;&gt;&gt; # Higher percentile typically results in higher contrast</span>
<a id="__codelineno-0-600" name="__codelineno-0-600"></a>
<a id="__codelineno-0-601" name="__codelineno-0-601"></a><span class="sd">    ```</span>
<a id="__codelineno-0-602" name="__codelineno-0-602"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-603" name="__codelineno-0-603"></a>    <span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">bands</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-0-604" name="__codelineno-0-604"></a>    <span class="c1"># flatten image.</span>
<a id="__codelineno-0-605" name="__codelineno-0-605"></a>    <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">[</span><span class="n">rows</span> <span class="o">*</span> <span class="n">columns</span><span class="p">,</span> <span class="n">bands</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<a id="__codelineno-0-606" name="__codelineno-0-606"></a>    <span class="c1"># lower percentile values (one value for each band).</span>
<a id="__codelineno-0-607" name="__codelineno-0-607"></a>    <span class="n">lower_percent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">percentile</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-608" name="__codelineno-0-608"></a>    <span class="c1"># 98 percentile values.</span>
<a id="__codelineno-0-609" name="__codelineno-0-609"></a>    <span class="n">upper_percent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="mi">100</span> <span class="o">-</span> <span class="n">percentile</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">lower_percent</span>
<a id="__codelineno-0-610" name="__codelineno-0-610"></a>    <span class="c1"># normalize the 3 bands using the percentile values for each band.</span>
<a id="__codelineno-0-611" name="__codelineno-0-611"></a>    <span class="n">arr</span> <span class="o">=</span> <span class="p">(</span><span class="n">arr</span> <span class="o">-</span> <span class="n">lower_percent</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:])</span> <span class="o">/</span> <span class="n">upper_percent</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]</span>
<a id="__codelineno-0-612" name="__codelineno-0-612"></a>    <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">[</span><span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">bands</span><span class="p">])</span>
<a id="__codelineno-0-613" name="__codelineno-0-613"></a>    <span class="c1"># discard outliers.</span>
<a id="__codelineno-0-614" name="__codelineno-0-614"></a>    <span class="n">arr</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-615" name="__codelineno-0-615"></a>
<a id="__codelineno-0-616" name="__codelineno-0-616"></a>    <span class="k">return</span> <span class="n">arr</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="cleopatra.array_glyph.ArrayGlyph.scale_to_rgb" class="doc doc-heading"><a href="#cleopatra.array_glyph.ArrayGlyph.scale_to_rgb" class="toclink">
            <code class="highlight language-python"><span class="n">scale_to_rgb</span><span class="p">(</span><span class="n">arr</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</a><a href="#cleopatra.array_glyph.ArrayGlyph.scale_to_rgb" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Create an RGB image.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>arr</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>array. if None, the array in the object will be used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]])</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="n">ArrayGlyph</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">rgb_array</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">scale_to_rgb</span><span class="p">()</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">rgb_array</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">[[28 56 85]</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="go"> [113 141 170]</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="go"> [198 226 255]]</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="go"> &gt;&gt;&gt; print(rgb_array.dtype)</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>cleopatra/array_glyph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-853">853</a></span>
<span class="normal"><a href="#__codelineno-0-854">854</a></span>
<span class="normal"><a href="#__codelineno-0-855">855</a></span>
<span class="normal"><a href="#__codelineno-0-856">856</a></span>
<span class="normal"><a href="#__codelineno-0-857">857</a></span>
<span class="normal"><a href="#__codelineno-0-858">858</a></span>
<span class="normal"><a href="#__codelineno-0-859">859</a></span>
<span class="normal"><a href="#__codelineno-0-860">860</a></span>
<span class="normal"><a href="#__codelineno-0-861">861</a></span>
<span class="normal"><a href="#__codelineno-0-862">862</a></span>
<span class="normal"><a href="#__codelineno-0-863">863</a></span>
<span class="normal"><a href="#__codelineno-0-864">864</a></span>
<span class="normal"><a href="#__codelineno-0-865">865</a></span>
<span class="normal"><a href="#__codelineno-0-866">866</a></span>
<span class="normal"><a href="#__codelineno-0-867">867</a></span>
<span class="normal"><a href="#__codelineno-0-868">868</a></span>
<span class="normal"><a href="#__codelineno-0-869">869</a></span>
<span class="normal"><a href="#__codelineno-0-870">870</a></span>
<span class="normal"><a href="#__codelineno-0-871">871</a></span>
<span class="normal"><a href="#__codelineno-0-872">872</a></span>
<span class="normal"><a href="#__codelineno-0-873">873</a></span>
<span class="normal"><a href="#__codelineno-0-874">874</a></span>
<span class="normal"><a href="#__codelineno-0-875">875</a></span>
<span class="normal"><a href="#__codelineno-0-876">876</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-853" name="__codelineno-0-853"></a><span class="k">def</span><span class="w"> </span><span class="nf">scale_to_rgb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arr</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<a id="__codelineno-0-854" name="__codelineno-0-854"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an RGB image.</span>
<a id="__codelineno-0-855" name="__codelineno-0-855"></a>
<a id="__codelineno-0-856" name="__codelineno-0-856"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-857" name="__codelineno-0-857"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-858" name="__codelineno-0-858"></a><span class="sd">    arr: np.ndarray, default is None.</span>
<a id="__codelineno-0-859" name="__codelineno-0-859"></a><span class="sd">        array. if None, the array in the object will be used.</span>
<a id="__codelineno-0-860" name="__codelineno-0-860"></a>
<a id="__codelineno-0-861" name="__codelineno-0-861"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-862" name="__codelineno-0-862"></a><span class="sd">    --------</span>
<a id="__codelineno-0-863" name="__codelineno-0-863"></a><span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-864" name="__codelineno-0-864"></a><span class="sd">    &gt;&gt;&gt; arr = np.array([[1, 2, 3], [4, 5, 6], [7, 8, 9]])</span>
<a id="__codelineno-0-865" name="__codelineno-0-865"></a><span class="sd">    &gt;&gt;&gt; array = ArrayGlyph(arr)</span>
<a id="__codelineno-0-866" name="__codelineno-0-866"></a><span class="sd">    &gt;&gt;&gt; rgb_array = array.scale_to_rgb()</span>
<a id="__codelineno-0-867" name="__codelineno-0-867"></a><span class="sd">    &gt;&gt;&gt; print(rgb_array)</span>
<a id="__codelineno-0-868" name="__codelineno-0-868"></a><span class="sd">    [[28 56 85]</span>
<a id="__codelineno-0-869" name="__codelineno-0-869"></a><span class="sd">     [113 141 170]</span>
<a id="__codelineno-0-870" name="__codelineno-0-870"></a><span class="sd">     [198 226 255]]</span>
<a id="__codelineno-0-871" name="__codelineno-0-871"></a><span class="sd">     &gt;&gt;&gt; print(rgb_array.dtype)</span>
<a id="__codelineno-0-872" name="__codelineno-0-872"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-873" name="__codelineno-0-873"></a>    <span class="k">if</span> <span class="n">arr</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-874" name="__codelineno-0-874"></a>        <span class="n">arr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr</span>
<a id="__codelineno-0-875" name="__codelineno-0-875"></a>    <span class="c1"># This is done to scale the values between 0 and 255</span>
<a id="__codelineno-0-876" name="__codelineno-0-876"></a>    <span class="k">return</span> <span class="p">(</span><span class="n">arr</span> <span class="o">*</span> <span class="mi">255</span> <span class="o">/</span> <span class="n">arr</span><span class="o">.</span><span class="n">max</span><span class="p">())</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;uint8&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="cleopatra.array_glyph.ArrayGlyph.to_image" class="doc doc-heading"><a href="#cleopatra.array_glyph.ArrayGlyph.to_image" class="toclink">
            <code class="highlight language-python"><span class="n">to_image</span><span class="p">(</span><span class="n">arr</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</a><a href="#cleopatra.array_glyph.ArrayGlyph.to_image" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Create an RGB image from an array.</p>
<div class="highlight"><pre><span></span><code>convert the array to an image.
</code></pre></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>arr</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>array. if None, the array in the object will be used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]])</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="n">ArrayGlyph</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">to_image</span><span class="p">()</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">&lt;PIL.Image.Image image mode=RGB size=3x3 at 0x7F5E0D2F4C40&gt;</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>cleopatra/array_glyph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-828">828</a></span>
<span class="normal"><a href="#__codelineno-0-829">829</a></span>
<span class="normal"><a href="#__codelineno-0-830">830</a></span>
<span class="normal"><a href="#__codelineno-0-831">831</a></span>
<span class="normal"><a href="#__codelineno-0-832">832</a></span>
<span class="normal"><a href="#__codelineno-0-833">833</a></span>
<span class="normal"><a href="#__codelineno-0-834">834</a></span>
<span class="normal"><a href="#__codelineno-0-835">835</a></span>
<span class="normal"><a href="#__codelineno-0-836">836</a></span>
<span class="normal"><a href="#__codelineno-0-837">837</a></span>
<span class="normal"><a href="#__codelineno-0-838">838</a></span>
<span class="normal"><a href="#__codelineno-0-839">839</a></span>
<span class="normal"><a href="#__codelineno-0-840">840</a></span>
<span class="normal"><a href="#__codelineno-0-841">841</a></span>
<span class="normal"><a href="#__codelineno-0-842">842</a></span>
<span class="normal"><a href="#__codelineno-0-843">843</a></span>
<span class="normal"><a href="#__codelineno-0-844">844</a></span>
<span class="normal"><a href="#__codelineno-0-845">845</a></span>
<span class="normal"><a href="#__codelineno-0-846">846</a></span>
<span class="normal"><a href="#__codelineno-0-847">847</a></span>
<span class="normal"><a href="#__codelineno-0-848">848</a></span>
<span class="normal"><a href="#__codelineno-0-849">849</a></span>
<span class="normal"><a href="#__codelineno-0-850">850</a></span>
<span class="normal"><a href="#__codelineno-0-851">851</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-828" name="__codelineno-0-828"></a><span class="k">def</span><span class="w"> </span><span class="nf">to_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arr</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Image</span><span class="o">.</span><span class="n">Image</span><span class="p">:</span>
<a id="__codelineno-0-829" name="__codelineno-0-829"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an RGB image from an array.</span>
<a id="__codelineno-0-830" name="__codelineno-0-830"></a>
<a id="__codelineno-0-831" name="__codelineno-0-831"></a><span class="sd">        convert the array to an image.</span>
<a id="__codelineno-0-832" name="__codelineno-0-832"></a>
<a id="__codelineno-0-833" name="__codelineno-0-833"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-834" name="__codelineno-0-834"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-835" name="__codelineno-0-835"></a><span class="sd">    arr: np.ndarray, default is None.</span>
<a id="__codelineno-0-836" name="__codelineno-0-836"></a><span class="sd">        array. if None, the array in the object will be used.</span>
<a id="__codelineno-0-837" name="__codelineno-0-837"></a>
<a id="__codelineno-0-838" name="__codelineno-0-838"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-839" name="__codelineno-0-839"></a><span class="sd">    --------</span>
<a id="__codelineno-0-840" name="__codelineno-0-840"></a><span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<a id="__codelineno-0-841" name="__codelineno-0-841"></a><span class="sd">    &gt;&gt;&gt; arr = np.array([[1, 2, 3], [4, 5, 6], [7, 8, 9]])</span>
<a id="__codelineno-0-842" name="__codelineno-0-842"></a><span class="sd">    &gt;&gt;&gt; array = ArrayGlyph(arr)</span>
<a id="__codelineno-0-843" name="__codelineno-0-843"></a><span class="sd">    &gt;&gt;&gt; image = array.to_image()</span>
<a id="__codelineno-0-844" name="__codelineno-0-844"></a><span class="sd">    &gt;&gt;&gt; print(image) # doctest: +SKIP</span>
<a id="__codelineno-0-845" name="__codelineno-0-845"></a><span class="sd">    &lt;PIL.Image.Image image mode=RGB size=3x3 at 0x7F5E0D2F4C40&gt;</span>
<a id="__codelineno-0-846" name="__codelineno-0-846"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-847" name="__codelineno-0-847"></a>    <span class="k">if</span> <span class="n">arr</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-848" name="__codelineno-0-848"></a>        <span class="n">arr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">arr</span>
<a id="__codelineno-0-849" name="__codelineno-0-849"></a>    <span class="c1"># This is done to scale the values between 0 and 255</span>
<a id="__codelineno-0-850" name="__codelineno-0-850"></a>    <span class="n">arr</span> <span class="o">=</span> <span class="n">arr</span> <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s2">&quot;uint8&quot;</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale_to_rgb</span><span class="p">()</span>
<a id="__codelineno-0-851" name="__codelineno-0-851"></a>    <span class="k">return</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;RGB&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="examples"><a class="toclink" href="#examples">Examples</a><a class="headerlink" href="#examples" title="Permanent link">#</a></h2>
<h3 id="basic-array-plot"><a class="toclink" href="#basic-array-plot">Basic Array Plot</a><a class="headerlink" href="#basic-array-plot" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">cleopatra.array_glyph</span><span class="w"> </span><span class="kn">import</span> <span class="n">ArrayGlyph</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Create a sample array</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="c1"># Create an ArrayGlyph object</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="n">array_glyph</span> <span class="o">=</span> <span class="n">ArrayGlyph</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="c1"># Plot the array</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">im</span><span class="p">,</span> <span class="n">cbar</span> <span class="o">=</span> <span class="n">array_glyph</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</code></pre></div>
<p><img alt="Array Plot Example" src="../_images/array-plot.png" /></p>
<h3 id="display-cell-values"><a class="toclink" href="#display-cell-values">Display Cell Values</a><a class="headerlink" href="#display-cell-values" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1"># Plot the array with cell values displayed</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">im</span><span class="p">,</span> <span class="n">cbar</span> <span class="o">=</span> <span class="n">array_glyph</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">display_cell_values</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
<p><img alt="Display Cell Values Example" src="../_images/display-cell-values.png" /></p>
<h3 id="display-points"><a class="toclink" href="#display-points">Display Points</a><a class="headerlink" href="#display-points" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1"># Create some points to display on the array</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="c1"># Plot the array with points</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">im</span><span class="p">,</span> <span class="n">cbar</span> <span class="o">=</span> <span class="n">array_glyph</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="o">=</span><span class="n">points</span><span class="p">)</span>
</code></pre></div>
<p><img alt="Display Points Example" src="../_images/display-points.png" /></p>
<h3 id="animation"><a class="toclink" href="#animation">Animation</a><a class="headerlink" href="#animation" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">cleopatra.array_glyph</span><span class="w"> </span><span class="kn">import</span> <span class="n">ArrayGlyph</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="c1"># Create a time series of arrays</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="n">time_series</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="n">time_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;t1&quot;</span><span class="p">,</span> <span class="s2">&quot;t2&quot;</span><span class="p">,</span> <span class="s2">&quot;t3&quot;</span><span class="p">,</span> <span class="s2">&quot;t4&quot;</span><span class="p">,</span> <span class="s2">&quot;t5&quot;</span><span class="p">]</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="c1"># Create an ArrayGlyph object with the first array</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="n">array_glyph</span> <span class="o">=</span> <span class="n">ArrayGlyph</span><span class="p">(</span><span class="n">time_series</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="c1"># Animate the array over time</span>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="n">anim</span> <span class="o">=</span> <span class="n">array_glyph</span><span class="o">.</span><span class="n">animate</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time_labels</span><span class="p">,</span> <span class="n">points</span><span class="o">=</span><span class="n">points</span><span class="p">)</span>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="c1"># Save the animation</span>
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="n">array_glyph</span><span class="o">.</span><span class="n">save_animation</span><span class="p">(</span><span class="s2">&quot;animation.gif&quot;</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div>
<p><img alt="Animation Example" src="../_images/animated_array.gif" /></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../statistics-class/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Statistical plots">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Statistical plots
              </div>
            </div>
          </a>
        
        
          
          <a href="../colors-class/" class="md-footer__link md-footer__link--next" aria-label="Next: Colors">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Colors
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/Serapieum-of-alex/cleopatra" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.expand", "navigation.indexes", "navigation.footer", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "content.code.copy", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tooltips", "search.highlight", "search.suggest", "toc.follow", "announce.dismiss"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>